"use strict";var snarkjs=(()=>{var xs=Object.defineProperty;var E0=Object.getOwnPropertyDescriptor;var v0=Object.getOwnPropertyNames;var S0=Object.prototype.hasOwnProperty;var xe=(c,t)=>()=>(c&&(t=c(c=0)),t);var Sn=(c,t)=>()=>(t||c((t={exports:{}}).exports,t),t.exports),Ae=(c,t)=>{for(var n in t)xs(c,n,{get:t[n],enumerable:!0})},q0=(c,t,n,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of v0(t))!S0.call(c,o)&&o!==n&&xs(c,o,{get:()=>t[o],enumerable:!(a=E0(t,o))||a.enumerable});return c};var Ee=c=>q0(xs({},"__esModule",{value:!0}),c);var su={};Ae(su,{BigBuffer:()=>gn,ChaCha:()=>Re,EC:()=>$s,F1Field:()=>ks,F2Field:()=>Us,F3Field:()=>Ns,PolField:()=>Ts,Scalar:()=>fg,ZqField:()=>ks,buildBls12381:()=>Xe,buildBn128:()=>Qe,getCurveFromName:()=>hg,getCurveFromQ:()=>_g,getCurveFromR:()=>ug,utils:()=>gg});function je(c,t){if(!t||t==10)return BigInt(c);if(t==16)return c.slice(0,2)=="0x"?BigInt(c):BigInt("0x"+c)}function O0(c,t){let n=BigInt(0);t=BigInt(t);for(let a=0;a<c.length;a++)n=n*t+BigInt(c[a]);return n}function fi(c){let t=c.toString(16);return(t.length-1)*4+I0[parseInt(t[0],16)]}function v2(c){return BigInt(c)<BigInt(0)}function Js(c){return!c}function Ie(c,t){return BigInt(c)<<BigInt(t)}function Fo(c,t){return BigInt(c)>>BigInt(t)}function Ys(c){return(BigInt(c)&BigInt(1))==BigInt(1)}function S2(c){let t=BigInt(c),n=[];for(;t;){if(t&BigInt(1)){let a=2-Number(t%BigInt(4));n.push(a),t=t-BigInt(a)}else n.push(0);t=t>>BigInt(1)}return n}function q2(c){let t=BigInt(c),n=[];for(;t;)t&BigInt(1)?n.push(1):n.push(0),t=t>>BigInt(1);return n}function I2(c){if(c>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(c)}function R0(c,t){let n=[],a=BigInt(c);for(t=BigInt(t);a;)n.unshift(Number(a%t)),a=a/t;return n}function tl(c,t){return BigInt(c)+BigInt(t)}function Sa(c,t){return BigInt(c)-BigInt(t)}function O2(c){return-BigInt(c)}function P2(c,t){return BigInt(c)*BigInt(t)}function z0(c){return BigInt(c)*BigInt(c)}function gi(c,t){return BigInt(c)**BigInt(t)}function T0(c,t){return BigInt(c)**BigInt(t)}function G0(c){return BigInt(c)>=0?BigInt(c):-BigInt(c)}function Co(c,t){return BigInt(c)/BigInt(t)}function ba(c,t){return BigInt(c)%BigInt(t)}function ua(c,t){return BigInt(c)==BigInt(t)}function k0(c,t){return BigInt(c)!=BigInt(t)}function U0(c,t){return BigInt(c)<BigInt(t)}function Oe(c,t){return BigInt(c)>BigInt(t)}function N0(c,t){return BigInt(c)<=BigInt(t)}function M2(c,t){return BigInt(c)>=BigInt(t)}function nl(c,t){return BigInt(c)&BigInt(t)}function $0(c,t){return BigInt(c)|BigInt(t)}function Z0(c,t){return BigInt(c)^BigInt(t)}function j0(c,t){return BigInt(c)&&BigInt(t)}function V0(c,t){return BigInt(c)||BigInt(t)}function W0(c){return!BigInt(c)}function _i(c,t,n,a){let o="0000000"+n.toString(16),e=new Uint32Array(c.buffer,c.byteOffset+t,a/4),h=((o.length-7)*4-1>>5)+1;for(let d=0;d<h;d++)e[d]=parseInt(o.substring(o.length-8*d-8,o.length-8*d),16);for(let d=h;d<e.length;d++)e[d]=0;for(let d=e.length*4;d<a;d++)c[d]=I2(nl(Fo(n,d*8),255))}function R2(c,t,n,a){let o="0000000"+n.toString(16),e=new DataView(c.buffer,c.byteOffset+t,a),h=((o.length-7)*4-1>>5)+1;for(let d=0;d<h;d++)e.setUint32(a-d*4-4,parseInt(o.substring(o.length-8*d-8,o.length-8*d),16),!1);for(let d=0;d<a/4-h;d++)e[d]=0}function hi(c,t,n){n=n||c.byteLength,t=t||0;let a=new Uint32Array(c.buffer,c.byteOffset+t,n/4),o=new Array(n/4);return a.forEach((e,h)=>o[o.length-h-1]=e.toString(16).padStart(8,"0")),je(o.join(""),16)}function z2(c,t,n){n=n||c.byteLength,t=t||0;let a=new DataView(c.buffer,c.byteOffset+t,n),o=new Array(n/4);for(let e=0;e<n/4;e++)o[e]=a.getUint32(e*4,!1).toString(16).padStart(8,"0");return je(o.join(""),16)}function Ve(c,t){return c.toString(t)}function Bo(c){let t=new Uint8Array(Math.floor((fi(c)-1)/8)+1);return _i(t,0,c,t.byteLength),t}function pa(c){return((c&4294901760)!==0?(c&=4294901760,16):0)|((c&4278255360)!==0?(c&=4278255360,8):0)|((c&4042322160)!==0?(c&=4042322160,4):0)|((c&3435973836)!==0?(c&=3435973836,2):0)|(c&2863311530)!==0}function so(c,t,n,a,o){let e=1<<n;if(e==1)return[t[a]];if(e==2)return[c.F.add(t[a],t[a+o]),c.F.sub(t[a],t[a+o])];let h=e>>1,d=so(c,t,n-1,a,o*2),b=so(c,t,n-1,a+o,o*2),l=new Array(e);for(let s=0;s<h;s++)l[s]=c.F.add(d[s],c.F.mul(c.roots[n][s],b[s])),l[s+h]=c.F.sub(d[s],c.F.mul(c.roots[n][s],b[s]));return l}function Pe(c,t,n){let a=1<<n;if(a==1)return[t[0]];let o=a>>1,e=Pe(c,t.slice(0,o),n-1),h=Pe(c,t.slice(o),n-1),d=new Array(a);for(let b=0;b<o;b++)d[b]=c.F.add(e[b],c.F.mul(c.roots[n][b],h[b])),d[b+o]=c.F.sub(e[b],c.F.mul(c.roots[n][b],h[b]));return d}function X0(c,t){let n=0,a=c;for(let o=0;o<t;o++)n<<=1,n=n|a&1,a>>=1;return n}function H0(c,t){return(di[c>>>24]|di[c>>>16&255]<<8|di[c>>>8&255]<<16|di[c&255]<<24)>>>32-t}function l2(c,t){for(let n=0;n<c.length;n++){let a=H0(n,t);if(a>n){let o=c[n];c[n]=c[a],c[a]=o}}}function Me(c,t,n){let a;if(Js(n))return c.zero;let o=S2(n);if(o[o.length-1]==1)a=t;else if(o[o.length-1]==-1)a=c.neg(t);else throw new Error("invlaud NAF");for(let e=o.length-2;e>=0;e--)a=c.double(a),o[e]==1?a=c.add(a,t):o[e]==-1&&(a=c.sub(a,t));return a}function xo(c,t,n){if(Js(n))return c.one;let a=q2(n);if(a.length==0)return c.one;let o=t;for(let e=a.length-2;e>=0;e--)o=c.square(o),a[e]&&(o=c.mul(o,t));return o}function G2(c){if(c.m%2==1)if(ua(ba(c.p,4),1))if(ua(ba(c.p,8),1))if(ua(ba(c.p,16),1))D0(c);else if(ua(ba(c.p,16),9))K0(c);else throw new Error("Field withot sqrt");else if(ua(ba(c.p,8),5))J0(c);else throw new Error("Field withot sqrt");else ua(ba(c.p,4),3)&&Y0(c);else{let t=ba(gi(c.p,c.m/2),4);t==1?t1(c):t==3?n1(c):a1(c)}}function D0(c){for(c.sqrt_q=gi(c.p,c.m),c.sqrt_s=0,c.sqrt_t=Sa(c.sqrt_q,1);!Ys(c.sqrt_t);)c.sqrt_s=c.sqrt_s+1,c.sqrt_t=Co(c.sqrt_t,2);let t=c.one;for(;c.eq(t,c.one);){let n=c.random();c.sqrt_z=c.pow(n,c.sqrt_t),t=c.pow(c.sqrt_z,2**(c.sqrt_s-1))}c.sqrt_tm1d2=Co(Sa(c.sqrt_t,1),2),c.sqrt=function(n){let a=this;if(a.isZero(n))return a.zero;let o=a.pow(n,a.sqrt_tm1d2),e=a.pow(a.mul(a.square(o),n),2**(a.sqrt_s-1));if(a.eq(e,a.negone))return null;let h=a.sqrt_s,d=a.mul(n,o),b=a.mul(d,o),l=a.sqrt_z;for(;!a.eq(b,a.one);){let s=a.square(b),m=1;for(;!a.eq(s,a.one);)s=a.square(s),m++;o=l;for(let B=0;B<h-m-1;B++)o=a.square(o);l=a.square(o),b=a.mul(b,l),d=a.mul(d,o),h=m}return a.geq(d,a.zero)?d:a.neg(d)}}function K0(c){c.sqrt=function(){throw new Error("Sqrt alg 4 not implemented")}}function J0(c){c.sqrt=function(){throw new Error("Sqrt alg 3 not implemented")}}function Y0(c){c.sqrt_q=gi(c.p,c.m),c.sqrt_e1=Co(Sa(c.sqrt_q,3),4),c.sqrt=function(t){if(this.isZero(t))return this.zero;let n=this.pow(t,this.sqrt_e1),a=this.mul(this.square(n),t);if(this.eq(a,this.negone))return null;let o=this.mul(n,t);return c.geq(o,c.zero)?o:c.neg(o)}}function t1(c){c.sqrt=function(){throw new Error("Sqrt alg 10 not implemented")}}function n1(c){c.sqrt_q=gi(c.p,c.m/2),c.sqrt_e34=Co(Sa(c.sqrt_q,3),4),c.sqrt_e12=Co(Sa(c.sqrt_q,1),2),c.frobenius=function(t,n){return t%2==1?c.conjugate(n):n},c.sqrt=function(t){let n=this,a=n.pow(t,n.sqrt_e34),o=n.mul(n.square(a),t),e=n.mul(n.frobenius(1,o),o);if(n.eq(e,n.negone))return null;let h=n.mul(a,t),d;if(n.eq(o,n.negone))d=n.mul(h,[n.F.zero,n.F.one]);else{let b=n.pow(n.add(n.one,o),n.sqrt_e12);d=n.mul(b,h)}return n.geq(d,n.zero)?d:n.neg(d)}}function a1(c){c.sqrt=function(){throw new Error("Sqrt alg 8 not implemented")}}function ka(c,t,n,a,o){c[t]=c[t]+c[n]>>>0,c[o]=(c[o]^c[t])>>>0,c[o]=(c[o]<<16|c[o]>>>16&65535)>>>0,c[a]=c[a]+c[o]>>>0,c[n]=(c[n]^c[a])>>>0,c[n]=(c[n]<<12|c[n]>>>20&4095)>>>0,c[t]=c[t]+c[n]>>>0,c[o]=(c[o]^c[t])>>>0,c[o]=(c[o]<<8|c[o]>>>24&255)>>>0,c[a]=c[a]+c[o]>>>0,c[n]=(c[n]^c[a])>>>0,c[n]=(c[n]<<7|c[n]>>>25&127)>>>0}function o1(c){ka(c,0,4,8,12),ka(c,1,5,9,13),ka(c,2,6,10,14),ka(c,3,7,11,15),ka(c,0,5,10,15),ka(c,1,6,11,12),ka(c,2,7,8,13),ka(c,3,4,9,14)}function k2(c){let t=new Uint8Array(c);if(typeof globalThis.crypto<"u")globalThis.crypto.getRandomValues(t);else for(let n=0;n<c;n++)t[n]=Math.random()*4294967296>>>0;return t}function i1(){let c=k2(32),t=new Uint32Array(c.buffer),n=[];for(let a=0;a<8;a++)n.push(t[a]);return n}function al(){return ve||(ve=new Re(i1()),ve)}function r2(c){return((c&4294901760)!==0?(c&=4294901760,16):0)|((c&4278255360)!==0?(c&=4278255360,8):0)|((c&4042322160)!==0?(c&=4042322160,4):0)|((c&3435973836)!==0?(c&=3435973836,2):0)|(c&2863311530)!==0}function ze(c,t,n,a,o){let e=1<<n;if(e==1)return[t[a]];if(e==2)return[c.G.add(t[a],t[a+o]),c.G.sub(t[a],t[a+o])];let h=e>>1,d=ze(c,t,n-1,a,o*2),b=ze(c,t,n-1,a+o,o*2),l=new Array(e);for(let s=0;s<h;s++)l[s]=c.G.add(d[s],c.opMulGF(b[s],c.roots[n][s])),l[s+h]=c.G.sub(d[s],c.opMulGF(b[s],c.roots[n][s]));return l}function qe(c,t){if(Array.isArray(t)){for(let n=t.length-1;n>=0;n--)if(!c.F.isZero(t[n]))return qe(c.F,t[n]);return 0}else{let n=c.neg(t);return Oe(t,n)}}function c1(c,t){let n=c.modules[t].n64*8,a=c.addFunction(t+"_batchInverse");a.addParam("pIn","i32"),a.addParam("inStep","i32"),a.addParam("n","i32"),a.addParam("pOut","i32"),a.addParam("outStep","i32"),a.addLocal("itAux","i32"),a.addLocal("itIn","i32"),a.addLocal("itOut","i32"),a.addLocal("i","i32");let o=a.getCodeBuilder(),e=o.i32_const(c.alloc(n));a.addCode(o.setLocal("itAux",o.i32_load(o.i32_const(0))),o.i32_store(o.i32_const(0),o.i32_add(o.getLocal("itAux"),o.i32_mul(o.i32_add(o.getLocal("n"),o.i32_const(1)),o.i32_const(n))))),a.addCode(o.call(t+"_one",o.getLocal("itAux")),o.setLocal("itIn",o.getLocal("pIn")),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.if(o.call(t+"_isZero",o.getLocal("itIn")),o.call(t+"_copy",o.i32_sub(o.getLocal("itAux"),o.i32_const(n)),o.getLocal("itAux")),o.call(t+"_mul",o.getLocal("itIn"),o.i32_sub(o.getLocal("itAux"),o.i32_const(n)),o.getLocal("itAux"))),o.setLocal("itIn",o.i32_add(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))),o.setLocal("itIn",o.i32_sub(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itAux",o.i32_sub(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("itOut",o.i32_add(o.getLocal("pOut"),o.i32_mul(o.i32_sub(o.getLocal("n"),o.i32_const(1)),o.getLocal("outStep")))),o.call(t+"_inverse",o.getLocal("itAux"),o.getLocal("itAux")),o.block(o.loop(o.br_if(1,o.i32_eqz(o.getLocal("i"))),o.if(o.call(t+"_isZero",o.getLocal("itIn")),[...o.call(t+"_copy",o.getLocal("itAux"),o.i32_sub(o.getLocal("itAux"),o.i32_const(n))),...o.call(t+"_zero",o.getLocal("itOut"))],[...o.call(t+"_copy",o.i32_sub(o.getLocal("itAux"),o.i32_const(n)),e),...o.call(t+"_mul",o.getLocal("itAux"),o.getLocal("itIn"),o.i32_sub(o.getLocal("itAux"),o.i32_const(n))),...o.call(t+"_mul",o.getLocal("itAux"),e,o.getLocal("itOut"))]),o.setLocal("itIn",o.i32_sub(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itOut",o.i32_sub(o.getLocal("itOut"),o.getLocal("outStep"))),o.setLocal("itAux",o.i32_sub(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("i",o.i32_sub(o.getLocal("i"),o.i32_const(1))),o.br(0)))),a.addCode(o.i32_store(o.i32_const(0),o.getLocal("itAux")))}function s1(c,t,n,a,o,e){typeof e>"u"&&(a<o?e=!0:e=!1);let h=c.addFunction(t);h.addParam("pIn","i32"),h.addParam("n","i32"),h.addParam("pOut","i32"),h.addLocal("i","i32"),h.addLocal("itIn","i32"),h.addLocal("itOut","i32");let d=h.getCodeBuilder();e?h.addCode(d.setLocal("itIn",d.i32_add(d.getLocal("pIn"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(a)))),d.setLocal("itOut",d.i32_add(d.getLocal("pOut"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(o)))),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn"),d.getLocal("itOut")),d.setLocal("itIn",d.i32_sub(d.getLocal("itIn"),d.i32_const(a))),d.setLocal("itOut",d.i32_sub(d.getLocal("itOut"),d.i32_const(o))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0)))):h.addCode(d.setLocal("itIn",d.getLocal("pIn")),d.setLocal("itOut",d.getLocal("pOut")),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn"),d.getLocal("itOut")),d.setLocal("itIn",d.i32_add(d.getLocal("itIn"),d.i32_const(a))),d.setLocal("itOut",d.i32_add(d.getLocal("itOut"),d.i32_const(o))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0))))}function r1(c,t,n,a,o,e){typeof e>"u"&&(a<o?e=!0:e=!1);let h=c.addFunction(t);h.addParam("pIn1","i32"),h.addParam("pIn2","i32"),h.addParam("n","i32"),h.addParam("pOut","i32"),h.addLocal("i","i32"),h.addLocal("itIn1","i32"),h.addLocal("itIn2","i32"),h.addLocal("itOut","i32");let d=h.getCodeBuilder();e?h.addCode(d.setLocal("itIn1",d.i32_add(d.getLocal("pIn1"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(a)))),d.setLocal("itIn2",d.i32_add(d.getLocal("pIn2"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(a)))),d.setLocal("itOut",d.i32_add(d.getLocal("pOut"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(o)))),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn1"),d.getLocal("itIn2"),d.getLocal("itOut")),d.setLocal("itIn1",d.i32_sub(d.getLocal("itIn1"),d.i32_const(a))),d.setLocal("itIn2",d.i32_sub(d.getLocal("itIn2"),d.i32_const(a))),d.setLocal("itOut",d.i32_sub(d.getLocal("itOut"),d.i32_const(o))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0)))):h.addCode(d.setLocal("itIn1",d.getLocal("pIn1")),d.setLocal("itIn2",d.getLocal("pIn2")),d.setLocal("itOut",d.getLocal("pOut")),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn1"),d.getLocal("itIn2"),d.getLocal("itOut")),d.setLocal("itIn1",d.i32_add(d.getLocal("itIn1"),d.i32_const(a))),d.setLocal("itIn2",d.i32_add(d.getLocal("itIn2"),d.i32_const(a))),d.setLocal("itOut",d.i32_add(d.getLocal("itOut"),d.i32_const(o))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0))))}function N2(c,t){return c===t?0:c>t?1:-1}function el(c){return c*c}function $2(c){return c%2n!==0n}function cl(c){return c%2n===0n}function We(c){return c<0n}function d1(c){return c>0n}function Z2(c){return We(c)?c.toString(2).length-1:c.toString(2).length}function Li(c){return c<0n?-c:c}function Ao(c){return Li(c)===1n}function j2(c,t){for(var n=0n,a=1n,o=t,e=Li(c),h,d,b;e!==0n;)h=o/e,d=n,b=o,n=a,o=e,a=d-h*a,e=b-h*e;if(!Ao(o))throw new Error(c.toString()+" and "+t.toString()+" are not co-prime");return N2(n,0n)===-1&&(n=n+t),We(c)?-n:n}function V2(c,t,n){if(n===0n)throw new Error("Cannot take modPow with modulus 0");var a=1n,o=c%n;for(We(t)&&(t=t*-1n,o=j2(o,n));d1(t);){if(o===0n)return 0n;$2(t)&&(a=a*o%n),t=t/2n,o=el(o)%n}return a}function u1(c,t){return c=c>=0n?c:-c,t=t>=0n?t:-t,c===t?0:c>t?1:-1}function d2(c,t){return t===0n?!1:Ao(t)?!0:u1(t,2n)===0?cl(c):c%t===0n}function _1(c){var t=Li(c);if(Ao(t))return!1;if(t===2n||t===3n||t===5n)return!0;if(cl(t)||d2(t,3n)||d2(t,5n))return!1;if(t<49n)return!0}function h1(c){return c-1n}function u2(c,t){for(var n=h1(c),a=n,o=0,e,h,d;cl(a);)a=a/2n,o++;t:for(h=0;h<t.length;h++)if(!(c<t[h])&&(d=V2(BigInt(t[h]),a,c),!(Ao(d)||d===n))){for(e=o-1;e!=0;e--){if(d=el(d)%c,Ao(d))return!1;if(d===n)continue t}return!1}return!0}function f1(c){var t=_1(c);if(t!==void 0)return t;var n=Li(c),a=Z2(n);if(a<=64)return u2(n,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var o=Math.log(2)*Number(a),e=Math.ceil(o),h=[],d=0;d<e;d++)h.push(BigInt(d+2));return u2(n,h)}function Zs(c){if(typeof c=="bigint"||c.eq!==void 0)return c.toString(10);if(c instanceof Uint8Array)return hi(c,0);if(Array.isArray(c))return c.map(Zs);if(typeof c=="object"){let t={};return Object.keys(c).forEach(a=>{t[a]=Zs(c[a])}),t}else return c}function js(c){if(typeof c=="string"&&/^[0-9]+$/.test(c))return BigInt(c);if(typeof c=="string"&&/^0x[0-9a-fA-F]+$/.test(c))return BigInt(c);if(Array.isArray(c))return c.map(js);if(typeof c=="object"){if(c===null)return null;let t={};return Object.keys(c).forEach(a=>{t[a]=js(c[a])}),t}else return c}function X1(c){let t=BigInt(0),n=c.length,a=0,o=new DataView(c.buffer,c.byteOffset,c.byteLength);for(;n>0;)n>=4?(n-=4,t+=BigInt(o.getUint32(n))<<BigInt(a*8),a+=4):n>=2?(n-=2,t+=BigInt(o.getUint16(n))<<BigInt(a*8),a+=2):(n-=1,t+=BigInt(o.getUint8(n))<<BigInt(a*8),a+=1);return t}function H1(c,t){let n=c,a=new Uint8Array(t),o=new DataView(a.buffer),e=t;for(;e>0;)e-4>=0?(e-=4,o.setUint32(e,Number(n&BigInt(4294967295))),n=n>>BigInt(32)):e-2>=0?(e-=2,o.setUint16(e,Number(n&BigInt(65535))),n=n>>BigInt(16)):(e-=1,o.setUint8(e,Number(n&BigInt(255))),n=n>>BigInt(8));if(n)throw new Error("Number does not fit in this length");return a}function D1(c){let t=BigInt(0),n=0,a=new DataView(c.buffer,c.byteOffset,c.byteLength);for(;n<c.length;)n+4<=c.length?(t+=BigInt(a.getUint32(n,!0))<<BigInt(n*8),n+=4):n+2<=c.length?(t+=BigInt(a.getUint16(n,!0))<<BigInt(n*8),n+=2):(t+=BigInt(a.getUint8(n,!0))<<BigInt(n*8),n+=1);return t}function tu(c,t){let n=c;typeof t>"u"&&(t=Math.floor((fi(c)-1)/8)+1,t==0&&(t=1));let a=new Uint8Array(t),o=new DataView(a.buffer),e=0;for(;e<t;)e+4<=t?(o.setUint32(e,Number(n&BigInt(4294967295)),!0),e+=4,n=n>>BigInt(32)):e+2<=t?(o.setUint16(e,Number(n&BigInt(65535)),!0),e+=2,n=n>>BigInt(16)):(o.setUint8(e,Number(n&BigInt(255)),!0),e+=1,n=n>>BigInt(8));if(n)throw new Error("Number does not fit in this length");return a}function Vs(c,t){if(typeof t=="bigint"||t.eq!==void 0)return t.toString(10);if(t instanceof Uint8Array)return c.toString(c.e(t));if(Array.isArray(t))return t.map(Vs.bind(this,c));if(typeof t=="object"){let n={};return Object.keys(t).forEach(o=>{n[o]=Vs(c,t[o])}),n}else return t}function Ws(c,t){if(typeof t=="string"&&/^[0-9]+$/.test(t))return c.e(t);if(typeof t=="string"&&/^0x[0-9a-fA-F]+$/.test(t))return c.e(t);if(Array.isArray(t))return t.map(Ws.bind(this,c));if(typeof t=="object"){if(t===null)return null;let n={};return Object.keys(t).forEach(o=>{n[o]=Ws(c,t[o])}),n}else return t}function K1(c,t){let n=0,a=c;for(let o=0;o<t;o++)n<<=1,n=n|a&1,a>>=1;return n}function nu(c,t){return(ui[c>>>24]|ui[c>>>16&255]<<8|ui[c>>>8&255]<<16|ui[c&255]<<24)>>>32-t}function Jn(c){return((c&4294901760)!==0?(c&=4294901760,16):0)|((c&4278255360)!==0?(c&=4278255360,8):0)|((c&4042322160)!==0?(c&=4042322160,4):0)|((c&3435973836)!==0?(c&=3435973836,2):0)|(c&2863311530)!==0}function au(c,t){let n=c.byteLength/t,a=Jn(n);if(n!=1<<a)throw new Error("Invalid number of pointers");for(let o=0;o<n;o++){let e=nu(o,a);if(o>e){let h=c.slice(o*t,(o+1)*t);c.set(c.slice(e*t,(e+1)*t),o*t),c.set(h,e*t)}}}function ll(c,t){let n=new Uint8Array(t*c.length);for(let a=0;a<c.length;a++)n.set(c[a],a*t);return n}function Te(c,t){let n=c.byteLength/t,a=new Array(n);for(let o=0;o<n;o++)a[o]=c.slice(o*t,o*t+t);return a}function Ua(c,t,n,a){return async function(e){let h=Math.floor(e.byteLength/n);if(h*n!==e.byteLength)throw new Error("Invalid buffer size");let d=Math.floor(h/c.concurrency),b=[];for(let B=0;B<c.concurrency;B++){let p;if(B<c.concurrency-1?p=d:p=h-B*d,p==0)continue;let M=[{cmd:"ALLOCSET",var:0,buff:e.slice(B*d*n,B*d*n+p*n)},{cmd:"ALLOC",var:1,len:a*p},{cmd:"CALL",fnName:t,params:[{var:0},{val:p},{var:1}]},{cmd:"GET",out:0,var:1,len:a*p}];b.push(c.queueAction(M))}let l=await Promise.all(b),s;e instanceof gn?s=new gn(h*a):s=new Uint8Array(h*a);let m=0;for(let B=0;B<l.length;B++)s.set(l[B][0],m),m+=l[B][0].byteLength;return s}}function Y1(c){let n,a;c&&(c.onmessage=function(s){let m;if(s.data?m=s.data:m=s,m[0].cmd=="INIT")o(m[0]).then(function(){c.postMessage(m.result)});else if(m[0].cmd=="TERMINATE")c.close();else{let B=l(m);c.postMessage(B)}});async function o(s){let m=new Uint8Array(s.code),B=await WebAssembly.compile(m);a=new WebAssembly.Memory({initial:s.init,maximum:32767}),n=await WebAssembly.instantiate(B,{env:{memory:a}})}function e(s){let m=new Uint32Array(a.buffer,0,1);for(;m[0]&3;)m[0]++;let B=m[0];if(m[0]+=s,m[0]+s>a.buffer.byteLength){let p=a.buffer.byteLength/65536,v=Math.floor((m[0]+s)/65536)+1;v>32767&&(v=32767),a.grow(v-p)}return B}function h(s){let m=e(s.byteLength);return b(m,s),m}function d(s,m){let B=new Uint8Array(a.buffer);return new Uint8Array(B.buffer,B.byteOffset+s,m)}function b(s,m){new Uint8Array(a.buffer).set(new Uint8Array(m),s)}function l(s){if(s[0].cmd=="INIT")return o(s[0]);let m={vars:[],out:[]},p=new Uint32Array(a.buffer,0,1)[0];for(let M=0;M<s.length;M++)switch(s[M].cmd){case"ALLOCSET":m.vars[s[M].var]=h(s[M].buff);break;case"ALLOC":m.vars[s[M].var]=e(s[M].len);break;case"SET":b(m.vars[s[M].var],s[M].buff);break;case"CALL":{let x=[];for(let S=0;S<s[M].params.length;S++){let w=s[M].params[S];typeof w.var<"u"?x.push(m.vars[w.var]+(w.offset||0)):typeof w.val<"u"&&x.push(w.val)}n.exports[s[M].fnName](...x);break}case"GET":m.out[s[M].out]=d(m.vars[s[M].var],s[M].len).slice();break;default:throw new Error("Invalid cmd")}let v=new Uint32Array(a.buffer,0,1);return v[0]=p,m.out}return l}function tg(c){return new Promise(t=>setTimeout(t,c))}async function ng(c,t){let n=new Hs;n.memory=new WebAssembly.Memory({initial:Os}),n.u8=new Uint8Array(n.memory.buffer),n.u32=new Uint32Array(n.memory.buffer);let a=await WebAssembly.compile(c.code);if(n.instance=await WebAssembly.instantiate(a,{env:{memory:n.memory}}),globalThis?.Worker||(t=!0),n.singleThread=t,n.initalPFree=n.u32[0],n.pq=c.pq,n.pr=c.pr,n.pG1gen=c.pG1gen,n.pG1zero=c.pG1zero,n.pG2gen=c.pG2gen,n.pG2zero=c.pG2zero,n.pOneT=c.pOneT,t)n.code=c.code,n.taskManager=Y1(),await n.taskManager([{cmd:"INIT",init:Os,code:n.code.slice()}]),n.concurrency=1;else{n.workers=[],n.pendingDeferreds=[],n.working=[];let e=2;typeof navigator=="object"&&navigator.hardwareConcurrency&&(e=navigator.hardwareConcurrency),e==0&&(e=2),e>64&&(e=64),n.concurrency=e;for(let d=0;d<e;d++)n.workers[d]=new Worker(Xs),n.workers[d].addEventListener("message",o(d)),n.working[d]=!1;let h=[];for(let d=0;d<n.workers.length;d++){let b=c.code.slice();h.push(n.postAction(d,[{cmd:"INIT",init:Os,code:b}],[b.buffer]))}await Promise.all(h)}return n;function o(e){return function(h){let d;h&&h.data?d=h.data:d=h,n.working[e]=!1,n.pendingDeferreds[e].resolve(d),n.processWorks()}}}function Ps(c,t){let n=c[t],a=c.Fr,o=c.tm;c[t].batchApplyKey=async function(e,h,d,b,l){b=b||"affine",l=l||"affine";let s,m,B,p,v;if(t=="G1")b=="jacobian"?(B=n.F.n8*3,s="g1m_batchApplyKey"):(B=n.F.n8*2,s="g1m_batchApplyKeyMixed"),p=n.F.n8*3,l=="jacobian"?v=n.F.n8*3:(m="g1m_batchToAffine",v=n.F.n8*2);else if(t=="G2")b=="jacobian"?(B=n.F.n8*3,s="g2m_batchApplyKey"):(B=n.F.n8*2,s="g2m_batchApplyKeyMixed"),p=n.F.n8*3,l=="jacobian"?v=n.F.n8*3:(m="g2m_batchToAffine",v=n.F.n8*2);else if(t=="Fr")s="frm_batchApplyKey",B=n.n8,p=n.n8,v=n.n8;else throw new Error("Invalid group: "+t);let M=Math.floor(e.byteLength/B),x=Math.floor(M/o.concurrency),S=[];d=a.e(d);let w=a.e(h);for(let F=0;F<o.concurrency;F++){let u;if(F<o.concurrency-1?u=x:u=M-F*x,u==0)continue;let L=[];L.push({cmd:"ALLOCSET",var:0,buff:e.slice(F*x*B,F*x*B+u*B)}),L.push({cmd:"ALLOCSET",var:1,buff:w}),L.push({cmd:"ALLOCSET",var:2,buff:d}),L.push({cmd:"ALLOC",var:3,len:u*Math.max(p,v)}),L.push({cmd:"CALL",fnName:s,params:[{var:0},{val:u},{var:1},{var:2},{var:3}]}),m&&L.push({cmd:"CALL",fnName:m,params:[{var:3},{val:u},{var:3}]}),L.push({cmd:"GET",out:0,var:3,len:u*v}),S.push(o.queueAction(L)),w=a.mul(w,a.exp(d,u))}let k=await Promise.all(S),O;e instanceof gn?O=new gn(M*v):O=new Uint8Array(M*v);let W=0;for(let F=0;F<k.length;F++)O.set(k[F][0],W),W+=k[F][0].byteLength;return O}}function ag(c){let t=c.tm;c.pairing=function(a,o){t.startSyncOp();let e=t.allocBuff(c.G1.toJacobian(a)),h=t.allocBuff(c.G2.toJacobian(o)),d=t.alloc(c.Gt.n8);t.instance.exports[c.name+"_pairing"](e,h,d);let b=t.getBuff(d,c.Gt.n8);return t.endSyncOp(),b},c.pairingEq=async function(){let a,o;arguments.length%2==1?(a=arguments[arguments.length-1],o=(arguments.length-1)/2):(a=c.Gt.one,o=arguments.length/2);let e=[];for(let s=0;s<o;s++){let m=[],B=c.G1.toJacobian(arguments[s*2]);m.push({cmd:"ALLOCSET",var:0,buff:B}),m.push({cmd:"ALLOC",var:1,len:c.prePSize});let p=c.G2.toJacobian(arguments[s*2+1]);m.push({cmd:"ALLOCSET",var:2,buff:p}),m.push({cmd:"ALLOC",var:3,len:c.preQSize}),m.push({cmd:"ALLOC",var:4,len:c.Gt.n8}),m.push({cmd:"CALL",fnName:c.name+"_prepareG1",params:[{var:0},{var:1}]}),m.push({cmd:"CALL",fnName:c.name+"_prepareG2",params:[{var:2},{var:3}]}),m.push({cmd:"CALL",fnName:c.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),m.push({cmd:"GET",out:0,var:4,len:c.Gt.n8}),e.push(t.queueAction(m))}let h=await Promise.all(e);t.startSyncOp();let d=t.alloc(c.Gt.n8);t.instance.exports.ftm_one(d);for(let s=0;s<h.length;s++){let m=t.allocBuff(h[s][0]);t.instance.exports.ftm_mul(d,m,d)}t.instance.exports[c.name+"_finalExponentiation"](d,d);let b=t.allocBuff(a),l=!!t.instance.exports.ftm_eq(d,b);return t.endSyncOp(),l},c.prepareG1=function(n){this.tm.startSyncOp();let a=this.tm.allocBuff(n),o=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](a,o);let e=this.tm.getBuff(o,this.prePSize);return this.tm.endSyncOp(),e},c.prepareG2=function(n){this.tm.startSyncOp();let a=this.tm.allocBuff(n),o=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](a,o);let e=this.tm.getBuff(o,this.preQSize);return this.tm.endSyncOp(),e},c.millerLoop=function(n,a){this.tm.startSyncOp();let o=this.tm.allocBuff(n),e=this.tm.allocBuff(a),h=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](o,e,h);let d=this.tm.getBuff(h,this.Gt.n8);return this.tm.endSyncOp(),d},c.finalExponentiation=function(n){this.tm.startSyncOp();let a=this.tm.allocBuff(n),o=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](a,o);let e=this.tm.getBuff(o,this.Gt.n8);return this.tm.endSyncOp(),e}}function A2(c,t){let n=c[t],a=n.tm;async function o(h,d,b,l,s){if(!(h instanceof Uint8Array))throw l&&l.error(`${s} _multiExpChunk buffBases is not Uint8Array`),new Error(`${s} _multiExpChunk buffBases is not Uint8Array`);if(!(d instanceof Uint8Array))throw l&&l.error(`${s} _multiExpChunk buffScalars is not Uint8Array`),new Error(`${s} _multiExpChunk buffScalars is not Uint8Array`);b=b||"affine";let m,B;if(t=="G1")b=="affine"?(B="g1m_multiexpAffine_chunk",m=n.F.n8*2):(B="g1m_multiexp_chunk",m=n.F.n8*3);else if(t=="G2")b=="affine"?(B="g2m_multiexpAffine_chunk",m=n.F.n8*2):(B="g2m_multiexp_chunk",m=n.F.n8*3);else throw new Error("Invalid group");let p=Math.floor(h.byteLength/m);if(p==0)return n.zero;let v=Math.floor(d.byteLength/p);if(v*p!=d.byteLength)throw new Error("Scalar size does not match");let M=x2[Jn(p)],x=Math.floor((v*8-1)/M)+1,S=[];for(let O=0;O<x;O++){let W=[{cmd:"ALLOCSET",var:0,buff:h},{cmd:"ALLOCSET",var:1,buff:d},{cmd:"ALLOC",var:2,len:n.F.n8*3},{cmd:"CALL",fnName:B,params:[{var:0},{var:1},{val:v},{val:p},{val:O*M},{val:Math.min(v*8-O*M,M)},{var:2}]},{cmd:"GET",out:0,var:2,len:n.F.n8*3}];S.push(n.tm.queueAction(W))}let w=await Promise.all(S),k=n.zero;for(let O=w.length-1;O>=0;O--){if(!n.isZero(k))for(let W=0;W<M;W++)k=n.double(k);k=n.add(k,w[O][0])}return k}async function e(h,d,b,l,s){let p;if(t=="G1")b=="affine"?p=n.F.n8*2:p=n.F.n8*3;else if(t=="G2")b=="affine"?p=n.F.n8*2:p=n.F.n8*3;else throw new Error("Invalid group");let v=Math.floor(h.byteLength/p);if(v==0)return n.zero;let M=Math.floor(d.byteLength/v);if(M*v!=d.byteLength)throw new Error("Scalar size does not match");let x=x2[Jn(v)],S=Math.floor((M*8-1)/x)+1,w;w=Math.floor(v/(a.concurrency/S)),w>4194304&&(w=4194304),w<1024&&(w=1024);let k=[];for(let F=0;F<v;F+=w){l&&l.debug(`Multiexp start: ${s}: ${F}/${v}`);let u=Math.min(v-F,w),L=h.slice(F*p,(F+u)*p),$=d.slice(F*M,(F+u)*M);k.push(o(L,$,b,l,s).then(Q=>(l&&l.debug(`Multiexp end: ${s}: ${F}/${v}`),Q)))}let O=await Promise.all(k),W=n.zero;for(let F=O.length-1;F>=0;F--)W=n.add(W,O[F]);return W}n.multiExp=async function(d,b,l,s){return await e(d,b,"jacobian",l,s)},n.multiExpAffine=async function(d,b,l,s){return await e(d,b,"affine",l,s)}}function Ms(c,t){let n=c[t],a=c.Fr,o=n.tm;async function e(l,s,m,B,p,v){m=m||"affine",B=B||"affine";let M=14,x,S,w,k,O,W,F,u;t=="G1"?(m=="affine"?(x=n.F.n8*2,k="g1m_batchToJacobian"):x=n.F.n8*3,S=n.F.n8*3,s&&(u="g1m_fftFinal"),F="g1m_fftJoin",W="g1m_fftMix",B=="affine"?(w=n.F.n8*2,O="g1m_batchToAffine"):w=n.F.n8*3):t=="G2"?(m=="affine"?(x=n.F.n8*2,k="g2m_batchToJacobian"):x=n.F.n8*3,S=n.F.n8*3,s&&(u="g2m_fftFinal"),F="g2m_fftJoin",W="g2m_fftMix",B=="affine"?(w=n.F.n8*2,O="g2m_batchToAffine"):w=n.F.n8*3):t=="Fr"&&(x=n.n8,S=n.n8,w=n.n8,s&&(u="frm_fftFinal"),W="frm_fftMix",F="frm_fftJoin");let L=!1;Array.isArray(l)?(l=ll(l,x),L=!0):l=l.slice(0,l.byteLength);let $=l.byteLength/x,Q=Jn($);if(1<<Q!=$)throw new Error("fft must be multiple of 2");if(Q==a.s+1){let j;return s?j=await d(l,m,B,p,v):j=await h(l,m,B,p,v),L?Te(j,w):j}let H;s&&(H=a.inv(a.e($)));let q;au(l,x);let y,I=Math.min(1<<M,$),N=$/I;for(;N<o.concurrency&&I>=16;)N*=2,I/=2;let nt=Jn(I),J=[];for(let j=0;j<N;j++){p&&p.debug(`${v}: fft ${Q} mix start: ${j}/${N}`);let ot=[];ot.push({cmd:"ALLOC",var:0,len:S*I});let V=l.slice(I*j*x,I*(j+1)*x);ot.push({cmd:"SET",var:0,buff:V}),k&&ot.push({cmd:"CALL",fnName:k,params:[{var:0},{val:I},{var:0}]});for(let at=1;at<=nt;at++)ot.push({cmd:"CALL",fnName:W,params:[{var:0},{val:I},{val:at}]});nt==Q?(u&&(ot.push({cmd:"ALLOCSET",var:1,buff:H}),ot.push({cmd:"CALL",fnName:u,params:[{var:0},{val:I},{var:1}]})),O&&ot.push({cmd:"CALL",fnName:O,params:[{var:0},{val:I},{var:0}]}),ot.push({cmd:"GET",out:0,var:0,len:I*w})):ot.push({cmd:"GET",out:0,var:0,len:S*I}),J.push(o.queueAction(ot).then(at=>(p&&p.debug(`${v}: fft ${Q} mix end: ${j}/${N}`),at)))}y=await Promise.all(J);for(let j=0;j<N;j++)y[j]=y[j][0];for(let j=nt+1;j<=Q;j++){p&&p.debug(`${v}: fft  ${Q}  join: ${j}/${Q}`);let ot=1<<Q-j,V=N/ot,at=[];for(let rt=0;rt<ot;rt++)for(let ht=0;ht<V/2;ht++){let A=a.exp(a.w[j],ht*I),i=a.w[j],C=rt*V+ht,r=rt*V+ht+V/2,z=[];z.push({cmd:"ALLOCSET",var:0,buff:y[C]}),z.push({cmd:"ALLOCSET",var:1,buff:y[r]}),z.push({cmd:"ALLOCSET",var:2,buff:A}),z.push({cmd:"ALLOCSET",var:3,buff:i}),z.push({cmd:"CALL",fnName:F,params:[{var:0},{var:1},{val:I},{var:2},{var:3}]}),j==Q?(u&&(z.push({cmd:"ALLOCSET",var:4,buff:H}),z.push({cmd:"CALL",fnName:u,params:[{var:0},{val:I},{var:4}]}),z.push({cmd:"CALL",fnName:u,params:[{var:1},{val:I},{var:4}]})),O&&(z.push({cmd:"CALL",fnName:O,params:[{var:0},{val:I},{var:0}]}),z.push({cmd:"CALL",fnName:O,params:[{var:1},{val:I},{var:1}]})),z.push({cmd:"GET",out:0,var:0,len:I*w}),z.push({cmd:"GET",out:1,var:1,len:I*w})):(z.push({cmd:"GET",out:0,var:0,len:I*S}),z.push({cmd:"GET",out:1,var:1,len:I*S})),at.push(o.queueAction(z).then(E=>(p&&p.debug(`${v}: fft ${Q} join  ${j}/${Q}  ${rt+1}/${ot} ${ht}/${V/2}`),E)))}let Lt=await Promise.all(at);for(let rt=0;rt<ot;rt++)for(let ht=0;ht<V/2;ht++){let A=rt*V+ht,i=rt*V+ht+V/2,C=Lt.shift();y[A]=C[0],y[i]=C[1]}}if(l instanceof gn?q=new gn($*w):q=new Uint8Array($*w),s){q.set(y[0].slice((I-1)*w));let j=w;for(let ot=N-1;ot>0;ot--)q.set(y[ot],j),j+=I*w,delete y[ot];q.set(y[0].slice(0,(I-1)*w),j),delete y[0]}else for(let j=0;j<N;j++)q.set(y[j],I*w*j),delete y[j];return L?Te(q,w):q}async function h(l,s,m,B,p){let v,M;v=l.slice(0,l.byteLength/2),M=l.slice(l.byteLength/2,l.byteLength);let x=[];[v,M]=await b(v,M,"fftJoinExt",a.one,a.shift,s,"jacobian",B,p),x.push(e(v,!1,"jacobian",m,B,p)),x.push(e(M,!1,"jacobian",m,B,p));let S=await Promise.all(x),w;return S[0].byteLength>1<<28?w=new gn(S[0].byteLength*2):w=new Uint8Array(S[0].byteLength*2),w.set(S[0]),w.set(S[1],S[0].byteLength),w}async function d(l,s,m,B,p){let v,M;v=l.slice(0,l.byteLength/2),M=l.slice(l.byteLength/2,l.byteLength);let x=[];x.push(e(v,!0,s,"jacobian",B,p)),x.push(e(M,!0,s,"jacobian",B,p)),[v,M]=await Promise.all(x);let S=await b(v,M,"fftJoinExtInv",a.one,a.shiftInv,"jacobian",m,B,p),w;return S[0].byteLength>1<<28?w=new gn(S[0].byteLength*2):w=new Uint8Array(S[0].byteLength*2),w.set(S[0]),w.set(S[1],S[0].byteLength),w}async function b(l,s,m,B,p,v,M,x,S){let O,W,F,u,L,$;if(t=="G1")v=="affine"?(L=n.F.n8*2,W="g1m_batchToJacobian"):L=n.F.n8*3,$=n.F.n8*3,O="g1m_"+m,M=="affine"?(F="g1m_batchToAffine",u=n.F.n8*2):u=n.F.n8*3;else if(t=="G2")v=="affine"?(L=n.F.n8*2,W="g2m_batchToJacobian"):L=n.F.n8*3,O="g2m_"+m,$=n.F.n8*3,M=="affine"?(F="g2m_batchToAffine",u=n.F.n8*2):u=n.F.n8*3;else if(t=="Fr")L=a.n8,u=a.n8,$=a.n8,O="frm_"+m;else throw new Error("Invalid group");if(l.byteLength!=s.byteLength)throw new Error("Invalid buffer size");let Q=Math.floor(l.byteLength/L);if(Q!=1<<Jn(Q))throw new Error("Invalid number of points");let H=Math.floor(Q/o.concurrency);H<16&&(H=16),H>65536&&(H=65536);let q=[];for(let J=0;J<Q;J+=H){x&&x.debug(`${S}: fftJoinExt Start: ${J}/${Q}`);let j=Math.min(Q-J,H),ot=a.mul(B,a.exp(p,J)),V=[],at=l.slice(J*L,(J+j)*L),Lt=s.slice(J*L,(J+j)*L);V.push({cmd:"ALLOC",var:0,len:$*j}),V.push({cmd:"SET",var:0,buff:at}),V.push({cmd:"ALLOC",var:1,len:$*j}),V.push({cmd:"SET",var:1,buff:Lt}),V.push({cmd:"ALLOCSET",var:2,buff:ot}),V.push({cmd:"ALLOCSET",var:3,buff:p}),W&&(V.push({cmd:"CALL",fnName:W,params:[{var:0},{val:j},{var:0}]}),V.push({cmd:"CALL",fnName:W,params:[{var:1},{val:j},{var:1}]})),V.push({cmd:"CALL",fnName:O,params:[{var:0},{var:1},{val:j},{var:2},{var:3},{val:a.s}]}),F&&(V.push({cmd:"CALL",fnName:F,params:[{var:0},{val:j},{var:0}]}),V.push({cmd:"CALL",fnName:F,params:[{var:1},{val:j},{var:1}]})),V.push({cmd:"GET",out:0,var:0,len:j*u}),V.push({cmd:"GET",out:1,var:1,len:j*u}),q.push(o.queueAction(V).then(rt=>(x&&x.debug(`${S}: fftJoinExt End: ${J}/${Q}`),rt)))}let y=await Promise.all(q),I,N;Q*u>1<<28?(I=new gn(Q*u),N=new gn(Q*u)):(I=new Uint8Array(Q*u),N=new Uint8Array(Q*u));let nt=0;for(let J=0;J<y.length;J++)I.set(y[J][0],nt),N.set(y[J][1],nt),nt+=y[J][0].byteLength;return[I,N]}n.fft=async function(l,s,m,B,p){return await e(l,!1,s,m,B,p)},n.ifft=async function(l,s,m,B,p){return await e(l,!0,s,m,B,p)},n.lagrangeEvaluations=async function(l,s,m,B,p){s=s||"affine",m=m||"affine";let v;if(t=="G1")s=="affine"?v=n.F.n8*2:v=n.F.n8*3;else if(t=="G2")s=="affine"?v=n.F.n8*2:v=n.F.n8*3;else if(t=="Fr")v=a.n8;else throw new Error("Invalid group");let M=l.byteLength/v,x=Jn(M);if(2**x*v!=l.byteLength)throw B&&B.error("lagrangeEvaluations iinvalid input size"),new Error("lagrangeEvaluations invalid Input size");if(x<=a.s)return await n.ifft(l,s,m,B,p);if(x>a.s+1)throw B&&B.error("lagrangeEvaluations input too big"),new Error("lagrangeEvaluations input too big");let S=l.slice(0,l.byteLength/2),w=l.slice(l.byteLength/2,l.byteLength),k=a.exp(a.shift,M/2),O=a.inv(a.sub(a.one,k));[S,w]=await b(S,w,"prepareLagrangeEvaluation",O,a.shiftInv,s,"jacobian",B,p+" prep");let W=[];W.push(e(S,!0,"jacobian",m,B,p+" t0")),W.push(e(w,!0,"jacobian",m,B,p+" t1")),[S,w]=await Promise.all(W);let F;return S.byteLength>1<<28?F=new gn(S.byteLength*2):F=new Uint8Array(S.byteLength*2),F.set(S),F.set(w,S.byteLength),F},n.fftMix=async function(s){let m=n.F.n8*3,B,p;if(t=="G1")B="g1m_fftMix",p="g1m_fftJoin";else if(t=="G2")B="g2m_fftMix",p="g2m_fftJoin";else if(t=="Fr")B="frm_fftMix",p="frm_fftJoin";else throw new Error("Invalid group");let v=Math.floor(s.byteLength/m),M=Jn(v),x=1<<Jn(o.concurrency);v<=x*2&&(x=1);let S=v/x,w=Jn(S),k=[];for(let L=0;L<x;L++){let $=[],Q=s.slice(L*S*m,(L+1)*S*m);$.push({cmd:"ALLOCSET",var:0,buff:Q});for(let H=1;H<=w;H++)$.push({cmd:"CALL",fnName:B,params:[{var:0},{val:S},{val:H}]});$.push({cmd:"GET",out:0,var:0,len:S*m}),k.push(o.queueAction($))}let O=await Promise.all(k),W=[];for(let L=0;L<O.length;L++)W[L]=O[L][0];for(let L=w+1;L<=M;L++){let $=1<<M-L,Q=x/$,H=[];for(let y=0;y<$;y++)for(let I=0;I<Q/2;I++){let N=a.exp(a.w[L],I*S),nt=a.w[L],J=y*Q+I,j=y*Q+I+Q/2,ot=[];ot.push({cmd:"ALLOCSET",var:0,buff:W[J]}),ot.push({cmd:"ALLOCSET",var:1,buff:W[j]}),ot.push({cmd:"ALLOCSET",var:2,buff:N}),ot.push({cmd:"ALLOCSET",var:3,buff:nt}),ot.push({cmd:"CALL",fnName:p,params:[{var:0},{var:1},{val:S},{var:2},{var:3}]}),ot.push({cmd:"GET",out:0,var:0,len:S*m}),ot.push({cmd:"GET",out:1,var:1,len:S*m}),H.push(o.queueAction(ot))}let q=await Promise.all(H);for(let y=0;y<$;y++)for(let I=0;I<Q/2;I++){let N=y*Q+I,nt=y*Q+I+Q/2,J=q.shift();W[N]=J[0],W[nt]=J[1]}}let F;s instanceof gn?F=new gn(v*m):F=new Uint8Array(v*m);let u=0;for(let L=0;L<x;L++)F.set(W[L],u),u+=W[L].byteLength;return F},n.fftJoin=async function(s,m,B,p){let v=n.F.n8*3,M;if(t=="G1")M="g1m_fftJoin";else if(t=="G2")M="g2m_fftJoin";else if(t=="Fr")M="frm_fftJoin";else throw new Error("Invalid group");if(s.byteLength!=m.byteLength)throw new Error("Invalid buffer size");let x=Math.floor(s.byteLength/v);if(x!=1<<Jn(x))throw new Error("Invalid number of points");let S=1<<Jn(o.concurrency);x<=S*2&&(S=1);let w=x/S,k=[];for(let L=0;L<S;L++){let $=[],Q=a.mul(B,a.exp(p,L*w)),H=s.slice(L*w*v,(L+1)*w*v),q=m.slice(L*w*v,(L+1)*w*v);$.push({cmd:"ALLOCSET",var:0,buff:H}),$.push({cmd:"ALLOCSET",var:1,buff:q}),$.push({cmd:"ALLOCSET",var:2,buff:Q}),$.push({cmd:"ALLOCSET",var:3,buff:p}),$.push({cmd:"CALL",fnName:M,params:[{var:0},{var:1},{val:w},{var:2},{var:3}]}),$.push({cmd:"GET",out:0,var:0,len:w*v}),$.push({cmd:"GET",out:1,var:1,len:w*v}),k.push(o.queueAction($))}let O=await Promise.all(k),W,F;s instanceof gn?(W=new gn(x*v),F=new gn(x*v)):(W=new Uint8Array(x*v),F=new Uint8Array(x*v));let u=0;for(let L=0;L<O.length;L++)W.set(O[L][0],u),F.set(O[L][1],u),u+=O[L][0].byteLength;return[W,F]},n.fftFinal=async function(s,m){let B=n.F.n8*3,p=n.F.n8*2,v,M;if(t=="G1")v="g1m_fftFinal",M="g1m_batchToAffine";else if(t=="G2")v="g2m_fftFinal",M="g2m_batchToAffine";else throw new Error("Invalid group");let x=Math.floor(s.byteLength/B);if(x!=1<<Jn(x))throw new Error("Invalid number of points");let S=Math.floor(x/o.concurrency),w=[];for(let F=0;F<o.concurrency;F++){let u;if(F<o.concurrency-1?u=S:u=x-F*S,u==0)continue;let L=[],$=s.slice(F*S*B,(F*S+u)*B);L.push({cmd:"ALLOCSET",var:0,buff:$}),L.push({cmd:"ALLOCSET",var:1,buff:m}),L.push({cmd:"CALL",fnName:v,params:[{var:0},{val:u},{var:1}]}),L.push({cmd:"CALL",fnName:M,params:[{var:0},{val:u},{var:0}]}),L.push({cmd:"GET",out:0,var:0,len:u*p}),w.push(o.queueAction(L))}let k=await Promise.all(w),O;s instanceof gn?O=new gn(x*p):O=new Uint8Array(x*p);let W=0;for(let F=k.length-1;F>=0;F--)O.set(k[F][0],W),W+=k[F][0].byteLength;return O}}async function ou(c){let t=await ng(c.wasm,c.singleThread),n={};return n.q=mn(c.wasm.q.toString()),n.r=mn(c.wasm.r.toString()),n.name=c.name,n.tm=t,n.prePSize=c.wasm.prePSize,n.preQSize=c.wasm.preQSize,n.Fr=new Ge(t,"frm",c.n8r,c.r),n.F1=new Ge(t,"f1m",c.n8q,c.q),n.F2=new ke(t,"f2m",n.F1),n.G1=new Ue(t,"g1m",n.F1,c.wasm.pG1gen,c.wasm.pG1b,c.cofactorG1),n.G2=new Ue(t,"g2m",n.F2,c.wasm.pG2gen,c.wasm.pG2b,c.cofactorG2),n.F6=new Qs(t,"f6m",n.F2),n.F12=new ke(t,"ftm",n.F6),n.Gt=n.F12,Ps(n,"G1"),Ps(n,"G2"),Ps(n,"Fr"),A2(n,"G1"),A2(n,"G2"),Ms(n,"G1"),Ms(n,"G2"),Ms(n,"Fr"),ag(n),n.array2buffer=function(a,o){let e=new Uint8Array(o*a.length);for(let h=0;h<a.length;h++)e.set(a[h],h*o);return e},n.buffer2array=function(a,o){let e=a.byteLength/o,h=new Array(e);for(let d=0;d<e;d++)h[d]=a.slice(d*o,d*o+o);return h},n}function Eo(c){return BigInt(c)}function iu(c){return c<0n}function og(c){return c===0n}function ig(c){return iu(c)?c.toString(2).length-1:c.toString(2).length}function Rs(c){let t=[],n=Eo(c);return t.push(Number(n&0xFFn)),t.push(Number(n>>8n&0xFFn)),t.push(Number(n>>16n&0xFFn)),t.push(Number(n>>24n&0xFFn)),t}function eg(c){for(var t=[],n=0;n<c.length;n++){var a=c.charCodeAt(n);a<128?t.push(a):a<2048?t.push(192|a>>6,128|a&63):a<55296||a>=57344?t.push(224|a>>12,128|a>>6&63,128|a&63):(n++,a=65536+((a&1023)<<10|c.charCodeAt(n)&1023),t.push(240|a>>18,128|a>>12&63,128|a>>6&63,128|a&63))}return t}function ri(c){let t=eg(c);return[...jt(t.length),...t]}function eu(c){let t=[],n=Eo(c);if(iu(n))throw new Error("Number cannot be negative");for(;!og(n);)t.push(Number(n&0x7Fn)),n=n>>7n;t.length==0&&t.push(0);for(let a=0;a<t.length-1;a++)t[a]=t[a]|128;return t}function cu(c){let t,n,a=ig(c);c<0?(n=!0,t=(1n<<BigInt(a))+c):(n=!1,t=Eo(c));let o=7-a%7,e=(1n<<BigInt(o))-1n<<BigInt(a),h=(1<<7-o)-1|128,d=eu(t+e);return n||(d[d.length-1]=d[d.length-1]&h),d}function Ds(c){let t=Eo(c);if(t>0xFFFFFFFFn)throw new Error("Number too big");if(t>0x7FFFFFFFn&&(t=t-0x100000000n),t<-2147483648n)throw new Error("Number too small");return cu(t)}function cg(c){let t=Eo(c);if(t>0xFFFFFFFFFFFFFFFFn)throw new Error("Number too big");if(t>0x7FFFFFFFFFFFFFFFn&&(t=t-0x10000000000000000n),t<-9223372036854775808n)throw new Error("Number too small");return cu(t)}function jt(c){let t=Eo(c);if(t>0xFFFFFFFFn)throw new Error("Number too big");return eu(t)}function E2(c){return Array.from(c,function(t){return("0"+(t&255).toString(16)).slice(-2)}).join("")}async function Qe(c,t){if(!c&&globalThis.curve_bn128)return globalThis.curve_bn128;let n=new Ze;n.setMemory(25),W1(n),t&&t(n);let a={};a.code=n.build(),a.pq=n.modules.f1m.pq,a.pr=n.modules.frm.pq,a.pG1gen=n.modules.bn128.pG1gen,a.pG1zero=n.modules.bn128.pG1zero,a.pG1b=n.modules.bn128.pG1b,a.pG2gen=n.modules.bn128.pG2gen,a.pG2zero=n.modules.bn128.pG2zero,a.pG2b=n.modules.bn128.pG2b,a.pOneT=n.modules.bn128.pOneT,a.prePSize=n.modules.bn128.prePSize,a.preQSize=n.modules.bn128.preQSize,a.n8q=32,a.n8r=32,a.q=n.modules.bn128.q,a.r=n.modules.bn128.r;let o={name:"bn128",wasm:a,q:mn("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:mn("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:mn("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!c},e=await ou(o);return e.terminate=async function(){o.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},c||(globalThis.curve_bn128=e),e}async function Xe(c,t){if(!c&&globalThis.curve_bls12381)return globalThis.curve_bls12381;let n=new Ze;n.setMemory(25),Q1(n),t&&t(n);let a={};a.code=n.build(),a.pq=n.modules.f1m.pq,a.pr=n.modules.frm.pq,a.pG1gen=n.modules.bls12381.pG1gen,a.pG1zero=n.modules.bls12381.pG1zero,a.pG1b=n.modules.bls12381.pG1b,a.pG2gen=n.modules.bls12381.pG2gen,a.pG2zero=n.modules.bls12381.pG2zero,a.pG2b=n.modules.bls12381.pG2b,a.pOneT=n.modules.bls12381.pOneT,a.prePSize=n.modules.bls12381.prePSize,a.preQSize=n.modules.bls12381.preQSize,a.n8q=48,a.n8r=32,a.q=n.modules.bls12381.q,a.r=n.modules.bls12381.r;let o={name:"bls12381",wasm:a,q:mn("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:mn("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:mn("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:mn("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!c},e=await ou(o);return e.terminate=async function(){o.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},c||(globalThis.curve_bls12381=e),e}async function ug(c,t,n){let a;if(ua(c,lg))a=await Qe(t,n);else if(ua(c,sg))a=await Xe(t,n);else throw new Error(`Curve not supported: ${Ve(c)}`);return a}async function _g(c,t,n){let a;if(ua(c,dg))a=await Qe(t,n);else if(ua(c,rg))a=await Xe(t,n);else throw new Error(`Curve not supported: ${Ve(c,16)}`);return a}async function hg(c,t,n){let a,o=e(c);if(["BN128","BN254","ALTBN128"].indexOf(o)>=0)a=await Qe(t,n);else if(["BLS12381"].indexOf(o)>=0)a=await Xe(t,n);else throw new Error(`Curve not supported: ${c}`);return a;function e(h){return h.toUpperCase().match(/[A-Za-z0-9]+/g).join("")}}var I0,mn,P0,M0,T2,co,Q0,Ts,di,Re,ve,Gs,ks,Us,Ns,$s,Na,e1,ol,il,U2,l1,Vn,g1,va,L1,p1,As,Es,b1,vs,_2,h2,m1,y1,sl,w1,F1,W2,C1,B1,Ss,Q2,x1,A1,X2,E1,v1,f2,ei,g2,H2,S1,L2,ci,Se,D2,K2,J2,Y2,Yt,q1,I1,p2,O1,b2,qs,P1,M1,si,R1,z1,m2,T1,G1,Zt,k1,U1,y2,N1,w2,Is,$1,Z1,li,F2,C2,j1,V1,W1,Q1,ui,J1,On,gn,Ge,ke,Qs,Ue,Os,Ne,Xs,B2,Hs,x2,Ks,zs,$e,Ze,sg,lg,rg,dg,fg,gg,lu=xe(()=>{I0=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];mn=je;P0=Ie,M0=Fo;T2=mn(0),co=mn(1),Q0=Object.freeze({__proto__:null,abs:G0,add:tl,band:nl,bitLength:fi,bits:q2,bor:$0,bxor:Z0,div:Co,e:mn,eq:ua,exp:T0,fromArray:O0,fromRprBE:z2,fromRprLE:hi,fromString:je,geq:M2,gt:Oe,isNegative:v2,isOdd:Ys,isZero:Js,land:j0,leq:N0,lnot:W0,lor:V0,lt:U0,mod:ba,mul:P2,naf:S2,neg:O2,neq:k0,one:co,pow:gi,shiftLeft:Ie,shiftRight:Fo,shl:P0,shr:M0,square:z0,sub:Sa,toArray:R0,toLEBuff:Bo,toNumber:I2,toRprBE:R2,toRprLE:_i,toString:Ve,zero:T2}),Ts=class{constructor(t){this.F=t;let n=t.sqrt_t,a=t.sqrt_s,o=this.F.add(this.F.add(this.F.two,this.F.two),this.F.one);this.w=new Array(a+1),this.wi=new Array(a+1),this.w[a]=this.F.pow(o,n),this.wi[a]=this.F.inv(this.w[a]);let e=a-1;for(;e>=0;)this.w[e]=this.F.square(this.w[e+1]),this.wi[e]=this.F.square(this.wi[e+1]),e--;this.roots=[],this._setRoots(15)}_setRoots(t){t>this.F.sqrt_s&&(t=this.s);for(let n=t;n>=0&&!this.roots[n];n--){let a=this.F.one,o=1<<n,e=new Array(o);for(let h=0;h<o;h++)e[h]=a,a=this.F.mul(a,this.w[n]);this.roots[n]=e}}add(t,n){let a=Math.max(t.length,n.length),o=new Array(a);for(let e=0;e<a;e++)o[e]=this.F.add(t[e]||this.F.zero,n[e]||this.F.zero);return this.reduce(o)}double(t){return this.add(t,t)}sub(t,n){let a=Math.max(t.length,n.length),o=new Array(a);for(let e=0;e<a;e++)o[e]=this.F.sub(t[e]||this.F.zero,n[e]||this.F.zero);return this.reduce(o)}mulScalar(t,n){if(this.F.eq(n,this.F.zero))return[];if(this.F.eq(n,this.F.one))return t;let a=new Array(t.length);for(let o=0;o<t.length;o++)a[o]=this.F.mul(t[o],n);return a}mul(t,n){return t.length==0?[]:n.length==0?[]:t.length==1?this.mulScalar(n,t[0]):n.length==1?this.mulScalar(t,n[0]):(n.length>t.length&&([n,t]=[t,n]),n.length<=2||n.length<pa(t.length)?this.mulNormal(t,n):this.mulFFT(t,n))}mulNormal(t,n){let a=[];for(let o=0;o<n.length;o++)a=this.add(a,this.scaleX(this.mulScalar(t,n[o]),o));return a}mulFFT(t,n){let a=Math.max(t.length,n.length),o=pa(a-1)+2;this._setRoots(o);let e=1<<o,h=this.extend(t,e),d=this.extend(n,e),b=so(this,h,o,0,1),l=so(this,d,o,0,1),s=new Array(e);for(let v=0;v<e;v++)s[v]=this.F.mul(b[v],l[v]);let m=so(this,s,o,0,1),B=this.F.inv(this.F.mulScalar(this.F.one,e)),p=new Array(e);for(let v=0;v<e;v++)p[v]=this.F.mul(m[(e-v)%e],B);return this.reduce(p)}square(t){return this.mul(t,t)}scaleX(t,n){return n==0?t:n>0?new Array(n).fill(this.F.zero).concat(t):-n>=t.length?[]:t.slice(-n)}eval2(t,n){let a=this.F.zero,o=this.F.one;for(let e=0;e<t.length;e++)a=this.F.add(a,this.F.mul(t[e],o)),o=this.F.mul(o,n);return a}evaluate(t,n){let a=this.F;if(t.length==0)return a.zero;let o=this._next2Power(t.length),e=this.extend(t,o);return h(e,n,0,1,o);function h(d,b,l,s,m){if(m==1)return d[l];let B=a.square(b);return a.add(h(d,B,l,s<<1,m>>1),a.mul(b,h(d,B,l+s,s<<1,m>>1)))}}lagrange(t){let n=[this.F.one];for(let o=0;o<t.length;o++)n=this.mul(n,[this.F.neg(t[o][0]),this.F.one]);let a=[];for(let o=0;o<t.length;o++){let e=this.ruffini(n,t[o][0]),h=this.F.mul(this.F.inv(this.evaluate(e,t[o][0])),t[o][1]);e=this.mulScalar(e,h),a=this.add(a,e)}return a}fft(t){if(t.length<=1)return t;let n=pa(t.length-1)+1;this._setRoots(n);let a=1<<n,o=this.extend(t,a);return so(this,o,n,0,1)}fft2(t){if(t.length<=1)return t;let n=pa(t.length-1)+1;this._setRoots(n);let a=1<<n,o=this.extend(t,a);return l2(o,n),Pe(this,o,n)}ifft(t){if(t.length<=1)return t;let n=pa(t.length-1)+1;this._setRoots(n);let a=1<<n,o=this.extend(t,a),e=so(this,o,n,0,1),h=this.F.inv(this.F.mulScalar(this.F.one,a)),d=new Array(a);for(let b=0;b<a;b++)d[b]=this.F.mul(e[(a-b)%a],h);return d}ifft2(t){if(t.length<=1)return t;let n=pa(t.length-1)+1;this._setRoots(n);let a=1<<n,o=this.extend(t,a);l2(o,n);let e=Pe(this,o,n),h=this.F.inv(this.F.mulScalar(this.F.one,a)),d=new Array(a);for(let b=0;b<a;b++)d[b]=this.F.mul(e[(a-b)%a],h);return d}_fft(t,n,a,o){let e=1<<n;if(e==1)return[t[a]];let h=e>>1,d=this._fft(t,n-1,a,o*2),b=this._fft(t,n-1,a+o,o*2),l=new Array(e),s=this.F.one;for(let m=0;m<h;m++)l[m]=this.F.add(d[m],this.F.mul(s,b[m])),l[m+h]=this.F.sub(d[m],this.F.mul(s,b[m])),s=this.F.mul(s,this.w[n]);return l}extend(t,n){if(n==t.length)return t;let a=new Array(n-t.length).fill(this.F.zero);return t.concat(a)}reduce(t){if(t.length==0||!this.F.eq(t[t.length-1],this.F.zero))return t;let n=t.length-1;for(;n>0&&this.F.eq(t[n],this.F.zero);)n--;return t.slice(0,n+1)}eq(t,n){let a=this.reduce(t),o=this.reduce(n);if(a.length!=o.length)return!1;for(let e=0;e<o.length;e++)if(!this.F.eq(a[e],o[e]))return!1;return!0}ruffini(t,n){let a=new Array(t.length-1);a[a.length-1]=t[t.length-1];for(let o=a.length-2;o>=0;o--)a[o]=this.F.add(this.F.mul(a[o+1],n),t[o+1]);return a}_next2Power(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t++,t}toString(t){let n=this.normalize(t),a="";for(let o=n.length-1;o>=0;o--)this.F.eq(t[o],this.F.zero)||(a!=""&&(a+=" + "),a=a+t[o].toString(10),o>0&&(a=a+"x",o>1&&(a=a+"^"+o)));return a}normalize(t){let n=new Array(t.length);for(let a=0;a<t.length;a++)n[a]=this.F.normalize(t[a]);return n}_reciprocal(t,n){let a=1<<n;if(a==1)return[this.F.inv(t[0])];let o=this.scaleX(t,-a/2),e=this._reciprocal(o,n-1),h=this.scaleX(this.double(e),3*a/2-2),d=this.mul(this.square(e),t);return this.scaleX(this.sub(h,d),-(a-2))}_div2(t,n){let a=pa(n.length-1)+1,o=1<<a,e=o-n.length,h=this._reciprocal(this.scaleX(n,e),a);return this.scaleX(h,t-2*o+2+e)}div(t,n){if(t.length<n.length)return[];let a=pa(n.length-1)+1,o=1<<a,e=this.scaleX(t,o-n.length),h=this.scaleX(n,o-n.length),d=h.length-1,b=e.length-1,l=this._reciprocal(h,a),s;b>2*d&&(s=this.sub(this.scaleX([this.F.one],2*d),this.mul(l,h)));let m=[],B=e,p,v,M=!1;for(;!M;)p=this.mul(B,l),m=this.add(m,this.scaleX(p,-2*d)),b>2*d?(v=this.mul(B,s),B=this.scaleX(v,-2*d),b=B.length-1):M=!0;return m}oneRoot(t,n){let a=pa(t-1)+1,o=this.F.one,e=n;if(n>=t)throw new Error("Given 'i' should be lower than 'n'");if(1<<a!==t)throw new Error(`Internal errlr: ${t} should equal ${1<<a}`);for(;e>0;)e&!0&&(o=this.F.mul(o,this.w[a])),e=e>>1,a--;return o}computeVanishingPolinomial(t,n){let a=1<<t;return this.F.sub(this.F.pow(n,a),this.F.one)}evaluateLagrangePolynomials(t,n){let a=1<<t,o=this.F.pow(n,a),e=new Array(a).fill(this.F.zero);this._setRoots(t);let h=this.w[t];if(this.F.eq(o,this.F.one)){for(let l=0;l<a;l++)if(this.F.eq(this.roots[t][0],n))return e[l]=this.F.one,e}let d=this.F.sub(o,this.F.one),b=this.F.mul(d,this.F.inv(this.F.e(a)));for(let l=0;l<a;l++)e[l]=this.F.mul(b,this.F.inv(this.F.sub(n,this.roots[t][l]))),b=this.F.mul(b,h);return e}log2(t){return pa(t)}};di=[];for(let c=0;c<256;c++)di[c]=X0(c,8);Re=class{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=new Array(16)}nextU32(){return this.idx==16&&this.update(),this.buff[this.idx++]}nextU64(){return tl(P2(this.nextU32(),4294967296),this.nextU32())}nextBool(){return(this.nextU32()&1)==1}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let t=0;t<10;t++)o1(this.buff);for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,this.state[12]==0&&(this.state[13]=this.state[13]+1>>>0,this.state[13]==0&&(this.state[14]=this.state[14]+1>>>0,this.state[14]==0&&(this.state[15]=this.state[15]+1>>>0)))}};ve=null;Gs=class{constructor(t,n,a){this.F=n,this.G=t,this.opMulGF=a;let o=n.sqrt_t||n.t,e=n.sqrt_s||n.s,h=n.one;for(;n.eq(n.pow(h,n.half),n.one);)h=n.add(h,n.one);this.w=new Array(e+1),this.wi=new Array(e+1),this.w[e]=this.F.pow(h,o),this.wi[e]=this.F.inv(this.w[e]);let d=e-1;for(;d>=0;)this.w[d]=this.F.square(this.w[d+1]),this.wi[d]=this.F.square(this.wi[d+1]),d--;this.roots=[],this._setRoots(Math.min(e,15))}_setRoots(t){for(let n=t;n>=0&&!this.roots[n];n--){let a=this.F.one,o=1<<n,e=new Array(o);for(let h=0;h<o;h++)e[h]=a,a=this.F.mul(a,this.w[n]);this.roots[n]=e}}fft(t){if(t.length<=1)return t;let n=r2(t.length-1)+1;this._setRoots(n);let a=1<<n;if(t.length!=a)throw new Error("Size must be multiple of 2");return ze(this,t,n,0,1)}ifft(t){if(t.length<=1)return t;let n=r2(t.length-1)+1;this._setRoots(n);let a=1<<n;if(t.length!=a)throw new Error("Size must be multiple of 2");let o=ze(this,t,n,0,1),e=this.F.inv(this.F.mulScalar(this.F.one,a)),h=new Array(a);for(let d=0;d<a;d++)h[d]=this.opMulGF(o[(a-d)%a],e);return h}};ks=class{constructor(t){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(t),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=fi(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=this.n64*2,this.n8=this.n64*8,this.R=this.e(this.one<<BigInt(this.n64*64)),this.Ri=this.inv(this.R);let n=this.negone>>this.one;this.nqr=this.two;let a=this.pow(this.nqr,n);for(;!this.eq(a,this.negone);)this.nqr=this.nqr+this.one,a=this.pow(this.nqr,n);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),G2(this),this.FFT=new Gs(this,this,this.mul.bind(this)),this.fft=this.FFT.fft.bind(this.FFT),this.ifft=this.FFT.ifft.bind(this.FFT),this.w=this.FFT.w,this.wi=this.FFT.wi,this.shift=this.square(this.nqr),this.k=this.exp(this.nqr,2**this.s)}e(t,n){let a;if(n?n==16&&(a=BigInt("0x"+t)):a=BigInt(t),a<0){let o=-a;return o>=this.p&&(o=o%this.p),this.p-o}else return a>=this.p?a%this.p:a}add(t,n){let a=t+n;return a>=this.p?a-this.p:a}sub(t,n){return t>=n?t-n:this.p-n+t}neg(t){return t&&this.p-t}mul(t,n){return t*n%this.p}mulScalar(t,n){return t*this.e(n)%this.p}square(t){return t*t%this.p}eq(t,n){return t==n}neq(t,n){return t!=n}lt(t,n){let a=t>this.half?t-this.p:t,o=n>this.half?n-this.p:n;return a<o}gt(t,n){let a=t>this.half?t-this.p:t,o=n>this.half?n-this.p:n;return a>o}leq(t,n){let a=t>this.half?t-this.p:t,o=n>this.half?n-this.p:n;return a<=o}geq(t,n){let a=t>this.half?t-this.p:t,o=n>this.half?n-this.p:n;return a>=o}div(t,n){return this.mul(t,this.inv(n))}idiv(t,n){if(!n)throw new Error("Division by zero");return t/n}inv(t){if(!t)throw new Error("Division by zero");let n=this.zero,a=this.p,o=this.one,e=t%this.p;for(;e;){let h=a/e;[n,o]=[o,n-h*o],[a,e]=[e,a-h*e]}return n<this.zero&&(n+=this.p),n}mod(t,n){return t%n}pow(t,n){return xo(this,t,n)}exp(t,n){return xo(this,t,n)}band(t,n){let a=t&n&this.mask;return a>=this.p?a-this.p:a}bor(t,n){let a=(t|n)&this.mask;return a>=this.p?a-this.p:a}bxor(t,n){let a=(t^n)&this.mask;return a>=this.p?a-this.p:a}bnot(t){let n=t^this.mask;return n>=this.p?n-this.p:n}shl(t,n){if(Number(n)<this.bitLength){let a=t<<n&this.mask;return a>=this.p?a-this.p:a}else{let a=this.p-n;return Number(a)<this.bitLength?t>>a:this.zero}}shr(t,n){if(Number(n)<this.bitLength)return t>>n;{let a=this.p-n;if(Number(a)<this.bitLength){let o=t<<a&this.mask;return o>=this.p?o-this.p:o}else return 0}}land(t,n){return t&&n?this.one:this.zero}lor(t,n){return t||n?this.one:this.zero}lnot(t){return t?this.zero:this.one}sqrt_old(t){if(t==this.zero)return this.zero;if(this.pow(t,this.negone>>this.one)!=this.one)return null;let a=this.s,o=this.nqr_to_t,e=this.pow(t,this.t),h=this.pow(t,this.add(this.t,this.one)>>this.one);for(;e!=this.one;){let d=this.square(e),b=1;for(;d!=this.one;)b++,d=this.square(d);let l=o;for(let s=0;s<a-b-1;s++)l=this.square(l);a=b,o=this.square(l),e=this.mul(e,o),h=this.mul(h,l)}return h>this.p>>this.one&&(h=this.neg(h)),h}normalize(t,n){if(t=BigInt(t,n),t<0){let a=-t;return a>=this.p&&(a=a%this.p),this.p-a}else return t>=this.p?t%this.p:t}random(){let t=this.bitLength*2/8,n=this.zero;for(let a=0;a<t;a++)n=(n<<BigInt(8))+BigInt(k2(1)[0]);return n%this.p}toString(t,n){n=n||10;let a;return t>this.half&&n==10?a="-"+(this.p-t).toString(n):a=t.toString(n),a}isZero(t){return t==this.zero}fromRng(t){let n;do{n=this.zero;for(let a=0;a<this.n64;a++)n+=t.nextU64()<<BigInt(64*a);n&=this.mask}while(n>=this.p);return n=n*this.Ri%this.p,n}fft(t){return this.FFT.fft(t)}ifft(t){return this.FFT.ifft(t)}toRprLE(t,n,a){_i(t,n,a,this.n64*8)}toRprBE(t,n,a){R2(t,n,a,this.n64*8)}toRprBEM(t,n,a){return this.toRprBE(t,n,this.mul(this.R,a))}toRprLEM(t,n,a){return this.toRprLE(t,n,this.mul(this.R,a))}fromRprLE(t,n){return hi(t,n,this.n8)}fromRprBE(t,n){return z2(t,n,this.n8)}fromRprLEM(t,n){return this.mul(this.fromRprLE(t,n),this.Ri)}fromRprBEM(t,n){return this.mul(this.fromRprBE(t,n),this.Ri)}toObject(t){return t}},Us=class{constructor(t,n){this.type="F2",this.F=t,this.zero=[this.F.zero,this.F.zero],this.one=[this.F.one,this.F.zero],this.negone=this.neg(this.one),this.nonResidue=n,this.m=t.m*2,this.p=t.p,this.n64=t.n64*2,this.n32=this.n64*2,this.n8=this.n64*8,G2(this)}_mulByNonResidue(t){return this.F.mul(this.nonResidue,t)}copy(t){return[this.F.copy(t[0]),this.F.copy(t[1])]}add(t,n){return[this.F.add(t[0],n[0]),this.F.add(t[1],n[1])]}double(t){return this.add(t,t)}sub(t,n){return[this.F.sub(t[0],n[0]),this.F.sub(t[1],n[1])]}neg(t){return this.sub(this.zero,t)}conjugate(t){return[t[0],this.F.neg(t[1])]}mul(t,n){let a=this.F.mul(t[0],n[0]),o=this.F.mul(t[1],n[1]);return[this.F.add(a,this._mulByNonResidue(o)),this.F.sub(this.F.mul(this.F.add(t[0],t[1]),this.F.add(n[0],n[1])),this.F.add(a,o))]}inv(t){let n=this.F.square(t[0]),a=this.F.square(t[1]),o=this.F.sub(n,this._mulByNonResidue(a)),e=this.F.inv(o);return[this.F.mul(t[0],e),this.F.neg(this.F.mul(t[1],e))]}div(t,n){return this.mul(t,this.inv(n))}square(t){let n=this.F.mul(t[0],t[1]);return[this.F.sub(this.F.mul(this.F.add(t[0],t[1]),this.F.add(t[0],this._mulByNonResidue(t[1]))),this.F.add(n,this._mulByNonResidue(n))),this.F.add(n,n)]}isZero(t){return this.F.isZero(t[0])&&this.F.isZero(t[1])}eq(t,n){return this.F.eq(t[0],n[0])&&this.F.eq(t[1],n[1])}mulScalar(t,n){return Me(this,t,n)}pow(t,n){return xo(this,t,n)}exp(t,n){return xo(this,t,n)}toString(t){return`[ ${this.F.toString(t[0])} , ${this.F.toString(t[1])} ]`}fromRng(t){let n=this.F.fromRng(t),a=this.F.fromRng(t);return[n,a]}gt(t,n){return this.F.gt(t[0],n[0])?!0:this.F.gt(n[0],t[0])?!1:!!this.F.gt(t[1],n[1])}geq(t,n){return this.gt(t,n)||this.eq(t,n)}lt(t,n){return!this.geq(t,n)}leq(t,n){return!this.gt(t,n)}neq(t,n){return!this.eq(t,n)}random(){return[this.F.random(),this.F.random()]}toRprLE(t,n,a){this.F.toRprLE(t,n,a[0]),this.F.toRprLE(t,n+this.F.n8,a[1])}toRprBE(t,n,a){this.F.toRprBE(t,n,a[1]),this.F.toRprBE(t,n+this.F.n8,a[0])}toRprLEM(t,n,a){this.F.toRprLEM(t,n,a[0]),this.F.toRprLEM(t,n+this.F.n8,a[1])}toRprBEM(t,n,a){this.F.toRprBEM(t,n,a[1]),this.F.toRprBEM(t,n+this.F.n8,a[0])}fromRprLE(t,n){n=n||0;let a=this.F.fromRprLE(t,n),o=this.F.fromRprLE(t,n+this.F.n8);return[a,o]}fromRprBE(t,n){n=n||0;let a=this.F.fromRprBE(t,n);return[this.F.fromRprBE(t,n+this.F.n8),a]}fromRprLEM(t,n){n=n||0;let a=this.F.fromRprLEM(t,n),o=this.F.fromRprLEM(t,n+this.F.n8);return[a,o]}fromRprBEM(t,n){n=n||0;let a=this.F.fromRprBEM(t,n);return[this.F.fromRprBEM(t,n+this.F.n8),a]}toObject(t){return t}},Ns=class{constructor(t,n){this.type="F3",this.F=t,this.zero=[this.F.zero,this.F.zero,this.F.zero],this.one=[this.F.one,this.F.zero,this.F.zero],this.negone=this.neg(this.one),this.nonResidue=n,this.m=t.m*3,this.p=t.p,this.n64=t.n64*3,this.n32=this.n64*2,this.n8=this.n64*8}_mulByNonResidue(t){return this.F.mul(this.nonResidue,t)}copy(t){return[this.F.copy(t[0]),this.F.copy(t[1]),this.F.copy(t[2])]}add(t,n){return[this.F.add(t[0],n[0]),this.F.add(t[1],n[1]),this.F.add(t[2],n[2])]}double(t){return this.add(t,t)}sub(t,n){return[this.F.sub(t[0],n[0]),this.F.sub(t[1],n[1]),this.F.sub(t[2],n[2])]}neg(t){return this.sub(this.zero,t)}mul(t,n){let a=this.F.mul(t[0],n[0]),o=this.F.mul(t[1],n[1]),e=this.F.mul(t[2],n[2]);return[this.F.add(a,this._mulByNonResidue(this.F.sub(this.F.mul(this.F.add(t[1],t[2]),this.F.add(n[1],n[2])),this.F.add(o,e)))),this.F.add(this.F.sub(this.F.mul(this.F.add(t[0],t[1]),this.F.add(n[0],n[1])),this.F.add(a,o)),this._mulByNonResidue(e)),this.F.add(this.F.sub(this.F.mul(this.F.add(t[0],t[2]),this.F.add(n[0],n[2])),this.F.add(a,e)),o)]}inv(t){let n=this.F.square(t[0]),a=this.F.square(t[1]),o=this.F.square(t[2]),e=this.F.mul(t[0],t[1]),h=this.F.mul(t[0],t[2]),d=this.F.mul(t[1],t[2]),b=this.F.sub(n,this._mulByNonResidue(d)),l=this.F.sub(this._mulByNonResidue(o),e),s=this.F.sub(a,h),m=this.F.inv(this.F.add(this.F.mul(t[0],b),this._mulByNonResidue(this.F.add(this.F.mul(t[2],l),this.F.mul(t[1],s)))));return[this.F.mul(m,b),this.F.mul(m,l),this.F.mul(m,s)]}div(t,n){return this.mul(t,this.inv(n))}square(t){let n=this.F.square(t[0]),a=this.F.mul(t[0],t[1]),o=this.F.add(a,a),e=this.F.square(this.F.add(this.F.sub(t[0],t[1]),t[2])),h=this.F.mul(t[1],t[2]),d=this.F.add(h,h),b=this.F.square(t[2]);return[this.F.add(n,this._mulByNonResidue(d)),this.F.add(o,this._mulByNonResidue(b)),this.F.sub(this.F.add(this.F.add(o,e),d),this.F.add(n,b))]}isZero(t){return this.F.isZero(t[0])&&this.F.isZero(t[1])&&this.F.isZero(t[2])}eq(t,n){return this.F.eq(t[0],n[0])&&this.F.eq(t[1],n[1])&&this.F.eq(t[2],n[2])}affine(t){return[this.F.affine(t[0]),this.F.affine(t[1]),this.F.affine(t[2])]}mulScalar(t,n){return Me(this,t,n)}pow(t,n){return xo(this,t,n)}exp(t,n){return xo(this,t,n)}toString(t){return`[ ${this.F.toString(t[0])} , ${this.F.toString(t[1])}, ${this.F.toString(t[2])} ]`}fromRng(t){let n=this.F.fromRng(t),a=this.F.fromRng(t),o=this.F.fromRng(t);return[n,a,o]}gt(t,n){return this.F.gt(t[0],n[0])?!0:this.F.gt(n[0],t[0])?!1:this.F.gt(t[1],n[1])?!0:this.F.gt(n[1],t[1])?!1:!!this.F.gt(t[2],n[2])}geq(t,n){return this.gt(t,n)||this.eq(t,n)}lt(t,n){return!this.geq(t,n)}leq(t,n){return!this.gt(t,n)}neq(t,n){return!this.eq(t,n)}random(){return[this.F.random(),this.F.random(),this.F.random()]}toRprLE(t,n,a){this.F.toRprLE(t,n,a[0]),this.F.toRprLE(t,n+this.F.n8,a[1]),this.F.toRprLE(t,n+this.F.n8*2,a[2])}toRprBE(t,n,a){this.F.toRprBE(t,n,a[2]),this.F.toRprBE(t,n+this.F.n8,a[1]),this.F.toRprBE(t,n+this.F.n8*2,a[0])}toRprLEM(t,n,a){this.F.toRprLEM(t,n,a[0]),this.F.toRprLEM(t,n+this.F.n8,a[1]),this.F.toRprLEM(t,n+this.F.n8*2,a[2])}toRprBEM(t,n,a){this.F.toRprBEM(t,n,a[2]),this.F.toRprBEM(t,n+this.F.n8,a[1]),this.F.toRprBEM(t,n+this.F.n8*2,a[0])}fromRprLE(t,n){n=n||0;let a=this.F.fromRprLE(t,n),o=this.F.fromRprLE(t,n+this.n8),e=this.F.fromRprLE(t,n+this.n8*2);return[a,o,e]}fromRprBE(t,n){n=n||0;let a=this.F.fromRprBE(t,n),o=this.F.fromRprBE(t,n+this.n8);return[this.F.fromRprBE(t,n+this.n8*2),o,a]}fromRprLEM(t,n){n=n||0;let a=this.F.fromRprLEM(t,n),o=this.F.fromRprLEM(t,n+this.n8),e=this.F.fromRprLEM(t,n+this.n8*2);return[a,o,e]}fromRprBEM(t,n){n=n||0;let a=this.F.fromRprBEM(t,n),o=this.F.fromRprBEM(t,n+this.n8);return[this.F.fromRprBEM(t,n+this.n8*2),o,a]}toObject(t){return t}};$s=class{constructor(t,n){this.F=t,this.g=n,this.g.length==2&&(this.g[2]=this.F.one),this.zero=[this.F.zero,this.F.one,this.F.zero]}add(t,n){let a=this.F;if(this.eq(t,this.zero))return n;if(this.eq(n,this.zero))return t;let o=new Array(3),e=a.square(t[2]),h=a.square(n[2]),d=a.mul(t[0],h),b=a.mul(n[0],e),l=a.mul(t[2],e),s=a.mul(n[2],h),m=a.mul(t[1],s),B=a.mul(n[1],l);if(a.eq(d,b)&&a.eq(m,B))return this.double(t);let p=a.sub(b,d),v=a.sub(B,m),M=a.square(a.add(p,p)),x=a.mul(p,M),S=a.add(v,v),w=a.mul(d,M);o[0]=a.sub(a.sub(a.square(S),x),a.add(w,w));let k=a.mul(m,x);return o[1]=a.sub(a.mul(S,a.sub(w,o[0])),a.add(k,k)),o[2]=a.mul(p,a.sub(a.square(a.add(t[2],n[2])),a.add(e,h))),o}neg(t){return[t[0],this.F.neg(t[1]),t[2]]}sub(t,n){return this.add(t,this.neg(n))}double(t){let n=this.F,a=new Array(3);if(this.eq(t,this.zero))return t;let o=n.square(t[0]),e=n.square(t[1]),h=n.square(e),d=n.sub(n.square(n.add(t[0],e)),n.add(o,h));d=n.add(d,d);let b=n.add(n.add(o,o),o),l=n.square(b);a[0]=n.sub(l,n.add(d,d));let s=n.add(h,h);s=n.add(s,s),s=n.add(s,s),a[1]=n.sub(n.mul(b,n.sub(d,a[0])),s);let m=n.mul(t[1],t[2]);return a[2]=n.add(m,m),a}timesScalar(t,n){return Me(this,t,n)}mulScalar(t,n){return Me(this,t,n)}affine(t){let n=this.F;if(this.isZero(t))return this.zero;if(n.eq(t[2],n.one))return t;{let a=n.inv(t[2]),o=n.square(a),e=n.mul(o,a),h=new Array(3);return h[0]=n.mul(t[0],o),h[1]=n.mul(t[1],e),h[2]=n.one,h}}multiAffine(t){let n=Object.keys(t),a=this.F,o=new Array(n.length+1);o[0]=a.one;for(let e=0;e<n.length;e++)a.eq(t[n[e]][2],a.zero)?o[e+1]=o[e]:o[e+1]=a.mul(o[e],t[n[e]][2]);o[n.length]=a.inv(o[n.length]);for(let e=n.length-1;e>=0;e--)if(a.eq(t[n[e]][2],a.zero))o[e]=o[e+1],t[n[e]]=this.zero;else{let h=a.mul(o[e],o[e+1]);o[e]=a.mul(t[n[e]][2],o[e+1]);let d=a.square(h),b=a.mul(d,h);t[n[e]][0]=a.mul(t[n[e]][0],d),t[n[e]][1]=a.mul(t[n[e]][1],b),t[n[e]][2]=a.one}}eq(t,n){let a=this.F;if(this.F.eq(t[2],this.F.zero))return this.F.eq(n[2],this.F.zero);if(this.F.eq(n[2],this.F.zero))return!1;let o=a.square(t[2]),e=a.square(n[2]),h=a.mul(t[0],e),d=a.mul(n[0],o),b=a.mul(t[2],o),l=a.mul(n[2],e),s=a.mul(t[1],l),m=a.mul(n[1],b);return a.eq(h,d)&&a.eq(s,m)}isZero(t){return this.F.isZero(t[2])}toString(t){let n=this.affine(t);return`[ ${this.F.toString(n[0])} , ${this.F.toString(n[1])} ]`}fromRng(t){let n=this.F,a=[],o;do{a[0]=n.fromRng(t),o=t.nextBool();let h=n.add(n.mul(n.square(a[0]),a[0]),this.b);a[1]=n.sqrt(h)}while(a[1]==null||n.isZero[a]);let e=qe(n,a[1]);return o^e&&(a[1]=n.neg(a[1])),a[2]=n.one,this.cofactor&&(a=this.mulScalar(a,this.cofactor)),a=this.affine(a),a}toRprLE(t,n,a){if(a=this.affine(a),this.isZero(a)){new Uint8Array(t,n,this.F.n8*2).fill(0);return}this.F.toRprLE(t,n,a[0]),this.F.toRprLE(t,n+this.F.n8,a[1])}toRprBE(t,n,a){if(a=this.affine(a),this.isZero(a)){new Uint8Array(t,n,this.F.n8*2).fill(0);return}this.F.toRprBE(t,n,a[0]),this.F.toRprBE(t,n+this.F.n8,a[1])}toRprLEM(t,n,a){if(a=this.affine(a),this.isZero(a)){new Uint8Array(t,n,this.F.n8*2).fill(0);return}this.F.toRprLEM(t,n,a[0]),this.F.toRprLEM(t,n+this.F.n8,a[1])}toRprLEJM(t,n,a){if(a=this.affine(a),this.isZero(a)){new Uint8Array(t,n,this.F.n8*2).fill(0);return}this.F.toRprLEM(t,n,a[0]),this.F.toRprLEM(t,n+this.F.n8,a[1]),this.F.toRprLEM(t,n+2*this.F.n8,a[2])}toRprBEM(t,n,a){if(a=this.affine(a),this.isZero(a)){new Uint8Array(t,n,this.F.n8*2).fill(0);return}this.F.toRprBEM(t,n,a[0]),this.F.toRprBEM(t,n+this.F.n8,a[1])}fromRprLE(t,n){n=n||0;let a=this.F.fromRprLE(t,n),o=this.F.fromRprLE(t,n+this.F.n8);return this.F.isZero(a)&&this.F.isZero(o)?this.zero:[a,o,this.F.one]}fromRprBE(t,n){n=n||0;let a=this.F.fromRprBE(t,n),o=this.F.fromRprBE(t,n+this.F.n8);return this.F.isZero(a)&&this.F.isZero(o)?this.zero:[a,o,this.F.one]}fromRprLEM(t,n){n=n||0;let a=this.F.fromRprLEM(t,n),o=this.F.fromRprLEM(t,n+this.F.n8);return this.F.isZero(a)&&this.F.isZero(o)?this.zero:[a,o,this.F.one]}fromRprLEJM(t,n){n=n||0;let a=this.F.fromRprLEM(t,n),o=this.F.fromRprLEM(t,n+this.F.n8),e=this.F.fromRprLEM(t,n+this.F.n8*2);return this.F.isZero(a)&&this.F.isZero(o)?this.zero:[a,o,e]}fromRprBEM(t,n){n=n||0;let a=this.F.fromRprBEM(t,n),o=this.F.fromRprBEM(t,n+this.F.n8);return this.F.isZero(a)&&this.F.isZero(o)?this.zero:[a,o,this.F.one]}fromRprCompressed(t,n){let a=this.F,o=new Uint8Array(t.buffer,n,a.n8);if(o[0]&64)return this.zero;let e=new Array(3),h=(o[0]&128)!=0;o[0]=o[0]&127,e[0]=a.fromRprBE(t,n),h&&(o[0]=o[0]|128);let d=a.add(a.mul(a.square(e[0]),e[0]),this.b);if(e[1]=a.sqrt(d),e[1]===null)throw new Error("Invalid Point!");let b=qe(a,e[1]);return h^b&&(e[1]=a.neg(e[1])),e[2]=a.one,e}toRprCompressed(t,n,a){a=this.affine(a);let o=new Uint8Array(t.buffer,n,this.F.n8);if(this.isZero(a)){o.fill(0),o[0]=64;return}this.F.toRprBE(t,n,a[0]),qe(this.F,a[1])&&(o[0]=o[0]|128)}fromRprUncompressed(t,n){return t[0]&64?this.zero:this.fromRprBE(t,n)}toRprUncompressed(t,n,a){this.toRprBE(t,n,a),this.isZero(a)&&(t[n]=t[n]|64)}},Na={};Na.bigInt2BytesLE=function(t,n){let a=Array(n),o=BigInt(t);for(let e=0;e<n;e++)a[e]=Number(o&0xFFn),o=o>>8n;return a};Na.bigInt2U32LE=function(t,n){let a=Array(n),o=BigInt(t);for(let e=0;e<n;e++)a[e]=Number(o&0xFFFFFFFFn),o=o>>32n;return a};Na.isOcamNum=function(c){return!(!Array.isArray(c)||c.length!=3||typeof c[0]!="number"||typeof c[1]!="number"||!Array.isArray(c[2]))};e1=function(t,n,a){let o=a||"int";if(t.modules[o])return o;t.modules[o]={};let e=n*2,h=n*8;function d(){let F=t.addFunction(o+"_copy");F.addParam("px","i32"),F.addParam("pr","i32");let u=F.getCodeBuilder();for(let L=0;L<n;L++)F.addCode(u.i64_store(u.getLocal("pr"),L*8,u.i64_load(u.getLocal("px"),L*8)))}function b(){let F=t.addFunction(o+"_zero");F.addParam("pr","i32");let u=F.getCodeBuilder();for(let L=0;L<n;L++)F.addCode(u.i64_store(u.getLocal("pr"),L*8,u.i64_const(0)))}function l(){let F=t.addFunction(o+"_one");F.addParam("pr","i32");let u=F.getCodeBuilder();F.addCode(u.i64_store(u.getLocal("pr"),0,u.i64_const(1)));for(let L=1;L<n;L++)F.addCode(u.i64_store(u.getLocal("pr"),L*8,u.i64_const(0)))}function s(){let F=t.addFunction(o+"_isZero");F.addParam("px","i32"),F.setReturnType("i32");let u=F.getCodeBuilder();function L($){return $==0?u.ret(u.i64_eqz(u.i64_load(u.getLocal("px")))):u.if(u.i64_eqz(u.i64_load(u.getLocal("px"),$*8)),L($-1),u.ret(u.i32_const(0)))}F.addCode(L(n-1)),F.addCode(u.ret(u.i32_const(0)))}function m(){let F=t.addFunction(o+"_eq");F.addParam("px","i32"),F.addParam("py","i32"),F.setReturnType("i32");let u=F.getCodeBuilder();function L($){return $==0?u.ret(u.i64_eq(u.i64_load(u.getLocal("px")),u.i64_load(u.getLocal("py")))):u.if(u.i64_eq(u.i64_load(u.getLocal("px"),$*8),u.i64_load(u.getLocal("py"),$*8)),L($-1),u.ret(u.i32_const(0)))}F.addCode(L(n-1)),F.addCode(u.ret(u.i32_const(0)))}function B(){let F=t.addFunction(o+"_gte");F.addParam("px","i32"),F.addParam("py","i32"),F.setReturnType("i32");let u=F.getCodeBuilder();function L($){return $==0?u.ret(u.i64_ge_u(u.i64_load(u.getLocal("px")),u.i64_load(u.getLocal("py")))):u.if(u.i64_lt_u(u.i64_load(u.getLocal("px"),$*8),u.i64_load(u.getLocal("py"),$*8)),u.ret(u.i32_const(0)),u.if(u.i64_gt_u(u.i64_load(u.getLocal("px"),$*8),u.i64_load(u.getLocal("py"),$*8)),u.ret(u.i32_const(1)),L($-1)))}F.addCode(L(n-1)),F.addCode(u.ret(u.i32_const(0)))}function p(){let F=t.addFunction(o+"_add");F.addParam("x","i32"),F.addParam("y","i32"),F.addParam("r","i32"),F.setReturnType("i32"),F.addLocal("c","i64");let u=F.getCodeBuilder();F.addCode(u.setLocal("c",u.i64_add(u.i64_load32_u(u.getLocal("x")),u.i64_load32_u(u.getLocal("y"))))),F.addCode(u.i64_store32(u.getLocal("r"),u.getLocal("c")));for(let L=1;L<e;L++)F.addCode(u.setLocal("c",u.i64_add(u.i64_add(u.i64_load32_u(u.getLocal("x"),4*L),u.i64_load32_u(u.getLocal("y"),4*L)),u.i64_shr_u(u.getLocal("c"),u.i64_const(32))))),F.addCode(u.i64_store32(u.getLocal("r"),L*4,u.getLocal("c")));F.addCode(u.i32_wrap_i64(u.i64_shr_u(u.getLocal("c"),u.i64_const(32))))}function v(){let F=t.addFunction(o+"_sub");F.addParam("x","i32"),F.addParam("y","i32"),F.addParam("r","i32"),F.setReturnType("i32"),F.addLocal("c","i64");let u=F.getCodeBuilder();F.addCode(u.setLocal("c",u.i64_sub(u.i64_load32_u(u.getLocal("x")),u.i64_load32_u(u.getLocal("y"))))),F.addCode(u.i64_store32(u.getLocal("r"),u.i64_and(u.getLocal("c"),u.i64_const("0xFFFFFFFF"))));for(let L=1;L<e;L++)F.addCode(u.setLocal("c",u.i64_add(u.i64_sub(u.i64_load32_u(u.getLocal("x"),4*L),u.i64_load32_u(u.getLocal("y"),4*L)),u.i64_shr_s(u.getLocal("c"),u.i64_const(32))))),F.addCode(u.i64_store32(u.getLocal("r"),L*4,u.i64_and(u.getLocal("c"),u.i64_const("0xFFFFFFFF"))));F.addCode(u.i32_wrap_i64(u.i64_shr_s(u.getLocal("c"),u.i64_const(32))))}function M(){let F=t.addFunction(o+"_mul");F.addParam("x","i32"),F.addParam("y","i32"),F.addParam("r","i32"),F.addLocal("c0","i64"),F.addLocal("c1","i64");for(let y=0;y<e;y++)F.addLocal("x"+y,"i64"),F.addLocal("y"+y,"i64");let u=F.getCodeBuilder(),L=[],$=[];function Q(y,I){let N,nt;return L[y]?N=u.getLocal("x"+y):(N=u.teeLocal("x"+y,u.i64_load32_u(u.getLocal("x"),y*4)),L[y]=!0),$[I]?nt=u.getLocal("y"+I):(nt=u.teeLocal("y"+I,u.i64_load32_u(u.getLocal("y"),I*4)),$[I]=!0),u.i64_mul(N,nt)}let H="c0",q="c1";for(let y=0;y<e*2-1;y++){for(let I=Math.max(0,y-e+1);I<=y&&I<e;I++){let N=y-I;F.addCode(u.setLocal(H,u.i64_add(u.i64_and(u.getLocal(H),u.i64_const(4294967295)),Q(I,N)))),F.addCode(u.setLocal(q,u.i64_add(u.getLocal(q),u.i64_shr_u(u.getLocal(H),u.i64_const(32)))))}F.addCode(u.i64_store32(u.getLocal("r"),y*4,u.getLocal(H))),[H,q]=[q,H],F.addCode(u.setLocal(q,u.i64_shr_u(u.getLocal(H),u.i64_const(32))))}F.addCode(u.i64_store32(u.getLocal("r"),e*4*2-4,u.getLocal(H)))}function x(){let F=t.addFunction(o+"_square");F.addParam("x","i32"),F.addParam("r","i32"),F.addLocal("c0","i64"),F.addLocal("c1","i64"),F.addLocal("c0_old","i64"),F.addLocal("c1_old","i64");for(let I=0;I<e;I++)F.addLocal("x"+I,"i64");let u=F.getCodeBuilder(),L=[];function $(I,N){let nt,J;return L[I]?nt=u.getLocal("x"+I):(nt=u.teeLocal("x"+I,u.i64_load32_u(u.getLocal("x"),I*4)),L[I]=!0),L[N]?J=u.getLocal("x"+N):(J=u.teeLocal("x"+N,u.i64_load32_u(u.getLocal("x"),N*4)),L[N]=!0),u.i64_mul(nt,J)}let Q="c0",H="c1",q="c0_old",y="c1_old";for(let I=0;I<e*2-1;I++){F.addCode(u.setLocal(Q,u.i64_const(0)),u.setLocal(H,u.i64_const(0)));for(let N=Math.max(0,I-e+1);N<I+1>>1&&N<e;N++){let nt=I-N;F.addCode(u.setLocal(Q,u.i64_add(u.i64_and(u.getLocal(Q),u.i64_const(4294967295)),$(N,nt)))),F.addCode(u.setLocal(H,u.i64_add(u.getLocal(H),u.i64_shr_u(u.getLocal(Q),u.i64_const(32)))))}F.addCode(u.setLocal(Q,u.i64_shl(u.i64_and(u.getLocal(Q),u.i64_const(4294967295)),u.i64_const(1)))),F.addCode(u.setLocal(H,u.i64_add(u.i64_shl(u.getLocal(H),u.i64_const(1)),u.i64_shr_u(u.getLocal(Q),u.i64_const(32))))),I%2==0&&(F.addCode(u.setLocal(Q,u.i64_add(u.i64_and(u.getLocal(Q),u.i64_const(4294967295)),$(I>>1,I>>1)))),F.addCode(u.setLocal(H,u.i64_add(u.getLocal(H),u.i64_shr_u(u.getLocal(Q),u.i64_const(32)))))),I>0&&(F.addCode(u.setLocal(Q,u.i64_add(u.i64_and(u.getLocal(Q),u.i64_const(4294967295)),u.i64_and(u.getLocal(q),u.i64_const(4294967295))))),F.addCode(u.setLocal(H,u.i64_add(u.i64_add(u.getLocal(H),u.i64_shr_u(u.getLocal(Q),u.i64_const(32))),u.getLocal(y))))),F.addCode(u.i64_store32(u.getLocal("r"),I*4,u.getLocal(Q))),F.addCode(u.setLocal(q,u.getLocal(H)),u.setLocal(y,u.i64_shr_u(u.getLocal(q),u.i64_const(32))))}F.addCode(u.i64_store32(u.getLocal("r"),e*4*2-4,u.getLocal(q)))}function S(){let F=t.addFunction(o+"_squareOld");F.addParam("x","i32"),F.addParam("r","i32");let u=F.getCodeBuilder();F.addCode(u.call(o+"_mul",u.getLocal("x"),u.getLocal("x"),u.getLocal("r")))}function w(){let F=t.addFunction(o+"__mul1");F.addParam("px","i32"),F.addParam("y","i64"),F.addParam("pr","i32"),F.addLocal("c","i64");let u=F.getCodeBuilder();F.addCode(u.setLocal("c",u.i64_mul(u.i64_load32_u(u.getLocal("px"),0,0),u.getLocal("y")))),F.addCode(u.i64_store32(u.getLocal("pr"),0,0,u.getLocal("c")));for(let L=1;L<e;L++)F.addCode(u.setLocal("c",u.i64_add(u.i64_mul(u.i64_load32_u(u.getLocal("px"),4*L,0),u.getLocal("y")),u.i64_shr_u(u.getLocal("c"),u.i64_const(32))))),F.addCode(u.i64_store32(u.getLocal("pr"),L*4,0,u.getLocal("c")))}function k(){let F=t.addFunction(o+"__add1");F.addParam("x","i32"),F.addParam("y","i64"),F.addLocal("c","i64"),F.addLocal("px","i32");let u=F.getCodeBuilder();F.addCode(u.setLocal("px",u.getLocal("x"))),F.addCode(u.setLocal("c",u.i64_add(u.i64_load32_u(u.getLocal("px"),0,0),u.getLocal("y")))),F.addCode(u.i64_store32(u.getLocal("px"),0,0,u.getLocal("c"))),F.addCode(u.setLocal("c",u.i64_shr_u(u.getLocal("c"),u.i64_const(32)))),F.addCode(u.block(u.loop(u.br_if(1,u.i64_eqz(u.getLocal("c"))),u.setLocal("px",u.i32_add(u.getLocal("px"),u.i32_const(4))),u.setLocal("c",u.i64_add(u.i64_load32_u(u.getLocal("px"),0,0),u.getLocal("c"))),u.i64_store32(u.getLocal("px"),0,0,u.getLocal("c")),u.setLocal("c",u.i64_shr_u(u.getLocal("c"),u.i64_const(32))),u.br(0))))}function O(){w(),k();let F=t.addFunction(o+"_div");F.addParam("x","i32"),F.addParam("y","i32"),F.addParam("c","i32"),F.addParam("r","i32"),F.addLocal("rr","i32"),F.addLocal("cc","i32"),F.addLocal("eX","i32"),F.addLocal("eY","i32"),F.addLocal("sy","i64"),F.addLocal("sx","i64"),F.addLocal("ec","i32");let u=F.getCodeBuilder(),L=u.i32_const(t.alloc(h)),$=u.i32_const(t.alloc(h)),Q=u.i32_const(t.alloc(h)),H=u.getLocal("cc"),q=u.getLocal("rr"),y=t.alloc(h*2),I=u.i32_const(y),N=u.i32_const(y+h);F.addCode(u.if(u.getLocal("c"),u.setLocal("cc",u.getLocal("c")),u.setLocal("cc",$))),F.addCode(u.if(u.getLocal("r"),u.setLocal("rr",u.getLocal("r")),u.setLocal("rr",Q))),F.addCode(u.call(o+"_copy",u.getLocal("x"),q)),F.addCode(u.call(o+"_copy",u.getLocal("y"),L)),F.addCode(u.call(o+"_zero",H)),F.addCode(u.call(o+"_zero",I)),F.addCode(u.setLocal("eX",u.i32_const(h-1))),F.addCode(u.setLocal("eY",u.i32_const(h-1))),F.addCode(u.block(u.loop(u.br_if(1,u.i32_or(u.i32_load8_u(u.i32_add(L,u.getLocal("eY")),0,0),u.i32_eq(u.getLocal("eY"),u.i32_const(3)))),u.setLocal("eY",u.i32_sub(u.getLocal("eY"),u.i32_const(1))),u.br(0)))),F.addCode(u.setLocal("sy",u.i64_add(u.i64_load32_u(u.i32_sub(u.i32_add(L,u.getLocal("eY")),u.i32_const(3)),0,0),u.i64_const(1)))),F.addCode(u.if(u.i64_eq(u.getLocal("sy"),u.i64_const(1)),u.drop(u.i64_div_u(u.i64_const(0),u.i64_const(0))))),F.addCode(u.block(u.loop(u.block(u.loop(u.br_if(1,u.i32_or(u.i32_load8_u(u.i32_add(q,u.getLocal("eX")),0,0),u.i32_eq(u.getLocal("eX"),u.i32_const(7)))),u.setLocal("eX",u.i32_sub(u.getLocal("eX"),u.i32_const(1))),u.br(0))),u.setLocal("sx",u.i64_load(u.i32_sub(u.i32_add(q,u.getLocal("eX")),u.i32_const(7)),0,0)),u.setLocal("sx",u.i64_div_u(u.getLocal("sx"),u.getLocal("sy"))),u.setLocal("ec",u.i32_sub(u.i32_sub(u.getLocal("eX"),u.getLocal("eY")),u.i32_const(4))),u.block(u.loop(u.br_if(1,u.i32_and(u.i64_eqz(u.i64_and(u.getLocal("sx"),u.i64_const("0xFFFFFFFF00000000"))),u.i32_ge_s(u.getLocal("ec"),u.i32_const(0)))),u.setLocal("sx",u.i64_shr_u(u.getLocal("sx"),u.i64_const(8))),u.setLocal("ec",u.i32_add(u.getLocal("ec"),u.i32_const(1))),u.br(0))),u.if(u.i64_eqz(u.getLocal("sx")),[...u.br_if(2,u.i32_eqz(u.call(o+"_gte",q,L))),...u.setLocal("sx",u.i64_const(1)),...u.setLocal("ec",u.i32_const(0))]),u.call(o+"__mul1",L,u.getLocal("sx"),N),u.drop(u.call(o+"_sub",q,u.i32_sub(N,u.getLocal("ec")),q)),u.call(o+"__add1",u.i32_add(H,u.getLocal("ec")),u.getLocal("sx")),u.br(0))))}function W(){let F=t.addFunction(o+"_inverseMod");F.addParam("px","i32"),F.addParam("pm","i32"),F.addParam("pr","i32"),F.addLocal("t","i32"),F.addLocal("newt","i32"),F.addLocal("r","i32"),F.addLocal("qq","i32"),F.addLocal("qr","i32"),F.addLocal("newr","i32"),F.addLocal("swp","i32"),F.addLocal("x","i32"),F.addLocal("signt","i32"),F.addLocal("signnewt","i32"),F.addLocal("signx","i32");let u=F.getCodeBuilder(),L=u.i32_const(t.alloc(h)),$=u.i32_const(t.alloc(h)),Q=u.i32_const(t.alloc(h)),H=u.i32_const(t.alloc(h)),q=u.i32_const(t.alloc(h)),y=u.i32_const(t.alloc(h)),I=u.i32_const(t.alloc(h*2)),N=u.i32_const(t.alloc(h));F.addCode(u.setLocal("t",L),u.call(o+"_zero",L),u.setLocal("signt",u.i32_const(0))),F.addCode(u.setLocal("r",$),u.call(o+"_copy",u.getLocal("pm"),$)),F.addCode(u.setLocal("newt",Q),u.call(o+"_one",Q),u.setLocal("signnewt",u.i32_const(0))),F.addCode(u.setLocal("newr",H),u.call(o+"_copy",u.getLocal("px"),H)),F.addCode(u.setLocal("qq",q)),F.addCode(u.setLocal("qr",y)),F.addCode(u.setLocal("x",N)),F.addCode(u.block(u.loop(u.br_if(1,u.call(o+"_isZero",u.getLocal("newr"))),u.call(o+"_div",u.getLocal("r"),u.getLocal("newr"),u.getLocal("qq"),u.getLocal("qr")),u.call(o+"_mul",u.getLocal("qq"),u.getLocal("newt"),I),u.if(u.getLocal("signt"),u.if(u.getLocal("signnewt"),u.if(u.call(o+"_gte",I,u.getLocal("t")),[...u.drop(u.call(o+"_sub",I,u.getLocal("t"),u.getLocal("x"))),...u.setLocal("signx",u.i32_const(0))],[...u.drop(u.call(o+"_sub",u.getLocal("t"),I,u.getLocal("x"))),...u.setLocal("signx",u.i32_const(1))]),[...u.drop(u.call(o+"_add",I,u.getLocal("t"),u.getLocal("x"))),...u.setLocal("signx",u.i32_const(1))]),u.if(u.getLocal("signnewt"),[...u.drop(u.call(o+"_add",I,u.getLocal("t"),u.getLocal("x"))),...u.setLocal("signx",u.i32_const(0))],u.if(u.call(o+"_gte",u.getLocal("t"),I),[...u.drop(u.call(o+"_sub",u.getLocal("t"),I,u.getLocal("x"))),...u.setLocal("signx",u.i32_const(0))],[...u.drop(u.call(o+"_sub",I,u.getLocal("t"),u.getLocal("x"))),...u.setLocal("signx",u.i32_const(1))]))),u.setLocal("swp",u.getLocal("t")),u.setLocal("t",u.getLocal("newt")),u.setLocal("newt",u.getLocal("x")),u.setLocal("x",u.getLocal("swp")),u.setLocal("signt",u.getLocal("signnewt")),u.setLocal("signnewt",u.getLocal("signx")),u.setLocal("swp",u.getLocal("r")),u.setLocal("r",u.getLocal("newr")),u.setLocal("newr",u.getLocal("qr")),u.setLocal("qr",u.getLocal("swp")),u.br(0)))),F.addCode(u.if(u.getLocal("signt"),u.drop(u.call(o+"_sub",u.getLocal("pm"),u.getLocal("t"),u.getLocal("pr"))),u.call(o+"_copy",u.getLocal("t"),u.getLocal("pr"))))}return d(),b(),s(),l(),m(),B(),p(),v(),M(),x(),S(),O(),W(),t.exportFunction(o+"_copy"),t.exportFunction(o+"_zero"),t.exportFunction(o+"_one"),t.exportFunction(o+"_isZero"),t.exportFunction(o+"_eq"),t.exportFunction(o+"_gte"),t.exportFunction(o+"_add"),t.exportFunction(o+"_sub"),t.exportFunction(o+"_mul"),t.exportFunction(o+"_square"),t.exportFunction(o+"_squareOld"),t.exportFunction(o+"_div"),t.exportFunction(o+"_inverseMod"),o},ol=function(t,n,a,o,e,h,d){let b=t.addFunction(n);b.addParam("base","i32"),b.addParam("scalar","i32"),b.addParam("scalarLength","i32"),b.addParam("r","i32"),b.addLocal("i","i32"),b.addLocal("b","i32");let l=b.getCodeBuilder(),s=l.i32_const(t.alloc(a));b.addCode(l.if(l.i32_eqz(l.getLocal("scalarLength")),[...l.call(d,l.getLocal("r")),...l.ret([])])),b.addCode(l.call(h,l.getLocal("base"),s)),b.addCode(l.call(d,l.getLocal("r"))),b.addCode(l.setLocal("i",l.getLocal("scalarLength"))),b.addCode(l.block(l.loop(l.setLocal("i",l.i32_sub(l.getLocal("i"),l.i32_const(1))),l.setLocal("b",l.i32_load8_u(l.i32_add(l.getLocal("scalar"),l.getLocal("i")))),...m(),l.br_if(1,l.i32_eqz(l.getLocal("i"))),l.br(0))));function m(){let B=[];for(let p=0;p<8;p++)B.push(...l.call(e,l.getLocal("r"),l.getLocal("r")),...l.if(l.i32_ge_u(l.getLocal("b"),l.i32_const(128>>p)),[...l.setLocal("b",l.i32_sub(l.getLocal("b"),l.i32_const(128>>p))),...l.call(o,l.getLocal("r"),s,l.getLocal("r"))]));return B}},il=c1;U2=s1;l1=r1;Vn={};Vn.bitLength=Z2;Vn.isOdd=$2;Vn.isNegative=We;Vn.abs=Li;Vn.isUnit=Ao;Vn.compare=N2;Vn.modInv=j2;Vn.modPow=V2;Vn.isPrime=f1;Vn.square=el;g1=e1,va=Na,L1=ol,p1=il,As=U2,Es=l1,{bitLength:b1,modInv:vs,modPow:_2,isPrime:h2,isOdd:m1,square:y1}=Vn,sl=function(t,n,a,o){let e=BigInt(n),h=Math.floor((b1(e-1n)-1)/64)+1,d=h*2,b=h*8,l=a||"f1m";if(t.modules[l])return l;let s=g1(t,h,o),m=t.alloc(b,va.bigInt2BytesLE(e,b)),B=t.alloc(va.bigInt2BytesLE(y1(1n<<BigInt(h*64))%e,b)),p=t.alloc(va.bigInt2BytesLE((1n<<BigInt(h*64))%e,b)),v=t.alloc(va.bigInt2BytesLE(0n,b)),M=e-1n,x=M>>1n,S=t.alloc(b,va.bigInt2BytesLE(x,b)),w=x+1n,k=t.alloc(b,va.bigInt2BytesLE(w,b));t.modules[l]={pq:m,pR2:B,n64:h,q:e,pOne:p,pZero:v,pePlusOne:k};function O(){let E=t.addFunction(l+"_one");E.addParam("pr","i32");let g=E.getCodeBuilder();E.addCode(g.call(s+"_copy",g.i32_const(p),g.getLocal("pr")))}function W(){let E=t.addFunction(l+"_add");E.addParam("x","i32"),E.addParam("y","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.if(g.call(s+"_add",g.getLocal("x"),g.getLocal("y"),g.getLocal("r")),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))),g.if(g.call(s+"_gte",g.getLocal("r"),g.i32_const(m)),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))))))}function F(){let E=t.addFunction(l+"_sub");E.addParam("x","i32"),E.addParam("y","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.if(g.call(s+"_sub",g.getLocal("x"),g.getLocal("y"),g.getLocal("r")),g.drop(g.call(s+"_add",g.getLocal("r"),g.i32_const(m),g.getLocal("r")))))}function u(){let E=t.addFunction(l+"_neg");E.addParam("x","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.call(l+"_sub",g.i32_const(v),g.getLocal("x"),g.getLocal("r")))}function L(){let E=t.addFunction(l+"_isNegative");E.addParam("x","i32"),E.setReturnType("i32");let g=E.getCodeBuilder(),U=g.i32_const(t.alloc(b));E.addCode(g.call(l+"_fromMontgomery",g.getLocal("x"),U),g.call(s+"_gte",U,g.i32_const(k)))}function $(){let E=t.addFunction(l+"_sign");E.addParam("x","i32"),E.setReturnType("i32");let g=E.getCodeBuilder(),U=g.i32_const(t.alloc(b));E.addCode(g.if(g.call(s+"_isZero",g.getLocal("x")),g.ret(g.i32_const(0))),g.call(l+"_fromMontgomery",g.getLocal("x"),U),g.if(g.call(s+"_gte",U,g.i32_const(k)),g.ret(g.i32_const(-1))),g.ret(g.i32_const(1)))}function Q(){let E=t.alloc(d*d*8),g=t.addFunction(l+"_mReduct");g.addParam("t","i32"),g.addParam("r","i32"),g.addLocal("np32","i64"),g.addLocal("c","i64"),g.addLocal("m","i64");let U=g.getCodeBuilder(),st=Number(0x100000000n-vs(e,0x100000000n));g.addCode(U.setLocal("np32",U.i64_const(st)));for(let et=0;et<d;et++){g.addCode(U.setLocal("c",U.i64_const(0))),g.addCode(U.setLocal("m",U.i64_and(U.i64_mul(U.i64_load32_u(U.getLocal("t"),et*4),U.getLocal("np32")),U.i64_const("0xFFFFFFFF"))));for(let ct=0;ct<d;ct++)g.addCode(U.setLocal("c",U.i64_add(U.i64_add(U.i64_load32_u(U.getLocal("t"),(et+ct)*4),U.i64_shr_u(U.getLocal("c"),U.i64_const(32))),U.i64_mul(U.i64_load32_u(U.i32_const(m),ct*4),U.getLocal("m"))))),g.addCode(U.i64_store32(U.getLocal("t"),(et+ct)*4,U.getLocal("c")));g.addCode(U.i64_store32(U.i32_const(E),et*4,U.i64_shr_u(U.getLocal("c"),U.i64_const(32))))}g.addCode(U.call(l+"_add",U.i32_const(E),U.i32_add(U.getLocal("t"),U.i32_const(d*4)),U.getLocal("r")))}function H(){let E=t.addFunction(l+"_mul");E.addParam("x","i32"),E.addParam("y","i32"),E.addParam("r","i32"),E.addLocal("c0","i64"),E.addLocal("c1","i64"),E.addLocal("np32","i64");for(let ut=0;ut<d;ut++)E.addLocal("x"+ut,"i64"),E.addLocal("y"+ut,"i64"),E.addLocal("m"+ut,"i64"),E.addLocal("q"+ut,"i64");let g=E.getCodeBuilder(),U=Number(0x100000000n-vs(e,0x100000000n));E.addCode(g.setLocal("np32",g.i64_const(U)));let st=[],et=[],ct=[];function ft(ut,lt){let bt,Et;return st[ut]?bt=g.getLocal("x"+ut):(bt=g.teeLocal("x"+ut,g.i64_load32_u(g.getLocal("x"),ut*4)),st[ut]=!0),et[lt]?Et=g.getLocal("y"+lt):(Et=g.teeLocal("y"+lt,g.i64_load32_u(g.getLocal("y"),lt*4)),et[lt]=!0),g.i64_mul(bt,Et)}function _t(ut,lt){let bt,Et;return ct[ut]?bt=g.getLocal("q"+ut):(bt=g.teeLocal("q"+ut,g.i64_load32_u(g.i32_const(0),m+ut*4)),ct[ut]=!0),Et=g.getLocal("m"+lt),g.i64_mul(bt,Et)}let gt="c0",yt="c1";for(let ut=0;ut<d*2-1;ut++){for(let lt=Math.max(0,ut-d+1);lt<=ut&&lt<d;lt++){let bt=ut-lt;E.addCode(g.setLocal(gt,g.i64_add(g.i64_and(g.getLocal(gt),g.i64_const(4294967295)),ft(lt,bt)))),E.addCode(g.setLocal(yt,g.i64_add(g.getLocal(yt),g.i64_shr_u(g.getLocal(gt),g.i64_const(32)))))}for(let lt=Math.max(1,ut-d+1);lt<=ut&&lt<d;lt++){let bt=ut-lt;E.addCode(g.setLocal(gt,g.i64_add(g.i64_and(g.getLocal(gt),g.i64_const(4294967295)),_t(lt,bt)))),E.addCode(g.setLocal(yt,g.i64_add(g.getLocal(yt),g.i64_shr_u(g.getLocal(gt),g.i64_const(32)))))}ut<d&&(E.addCode(g.setLocal("m"+ut,g.i64_and(g.i64_mul(g.i64_and(g.getLocal(gt),g.i64_const(4294967295)),g.getLocal("np32")),g.i64_const("0xFFFFFFFF")))),E.addCode(g.setLocal(gt,g.i64_add(g.i64_and(g.getLocal(gt),g.i64_const(4294967295)),_t(0,ut)))),E.addCode(g.setLocal(yt,g.i64_add(g.getLocal(yt),g.i64_shr_u(g.getLocal(gt),g.i64_const(32)))))),ut>=d&&E.addCode(g.i64_store32(g.getLocal("r"),(ut-d)*4,g.getLocal(gt))),[gt,yt]=[yt,gt],E.addCode(g.setLocal(yt,g.i64_shr_u(g.getLocal(gt),g.i64_const(32))))}E.addCode(g.i64_store32(g.getLocal("r"),d*4-4,g.getLocal(gt))),E.addCode(g.if(g.i32_wrap_i64(g.getLocal(yt)),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))),g.if(g.call(s+"_gte",g.getLocal("r"),g.i32_const(m)),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))))))}function q(){let E=t.addFunction(l+"_square");E.addParam("x","i32"),E.addParam("r","i32"),E.addLocal("c0","i64"),E.addLocal("c1","i64"),E.addLocal("c0_old","i64"),E.addLocal("c1_old","i64"),E.addLocal("np32","i64");for(let lt=0;lt<d;lt++)E.addLocal("x"+lt,"i64"),E.addLocal("m"+lt,"i64"),E.addLocal("q"+lt,"i64");let g=E.getCodeBuilder(),U=Number(0x100000000n-vs(e,0x100000000n));E.addCode(g.setLocal("np32",g.i64_const(U)));let st=[],et=[];function ct(lt,bt){let Et,It;return st[lt]?Et=g.getLocal("x"+lt):(Et=g.teeLocal("x"+lt,g.i64_load32_u(g.getLocal("x"),lt*4)),st[lt]=!0),st[bt]?It=g.getLocal("x"+bt):(It=g.teeLocal("x"+bt,g.i64_load32_u(g.getLocal("x"),bt*4)),st[bt]=!0),g.i64_mul(Et,It)}function ft(lt,bt){let Et,It;return et[lt]?Et=g.getLocal("q"+lt):(Et=g.teeLocal("q"+lt,g.i64_load32_u(g.i32_const(0),m+lt*4)),et[lt]=!0),It=g.getLocal("m"+bt),g.i64_mul(Et,It)}let _t="c0",gt="c1",yt="c0_old",ut="c1_old";for(let lt=0;lt<d*2-1;lt++){E.addCode(g.setLocal(_t,g.i64_const(0)),g.setLocal(gt,g.i64_const(0)));for(let bt=Math.max(0,lt-d+1);bt<lt+1>>1&&bt<d;bt++){let Et=lt-bt;E.addCode(g.setLocal(_t,g.i64_add(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),ct(bt,Et)))),E.addCode(g.setLocal(gt,g.i64_add(g.getLocal(gt),g.i64_shr_u(g.getLocal(_t),g.i64_const(32)))))}E.addCode(g.setLocal(_t,g.i64_shl(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),g.i64_const(1)))),E.addCode(g.setLocal(gt,g.i64_add(g.i64_shl(g.getLocal(gt),g.i64_const(1)),g.i64_shr_u(g.getLocal(_t),g.i64_const(32))))),lt%2==0&&(E.addCode(g.setLocal(_t,g.i64_add(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),ct(lt>>1,lt>>1)))),E.addCode(g.setLocal(gt,g.i64_add(g.getLocal(gt),g.i64_shr_u(g.getLocal(_t),g.i64_const(32)))))),lt>0&&(E.addCode(g.setLocal(_t,g.i64_add(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),g.i64_and(g.getLocal(yt),g.i64_const(4294967295))))),E.addCode(g.setLocal(gt,g.i64_add(g.i64_add(g.getLocal(gt),g.i64_shr_u(g.getLocal(_t),g.i64_const(32))),g.getLocal(ut)))));for(let bt=Math.max(1,lt-d+1);bt<=lt&&bt<d;bt++){let Et=lt-bt;E.addCode(g.setLocal(_t,g.i64_add(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),ft(bt,Et)))),E.addCode(g.setLocal(gt,g.i64_add(g.getLocal(gt),g.i64_shr_u(g.getLocal(_t),g.i64_const(32)))))}lt<d&&(E.addCode(g.setLocal("m"+lt,g.i64_and(g.i64_mul(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),g.getLocal("np32")),g.i64_const("0xFFFFFFFF")))),E.addCode(g.setLocal(_t,g.i64_add(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),ft(0,lt)))),E.addCode(g.setLocal(gt,g.i64_add(g.getLocal(gt),g.i64_shr_u(g.getLocal(_t),g.i64_const(32)))))),lt>=d&&E.addCode(g.i64_store32(g.getLocal("r"),(lt-d)*4,g.getLocal(_t))),E.addCode(g.setLocal(yt,g.getLocal(gt)),g.setLocal(ut,g.i64_shr_u(g.getLocal(yt),g.i64_const(32))))}E.addCode(g.i64_store32(g.getLocal("r"),d*4-4,g.getLocal(yt))),E.addCode(g.if(g.i32_wrap_i64(g.getLocal(ut)),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))),g.if(g.call(s+"_gte",g.getLocal("r"),g.i32_const(m)),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))))))}function y(){let E=t.addFunction(l+"_squareOld");E.addParam("x","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.call(l+"_mul",g.getLocal("x"),g.getLocal("x"),g.getLocal("r")))}function I(){let E=t.addFunction(l+"_toMontgomery");E.addParam("x","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.call(l+"_mul",g.getLocal("x"),g.i32_const(B),g.getLocal("r")))}function N(){let E=t.alloc(b*2),g=t.addFunction(l+"_fromMontgomery");g.addParam("x","i32"),g.addParam("r","i32");let U=g.getCodeBuilder();g.addCode(U.call(s+"_copy",U.getLocal("x"),U.i32_const(E))),g.addCode(U.call(s+"_zero",U.i32_const(E+b))),g.addCode(U.call(l+"_mReduct",U.i32_const(E),U.getLocal("r")))}function nt(){let E=t.addFunction(l+"_inverse");E.addParam("x","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.call(l+"_fromMontgomery",g.getLocal("x"),g.getLocal("r"))),E.addCode(g.call(s+"_inverseMod",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))),E.addCode(g.call(l+"_toMontgomery",g.getLocal("r"),g.getLocal("r")))}let J=2n;if(h2(e))for(;_2(J,x,e)!==M;)J=J+1n;let j=0,ot=M;for(;!m1(ot)&&ot!==0n;)j++,ot=ot>>1n;let V=t.alloc(b,va.bigInt2BytesLE(ot,b)),at=_2(J,ot,e),Lt=t.alloc(va.bigInt2BytesLE((at<<BigInt(h*64))%e,b)),rt=ot+1n>>1n,ht=t.alloc(b,va.bigInt2BytesLE(rt,b));function A(){let E=t.addFunction(l+"_sqrt");E.addParam("n","i32"),E.addParam("r","i32"),E.addLocal("m","i32"),E.addLocal("i","i32"),E.addLocal("j","i32");let g=E.getCodeBuilder(),U=g.i32_const(p),st=g.i32_const(t.alloc(b)),et=g.i32_const(t.alloc(b)),ct=g.i32_const(t.alloc(b)),ft=g.i32_const(t.alloc(b)),_t=g.i32_const(t.alloc(b));E.addCode(g.if(g.call(l+"_isZero",g.getLocal("n")),g.ret(g.call(l+"_zero",g.getLocal("r")))),g.setLocal("m",g.i32_const(j)),g.call(l+"_copy",g.i32_const(Lt),st),g.call(l+"_exp",g.getLocal("n"),g.i32_const(V),g.i32_const(b),et),g.call(l+"_exp",g.getLocal("n"),g.i32_const(ht),g.i32_const(b),ct),g.block(g.loop(g.br_if(1,g.call(l+"_eq",et,U)),g.call(l+"_square",et,ft),g.setLocal("i",g.i32_const(1)),g.block(g.loop(g.br_if(1,g.call(l+"_eq",ft,U)),g.call(l+"_square",ft,ft),g.setLocal("i",g.i32_add(g.getLocal("i"),g.i32_const(1))),g.br(0))),g.call(l+"_copy",st,_t),g.setLocal("j",g.i32_sub(g.i32_sub(g.getLocal("m"),g.getLocal("i")),g.i32_const(1))),g.block(g.loop(g.br_if(1,g.i32_eqz(g.getLocal("j"))),g.call(l+"_square",_t,_t),g.setLocal("j",g.i32_sub(g.getLocal("j"),g.i32_const(1))),g.br(0))),g.setLocal("m",g.getLocal("i")),g.call(l+"_square",_t,st),g.call(l+"_mul",et,st,et),g.call(l+"_mul",ct,_t,ct),g.br(0))),g.if(g.call(l+"_isNegative",ct),g.call(l+"_neg",ct,g.getLocal("r")),g.call(l+"_copy",ct,g.getLocal("r"))))}function i(){let E=t.addFunction(l+"_isSquare");E.addParam("n","i32"),E.setReturnType("i32");let g=E.getCodeBuilder(),U=g.i32_const(p),st=g.i32_const(t.alloc(b));E.addCode(g.if(g.call(l+"_isZero",g.getLocal("n")),g.ret(g.i32_const(1))),g.call(l+"_exp",g.getLocal("n"),g.i32_const(S),g.i32_const(b),st),g.call(l+"_eq",st,U))}function C(){let E=t.addFunction(l+"_load");E.addParam("scalar","i32"),E.addParam("scalarLen","i32"),E.addParam("r","i32"),E.addLocal("p","i32"),E.addLocal("l","i32"),E.addLocal("i","i32"),E.addLocal("j","i32");let g=E.getCodeBuilder(),U=g.i32_const(t.alloc(b)),st=t.alloc(b),et=g.i32_const(st);E.addCode(g.call(s+"_zero",g.getLocal("r")),g.setLocal("i",g.i32_const(b)),g.setLocal("p",g.getLocal("scalar")),g.block(g.loop(g.br_if(1,g.i32_gt_u(g.getLocal("i"),g.getLocal("scalarLen"))),g.if(g.i32_eq(g.getLocal("i"),g.i32_const(b)),g.call(l+"_one",U),g.call(l+"_mul",U,g.i32_const(B),U)),g.call(l+"_mul",g.getLocal("p"),U,et),g.call(l+"_add",g.getLocal("r"),et,g.getLocal("r")),g.setLocal("p",g.i32_add(g.getLocal("p"),g.i32_const(b))),g.setLocal("i",g.i32_add(g.getLocal("i"),g.i32_const(b))),g.br(0))),g.setLocal("l",g.i32_rem_u(g.getLocal("scalarLen"),g.i32_const(b))),g.if(g.i32_eqz(g.getLocal("l")),g.ret([])),g.call(s+"_zero",et),g.setLocal("j",g.i32_const(0)),g.block(g.loop(g.br_if(1,g.i32_eq(g.getLocal("j"),g.getLocal("l"))),g.i32_store8(g.getLocal("j"),st,g.i32_load8_u(g.getLocal("p"))),g.setLocal("p",g.i32_add(g.getLocal("p"),g.i32_const(1))),g.setLocal("j",g.i32_add(g.getLocal("j"),g.i32_const(1))),g.br(0))),g.if(g.i32_eq(g.getLocal("i"),g.i32_const(b)),g.call(l+"_one",U),g.call(l+"_mul",U,g.i32_const(B),U)),g.call(l+"_mul",et,U,et),g.call(l+"_add",g.getLocal("r"),et,g.getLocal("r")))}function r(){let E=t.addFunction(l+"_timesScalar");E.addParam("x","i32"),E.addParam("scalar","i32"),E.addParam("scalarLen","i32"),E.addParam("r","i32");let g=E.getCodeBuilder(),U=g.i32_const(t.alloc(b));E.addCode(g.call(l+"_load",g.getLocal("scalar"),g.getLocal("scalarLen"),U),g.call(l+"_toMontgomery",U,U),g.call(l+"_mul",g.getLocal("x"),U,g.getLocal("r")))}function z(){let E=t.addFunction(l+"_isOne");E.addParam("x","i32"),E.setReturnType("i32");let g=E.getCodeBuilder();E.addCode(g.ret(g.call(s+"_eq",g.getLocal("x"),g.i32_const(p))))}return t.exportFunction(s+"_copy",l+"_copy"),t.exportFunction(s+"_zero",l+"_zero"),t.exportFunction(s+"_isZero",l+"_isZero"),t.exportFunction(s+"_eq",l+"_eq"),z(),W(),F(),u(),Q(),H(),q(),y(),I(),N(),L(),$(),nt(),O(),C(),r(),p1(t,l),As(t,l+"_batchToMontgomery",l+"_toMontgomery",b,b),As(t,l+"_batchFromMontgomery",l+"_fromMontgomery",b,b),As(t,l+"_batchNeg",l+"_neg",b,b),Es(t,l+"_batchAdd",l+"_add",b,b),Es(t,l+"_batchSub",l+"_sub",b,b),Es(t,l+"_batchMul",l+"_mul",b,b),t.exportFunction(l+"_add"),t.exportFunction(l+"_sub"),t.exportFunction(l+"_neg"),t.exportFunction(l+"_isNegative"),t.exportFunction(l+"_isOne"),t.exportFunction(l+"_sign"),t.exportFunction(l+"_mReduct"),t.exportFunction(l+"_mul"),t.exportFunction(l+"_square"),t.exportFunction(l+"_squareOld"),t.exportFunction(l+"_fromMontgomery"),t.exportFunction(l+"_toMontgomery"),t.exportFunction(l+"_inverse"),t.exportFunction(l+"_one"),t.exportFunction(l+"_load"),t.exportFunction(l+"_timesScalar"),L1(t,l+"_exp",b,l+"_mul",l+"_square",s+"_copy",l+"_one"),t.exportFunction(l+"_exp"),t.exportFunction(l+"_batchInverse"),h2(e)&&(A(),i(),t.exportFunction(l+"_sqrt"),t.exportFunction(l+"_isSquare")),t.exportFunction(l+"_batchToMontgomery"),t.exportFunction(l+"_batchFromMontgomery"),l},w1=sl,{bitLength:F1}=Vn,W2=function(t,n,a,o,e){let h=BigInt(n),d=Math.floor((F1(h-1n)-1)/64)+1,b=d*8,l=a||"f1";if(t.modules[l])return l;t.modules[l]={n64:d};let s=e||"int",m=w1(t,h,o,s),B=t.modules[m].pR2,p=t.modules[m].pq,v=t.modules[m].pePlusOne;function M(){let k=t.alloc(b),O=t.addFunction(l+"_mul");O.addParam("x","i32"),O.addParam("y","i32"),O.addParam("r","i32");let W=O.getCodeBuilder();O.addCode(W.call(m+"_mul",W.getLocal("x"),W.getLocal("y"),W.i32_const(k))),O.addCode(W.call(m+"_mul",W.i32_const(k),W.i32_const(B),W.getLocal("r")))}function x(){let k=t.addFunction(l+"_square");k.addParam("x","i32"),k.addParam("r","i32");let O=k.getCodeBuilder();k.addCode(O.call(l+"_mul",O.getLocal("x"),O.getLocal("x"),O.getLocal("r")))}function S(){let k=t.addFunction(l+"_inverse");k.addParam("x","i32"),k.addParam("r","i32");let O=k.getCodeBuilder();k.addCode(O.call(s+"_inverseMod",O.getLocal("x"),O.i32_const(p),O.getLocal("r")))}function w(){let k=t.addFunction(l+"_isNegative");k.addParam("x","i32"),k.setReturnType("i32");let O=k.getCodeBuilder();k.addCode(O.call(s+"_gte",O.getLocal("x"),O.i32_const(v)))}return M(),x(),S(),w(),t.exportFunction(m+"_add",l+"_add"),t.exportFunction(m+"_sub",l+"_sub"),t.exportFunction(m+"_neg",l+"_neg"),t.exportFunction(l+"_mul"),t.exportFunction(l+"_square"),t.exportFunction(l+"_inverse"),t.exportFunction(l+"_isNegative"),t.exportFunction(m+"_copy",l+"_copy"),t.exportFunction(m+"_zero",l+"_zero"),t.exportFunction(m+"_one",l+"_one"),t.exportFunction(m+"_isZero",l+"_isZero"),t.exportFunction(m+"_eq",l+"_eq"),l},C1=ol,B1=il,Ss=Na,Q2=function(t,n,a,o){if(t.modules[a])return a;let e=t.modules[o].n64*8,h=t.modules[o].q;t.modules[a]={n64:t.modules[o].n64*2};function d(){let q=t.addFunction(a+"_add");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("y"),J=y.i32_add(y.getLocal("y"),y.i32_const(e)),j=y.getLocal("r"),ot=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_add",I,nt,j),y.call(o+"_add",N,J,ot))}function b(){let q=t.addFunction(a+"_timesScalar");q.addParam("x","i32"),q.addParam("scalar","i32"),q.addParam("scalarLen","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_timesScalar",I,y.getLocal("scalar"),y.getLocal("scalarLen"),nt),y.call(o+"_timesScalar",N,y.getLocal("scalar"),y.getLocal("scalarLen"),J))}function l(){let q=t.addFunction(a+"_sub");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("y"),J=y.i32_add(y.getLocal("y"),y.i32_const(e)),j=y.getLocal("r"),ot=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_sub",I,nt,j),y.call(o+"_sub",N,J,ot))}function s(){let q=t.addFunction(a+"_neg");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_neg",I,nt),y.call(o+"_neg",N,J))}function m(){let q=t.addFunction(a+"_conjugate");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_copy",I,nt),y.call(o+"_neg",N,J))}function B(){let q=t.addFunction(a+"_isNegative");q.addParam("x","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.if(y.call(o+"_isZero",N),y.ret(y.call(o+"_isNegative",I))),y.ret(y.call(o+"_isNegative",N)))}function p(){let q=t.addFunction(a+"_mul");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("y"),J=y.i32_add(y.getLocal("y"),y.i32_const(e)),j=y.getLocal("r"),ot=y.i32_add(y.getLocal("r"),y.i32_const(e)),V=y.i32_const(t.alloc(e)),at=y.i32_const(t.alloc(e)),Lt=y.i32_const(t.alloc(e)),rt=y.i32_const(t.alloc(e));q.addCode(y.call(o+"_mul",I,nt,V),y.call(o+"_mul",N,J,at),y.call(o+"_add",I,N,Lt),y.call(o+"_add",nt,J,rt),y.call(o+"_mul",Lt,rt,Lt),y.call(n,at,j),y.call(o+"_add",V,j,j),y.call(o+"_add",V,at,ot),y.call(o+"_sub",Lt,ot,ot))}function v(){let q=t.addFunction(a+"_mul1");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("y"),J=y.getLocal("r"),j=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_mul",I,nt,J),y.call(o+"_mul",N,nt,j))}function M(){let q=t.addFunction(a+"_square");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e)),j=y.i32_const(t.alloc(e)),ot=y.i32_const(t.alloc(e)),V=y.i32_const(t.alloc(e)),at=y.i32_const(t.alloc(e));q.addCode(y.call(o+"_mul",I,N,j),y.call(o+"_add",I,N,ot),y.call(n,N,V),y.call(o+"_add",I,V,V),y.call(n,j,at),y.call(o+"_add",at,j,at),y.call(o+"_mul",ot,V,nt),y.call(o+"_sub",nt,at,nt),y.call(o+"_add",j,j,J))}function x(){let q=t.addFunction(a+"_toMontgomery");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_toMontgomery",I,nt),y.call(o+"_toMontgomery",N,J))}function S(){let q=t.addFunction(a+"_fromMontgomery");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_fromMontgomery",I,nt),y.call(o+"_fromMontgomery",N,J))}function w(){let q=t.addFunction(a+"_copy");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_copy",I,nt),y.call(o+"_copy",N,J))}function k(){let q=t.addFunction(a+"_zero");q.addParam("x","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.call(o+"_zero",I),y.call(o+"_zero",N))}function O(){let q=t.addFunction(a+"_one");q.addParam("x","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.call(o+"_one",I),y.call(o+"_zero",N))}function W(){let q=t.addFunction(a+"_eq");q.addParam("x","i32"),q.addParam("y","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("y"),J=y.i32_add(y.getLocal("y"),y.i32_const(e));q.addCode(y.i32_and(y.call(o+"_eq",I,nt),y.call(o+"_eq",N,J)))}function F(){let q=t.addFunction(a+"_isZero");q.addParam("x","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.i32_and(y.call(o+"_isZero",I),y.call(o+"_isZero",N)))}function u(){let q=t.addFunction(a+"_inverse");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e)),j=y.i32_const(t.alloc(e)),ot=y.i32_const(t.alloc(e)),V=y.i32_const(t.alloc(e)),at=y.i32_const(t.alloc(e));q.addCode(y.call(o+"_square",I,j),y.call(o+"_square",N,ot),y.call(n,ot,V),y.call(o+"_sub",j,V,V),y.call(o+"_inverse",V,at),y.call(o+"_mul",I,at,nt),y.call(o+"_mul",N,at,J),y.call(o+"_neg",J,J))}function L(){let q=t.addFunction(a+"_sign");q.addParam("x","i32"),q.addLocal("s","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.setLocal("s",y.call(o+"_sign",N)),y.if(y.getLocal("s"),y.ret(y.getLocal("s"))),y.ret(y.call(o+"_sign",I)))}function $(){let q=t.addFunction(a+"_isOne");q.addParam("x","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.ret(y.i32_and(y.call(o+"_isOne",I),y.call(o+"_isZero",N))))}function Q(){let q=t.addFunction(a+"_sqrt");q.addParam("a","i32"),q.addParam("pr","i32");let y=q.getCodeBuilder(),I=y.i32_const(t.alloc(Ss.bigInt2BytesLE((BigInt(h||0)-3n)/4n,e))),N=y.i32_const(t.alloc(Ss.bigInt2BytesLE((BigInt(h||0)-1n)/2n,e))),nt=y.getLocal("a"),J=y.i32_const(t.alloc(e*2)),j=y.i32_const(t.alloc(e*2)),ot=y.i32_const(t.alloc(e*2)),V=t.alloc(e*2),at=y.i32_const(V),Lt=y.i32_const(V),rt=y.i32_const(V+e),ht=y.i32_const(t.alloc(e*2)),A=y.i32_const(t.alloc(e*2));q.addCode(y.call(a+"_one",at),y.call(a+"_neg",at,at),y.call(a+"_exp",nt,I,y.i32_const(e),J),y.call(a+"_square",J,j),y.call(a+"_mul",nt,j,j),y.call(a+"_conjugate",j,ot),y.call(a+"_mul",ot,j,ot),y.if(y.call(a+"_eq",ot,at),y.unreachable()),y.call(a+"_mul",J,nt,ht),y.if(y.call(a+"_eq",j,at),[...y.call(o+"_zero",Lt),...y.call(o+"_one",rt),...y.call(a+"_mul",at,ht,y.getLocal("pr"))],[...y.call(a+"_one",A),...y.call(a+"_add",A,j,A),...y.call(a+"_exp",A,N,y.i32_const(e),A),...y.call(a+"_mul",A,ht,y.getLocal("pr"))]))}function H(){let q=t.addFunction(a+"_isSquare");q.addParam("a","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.i32_const(t.alloc(Ss.bigInt2BytesLE((BigInt(h||0)-3n)/4n,e))),N=y.getLocal("a"),nt=y.i32_const(t.alloc(e*2)),J=y.i32_const(t.alloc(e*2)),j=y.i32_const(t.alloc(e*2)),ot=t.alloc(e*2),V=y.i32_const(ot);q.addCode(y.call(a+"_one",V),y.call(a+"_neg",V,V),y.call(a+"_exp",N,I,y.i32_const(e),nt),y.call(a+"_square",nt,J),y.call(a+"_mul",N,J,J),y.call(a+"_conjugate",J,j),y.call(a+"_mul",j,J,j),y.if(y.call(a+"_eq",j,V),y.ret(y.i32_const(0))),y.ret(y.i32_const(1)))}return F(),$(),k(),O(),w(),p(),v(),M(),d(),l(),s(),m(),x(),S(),W(),u(),b(),L(),B(),t.exportFunction(a+"_isZero"),t.exportFunction(a+"_isOne"),t.exportFunction(a+"_zero"),t.exportFunction(a+"_one"),t.exportFunction(a+"_copy"),t.exportFunction(a+"_mul"),t.exportFunction(a+"_mul1"),t.exportFunction(a+"_square"),t.exportFunction(a+"_add"),t.exportFunction(a+"_sub"),t.exportFunction(a+"_neg"),t.exportFunction(a+"_sign"),t.exportFunction(a+"_conjugate"),t.exportFunction(a+"_fromMontgomery"),t.exportFunction(a+"_toMontgomery"),t.exportFunction(a+"_eq"),t.exportFunction(a+"_inverse"),B1(t,a),C1(t,a+"_exp",e*2,a+"_mul",a+"_square",a+"_copy",a+"_one"),Q(),H(),t.exportFunction(a+"_exp"),t.exportFunction(a+"_timesScalar"),t.exportFunction(a+"_batchInverse"),t.exportFunction(a+"_sqrt"),t.exportFunction(a+"_isSquare"),t.exportFunction(a+"_isNegative"),a},x1=ol,A1=il,X2=function(t,n,a,o){if(t.modules[a])return a;let e=t.modules[o].n64*8;t.modules[a]={n64:t.modules[o].n64*3};function h(){let u=t.addFunction(a+"_add");u.addParam("x","i32"),u.addParam("y","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("y"),y=L.i32_add(L.getLocal("y"),L.i32_const(e)),I=L.i32_add(L.getLocal("y"),L.i32_const(2*e)),N=L.getLocal("r"),nt=L.i32_add(L.getLocal("r"),L.i32_const(e)),J=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_add",$,q,N),L.call(o+"_add",Q,y,nt),L.call(o+"_add",H,I,J))}function d(){let u=t.addFunction(a+"_timesScalar");u.addParam("x","i32"),u.addParam("scalar","i32"),u.addParam("scalarLen","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_timesScalar",$,L.getLocal("scalar"),L.getLocal("scalarLen"),q),L.call(o+"_timesScalar",Q,L.getLocal("scalar"),L.getLocal("scalarLen"),y),L.call(o+"_timesScalar",H,L.getLocal("scalar"),L.getLocal("scalarLen"),I))}function b(){let u=t.addFunction(a+"_sub");u.addParam("x","i32"),u.addParam("y","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("y"),y=L.i32_add(L.getLocal("y"),L.i32_const(e)),I=L.i32_add(L.getLocal("y"),L.i32_const(2*e)),N=L.getLocal("r"),nt=L.i32_add(L.getLocal("r"),L.i32_const(e)),J=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_sub",$,q,N),L.call(o+"_sub",Q,y,nt),L.call(o+"_sub",H,I,J))}function l(){let u=t.addFunction(a+"_neg");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_neg",$,q),L.call(o+"_neg",Q,y),L.call(o+"_neg",H,I))}function s(){let u=t.addFunction(a+"_isNegative");u.addParam("x","i32"),u.setReturnType("i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e));u.addCode(L.if(L.call(o+"_isZero",H),L.if(L.call(o+"_isZero",Q),L.ret(L.call(o+"_isNegative",$)),L.ret(L.call(o+"_isNegative",Q)))),L.ret(L.call(o+"_isNegative",H)))}function m(){let u=t.addFunction(a+"_mul");u.addParam("x","i32"),u.addParam("y","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("y"),y=L.i32_add(L.getLocal("y"),L.i32_const(e)),I=L.i32_add(L.getLocal("y"),L.i32_const(2*e)),N=L.getLocal("r"),nt=L.i32_add(L.getLocal("r"),L.i32_const(e)),J=L.i32_add(L.getLocal("r"),L.i32_const(2*e)),j=L.i32_const(t.alloc(e)),ot=L.i32_const(t.alloc(e)),V=L.i32_const(t.alloc(e)),at=L.i32_const(t.alloc(e)),Lt=L.i32_const(t.alloc(e)),rt=L.i32_const(t.alloc(e)),ht=L.i32_const(t.alloc(e)),A=L.i32_const(t.alloc(e)),i=L.i32_const(t.alloc(e)),C=L.i32_const(t.alloc(e)),r=L.i32_const(t.alloc(e)),z=L.i32_const(t.alloc(e)),E=L.i32_const(t.alloc(e));u.addCode(L.call(o+"_mul",$,q,j),L.call(o+"_mul",Q,y,ot),L.call(o+"_mul",H,I,V),L.call(o+"_add",$,Q,at),L.call(o+"_add",q,y,Lt),L.call(o+"_add",$,H,rt),L.call(o+"_add",q,I,ht),L.call(o+"_add",Q,H,A),L.call(o+"_add",y,I,i),L.call(o+"_add",j,ot,C),L.call(o+"_add",j,V,r),L.call(o+"_add",ot,V,z),L.call(o+"_mul",A,i,N),L.call(o+"_sub",N,z,N),L.call(n,N,N),L.call(o+"_add",j,N,N),L.call(o+"_mul",at,Lt,nt),L.call(o+"_sub",nt,C,nt),L.call(n,V,E),L.call(o+"_add",nt,E,nt),L.call(o+"_mul",rt,ht,J),L.call(o+"_sub",J,r,J),L.call(o+"_add",J,ot,J))}function B(){let u=t.addFunction(a+"_square");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e)),N=L.i32_const(t.alloc(e)),nt=L.i32_const(t.alloc(e)),J=L.i32_const(t.alloc(e)),j=L.i32_const(t.alloc(e)),ot=L.i32_const(t.alloc(e)),V=L.i32_const(t.alloc(e)),at=L.i32_const(t.alloc(e));u.addCode(L.call(o+"_square",$,N),L.call(o+"_mul",$,Q,nt),L.call(o+"_add",nt,nt,J),L.call(o+"_sub",$,Q,j),L.call(o+"_add",j,H,j),L.call(o+"_square",j,j),L.call(o+"_mul",Q,H,ot),L.call(o+"_add",ot,ot,V),L.call(o+"_square",H,at),L.call(n,V,q),L.call(o+"_add",N,q,q),L.call(n,at,y),L.call(o+"_add",J,y,y),L.call(o+"_add",N,at,I),L.call(o+"_sub",V,I,I),L.call(o+"_add",j,I,I),L.call(o+"_add",J,I,I))}function p(){let u=t.addFunction(a+"_toMontgomery");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_toMontgomery",$,q),L.call(o+"_toMontgomery",Q,y),L.call(o+"_toMontgomery",H,I))}function v(){let u=t.addFunction(a+"_fromMontgomery");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_fromMontgomery",$,q),L.call(o+"_fromMontgomery",Q,y),L.call(o+"_fromMontgomery",H,I))}function M(){let u=t.addFunction(a+"_copy");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_copy",$,q),L.call(o+"_copy",Q,y),L.call(o+"_copy",H,I))}function x(){let u=t.addFunction(a+"_zero");u.addParam("x","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e));u.addCode(L.call(o+"_zero",$),L.call(o+"_zero",Q),L.call(o+"_zero",H))}function S(){let u=t.addFunction(a+"_one");u.addParam("x","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e));u.addCode(L.call(o+"_one",$),L.call(o+"_zero",Q),L.call(o+"_zero",H))}function w(){let u=t.addFunction(a+"_eq");u.addParam("x","i32"),u.addParam("y","i32"),u.setReturnType("i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("y"),y=L.i32_add(L.getLocal("y"),L.i32_const(e)),I=L.i32_add(L.getLocal("y"),L.i32_const(2*e));u.addCode(L.i32_and(L.i32_and(L.call(o+"_eq",$,q),L.call(o+"_eq",Q,y)),L.call(o+"_eq",H,I)))}function k(){let u=t.addFunction(a+"_isZero");u.addParam("x","i32"),u.setReturnType("i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e));u.addCode(L.i32_and(L.i32_and(L.call(o+"_isZero",$),L.call(o+"_isZero",Q)),L.call(o+"_isZero",H)))}function O(){let u=t.addFunction(a+"_inverse");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e)),N=L.i32_const(t.alloc(e)),nt=L.i32_const(t.alloc(e)),J=L.i32_const(t.alloc(e)),j=L.i32_const(t.alloc(e)),ot=L.i32_const(t.alloc(e)),V=L.i32_const(t.alloc(e)),at=L.i32_const(t.alloc(e)),Lt=L.i32_const(t.alloc(e)),rt=L.i32_const(t.alloc(e)),ht=L.i32_const(t.alloc(e)),A=L.i32_const(t.alloc(e));u.addCode(L.call(o+"_square",$,N),L.call(o+"_square",Q,nt),L.call(o+"_square",H,J),L.call(o+"_mul",$,Q,j),L.call(o+"_mul",$,H,ot),L.call(o+"_mul",Q,H,V),L.call(n,V,at),L.call(o+"_sub",N,at,at),L.call(n,J,Lt),L.call(o+"_sub",Lt,j,Lt),L.call(o+"_sub",nt,ot,rt),L.call(o+"_mul",H,Lt,ht),L.call(o+"_mul",Q,rt,A),L.call(o+"_add",ht,A,ht),L.call(n,ht,ht),L.call(o+"_mul",$,at,A),L.call(o+"_add",A,ht,ht),L.call(o+"_inverse",ht,ht),L.call(o+"_mul",ht,at,q),L.call(o+"_mul",ht,Lt,y),L.call(o+"_mul",ht,rt,I))}function W(){let u=t.addFunction(a+"_sign");u.addParam("x","i32"),u.addLocal("s","i32"),u.setReturnType("i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e));u.addCode(L.setLocal("s",L.call(o+"_sign",H)),L.if(L.getLocal("s"),L.ret(L.getLocal("s"))),L.setLocal("s",L.call(o+"_sign",Q)),L.if(L.getLocal("s"),L.ret(L.getLocal("s"))),L.ret(L.call(o+"_sign",$)))}function F(){let u=t.addFunction(a+"_isOne");u.addParam("x","i32"),u.setReturnType("i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(e*2));u.addCode(L.ret(L.i32_and(L.i32_and(L.call(o+"_isOne",$),L.call(o+"_isZero",Q)),L.call(o+"_isZero",H))))}return k(),F(),x(),S(),M(),m(),B(),h(),b(),l(),W(),p(),v(),w(),O(),d(),s(),t.exportFunction(a+"_isZero"),t.exportFunction(a+"_isOne"),t.exportFunction(a+"_zero"),t.exportFunction(a+"_one"),t.exportFunction(a+"_copy"),t.exportFunction(a+"_mul"),t.exportFunction(a+"_square"),t.exportFunction(a+"_add"),t.exportFunction(a+"_sub"),t.exportFunction(a+"_neg"),t.exportFunction(a+"_sign"),t.exportFunction(a+"_fromMontgomery"),t.exportFunction(a+"_toMontgomery"),t.exportFunction(a+"_eq"),t.exportFunction(a+"_inverse"),A1(t,a),x1(t,a+"_exp",e*3,a+"_mul",a+"_square",a+"_copy",a+"_one"),t.exportFunction(a+"_exp"),t.exportFunction(a+"_timesScalar"),t.exportFunction(a+"_batchInverse"),t.exportFunction(a+"_isNegative"),a},E1=function(t,n,a,o,e,h,d,b){let l=t.addFunction(n);l.addParam("base","i32"),l.addParam("scalar","i32"),l.addParam("scalarLength","i32"),l.addParam("r","i32"),l.addLocal("old0","i32"),l.addLocal("nbits","i32"),l.addLocal("i","i32"),l.addLocal("last","i32"),l.addLocal("cur","i32"),l.addLocal("carry","i32"),l.addLocal("p","i32");let s=l.getCodeBuilder(),m=s.i32_const(t.alloc(a));function B(v){return s.i32_and(s.i32_shr_u(s.i32_load(s.i32_add(s.getLocal("scalar"),s.i32_and(s.i32_shr_u(v,s.i32_const(3)),s.i32_const(4294967292)))),s.i32_and(v,s.i32_const(31))),s.i32_const(1))}function p(v){return[...s.i32_store8(s.getLocal("p"),s.i32_const(v)),...s.setLocal("p",s.i32_add(s.getLocal("p"),s.i32_const(1)))]}l.addCode(s.if(s.i32_eqz(s.getLocal("scalarLength")),[...s.call(b,s.getLocal("r")),...s.ret([])]),s.setLocal("nbits",s.i32_shl(s.getLocal("scalarLength"),s.i32_const(3))),s.setLocal("old0",s.i32_load(s.i32_const(0))),s.setLocal("p",s.getLocal("old0")),s.i32_store(s.i32_const(0),s.i32_and(s.i32_add(s.i32_add(s.getLocal("old0"),s.i32_const(32)),s.getLocal("nbits")),s.i32_const(4294967288))),s.setLocal("i",s.i32_const(1)),s.setLocal("last",B(s.i32_const(0))),s.setLocal("carry",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("nbits"))),s.setLocal("cur",B(s.getLocal("i"))),s.if(s.getLocal("last"),s.if(s.getLocal("cur"),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...p(1)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...p(255)]),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...p(255)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(0)),...p(1)])),s.if(s.getLocal("cur"),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...p(0)],[...s.setLocal("last",s.i32_const(1)),...s.setLocal("carry",s.i32_const(0)),...p(0)]),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(1)),...s.setLocal("carry",s.i32_const(0)),...p(0)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(0)),...p(0)]))),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0))),s.if(s.getLocal("last"),s.if(s.getLocal("carry"),[...p(255),...p(0),...p(1)],[...p(1)]),s.if(s.getLocal("carry"),[...p(0),...p(1)])),s.setLocal("p",s.i32_sub(s.getLocal("p"),s.i32_const(1))),s.call(d,s.getLocal("base"),m),s.call(b,s.getLocal("r")),s.block(s.loop(s.call(e,s.getLocal("r"),s.getLocal("r")),s.setLocal("cur",s.i32_load8_u(s.getLocal("p"))),s.if(s.getLocal("cur"),s.if(s.i32_eq(s.getLocal("cur"),s.i32_const(1)),s.call(o,s.getLocal("r"),m,s.getLocal("r")),s.call(h,s.getLocal("r"),m,s.getLocal("r")))),s.br_if(1,s.i32_eq(s.getLocal("old0"),s.getLocal("p"))),s.setLocal("p",s.i32_sub(s.getLocal("p"),s.i32_const(1))),s.br(0))),s.i32_store(s.i32_const(0),s.getLocal("old0")))},v1=function(t,n,a,o,e){let d=t.modules[n].n64*8;function b(){let B=t.addFunction(a+"_getChunk");B.addParam("pScalar","i32"),B.addParam("scalarSize","i32"),B.addParam("startBit","i32"),B.addParam("chunkSize","i32"),B.addLocal("bitsToEnd","i32"),B.addLocal("mask","i32"),B.setReturnType("i32");let p=B.getCodeBuilder();B.addCode(p.setLocal("bitsToEnd",p.i32_sub(p.i32_mul(p.getLocal("scalarSize"),p.i32_const(8)),p.getLocal("startBit"))),p.if(p.i32_gt_s(p.getLocal("chunkSize"),p.getLocal("bitsToEnd")),p.setLocal("mask",p.i32_sub(p.i32_shl(p.i32_const(1),p.getLocal("bitsToEnd")),p.i32_const(1))),p.setLocal("mask",p.i32_sub(p.i32_shl(p.i32_const(1),p.getLocal("chunkSize")),p.i32_const(1)))),p.i32_and(p.i32_shr_u(p.i32_load(p.i32_add(p.getLocal("pScalar"),p.i32_shr_u(p.getLocal("startBit"),p.i32_const(3))),0,0),p.i32_and(p.getLocal("startBit"),p.i32_const(7))),p.getLocal("mask")))}function l(){let B=t.addFunction(a+"_chunk");B.addParam("pBases","i32"),B.addParam("pScalars","i32"),B.addParam("scalarSize","i32"),B.addParam("n","i32"),B.addParam("startBit","i32"),B.addParam("chunkSize","i32"),B.addParam("pr","i32"),B.addLocal("nChunks","i32"),B.addLocal("itScalar","i32"),B.addLocal("endScalar","i32"),B.addLocal("itBase","i32"),B.addLocal("i","i32"),B.addLocal("j","i32"),B.addLocal("nTable","i32"),B.addLocal("pTable","i32"),B.addLocal("idx","i32"),B.addLocal("pIdxTable","i32");let p=B.getCodeBuilder();B.addCode(p.if(p.i32_eqz(p.getLocal("n")),[...p.call(n+"_zero",p.getLocal("pr")),...p.ret([])]),p.setLocal("nTable",p.i32_shl(p.i32_const(1),p.getLocal("chunkSize"))),p.setLocal("pTable",p.i32_load(p.i32_const(0))),p.i32_store(p.i32_const(0),p.i32_add(p.getLocal("pTable"),p.i32_mul(p.getLocal("nTable"),p.i32_const(d)))),p.setLocal("j",p.i32_const(0)),p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("j"),p.getLocal("nTable"))),p.call(n+"_zero",p.i32_add(p.getLocal("pTable"),p.i32_mul(p.getLocal("j"),p.i32_const(d)))),p.setLocal("j",p.i32_add(p.getLocal("j"),p.i32_const(1))),p.br(0))),p.setLocal("itBase",p.getLocal("pBases")),p.setLocal("itScalar",p.getLocal("pScalars")),p.setLocal("endScalar",p.i32_add(p.getLocal("pScalars"),p.i32_mul(p.getLocal("n"),p.getLocal("scalarSize")))),p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("itScalar"),p.getLocal("endScalar"))),p.setLocal("idx",p.call(a+"_getChunk",p.getLocal("itScalar"),p.getLocal("scalarSize"),p.getLocal("startBit"),p.getLocal("chunkSize"))),p.if(p.getLocal("idx"),[...p.setLocal("pIdxTable",p.i32_add(p.getLocal("pTable"),p.i32_mul(p.i32_sub(p.getLocal("idx"),p.i32_const(1)),p.i32_const(d)))),...p.call(o,p.getLocal("pIdxTable"),p.getLocal("itBase"),p.getLocal("pIdxTable"))]),p.setLocal("itScalar",p.i32_add(p.getLocal("itScalar"),p.getLocal("scalarSize"))),p.setLocal("itBase",p.i32_add(p.getLocal("itBase"),p.i32_const(e))),p.br(0))),p.call(a+"_reduceTable",p.getLocal("pTable"),p.getLocal("chunkSize")),p.call(n+"_copy",p.getLocal("pTable"),p.getLocal("pr")),p.i32_store(p.i32_const(0),p.getLocal("pTable")))}function s(){let B=t.addFunction(a);B.addParam("pBases","i32"),B.addParam("pScalars","i32"),B.addParam("scalarSize","i32"),B.addParam("n","i32"),B.addParam("pr","i32"),B.addLocal("chunkSize","i32"),B.addLocal("nChunks","i32"),B.addLocal("itScalar","i32"),B.addLocal("endScalar","i32"),B.addLocal("itBase","i32"),B.addLocal("itBit","i32"),B.addLocal("i","i32"),B.addLocal("j","i32"),B.addLocal("nTable","i32"),B.addLocal("pTable","i32"),B.addLocal("idx","i32"),B.addLocal("pIdxTable","i32");let p=B.getCodeBuilder(),v=p.i32_const(t.alloc(d)),M=t.alloc([17,17,17,17,17,17,17,17,17,17,16,16,15,14,13,13,12,11,10,9,8,7,7,6,5,4,3,2,1,1,1,1]);B.addCode(p.call(n+"_zero",p.getLocal("pr")),p.if(p.i32_eqz(p.getLocal("n")),p.ret([])),p.setLocal("chunkSize",p.i32_load8_u(p.i32_clz(p.getLocal("n")),M)),p.setLocal("nChunks",p.i32_add(p.i32_div_u(p.i32_sub(p.i32_shl(p.getLocal("scalarSize"),p.i32_const(3)),p.i32_const(1)),p.getLocal("chunkSize")),p.i32_const(1))),p.setLocal("itBit",p.i32_mul(p.i32_sub(p.getLocal("nChunks"),p.i32_const(1)),p.getLocal("chunkSize"))),p.block(p.loop(p.br_if(1,p.i32_lt_s(p.getLocal("itBit"),p.i32_const(0))),p.if(p.i32_eqz(p.call(n+"_isZero",p.getLocal("pr"))),[...p.setLocal("j",p.i32_const(0)),...p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("j"),p.getLocal("chunkSize"))),p.call(n+"_double",p.getLocal("pr"),p.getLocal("pr")),p.setLocal("j",p.i32_add(p.getLocal("j"),p.i32_const(1))),p.br(0)))]),p.call(a+"_chunk",p.getLocal("pBases"),p.getLocal("pScalars"),p.getLocal("scalarSize"),p.getLocal("n"),p.getLocal("itBit"),p.getLocal("chunkSize"),v),p.call(n+"_add",p.getLocal("pr"),v,p.getLocal("pr")),p.setLocal("itBit",p.i32_sub(p.getLocal("itBit"),p.getLocal("chunkSize"))),p.br(0))))}function m(){let B=t.addFunction(a+"_reduceTable");B.addParam("pTable","i32"),B.addParam("p","i32"),B.addLocal("half","i32"),B.addLocal("it1","i32"),B.addLocal("it2","i32"),B.addLocal("pAcc","i32");let p=B.getCodeBuilder();B.addCode(p.if(p.i32_eq(p.getLocal("p"),p.i32_const(1)),p.ret([])),p.setLocal("half",p.i32_shl(p.i32_const(1),p.i32_sub(p.getLocal("p"),p.i32_const(1)))),p.setLocal("it1",p.getLocal("pTable")),p.setLocal("it2",p.i32_add(p.getLocal("pTable"),p.i32_mul(p.getLocal("half"),p.i32_const(d)))),p.setLocal("pAcc",p.i32_sub(p.getLocal("it2"),p.i32_const(d))),p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("it1"),p.getLocal("pAcc"))),p.call(n+"_add",p.getLocal("it1"),p.getLocal("it2"),p.getLocal("it1")),p.call(n+"_add",p.getLocal("pAcc"),p.getLocal("it2"),p.getLocal("pAcc")),p.setLocal("it1",p.i32_add(p.getLocal("it1"),p.i32_const(d))),p.setLocal("it2",p.i32_add(p.getLocal("it2"),p.i32_const(d))),p.br(0))),p.call(a+"_reduceTable",p.getLocal("pTable"),p.i32_sub(p.getLocal("p"),p.i32_const(1))),p.setLocal("p",p.i32_sub(p.getLocal("p"),p.i32_const(1))),p.block(p.loop(p.br_if(1,p.i32_eqz(p.getLocal("p"))),p.call(n+"_double",p.getLocal("pAcc"),p.getLocal("pAcc")),p.setLocal("p",p.i32_sub(p.getLocal("p"),p.i32_const(1))),p.br(0))),p.call(n+"_add",p.getLocal("pTable"),p.getLocal("pAcc"),p.getLocal("pTable")))}b(),m(),l(),s(),t.exportFunction(a),t.exportFunction(a+"_chunk")},f2=E1,ei=U2,g2=v1,H2=function(t,n,a,o){let e=t.modules[a].n64,h=e*8;if(t.modules[n])return n;t.modules[n]={n64:e*3};function d(){let A=t.addFunction(n+"_isZero");A.addParam("p1","i32"),A.setReturnType("i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_isZero",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))))}function b(){let A=t.addFunction(n+"_isZeroAffine");A.addParam("p1","i32"),A.setReturnType("i32");let i=A.getCodeBuilder();A.addCode(i.i32_and(i.call(a+"_isZero",i.getLocal("p1")),i.call(a+"_isZero",i.i32_add(i.getLocal("p1"),i.i32_const(h)))))}function l(){let A=t.addFunction(n+"_copy");A.addParam("ps","i32"),A.addParam("pd","i32");let i=A.getCodeBuilder();for(let C=0;C<e*3;C++)A.addCode(i.i64_store(i.getLocal("pd"),C*8,i.i64_load(i.getLocal("ps"),C*8)))}function s(){let A=t.addFunction(n+"_copyAffine");A.addParam("ps","i32"),A.addParam("pd","i32");let i=A.getCodeBuilder();for(let C=0;C<e*2;C++)A.addCode(i.i64_store(i.getLocal("pd"),C*8,i.i64_load(i.getLocal("ps"),C*8)))}function m(){let A=t.addFunction(n+"_zero");A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_zero",i.getLocal("pr"))),A.addCode(i.call(a+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(h)))),A.addCode(i.call(a+"_zero",i.i32_add(i.getLocal("pr"),i.i32_const(h*2))))}function B(){let A=t.addFunction(n+"_zeroAffine");A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_zero",i.getLocal("pr"))),A.addCode(i.call(a+"_zero",i.i32_add(i.getLocal("pr"),i.i32_const(h))))}function p(){let A=t.addFunction(n+"_eq");A.addParam("p1","i32"),A.addParam("p2","i32"),A.setReturnType("i32"),A.addLocal("z1","i32"),A.addLocal("z2","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h));A.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));let z=i.getLocal("z1"),E=i.getLocal("p2"),g=i.i32_add(i.getLocal("p2"),i.i32_const(h));A.addCode(i.setLocal("z2",i.i32_add(i.getLocal("p2"),i.i32_const(h*2))));let U=i.getLocal("z2"),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),yt=i.i32_const(t.alloc(h)),ut=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),i.ret(i.call(n+"_isZero",i.getLocal("p2")))),i.if(i.call(n+"_isZero",i.getLocal("p2")),i.ret(i.i32_const(0))),i.if(i.call(a+"_isOne",z),i.ret(i.call(n+"_eqMixed",i.getLocal("p2"),i.getLocal("p1")))),i.if(i.call(a+"_isOne",U),i.ret(i.call(n+"_eqMixed",i.getLocal("p1"),i.getLocal("p2")))),i.call(a+"_square",z,st),i.call(a+"_square",U,et),i.call(a+"_mul",C,et,ct),i.call(a+"_mul",E,st,ft),i.call(a+"_mul",z,st,_t),i.call(a+"_mul",U,et,gt),i.call(a+"_mul",r,gt,yt),i.call(a+"_mul",g,_t,ut),i.if(i.call(a+"_eq",ct,ft),i.if(i.call(a+"_eq",yt,ut),i.ret(i.i32_const(1)))),i.ret(i.i32_const(0)))}function v(){let A=t.addFunction(n+"_eqMixed");A.addParam("p1","i32"),A.addParam("p2","i32"),A.setReturnType("i32"),A.addLocal("z1","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h));A.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));let z=i.getLocal("z1"),E=i.getLocal("p2"),g=i.i32_add(i.getLocal("p2"),i.i32_const(h)),U=i.i32_const(t.alloc(h)),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),i.ret(i.call(n+"_isZeroAffine",i.getLocal("p2")))),i.if(i.call(n+"_isZeroAffine",i.getLocal("p2")),i.ret(i.i32_const(0))),i.if(i.call(a+"_isOne",z),i.ret(i.call(n+"_eqAffine",i.getLocal("p1"),i.getLocal("p2")))),i.call(a+"_square",z,U),i.call(a+"_mul",E,U,st),i.call(a+"_mul",z,U,et),i.call(a+"_mul",g,et,ct),i.if(i.call(a+"_eq",C,st),i.if(i.call(a+"_eq",r,ct),i.ret(i.i32_const(1)))),i.ret(i.i32_const(0)))}function M(){let A=t.addFunction(n+"_double");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.i32_add(i.getLocal("p1"),i.i32_const(h*2)),E=i.getLocal("pr"),g=i.i32_add(i.getLocal("pr"),i.i32_const(h)),U=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),yt=i.i32_const(t.alloc(h)),ut=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(n+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(a+"_isOne",z),[...i.ret(i.call(n+"_doubleAffine",i.getLocal("p1"),i.getLocal("pr"))),...i.ret([])]),i.call(a+"_square",C,st),i.call(a+"_square",r,et),i.call(a+"_square",et,ct),i.call(a+"_add",C,et,ft),i.call(a+"_square",ft,ft),i.call(a+"_sub",ft,st,ft),i.call(a+"_sub",ft,ct,ft),i.call(a+"_add",ft,ft,ft),i.call(a+"_add",st,st,_t),i.call(a+"_add",_t,st,_t),i.call(a+"_square",_t,gt),i.call(a+"_mul",r,z,yt),i.call(a+"_add",ft,ft,E),i.call(a+"_sub",gt,E,E),i.call(a+"_add",ct,ct,ut),i.call(a+"_add",ut,ut,ut),i.call(a+"_add",ut,ut,ut),i.call(a+"_sub",ft,E,g),i.call(a+"_mul",g,_t,g),i.call(a+"_sub",g,ut,g),i.call(a+"_add",yt,yt,U))}function x(){let A=t.addFunction(n+"_doubleAffine");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.getLocal("pr"),E=i.i32_add(i.getLocal("pr"),i.i32_const(h)),g=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),U=i.i32_const(t.alloc(h)),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("p1")),[...i.call(n+"_toJacobian",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.call(a+"_square",C,U),i.call(a+"_square",r,st),i.call(a+"_square",st,et),i.call(a+"_add",C,st,ct),i.call(a+"_square",ct,ct),i.call(a+"_sub",ct,U,ct),i.call(a+"_sub",ct,et,ct),i.call(a+"_add",ct,ct,ct),i.call(a+"_add",U,U,ft),i.call(a+"_add",ft,U,ft),i.call(a+"_add",r,r,g),i.call(a+"_square",ft,z),i.call(a+"_sub",z,ct,z),i.call(a+"_sub",z,ct,z),i.call(a+"_add",et,et,_t),i.call(a+"_add",_t,_t,_t),i.call(a+"_add",_t,_t,_t),i.call(a+"_sub",ct,z,E),i.call(a+"_mul",E,ft,E),i.call(a+"_sub",E,_t,E))}function S(){let A=t.addFunction(n+"_eqAffine");A.addParam("p1","i32"),A.addParam("p2","i32"),A.setReturnType("i32"),A.addLocal("z1","i32");let i=A.getCodeBuilder();A.addCode(i.ret(i.i32_and(i.call(a+"_eq",i.getLocal("p1"),i.getLocal("p2")),i.call(a+"_eq",i.i32_add(i.getLocal("p1"),i.i32_const(h)),i.i32_add(i.getLocal("p2"),i.i32_const(h))))))}function w(){let A=t.addFunction(n+"_toMontgomery");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_toMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<3;C++)A.addCode(i.call(a+"_toMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*h)),i.i32_add(i.getLocal("pr"),i.i32_const(C*h))))}function k(){let A=t.addFunction(n+"_toMontgomeryAffine");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_toMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<2;C++)A.addCode(i.call(a+"_toMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*h)),i.i32_add(i.getLocal("pr"),i.i32_const(C*h))))}function O(){let A=t.addFunction(n+"_fromMontgomery");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_fromMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<3;C++)A.addCode(i.call(a+"_fromMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*h)),i.i32_add(i.getLocal("pr"),i.i32_const(C*h))))}function W(){let A=t.addFunction(n+"_fromMontgomeryAffine");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_fromMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<2;C++)A.addCode(i.call(a+"_fromMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*h)),i.i32_add(i.getLocal("pr"),i.i32_const(C*h))))}function F(){let A=t.addFunction(n+"_add");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32"),A.addLocal("z1","i32"),A.addLocal("z2","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h));A.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));let z=i.getLocal("z1"),E=i.getLocal("p2"),g=i.i32_add(i.getLocal("p2"),i.i32_const(h));A.addCode(i.setLocal("z2",i.i32_add(i.getLocal("p2"),i.i32_const(h*2))));let U=i.getLocal("z2"),st=i.getLocal("pr"),et=i.i32_add(i.getLocal("pr"),i.i32_const(h)),ct=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),yt=i.i32_const(t.alloc(h)),ut=i.i32_const(t.alloc(h)),lt=i.i32_const(t.alloc(h)),bt=i.i32_const(t.alloc(h)),Et=i.i32_const(t.alloc(h)),It=i.i32_const(t.alloc(h)),zt=i.i32_const(t.alloc(h)),Mt=i.i32_const(t.alloc(h)),kt=i.i32_const(t.alloc(h)),Pt=i.i32_const(t.alloc(h)),qt=i.i32_const(t.alloc(h)),Rt=i.i32_const(t.alloc(h)),Kt=i.i32_const(t.alloc(h)),Ut=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(n+"_copy",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(n+"_isZero",i.getLocal("p2")),[...i.call(n+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(a+"_isOne",z),[...i.call(n+"_addMixed",E,C,st),...i.ret([])]),i.if(i.call(a+"_isOne",U),[...i.call(n+"_addMixed",C,E,st),...i.ret([])]),i.call(a+"_square",z,ft),i.call(a+"_square",U,_t),i.call(a+"_mul",C,_t,gt),i.call(a+"_mul",E,ft,yt),i.call(a+"_mul",z,ft,ut),i.call(a+"_mul",U,_t,lt),i.call(a+"_mul",r,lt,bt),i.call(a+"_mul",g,ut,Et),i.if(i.call(a+"_eq",gt,yt),i.if(i.call(a+"_eq",bt,Et),[...i.call(n+"_double",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])])),i.call(a+"_sub",yt,gt,It),i.call(a+"_sub",Et,bt,zt),i.call(a+"_add",It,It,Mt),i.call(a+"_square",Mt,Mt),i.call(a+"_mul",It,Mt,kt),i.call(a+"_add",zt,zt,Pt),i.call(a+"_mul",gt,Mt,Rt),i.call(a+"_square",Pt,qt),i.call(a+"_add",Rt,Rt,Kt),i.call(a+"_sub",qt,kt,st),i.call(a+"_sub",st,Kt,st),i.call(a+"_mul",bt,kt,Ut),i.call(a+"_add",Ut,Ut,Ut),i.call(a+"_sub",Rt,st,et),i.call(a+"_mul",et,Pt,et),i.call(a+"_sub",et,Ut,et),i.call(a+"_add",z,U,ct),i.call(a+"_square",ct,ct),i.call(a+"_sub",ct,ft,ct),i.call(a+"_sub",ct,_t,ct),i.call(a+"_mul",ct,It,ct))}function u(){let A=t.addFunction(n+"_addMixed");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32"),A.addLocal("z1","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h));A.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));let z=i.getLocal("z1"),E=i.getLocal("p2"),g=i.i32_add(i.getLocal("p2"),i.i32_const(h)),U=i.getLocal("pr"),st=i.i32_add(i.getLocal("pr"),i.i32_const(h)),et=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),ct=i.i32_const(t.alloc(h)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),yt=i.i32_const(t.alloc(h)),ut=i.i32_const(t.alloc(h)),lt=i.i32_const(t.alloc(h)),bt=i.i32_const(t.alloc(h)),Et=i.i32_const(t.alloc(h)),It=i.i32_const(t.alloc(h)),zt=i.i32_const(t.alloc(h)),Mt=i.i32_const(t.alloc(h)),kt=i.i32_const(t.alloc(h)),Pt=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(n+"_copyAffine",i.getLocal("p2"),i.getLocal("pr")),...i.call(a+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(h*2))),...i.ret([])]),i.if(i.call(n+"_isZeroAffine",i.getLocal("p2")),[...i.call(n+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(a+"_isOne",z),[...i.call(n+"_addAffine",C,E,U),...i.ret([])]),i.call(a+"_square",z,ct),i.call(a+"_mul",E,ct,ft),i.call(a+"_mul",z,ct,_t),i.call(a+"_mul",g,_t,gt),i.if(i.call(a+"_eq",C,ft),i.if(i.call(a+"_eq",r,gt),[...i.call(n+"_doubleAffine",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])])),i.call(a+"_sub",ft,C,yt),i.call(a+"_sub",gt,r,lt),i.call(a+"_square",yt,ut),i.call(a+"_add",ut,ut,bt),i.call(a+"_add",bt,bt,bt),i.call(a+"_mul",yt,bt,Et),i.call(a+"_add",lt,lt,It),i.call(a+"_mul",C,bt,Mt),i.call(a+"_square",It,zt),i.call(a+"_add",Mt,Mt,kt),i.call(a+"_sub",zt,Et,U),i.call(a+"_sub",U,kt,U),i.call(a+"_mul",r,Et,Pt),i.call(a+"_add",Pt,Pt,Pt),i.call(a+"_sub",Mt,U,st),i.call(a+"_mul",st,It,st),i.call(a+"_sub",st,Pt,st),i.call(a+"_add",z,yt,et),i.call(a+"_square",et,et),i.call(a+"_sub",et,ct,et),i.call(a+"_sub",et,ut,et))}function L(){let A=t.addFunction(n+"_addAffine");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32"),A.addLocal("z1","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h));A.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));let z=i.getLocal("p2"),E=i.i32_add(i.getLocal("p2"),i.i32_const(h)),g=i.getLocal("pr"),U=i.i32_add(i.getLocal("pr"),i.i32_const(h)),st=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),yt=i.i32_const(t.alloc(h)),ut=i.i32_const(t.alloc(h)),lt=i.i32_const(t.alloc(h)),bt=i.i32_const(t.alloc(h)),Et=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("p1")),[...i.call(n+"_copyAffine",i.getLocal("p2"),i.getLocal("pr")),...i.call(a+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(h*2))),...i.ret([])]),i.if(i.call(n+"_isZeroAffine",i.getLocal("p2")),[...i.call(n+"_copyAffine",i.getLocal("p1"),i.getLocal("pr")),...i.call(a+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(h*2))),...i.ret([])]),i.if(i.call(a+"_eq",C,z),i.if(i.call(a+"_eq",r,E),[...i.call(n+"_doubleAffine",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])])),i.call(a+"_sub",z,C,et),i.call(a+"_sub",E,r,ft),i.call(a+"_square",et,ct),i.call(a+"_add",ct,ct,_t),i.call(a+"_add",_t,_t,_t),i.call(a+"_mul",et,_t,gt),i.call(a+"_add",ft,ft,yt),i.call(a+"_mul",C,_t,lt),i.call(a+"_square",yt,ut),i.call(a+"_add",lt,lt,bt),i.call(a+"_sub",ut,gt,g),i.call(a+"_sub",g,bt,g),i.call(a+"_mul",r,gt,Et),i.call(a+"_add",Et,Et,Et),i.call(a+"_sub",lt,g,U),i.call(a+"_mul",U,yt,U),i.call(a+"_sub",U,Et,U),i.call(a+"_add",et,et,st))}function $(){let A=t.addFunction(n+"_neg");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.i32_add(i.getLocal("p1"),i.i32_const(h*2)),E=i.getLocal("pr"),g=i.i32_add(i.getLocal("pr"),i.i32_const(h)),U=i.i32_add(i.getLocal("pr"),i.i32_const(h*2));A.addCode(i.call(a+"_copy",C,E),i.call(a+"_neg",r,g),i.call(a+"_copy",z,U))}function Q(){let A=t.addFunction(n+"_negAffine");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.getLocal("pr"),E=i.i32_add(i.getLocal("pr"),i.i32_const(h));A.addCode(i.call(a+"_copy",C,z),i.call(a+"_neg",r,E))}function H(){let A=t.addFunction(n+"_sub");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h*3));A.addCode(i.call(n+"_neg",i.getLocal("p2"),C),i.call(n+"_add",i.getLocal("p1"),C,i.getLocal("pr")))}function q(){let A=t.addFunction(n+"_subMixed");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h*3));A.addCode(i.call(n+"_negAffine",i.getLocal("p2"),C),i.call(n+"_addMixed",i.getLocal("p1"),C,i.getLocal("pr")))}function y(){let A=t.addFunction(n+"_subAffine");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h*3));A.addCode(i.call(n+"_negAffine",i.getLocal("p2"),C),i.call(n+"_addAffine",i.getLocal("p1"),C,i.getLocal("pr")))}function I(){let A=t.addFunction(n+"_normalize");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.i32_add(i.getLocal("p1"),i.i32_const(h*2)),E=i.getLocal("pr"),g=i.i32_add(i.getLocal("pr"),i.i32_const(h)),U=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),i.call(n+"_zero",i.getLocal("pr")),[...i.call(a+"_inverse",z,st),...i.call(a+"_square",st,et),...i.call(a+"_mul",st,et,ct),...i.call(a+"_mul",C,et,E),...i.call(a+"_mul",r,ct,g),...i.call(a+"_one",U)]))}function N(){let A=t.addFunction(n+"_toAffine");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.i32_add(i.getLocal("p1"),i.i32_const(h*2)),E=i.getLocal("pr"),g=i.i32_add(i.getLocal("pr"),i.i32_const(h)),U=i.i32_const(t.alloc(h)),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(a+"_zero",E),...i.call(a+"_zero",g)],[...i.call(a+"_inverse",z,U),...i.call(a+"_square",U,st),...i.call(a+"_mul",U,st,et),...i.call(a+"_mul",C,st,E),...i.call(a+"_mul",r,et,g)]))}function nt(){let A=t.addFunction(n+"_toJacobian");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.getLocal("pr"),E=i.i32_add(i.getLocal("pr"),i.i32_const(h)),g=i.i32_add(i.getLocal("pr"),i.i32_const(h*2));A.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("p1")),i.call(n+"_zero",i.getLocal("pr")),[...i.call(a+"_one",g),...i.call(a+"_copy",r,E),...i.call(a+"_copy",C,z)]))}function J(){let A=t.addFunction(n+"_batchToAffine");A.addParam("pIn","i32"),A.addParam("n","i32"),A.addParam("pOut","i32"),A.addLocal("pAux","i32"),A.addLocal("itIn","i32"),A.addLocal("itAux","i32"),A.addLocal("itOut","i32"),A.addLocal("i","i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h));A.addCode(i.setLocal("pAux",i.i32_load(i.i32_const(0))),i.i32_store(i.i32_const(0),i.i32_add(i.getLocal("pAux"),i.i32_mul(i.getLocal("n"),i.i32_const(h)))),i.call(a+"_batchInverse",i.i32_add(i.getLocal("pIn"),i.i32_const(h*2)),i.i32_const(h*3),i.getLocal("n"),i.getLocal("pAux"),i.i32_const(h)),i.setLocal("itIn",i.getLocal("pIn")),i.setLocal("itAux",i.getLocal("pAux")),i.setLocal("itOut",i.getLocal("pOut")),i.setLocal("i",i.i32_const(0)),i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("i"),i.getLocal("n"))),i.if(i.call(a+"_isZero",i.getLocal("itAux")),[...i.call(a+"_zero",i.getLocal("itOut")),...i.call(a+"_zero",i.i32_add(i.getLocal("itOut"),i.i32_const(h)))],[...i.call(a+"_mul",i.getLocal("itAux"),i.i32_add(i.getLocal("itIn"),i.i32_const(h)),C),...i.call(a+"_square",i.getLocal("itAux"),i.getLocal("itAux")),...i.call(a+"_mul",i.getLocal("itAux"),i.getLocal("itIn"),i.getLocal("itOut")),...i.call(a+"_mul",i.getLocal("itAux"),C,i.i32_add(i.getLocal("itOut"),i.i32_const(h)))]),i.setLocal("itIn",i.i32_add(i.getLocal("itIn"),i.i32_const(h*3))),i.setLocal("itOut",i.i32_add(i.getLocal("itOut"),i.i32_const(h*2))),i.setLocal("itAux",i.i32_add(i.getLocal("itAux"),i.i32_const(h))),i.setLocal("i",i.i32_add(i.getLocal("i"),i.i32_const(1))),i.br(0))),i.i32_store(i.i32_const(0),i.getLocal("pAux")))}function j(){let A=t.addFunction(n+"__reverseBytes");A.addParam("pIn","i32"),A.addParam("n","i32"),A.addParam("pOut","i32"),A.addLocal("itOut","i32"),A.addLocal("itIn","i32");let i=A.getCodeBuilder();A.addCode(i.setLocal("itOut",i.i32_sub(i.i32_add(i.getLocal("pOut"),i.getLocal("n")),i.i32_const(1))),i.setLocal("itIn",i.getLocal("pIn")),i.block(i.loop(i.br_if(1,i.i32_lt_s(i.getLocal("itOut"),i.getLocal("pOut"))),i.i32_store8(i.getLocal("itOut"),i.i32_load8_u(i.getLocal("itIn"))),i.setLocal("itOut",i.i32_sub(i.getLocal("itOut"),i.i32_const(1))),i.setLocal("itIn",i.i32_add(i.getLocal("itIn"),i.i32_const(1))),i.br(0))))}function ot(){let A=t.addFunction(n+"_LEMtoC");A.addParam("pIn","i32"),A.addParam("pOut","i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("pIn")),[...i.call(a+"_zero",i.getLocal("pOut")),...i.i32_store8(i.getLocal("pOut"),i.i32_const(64)),...i.ret([])]),i.call(a+"_fromMontgomery",i.getLocal("pIn"),C),i.call(n+"__reverseBytes",C,i.i32_const(h),i.getLocal("pOut")),i.if(i.i32_eq(i.call(a+"_sign",i.i32_add(i.getLocal("pIn"),i.i32_const(h))),i.i32_const(-1)),i.i32_store8(i.getLocal("pOut"),i.i32_or(i.i32_load8_u(i.getLocal("pOut")),i.i32_const(128)))))}function V(){let A=t.addFunction(n+"_LEMtoU");A.addParam("pIn","i32"),A.addParam("pOut","i32");let i=A.getCodeBuilder(),C=t.alloc(h*2),r=i.i32_const(C),z=i.i32_const(C),E=i.i32_const(C+h);A.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("pIn")),[...i.call(n+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.call(n+"_fromMontgomeryAffine",i.getLocal("pIn"),r),i.call(n+"__reverseBytes",z,i.i32_const(h),i.getLocal("pOut")),i.call(n+"__reverseBytes",E,i.i32_const(h),i.i32_add(i.getLocal("pOut"),i.i32_const(h))))}function at(){let A=t.addFunction(n+"_UtoLEM");A.addParam("pIn","i32"),A.addParam("pOut","i32");let i=A.getCodeBuilder(),C=t.alloc(h*2),r=i.i32_const(C),z=i.i32_const(C),E=i.i32_const(C+h);A.addCode(i.if(i.i32_and(i.i32_load8_u(i.getLocal("pIn")),i.i32_const(64)),[...i.call(n+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.call(n+"__reverseBytes",i.getLocal("pIn"),i.i32_const(h),z),i.call(n+"__reverseBytes",i.i32_add(i.getLocal("pIn"),i.i32_const(h)),i.i32_const(h),E),i.call(n+"_toMontgomeryAffine",r,i.getLocal("pOut")))}function Lt(){let A=t.addFunction(n+"_CtoLEM");A.addParam("pIn","i32"),A.addParam("pOut","i32"),A.addLocal("firstByte","i32"),A.addLocal("greatest","i32");let i=A.getCodeBuilder(),C=t.alloc(h*2),r=i.i32_const(C),z=i.i32_const(C+h);A.addCode(i.setLocal("firstByte",i.i32_load8_u(i.getLocal("pIn"))),i.if(i.i32_and(i.getLocal("firstByte"),i.i32_const(64)),[...i.call(n+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.setLocal("greatest",i.i32_and(i.getLocal("firstByte"),i.i32_const(128))),i.call(a+"_copy",i.getLocal("pIn"),z),i.i32_store8(z,i.i32_and(i.getLocal("firstByte"),i.i32_const(63))),i.call(n+"__reverseBytes",z,i.i32_const(h),r),i.call(a+"_toMontgomery",r,i.getLocal("pOut")),i.call(a+"_square",i.getLocal("pOut"),z),i.call(a+"_mul",i.getLocal("pOut"),z,z),i.call(a+"_add",z,i.i32_const(o),z),i.call(a+"_sqrt",z,z),i.call(a+"_neg",z,r),i.if(i.i32_eq(i.call(a+"_sign",z),i.i32_const(-1)),i.if(i.getLocal("greatest"),i.call(a+"_copy",z,i.i32_add(i.getLocal("pOut"),i.i32_const(h))),i.call(a+"_neg",z,i.i32_add(i.getLocal("pOut"),i.i32_const(h)))),i.if(i.getLocal("greatest"),i.call(a+"_neg",z,i.i32_add(i.getLocal("pOut"),i.i32_const(h))),i.call(a+"_copy",z,i.i32_add(i.getLocal("pOut"),i.i32_const(h))))))}function rt(){let A=t.addFunction(n+"_inCurveAffine");A.addParam("pIn","i32"),A.setReturnType("i32");let i=A.getCodeBuilder(),C=i.getLocal("pIn"),r=i.i32_add(i.getLocal("pIn"),i.i32_const(h)),z=i.i32_const(t.alloc(h)),E=i.i32_const(t.alloc(h));A.addCode(i.call(a+"_square",r,z),i.call(a+"_square",C,E),i.call(a+"_mul",C,E,E),i.call(a+"_add",E,i.i32_const(o),E),i.ret(i.call(a+"_eq",z,E)))}function ht(){let A=t.addFunction(n+"_inCurve");A.addParam("pIn","i32"),A.setReturnType("i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h*2));A.addCode(i.call(n+"_toAffine",i.getLocal("pIn"),C),i.ret(i.call(n+"_inCurveAffine",C)))}return b(),d(),B(),m(),s(),l(),nt(),S(),v(),p(),x(),M(),L(),u(),F(),Q(),$(),y(),q(),H(),W(),O(),k(),w(),N(),rt(),ht(),J(),I(),j(),V(),ot(),at(),Lt(),ei(t,n+"_batchLEMtoU",n+"_LEMtoU",h*2,h*2),ei(t,n+"_batchLEMtoC",n+"_LEMtoC",h*2,h),ei(t,n+"_batchUtoLEM",n+"_UtoLEM",h*2,h*2),ei(t,n+"_batchCtoLEM",n+"_CtoLEM",h,h*2,!0),ei(t,n+"_batchToJacobian",n+"_toJacobian",h*2,h*3,!0),g2(t,n,n+"_multiexp",n+"_add",h*3),g2(t,n,n+"_multiexpAffine",n+"_addMixed",h*2),f2(t,n+"_timesScalar",h*3,n+"_add",n+"_double",n+"_sub",n+"_copy",n+"_zero"),f2(t,n+"_timesScalarAffine",h*2,n+"_addMixed",n+"_double",n+"_subMixed",n+"_copyAffine",n+"_zero"),t.exportFunction(n+"_isZero"),t.exportFunction(n+"_isZeroAffine"),t.exportFunction(n+"_eq"),t.exportFunction(n+"_eqMixed"),t.exportFunction(n+"_eqAffine"),t.exportFunction(n+"_copy"),t.exportFunction(n+"_copyAffine"),t.exportFunction(n+"_zero"),t.exportFunction(n+"_zeroAffine"),t.exportFunction(n+"_double"),t.exportFunction(n+"_doubleAffine"),t.exportFunction(n+"_add"),t.exportFunction(n+"_addMixed"),t.exportFunction(n+"_addAffine"),t.exportFunction(n+"_neg"),t.exportFunction(n+"_negAffine"),t.exportFunction(n+"_sub"),t.exportFunction(n+"_subMixed"),t.exportFunction(n+"_subAffine"),t.exportFunction(n+"_fromMontgomery"),t.exportFunction(n+"_fromMontgomeryAffine"),t.exportFunction(n+"_toMontgomery"),t.exportFunction(n+"_toMontgomeryAffine"),t.exportFunction(n+"_timesScalar"),t.exportFunction(n+"_timesScalarAffine"),t.exportFunction(n+"_normalize"),t.exportFunction(n+"_LEMtoU"),t.exportFunction(n+"_LEMtoC"),t.exportFunction(n+"_UtoLEM"),t.exportFunction(n+"_CtoLEM"),t.exportFunction(n+"_batchLEMtoU"),t.exportFunction(n+"_batchLEMtoC"),t.exportFunction(n+"_batchUtoLEM"),t.exportFunction(n+"_batchCtoLEM"),t.exportFunction(n+"_toAffine"),t.exportFunction(n+"_toJacobian"),t.exportFunction(n+"_batchToAffine"),t.exportFunction(n+"_batchToJacobian"),t.exportFunction(n+"_inCurve"),t.exportFunction(n+"_inCurveAffine"),n},{isOdd:S1,modInv:L2,modPow:ci}=Vn,Se=Na,D2=function(t,n,a,o,e){let d=t.modules[o].n64*8,l=t.modules[a].n64*8,s=t.modules[o].q,m=s-1n,B=0;for(;!S1(m);)B++,m=m>>1n;let p=2n;for(;ci(p,s>>1n,s)===1n;)p=p+1n;let v=new Array(B+1);v[B]=ci(p,m,s);let M=B-1;for(;M>=0;)v[M]=ci(v[M+1],2n,s),M--;let x=[],S=(1n<<BigInt(d*8))%s;for(let C=0;C<v.length;C++){let r=v[C]*S%s;x.push(...Se.bigInt2BytesLE(r,d))}let w=t.alloc(x),k=new Array(B+1);k[0]=1n;for(let C=1;C<=B;C++)k[C]=k[C-1]*2n;let O=[];for(let C=0;C<=B;C++){let r=L2(k[C],s)*S%s;O.push(...Se.bigInt2BytesLE(r,d))}let W=t.alloc(O),F=ci(p,2n,s),u=[],L=[];for(let C=0;C<=B;C++){let r=ci(F,2n**BigInt(C),s),z=L2(s+1n-r,s);u.push(...Se.bigInt2BytesLE(r*S%s,d)),L.push(...Se.bigInt2BytesLE(z*S%s,d))}let $=t.alloc(u),Q=t.alloc(L);function H(C){let r=0;for(let z=0;z<8;z++)C&1<<z&&(r=r|128>>z);return r}let q=Array(256);for(let C=0;C<256;C++)q[C]=H(C);let y=t.alloc(q);function I(){let C=t.addFunction(n+"__log2");C.addParam("n","i32"),C.setReturnType("i32"),C.addLocal("bits","i32"),C.addLocal("aux","i32");let r=C.getCodeBuilder();C.addCode(r.setLocal("aux",r.i32_shr_u(r.getLocal("n"),r.i32_const(1)))),C.addCode(r.setLocal("bits",r.i32_const(0))),C.addCode(r.block(r.loop(r.br_if(1,r.i32_eqz(r.getLocal("aux"))),r.setLocal("aux",r.i32_shr_u(r.getLocal("aux"),r.i32_const(1))),r.setLocal("bits",r.i32_add(r.getLocal("bits"),r.i32_const(1))),r.br(0)))),C.addCode(r.if(r.i32_ne(r.getLocal("n"),r.i32_shl(r.i32_const(1),r.getLocal("bits"))),r.unreachable())),C.addCode(r.if(r.i32_gt_u(r.getLocal("bits"),r.i32_const(B)),r.unreachable())),C.addCode(r.getLocal("bits"))}function N(){let C=t.addFunction(n+"_fft");C.addParam("px","i32"),C.addParam("n","i32"),C.addLocal("bits","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d));C.addCode(r.setLocal("bits",r.call(n+"__log2",r.getLocal("n"))),r.call(o+"_one",z),r.call(n+"_rawfft",r.getLocal("px"),r.getLocal("bits"),r.i32_const(0),z))}function nt(){let C=t.addFunction(n+"_ifft");C.addParam("px","i32"),C.addParam("n","i32"),C.addLocal("bits","i32"),C.addLocal("pInv2","i32");let r=C.getCodeBuilder();C.addCode(r.setLocal("bits",r.call(n+"__log2",r.getLocal("n"))),r.setLocal("pInv2",r.i32_add(r.i32_const(W),r.i32_mul(r.getLocal("bits"),r.i32_const(d)))),r.call(n+"_rawfft",r.getLocal("px"),r.getLocal("bits"),r.i32_const(1),r.getLocal("pInv2")))}function J(){let C=t.addFunction(n+"_rawfft");C.addParam("px","i32"),C.addParam("bits","i32"),C.addParam("reverse","i32"),C.addParam("mulFactor","i32"),C.addLocal("s","i32"),C.addLocal("k","i32"),C.addLocal("j","i32"),C.addLocal("m","i32"),C.addLocal("mdiv2","i32"),C.addLocal("n","i32"),C.addLocal("pwm","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l)),g=r.i32_const(t.alloc(l));C.addCode(r.call(n+"__reversePermutation",r.getLocal("px"),r.getLocal("bits")),r.setLocal("n",r.i32_shl(r.i32_const(1),r.getLocal("bits"))),r.setLocal("s",r.i32_const(1)),r.block(r.loop(r.br_if(1,r.i32_gt_u(r.getLocal("s"),r.getLocal("bits"))),r.setLocal("m",r.i32_shl(r.i32_const(1),r.getLocal("s"))),r.setLocal("pwm",r.i32_add(r.i32_const(w),r.i32_mul(r.getLocal("s"),r.i32_const(d)))),r.setLocal("k",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_ge_u(r.getLocal("k"),r.getLocal("n"))),r.call(o+"_one",z),r.setLocal("mdiv2",r.i32_shr_u(r.getLocal("m"),r.i32_const(1))),r.setLocal("j",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_ge_u(r.getLocal("j"),r.getLocal("mdiv2"))),r.setLocal("idx1",r.i32_add(r.getLocal("px"),r.i32_mul(r.i32_add(r.getLocal("k"),r.getLocal("j")),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("idx1"),r.i32_mul(r.getLocal("mdiv2"),r.i32_const(l)))),r.call(e,r.getLocal("idx2"),z,E),r.call(a+"_copy",r.getLocal("idx1"),g),r.call(a+"_add",g,E,r.getLocal("idx1")),r.call(a+"_sub",g,E,r.getLocal("idx2")),r.call(o+"_mul",z,r.getLocal("pwm"),z),r.setLocal("j",r.i32_add(r.getLocal("j"),r.i32_const(1))),r.br(0))),r.setLocal("k",r.i32_add(r.getLocal("k"),r.getLocal("m"))),r.br(0))),r.setLocal("s",r.i32_add(r.getLocal("s"),r.i32_const(1))),r.br(0))),r.call(n+"__fftFinal",r.getLocal("px"),r.getLocal("bits"),r.getLocal("reverse"),r.getLocal("mulFactor")))}function j(){let C=t.addFunction(n+"__fftFinal");C.addParam("px","i32"),C.addParam("bits","i32"),C.addParam("reverse","i32"),C.addParam("mulFactor","i32"),C.addLocal("n","i32"),C.addLocal("ndiv2","i32"),C.addLocal("pInv2","i32"),C.addLocal("i","i32"),C.addLocal("mask","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(l));C.addCode(r.if(r.i32_and(r.i32_eqz(r.getLocal("reverse")),r.call(o+"_isOne",r.getLocal("mulFactor"))),r.ret([])),r.setLocal("n",r.i32_shl(r.i32_const(1),r.getLocal("bits"))),r.setLocal("mask",r.i32_sub(r.getLocal("n"),r.i32_const(1))),r.setLocal("i",r.i32_const(1)),r.setLocal("ndiv2",r.i32_shr_u(r.getLocal("n"),r.i32_const(1))),r.block(r.loop(r.br_if(1,r.i32_ge_u(r.getLocal("i"),r.getLocal("ndiv2"))),r.setLocal("idx1",r.i32_add(r.getLocal("px"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("px"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.getLocal("i")),r.i32_const(l)))),r.if(r.getLocal("reverse"),r.if(r.call(o+"_isOne",r.getLocal("mulFactor")),[...r.call(a+"_copy",r.getLocal("idx1"),z),...r.call(a+"_copy",r.getLocal("idx2"),r.getLocal("idx1")),...r.call(a+"_copy",z,r.getLocal("idx2"))],[...r.call(a+"_copy",r.getLocal("idx1"),z),...r.call(e,r.getLocal("idx2"),r.getLocal("mulFactor"),r.getLocal("idx1")),...r.call(e,z,r.getLocal("mulFactor"),r.getLocal("idx2"))]),r.if(r.call(o+"_isOne",r.getLocal("mulFactor")),[],[...r.call(e,r.getLocal("idx1"),r.getLocal("mulFactor"),r.getLocal("idx1")),...r.call(e,r.getLocal("idx2"),r.getLocal("mulFactor"),r.getLocal("idx2"))])),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))),r.if(r.call(o+"_isOne",r.getLocal("mulFactor")),[],[...r.call(e,r.getLocal("px"),r.getLocal("mulFactor"),r.getLocal("px")),...r.setLocal("idx2",r.i32_add(r.getLocal("px"),r.i32_mul(r.getLocal("ndiv2"),r.i32_const(l)))),...r.call(e,r.getLocal("idx2"),r.getLocal("mulFactor"),r.getLocal("idx2"))]))}function ot(){let C=t.addFunction(n+"__reversePermutation");C.addParam("px","i32"),C.addParam("bits","i32"),C.addLocal("n","i32"),C.addLocal("i","i32"),C.addLocal("ri","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(l));C.addCode(r.setLocal("n",r.i32_shl(r.i32_const(1),r.getLocal("bits"))),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.setLocal("idx1",r.i32_add(r.getLocal("px"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("ri",r.call(n+"__rev",r.getLocal("i"),r.getLocal("bits"))),r.setLocal("idx2",r.i32_add(r.getLocal("px"),r.i32_mul(r.getLocal("ri"),r.i32_const(l)))),r.if(r.i32_lt_u(r.getLocal("i"),r.getLocal("ri")),[...r.call(a+"_copy",r.getLocal("idx1"),z),...r.call(a+"_copy",r.getLocal("idx2"),r.getLocal("idx1")),...r.call(a+"_copy",z,r.getLocal("idx2"))]),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function V(){let C=t.addFunction(n+"__rev");C.addParam("x","i32"),C.addParam("bits","i32"),C.setReturnType("i32");let r=C.getCodeBuilder();C.addCode(r.i32_rotl(r.i32_add(r.i32_add(r.i32_shl(r.i32_load8_u(r.i32_and(r.getLocal("x"),r.i32_const(255)),y,0),r.i32_const(24)),r.i32_shl(r.i32_load8_u(r.i32_and(r.i32_shr_u(r.getLocal("x"),r.i32_const(8)),r.i32_const(255)),y,0),r.i32_const(16))),r.i32_add(r.i32_shl(r.i32_load8_u(r.i32_and(r.i32_shr_u(r.getLocal("x"),r.i32_const(16)),r.i32_const(255)),y,0),r.i32_const(8)),r.i32_load8_u(r.i32_and(r.i32_shr_u(r.getLocal("x"),r.i32_const(24)),r.i32_const(255)),y,0))),r.getLocal("bits")))}function at(){let C=t.addFunction(n+"_fftJoin");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l)),g=r.i32_const(t.alloc(l));C.addCode(r.call(o+"_copy",r.getLocal("first"),z),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff1"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("pBuff2"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.call(e,r.getLocal("idx2"),z,E),r.call(a+"_copy",r.getLocal("idx1"),g),r.call(a+"_add",g,E,r.getLocal("idx1")),r.call(a+"_sub",g,E,r.getLocal("idx2")),r.call(o+"_mul",z,r.getLocal("inc"),z),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function Lt(){let C=t.addFunction(n+"_fftJoinExt");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addParam("totalBits","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("pShiftToM","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l));C.addCode(r.setLocal("pShiftToM",r.i32_add(r.i32_const($),r.i32_mul(r.getLocal("totalBits"),r.i32_const(d)))),r.call(o+"_copy",r.getLocal("first"),z),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff1"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("pBuff2"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.call(a+"_add",r.getLocal("idx1"),r.getLocal("idx2"),E),r.call(e,r.getLocal("idx2"),r.getLocal("pShiftToM"),r.getLocal("idx2")),r.call(a+"_add",r.getLocal("idx1"),r.getLocal("idx2"),r.getLocal("idx2")),r.call(e,r.getLocal("idx2"),z,r.getLocal("idx2")),r.call(a+"_copy",E,r.getLocal("idx1")),r.call(o+"_mul",z,r.getLocal("inc"),z),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function rt(){let C=t.addFunction(n+"_fftJoinExtInv");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addParam("totalBits","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("pShiftToM","i32"),C.addLocal("pSConst","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l));C.addCode(r.setLocal("pShiftToM",r.i32_add(r.i32_const($),r.i32_mul(r.getLocal("totalBits"),r.i32_const(d)))),r.setLocal("pSConst",r.i32_add(r.i32_const(Q),r.i32_mul(r.getLocal("totalBits"),r.i32_const(d)))),r.call(o+"_copy",r.getLocal("first"),z),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff1"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("pBuff2"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.call(e,r.getLocal("idx2"),z,E),r.call(a+"_sub",r.getLocal("idx1"),E,r.getLocal("idx2")),r.call(e,r.getLocal("idx2"),r.getLocal("pSConst"),r.getLocal("idx2")),r.call(e,r.getLocal("idx1"),r.getLocal("pShiftToM"),r.getLocal("idx1")),r.call(a+"_sub",E,r.getLocal("idx1"),r.getLocal("idx1")),r.call(e,r.getLocal("idx1"),r.getLocal("pSConst"),r.getLocal("idx1")),r.call(o+"_mul",z,r.getLocal("inc"),z),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function ht(){let C=t.addFunction(n+"_prepareLagrangeEvaluation");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addParam("totalBits","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("pShiftToM","i32"),C.addLocal("pSConst","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l));C.addCode(r.setLocal("pShiftToM",r.i32_add(r.i32_const($),r.i32_mul(r.getLocal("totalBits"),r.i32_const(d)))),r.setLocal("pSConst",r.i32_add(r.i32_const(Q),r.i32_mul(r.getLocal("totalBits"),r.i32_const(d)))),r.call(o+"_copy",r.getLocal("first"),z),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff1"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("pBuff2"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.call(e,r.getLocal("idx1"),r.getLocal("pShiftToM"),E),r.call(a+"_sub",r.getLocal("idx2"),E,E),r.call(a+"_sub",r.getLocal("idx1"),r.getLocal("idx2"),r.getLocal("idx2")),r.call(e,E,r.getLocal("pSConst"),r.getLocal("idx1")),r.call(e,r.getLocal("idx2"),z,r.getLocal("idx2")),r.call(o+"_mul",z,r.getLocal("inc"),z),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function A(){let C=t.addFunction(n+"_fftMix");C.addParam("pBuff","i32"),C.addParam("n","i32"),C.addParam("exp","i32"),C.addLocal("nGroups","i32"),C.addLocal("nPerGroup","i32"),C.addLocal("nPerGroupDiv2","i32"),C.addLocal("pairOffset","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("j","i32"),C.addLocal("pwm","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l)),g=r.i32_const(t.alloc(l));C.addCode(r.setLocal("nPerGroup",r.i32_shl(r.i32_const(1),r.getLocal("exp"))),r.setLocal("nPerGroupDiv2",r.i32_shr_u(r.getLocal("nPerGroup"),r.i32_const(1))),r.setLocal("nGroups",r.i32_shr_u(r.getLocal("n"),r.getLocal("exp"))),r.setLocal("pairOffset",r.i32_mul(r.getLocal("nPerGroupDiv2"),r.i32_const(l))),r.setLocal("pwm",r.i32_add(r.i32_const(w),r.i32_mul(r.getLocal("exp"),r.i32_const(d)))),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("nGroups"))),r.call(o+"_one",z),r.setLocal("j",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("j"),r.getLocal("nPerGroupDiv2"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff"),r.i32_mul(r.i32_add(r.i32_mul(r.getLocal("i"),r.getLocal("nPerGroup")),r.getLocal("j")),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("idx1"),r.getLocal("pairOffset"))),r.call(e,r.getLocal("idx2"),z,E),r.call(a+"_copy",r.getLocal("idx1"),g),r.call(a+"_add",g,E,r.getLocal("idx1")),r.call(a+"_sub",g,E,r.getLocal("idx2")),r.call(o+"_mul",z,r.getLocal("pwm"),z),r.setLocal("j",r.i32_add(r.getLocal("j"),r.i32_const(1))),r.br(0))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function i(){let C=t.addFunction(n+"_fftFinal");C.addParam("pBuff","i32"),C.addParam("n","i32"),C.addParam("factor","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("ndiv2","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(l));C.addCode(r.setLocal("ndiv2",r.i32_shr_u(r.getLocal("n"),r.i32_const(1))),r.if(r.i32_and(r.getLocal("n"),r.i32_const(1)),r.call(e,r.i32_add(r.getLocal("pBuff"),r.i32_mul(r.getLocal("ndiv2"),r.i32_const(l))),r.getLocal("factor"),r.i32_add(r.getLocal("pBuff"),r.i32_mul(r.getLocal("ndiv2"),r.i32_const(l))))),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_ge_u(r.getLocal("i"),r.getLocal("ndiv2"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("pBuff"),r.i32_mul(r.i32_sub(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.getLocal("i")),r.i32_const(l)))),r.call(e,r.getLocal("idx2"),r.getLocal("factor"),z),r.call(e,r.getLocal("idx1"),r.getLocal("factor"),r.getLocal("idx2")),r.call(a+"_copy",z,r.getLocal("idx1")),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}V(),ot(),j(),J(),I(),N(),nt(),at(),Lt(),rt(),A(),i(),ht(),t.exportFunction(n+"_fft"),t.exportFunction(n+"_ifft"),t.exportFunction(n+"_rawfft"),t.exportFunction(n+"_fftJoin"),t.exportFunction(n+"_fftJoinExt"),t.exportFunction(n+"_fftJoinExtInv"),t.exportFunction(n+"_fftMix"),t.exportFunction(n+"_fftFinal"),t.exportFunction(n+"_prepareLagrangeEvaluation")},K2=function(t,n,a){let e=t.modules[a].n64*8;function h(){let b=t.addFunction(n+"_zero");b.addParam("px","i32"),b.addParam("n","i32"),b.addLocal("lastp","i32"),b.addLocal("p","i32");let l=b.getCodeBuilder();b.addCode(l.setLocal("p",l.getLocal("px")),l.setLocal("lastp",l.i32_add(l.getLocal("px"),l.i32_mul(l.getLocal("n"),l.i32_const(e)))),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("p"),l.getLocal("lastp"))),l.call(a+"_zero",l.getLocal("p")),l.setLocal("p",l.i32_add(l.getLocal("p"),l.i32_const(e))),l.br(0))))}function d(){let b=t.addFunction(n+"_constructLC");b.addParam("ppolynomials","i32"),b.addParam("psignals","i32"),b.addParam("nSignals","i32"),b.addParam("pres","i32"),b.addLocal("i","i32"),b.addLocal("j","i32"),b.addLocal("pp","i32"),b.addLocal("ps","i32"),b.addLocal("pd","i32"),b.addLocal("ncoefs","i32");let l=b.getCodeBuilder(),s=l.i32_const(t.alloc(e));b.addCode(l.setLocal("i",l.i32_const(0)),l.setLocal("pp",l.getLocal("ppolynomials")),l.setLocal("ps",l.getLocal("psignals")),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("nSignals"))),l.setLocal("ncoefs",l.i32_load(l.getLocal("pp"))),l.setLocal("pp",l.i32_add(l.getLocal("pp"),l.i32_const(4))),l.setLocal("j",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("j"),l.getLocal("ncoefs"))),l.setLocal("pd",l.i32_add(l.getLocal("pres"),l.i32_mul(l.i32_load(l.getLocal("pp")),l.i32_const(e)))),l.setLocal("pp",l.i32_add(l.getLocal("pp"),l.i32_const(4))),l.call(a+"_mul",l.getLocal("ps"),l.getLocal("pp"),s),l.call(a+"_add",s,l.getLocal("pd"),l.getLocal("pd")),l.setLocal("pp",l.i32_add(l.getLocal("pp"),l.i32_const(e))),l.setLocal("j",l.i32_add(l.getLocal("j"),l.i32_const(1))),l.br(0))),l.setLocal("ps",l.i32_add(l.getLocal("ps"),l.i32_const(e))),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))))}return h(),d(),t.exportFunction(n+"_zero"),t.exportFunction(n+"_constructLC"),n},J2=function(t,n,a){let e=t.modules[a].n64*8;function h(){let l=t.addFunction(n+"_buildABC");l.addParam("pCoefs","i32"),l.addParam("nCoefs","i32"),l.addParam("pWitness","i32"),l.addParam("pA","i32"),l.addParam("pB","i32"),l.addParam("pC","i32"),l.addParam("offsetOut","i32"),l.addParam("nOut","i32"),l.addParam("offsetWitness","i32"),l.addParam("nWitness","i32"),l.addLocal("it","i32"),l.addLocal("ita","i32"),l.addLocal("itb","i32"),l.addLocal("last","i32"),l.addLocal("m","i32"),l.addLocal("c","i32"),l.addLocal("s","i32"),l.addLocal("pOut","i32");let s=l.getCodeBuilder(),m=s.i32_const(t.alloc(e));l.addCode(s.setLocal("ita",s.getLocal("pA")),s.setLocal("itb",s.getLocal("pB")),s.setLocal("last",s.i32_add(s.getLocal("pA"),s.i32_mul(s.getLocal("nOut"),s.i32_const(e)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(a+"_zero",s.getLocal("ita")),s.call(a+"_zero",s.getLocal("itb")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(e))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(e))),s.br(0))),s.setLocal("it",s.getLocal("pCoefs")),s.setLocal("last",s.i32_add(s.getLocal("pCoefs"),s.i32_mul(s.getLocal("nCoefs"),s.i32_const(e+12)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("it"),s.getLocal("last"))),s.setLocal("s",s.i32_load(s.getLocal("it"),8)),s.if(s.i32_or(s.i32_lt_u(s.getLocal("s"),s.getLocal("offsetWitness")),s.i32_ge_u(s.getLocal("s"),s.i32_add(s.getLocal("offsetWitness"),s.getLocal("nWitness")))),[...s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(e+12))),...s.br(1)]),s.setLocal("m",s.i32_load(s.getLocal("it"))),s.if(s.i32_eq(s.getLocal("m"),s.i32_const(0)),s.setLocal("pOut",s.getLocal("pA")),s.if(s.i32_eq(s.getLocal("m"),s.i32_const(1)),s.setLocal("pOut",s.getLocal("pB")),[...s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(e+12))),...s.br(1)])),s.setLocal("c",s.i32_load(s.getLocal("it"),4)),s.if(s.i32_or(s.i32_lt_u(s.getLocal("c"),s.getLocal("offsetOut")),s.i32_ge_u(s.getLocal("c"),s.i32_add(s.getLocal("offsetOut"),s.getLocal("nOut")))),[...s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(e+12))),...s.br(1)]),s.setLocal("pOut",s.i32_add(s.getLocal("pOut"),s.i32_mul(s.i32_sub(s.getLocal("c"),s.getLocal("offsetOut")),s.i32_const(e)))),s.call(a+"_mul",s.i32_add(s.getLocal("pWitness"),s.i32_mul(s.i32_sub(s.getLocal("s"),s.getLocal("offsetWitness")),s.i32_const(e))),s.i32_add(s.getLocal("it"),s.i32_const(12)),m),s.call(a+"_add",s.getLocal("pOut"),m,s.getLocal("pOut")),s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(e+12))),s.br(0))),s.setLocal("ita",s.getLocal("pA")),s.setLocal("itb",s.getLocal("pB")),s.setLocal("it",s.getLocal("pC")),s.setLocal("last",s.i32_add(s.getLocal("pA"),s.i32_mul(s.getLocal("nOut"),s.i32_const(e)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(a+"_mul",s.getLocal("ita"),s.getLocal("itb"),s.getLocal("it")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(e))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(e))),s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(e))),s.br(0))))}function d(){let l=t.addFunction(n+"_joinABC");l.addParam("pA","i32"),l.addParam("pB","i32"),l.addParam("pC","i32"),l.addParam("n","i32"),l.addParam("pP","i32"),l.addLocal("ita","i32"),l.addLocal("itb","i32"),l.addLocal("itc","i32"),l.addLocal("itp","i32"),l.addLocal("last","i32");let s=l.getCodeBuilder(),m=s.i32_const(t.alloc(e));l.addCode(s.setLocal("ita",s.getLocal("pA")),s.setLocal("itb",s.getLocal("pB")),s.setLocal("itc",s.getLocal("pC")),s.setLocal("itp",s.getLocal("pP")),s.setLocal("last",s.i32_add(s.getLocal("pA"),s.i32_mul(s.getLocal("n"),s.i32_const(e)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(a+"_mul",s.getLocal("ita"),s.getLocal("itb"),m),s.call(a+"_sub",m,s.getLocal("itc"),s.getLocal("itp")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(e))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(e))),s.setLocal("itc",s.i32_add(s.getLocal("itc"),s.i32_const(e))),s.setLocal("itp",s.i32_add(s.getLocal("itp"),s.i32_const(e))),s.br(0))))}function b(){let l=t.addFunction(n+"_batchAdd");l.addParam("pa","i32"),l.addParam("pb","i32"),l.addParam("n","i32"),l.addParam("pr","i32"),l.addLocal("ita","i32"),l.addLocal("itb","i32"),l.addLocal("itr","i32"),l.addLocal("last","i32");let s=l.getCodeBuilder();l.addCode(s.setLocal("ita",s.getLocal("pa")),s.setLocal("itb",s.getLocal("pb")),s.setLocal("itr",s.getLocal("pr")),s.setLocal("last",s.i32_add(s.getLocal("pa"),s.i32_mul(s.getLocal("n"),s.i32_const(e)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(a+"_add",s.getLocal("ita"),s.getLocal("itb"),s.getLocal("itr")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(e))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(e))),s.setLocal("itr",s.i32_add(s.getLocal("itr"),s.i32_const(e))),s.br(0))))}return h(),d(),b(),t.exportFunction(n+"_buildABC"),t.exportFunction(n+"_joinABC"),t.exportFunction(n+"_batchAdd"),n},Y2=function(t,n,a,o,e,h,d,b){let l=t.addFunction(n);l.addParam("pIn","i32"),l.addParam("n","i32"),l.addParam("pFirst","i32"),l.addParam("pInc","i32"),l.addParam("pOut","i32"),l.addLocal("pOldFree","i32"),l.addLocal("i","i32"),l.addLocal("pFrom","i32"),l.addLocal("pTo","i32");let s=l.getCodeBuilder(),m=s.i32_const(t.alloc(d));l.addCode(s.setLocal("pFrom",s.getLocal("pIn")),s.setLocal("pTo",s.getLocal("pOut"))),l.addCode(s.call(o+"_copy",s.getLocal("pFirst"),m)),l.addCode(s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.call(b,s.getLocal("pFrom"),m,s.getLocal("pTo")),s.setLocal("pFrom",s.i32_add(s.getLocal("pFrom"),s.i32_const(e))),s.setLocal("pTo",s.i32_add(s.getLocal("pTo"),s.i32_const(h))),s.call(o+"_mul",m,s.getLocal("pInc"),m),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0)))),t.exportFunction(n)},Yt=Na,q1=sl,I1=W2,p2=Q2,O1=X2,b2=H2,qs=D2,P1=K2,M1=J2,si=Y2,{bitLength:R1,modInv:z1,isOdd:m2,isNegative:T1}=Vn,G1=function(t,n){let a=n||"bn128";if(t.modules[a])return a;let o=21888242871839275222246405745257275088696311157297823662689037894645226208583n,e=21888242871839275222246405745257275088548364400416034343698204186575808495617n,h=Math.floor((R1(o-1n)-1)/64)+1,d=h*8,b=d,l=d,s=l*2,m=l*12,B=t.alloc(Yt.bigInt2BytesLE(e,b)),p=q1(t,o,"f1m");I1(t,e,"fr","frm");let v=t.alloc(Yt.bigInt2BytesLE(O(3n),l)),M=b2(t,"g1m","f1m",v);qs(t,"frm","frm","frm","frm_mul"),P1(t,"pol","frm"),M1(t,"qap","frm");let x=p2(t,"f1m_neg","f2m","f1m"),S=t.alloc([...Yt.bigInt2BytesLE(O(19485874751759354771024239261021720505790618469301721065564631296452457478373n),l),...Yt.bigInt2BytesLE(O(266929791119991161246907387137283842545076965332900288569378510910307636690n),l)]),w=b2(t,"g2m","f2m",S);function k(X,_){let f=t.addFunction(X);f.addParam("pG","i32"),f.addParam("pFr","i32"),f.addParam("pr","i32");let R=f.getCodeBuilder(),G=R.i32_const(t.alloc(d));f.addCode(R.call("frm_fromMontgomery",R.getLocal("pFr"),G),R.call(_,R.getLocal("pG"),G,R.i32_const(d),R.getLocal("pr"))),t.exportFunction(X)}k("g1m_timesFr","g1m_timesScalar"),qs(t,"g1m","g1m","frm","g1m_timesFr"),k("g2m_timesFr","g2m_timesScalar"),qs(t,"g2m","g2m","frm","g2m_timesFr"),k("g1m_timesFrAffine","g1m_timesScalarAffine"),k("g2m_timesFrAffine","g2m_timesScalarAffine"),si(t,"frm_batchApplyKey","fmr","frm",d,d,d,"frm_mul"),si(t,"g1m_batchApplyKey","g1m","frm",d*3,d*3,d,"g1m_timesFr"),si(t,"g1m_batchApplyKeyMixed","g1m","frm",d*2,d*3,d,"g1m_timesFrAffine"),si(t,"g2m_batchApplyKey","g2m","frm",d*2*3,d*3*2,d,"g2m_timesFr"),si(t,"g2m_batchApplyKeyMixed","g2m","frm",d*2*2,d*3*2,d,"g2m_timesFrAffine");function O(X){return BigInt(X)*(1n<<BigInt(l*8))%o}let W=[1n,2n,1n],F=t.alloc([...Yt.bigInt2BytesLE(O(W[0]),l),...Yt.bigInt2BytesLE(O(W[1]),l),...Yt.bigInt2BytesLE(O(W[2]),l)]),u=[0n,1n,0n],L=t.alloc([...Yt.bigInt2BytesLE(O(u[0]),l),...Yt.bigInt2BytesLE(O(u[1]),l),...Yt.bigInt2BytesLE(O(u[2]),l)]),$=[[10857046999023057135944570762232829481370756359578518086990519993285655852781n,11559732032986387107991004021392285783925812861821192530917403151452391805634n],[8495653923123431417604973247489272438418190587263600148770280649306958101930n,4082367875863433681332203403145435568316851327593401208105741076214120093531n],[1n,0n]],Q=t.alloc([...Yt.bigInt2BytesLE(O($[0][0]),l),...Yt.bigInt2BytesLE(O($[0][1]),l),...Yt.bigInt2BytesLE(O($[1][0]),l),...Yt.bigInt2BytesLE(O($[1][1]),l),...Yt.bigInt2BytesLE(O($[2][0]),l),...Yt.bigInt2BytesLE(O($[2][1]),l)]),H=[[0n,0n],[1n,0n],[0n,0n]],q=t.alloc([...Yt.bigInt2BytesLE(O(H[0][0]),l),...Yt.bigInt2BytesLE(O(H[0][1]),l),...Yt.bigInt2BytesLE(O(H[1][0]),l),...Yt.bigInt2BytesLE(O(H[1][1]),l),...Yt.bigInt2BytesLE(O(H[2][0]),l),...Yt.bigInt2BytesLE(O(H[2][1]),l)]),y=t.alloc([...Yt.bigInt2BytesLE(O(1),l),...Yt.bigInt2BytesLE(O(0),l),...Yt.bigInt2BytesLE(O(0),l),...Yt.bigInt2BytesLE(O(0),l),...Yt.bigInt2BytesLE(O(0),l),...Yt.bigInt2BytesLE(O(0),l),...Yt.bigInt2BytesLE(O(0),l),...Yt.bigInt2BytesLE(O(0),l),...Yt.bigInt2BytesLE(O(0),l),...Yt.bigInt2BytesLE(O(0),l),...Yt.bigInt2BytesLE(O(0),l),...Yt.bigInt2BytesLE(O(0),l)]),I=t.alloc([...Yt.bigInt2BytesLE(O(9),l),...Yt.bigInt2BytesLE(O(1),l)]),N=t.alloc([...Yt.bigInt2BytesLE(O(z1(2n,o)),l),...Yt.bigInt2BytesLE(0n,l)]),nt=I,J=t.alloc([...Yt.bigInt2BytesLE(O(19485874751759354771024239261021720505790618469301721065564631296452457478373n),l),...Yt.bigInt2BytesLE(O(266929791119991161246907387137283842545076965332900288569378510910307636690n),l)]);function j(){let X=t.addFunction(a+"_mulNR6");X.addParam("x","i32"),X.addParam("pr","i32");let _=X.getCodeBuilder();X.addCode(_.call(x+"_mul",_.i32_const(I),_.getLocal("x"),_.getLocal("pr")))}j();let ot=O1(t,a+"_mulNR6","f6m","f2m");function V(){let X=t.addFunction(a+"_mulNR12");X.addParam("x","i32"),X.addParam("pr","i32");let _=X.getCodeBuilder();X.addCode(_.call(x+"_mul",_.i32_const(I),_.i32_add(_.getLocal("x"),_.i32_const(d*4)),_.getLocal("pr")),_.call(x+"_copy",_.getLocal("x"),_.i32_add(_.getLocal("pr"),_.i32_const(d*2))),_.call(x+"_copy",_.i32_add(_.getLocal("x"),_.i32_const(d*2)),_.i32_add(_.getLocal("pr"),_.i32_const(d*4))))}V();let at=p2(t,a+"_mulNR12","ftm",ot),rt=st(29793968203157093288n),ht=t.alloc(rt),A=3*s,i=rt.length-1,r=rt.reduce((X,_)=>X+(_!=0?1:0),0)+i+1,z=6*d,E=3*d*2+r*A;t.modules[a]={n64:h,pG1gen:F,pG1zero:L,pG1b:v,pG2gen:Q,pG2zero:q,pG2b:S,pq:t.modules.f1m.pq,pr:B,pOneT:y,prePSize:z,preQSize:E,r:e.toString(),q:o.toString()};let g=4965661367192848881n;function U(X){let _=X,f=[];for(;_>0n;){if(m2(_)){let R=2-Number(_%4n);f.push(R),_=_-BigInt(R)}else f.push(0);_=_>>1n}return f}function st(X){let _=X,f=[];for(;_>0n;)m2(_)?f.push(1):f.push(0),_=_>>1n;return f}function et(){let X=t.addFunction(a+"_prepareG1");X.addParam("pP","i32"),X.addParam("ppreP","i32");let _=X.getCodeBuilder();X.addCode(_.call(M+"_normalize",_.getLocal("pP"),_.getLocal("ppreP")))}function ct(){let X=t.addFunction(a+"_prepAddStep");X.addParam("pQ","i32"),X.addParam("pR","i32"),X.addParam("pCoef","i32");let _=X.getCodeBuilder(),f=_.getLocal("pQ"),R=_.i32_add(_.getLocal("pQ"),_.i32_const(s)),G=_.getLocal("pR"),P=_.i32_add(_.getLocal("pR"),_.i32_const(s)),Z=_.i32_add(_.getLocal("pR"),_.i32_const(2*s)),T=_.getLocal("pCoef"),D=_.i32_add(_.getLocal("pCoef"),_.i32_const(s)),Y=_.i32_add(_.getLocal("pCoef"),_.i32_const(2*s)),tt=D,K=_.i32_const(t.alloc(s)),it=_.i32_const(t.alloc(s)),mt=_.i32_const(t.alloc(s)),pt=_.i32_const(t.alloc(s)),dt=_.i32_const(t.alloc(s)),Ct=_.i32_const(t.alloc(s)),xt=_.i32_const(t.alloc(s));X.addCode(_.call(x+"_mul",f,Z,tt),_.call(x+"_sub",G,tt,tt),_.call(x+"_mul",R,Z,K),_.call(x+"_sub",P,K,K),_.call(x+"_square",tt,it),_.call(x+"_square",K,mt),_.call(x+"_mul",tt,it,pt),_.call(x+"_mul",G,it,dt),_.call(x+"_add",dt,dt,xt),_.call(x+"_mul",Z,mt,Ct),_.call(x+"_add",pt,Ct,Ct),_.call(x+"_sub",Ct,xt,Ct),_.call(x+"_mul",tt,Ct,G),_.call(x+"_mul",pt,P,P),_.call(x+"_sub",dt,Ct,xt),_.call(x+"_mul",K,xt,xt),_.call(x+"_sub",xt,P,P),_.call(x+"_mul",Z,pt,Z),_.call(x+"_mul",tt,R,xt),_.call(x+"_mul",K,f,T),_.call(x+"_sub",T,xt,T),_.call(x+"_mul",T,_.i32_const(nt),T),_.call(x+"_neg",K,Y))}function ft(){let X=t.addFunction(a+"_prepDblStep");X.addParam("pR","i32"),X.addParam("pCoef","i32");let _=X.getCodeBuilder(),f=_.getLocal("pR"),R=_.i32_add(_.getLocal("pR"),_.i32_const(s)),G=_.i32_add(_.getLocal("pR"),_.i32_const(2*s)),P=_.getLocal("pCoef"),Z=_.i32_add(_.getLocal("pCoef"),_.i32_const(s)),T=_.i32_add(_.getLocal("pCoef"),_.i32_const(2*s)),D=_.i32_const(t.alloc(s)),Y=_.i32_const(t.alloc(s)),tt=_.i32_const(t.alloc(s)),K=_.i32_const(t.alloc(s)),it=_.i32_const(t.alloc(s)),mt=_.i32_const(t.alloc(s)),pt=_.i32_const(t.alloc(s)),dt=_.i32_const(t.alloc(s)),Ct=_.i32_const(t.alloc(s)),xt=_.i32_const(t.alloc(s)),St=_.i32_const(t.alloc(s)),Bt=_.i32_const(t.alloc(s));X.addCode(_.call(x+"_mul",R,_.i32_const(N),D),_.call(x+"_mul",f,D,D),_.call(x+"_square",R,Y),_.call(x+"_square",G,tt),_.call(x+"_add",tt,tt,K),_.call(x+"_add",K,tt,K),_.call(x+"_mul",_.i32_const(J),K,it),_.call(x+"_add",it,it,mt),_.call(x+"_add",it,mt,mt),_.call(x+"_add",Y,mt,pt),_.call(x+"_mul",pt,_.i32_const(N),pt),_.call(x+"_add",Y,tt,Bt),_.call(x+"_add",R,G,dt),_.call(x+"_square",dt,dt),_.call(x+"_sub",dt,Bt,dt),_.call(x+"_sub",it,Y,Ct),_.call(x+"_square",f,xt),_.call(x+"_square",it,St),_.call(x+"_sub",Y,mt,Bt),_.call(x+"_mul",D,Bt,f),_.call(x+"_add",St,St,Bt),_.call(x+"_add",St,Bt,Bt),_.call(x+"_square",pt,R),_.call(x+"_sub",R,Bt,R),_.call(x+"_mul",Y,dt,G),_.call(x+"_mul",_.i32_const(nt),Ct,P),_.call(x+"_neg",dt,Z),_.call(x+"_add",xt,xt,T),_.call(x+"_add",xt,T,T))}function _t(){let X=t.addFunction(a+"_mulByQ");X.addParam("p1","i32"),X.addParam("pr","i32");let _=X.getCodeBuilder(),f=_.getLocal("p1"),R=_.i32_add(_.getLocal("p1"),_.i32_const(s)),G=_.i32_add(_.getLocal("p1"),_.i32_const(s*2)),P=_.getLocal("pr"),Z=_.i32_add(_.getLocal("pr"),_.i32_const(s)),T=_.i32_add(_.getLocal("pr"),_.i32_const(s*2)),D=_.i32_const(t.alloc([...Yt.bigInt2BytesLE(O("21575463638280843010398324269430826099269044274347216827212613867836435027261"),l),...Yt.bigInt2BytesLE(O("10307601595873709700152284273816112264069230130616436755625194854815875713954"),l)])),Y=_.i32_const(t.alloc([...Yt.bigInt2BytesLE(O("2821565182194536844548159561693502659359617185244120367078079554186484126554"),l),...Yt.bigInt2BytesLE(O("3505843767911556378687030309984248845540243509899259641013678093033130930403"),l)]));X.addCode(_.call(x+"_conjugate",f,P),_.call(x+"_mul",D,P,P),_.call(x+"_conjugate",R,Z),_.call(x+"_mul",Y,Z,Z),_.call(x+"_conjugate",G,T))}function gt(){_t();let X=t.addFunction(a+"_prepareG2");X.addParam("pQ","i32"),X.addParam("ppreQ","i32"),X.addLocal("pCoef","i32"),X.addLocal("i","i32");let _=X.getCodeBuilder(),f=_.getLocal("pQ"),R=t.alloc(s*3),G=_.i32_const(R),P=_.i32_const(R),Z=_.i32_const(R+s),T=_.i32_const(R+2*s),D=_.i32_add(_.getLocal("ppreQ"),_.i32_const(0)),Y=_.i32_add(_.getLocal("ppreQ"),_.i32_const(s)),tt=t.alloc(s*3),K=_.i32_const(tt),it=t.alloc(s*3),mt=_.i32_const(it),pt=_.i32_const(it+s);X.addCode(_.call(w+"_normalize",f,D),_.call(x+"_copy",D,P),_.call(x+"_copy",Y,Z),_.call(x+"_one",T)),X.addCode(_.setLocal("pCoef",_.i32_add(_.getLocal("ppreQ"),_.i32_const(s*3))),_.setLocal("i",_.i32_const(rt.length-2)),_.block(_.loop(_.call(a+"_prepDblStep",G,_.getLocal("pCoef")),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))),_.if(_.i32_load8_s(_.getLocal("i"),ht),[..._.call(a+"_prepAddStep",D,G,_.getLocal("pCoef")),..._.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A)))]),_.br_if(1,_.i32_eqz(_.getLocal("i"))),_.setLocal("i",_.i32_sub(_.getLocal("i"),_.i32_const(1))),_.br(0)))),X.addCode(_.call(a+"_mulByQ",D,K),_.call(a+"_mulByQ",K,mt)),X.addCode(_.call(x+"_neg",pt,pt),_.call(a+"_prepAddStep",K,G,_.getLocal("pCoef")),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))),_.call(a+"_prepAddStep",mt,G,_.getLocal("pCoef")),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))))}function yt(){let X=t.addFunction(a+"__mulBy024Old");X.addParam("pEll0","i32"),X.addParam("pEllVW","i32"),X.addParam("pEllVV","i32"),X.addParam("pR","i32");let _=X.getCodeBuilder(),f=_.getLocal("pEll0"),R=_.getLocal("pEllVV"),G=_.getLocal("pEllVW"),P=_.getLocal("pR"),Z=t.alloc(m),T=_.i32_const(Z),D=_.i32_const(Z),Y=_.i32_const(Z+s),tt=_.i32_const(Z+s*2),K=_.i32_const(Z+s*3),it=_.i32_const(Z+s*4),mt=_.i32_const(Z+s*5);X.addCode(_.call(x+"_copy",f,D),_.call(x+"_zero",Y),_.call(x+"_copy",R,tt),_.call(x+"_zero",K),_.call(x+"_copy",G,it),_.call(x+"_zero",mt),_.call(at+"_mul",T,P,P))}function ut(){let X=t.addFunction(a+"__mulBy024");X.addParam("pEll0","i32"),X.addParam("pEllVW","i32"),X.addParam("pEllVV","i32"),X.addParam("pR","i32");let _=X.getCodeBuilder(),f=_.getLocal("pEll0"),R=_.getLocal("pEllVV"),G=_.getLocal("pEllVW"),P=_.getLocal("pR"),Z=_.i32_add(_.getLocal("pR"),_.i32_const(2*d)),T=_.i32_add(_.getLocal("pR"),_.i32_const(4*d)),D=_.i32_add(_.getLocal("pR"),_.i32_const(6*d)),Y=_.i32_add(_.getLocal("pR"),_.i32_const(8*d)),tt=_.i32_add(_.getLocal("pR"),_.i32_const(10*d)),K=_.i32_const(t.alloc(s)),it=_.i32_const(t.alloc(s)),mt=_.i32_const(t.alloc(s)),pt=_.i32_const(t.alloc(s)),dt=_.i32_const(t.alloc(s)),Ct=_.i32_const(t.alloc(s)),xt=_.i32_const(t.alloc(s)),St=_.i32_const(t.alloc(s)),Bt=_.i32_const(t.alloc(s)),At=_.i32_const(t.alloc(s)),wt=_.i32_const(t.alloc(s));X.addCode(_.call(x+"_mul",P,f,xt),_.call(x+"_mul",T,R,St),_.call(x+"_mul",Y,G,Bt),_.call(x+"_add",P,Y,mt),_.call(x+"_add",P,T,it),_.call(x+"_add",Z,D,pt),_.call(x+"_add",pt,tt,pt),_.call(x+"_mul",Z,R,At),_.call(x+"_add",At,Bt,dt),_.call(x+"_mul",_.i32_const(I),dt,Ct),_.call(x+"_add",Ct,xt,P),_.call(x+"_mul",tt,G,dt),_.call(x+"_add",At,dt,At),_.call(x+"_add",dt,St,dt),_.call(x+"_mul",_.i32_const(I),dt,Ct),_.call(x+"_mul",Z,f,dt),_.call(x+"_add",At,dt,At),_.call(x+"_add",Ct,dt,Z),_.call(x+"_add",f,R,K),_.call(x+"_mul",it,K,dt),_.call(x+"_add",xt,St,wt),_.call(x+"_sub",dt,wt,dt),_.call(x+"_mul",D,G,Ct),_.call(x+"_add",At,Ct,At),_.call(x+"_add",T,Y,K),_.call(x+"_add",dt,Ct,T),_.call(x+"_add",R,G,it),_.call(x+"_mul",it,K,dt),_.call(x+"_add",St,Bt,wt),_.call(x+"_sub",dt,wt,dt),_.call(x+"_mul",_.i32_const(I),dt,Ct),_.call(x+"_mul",D,f,dt),_.call(x+"_add",At,dt,At),_.call(x+"_add",Ct,dt,D),_.call(x+"_mul",tt,R,dt),_.call(x+"_add",At,dt,At),_.call(x+"_mul",_.i32_const(I),dt,Ct),_.call(x+"_add",f,G,K),_.call(x+"_mul",mt,K,dt),_.call(x+"_add",xt,Bt,wt),_.call(x+"_sub",dt,wt,dt),_.call(x+"_add",Ct,dt,Y),_.call(x+"_add",f,R,K),_.call(x+"_add",K,G,K),_.call(x+"_mul",pt,K,dt),_.call(x+"_sub",dt,At,tt))}function lt(){let X=t.addFunction(a+"_millerLoop");X.addParam("ppreP","i32"),X.addParam("ppreQ","i32"),X.addParam("r","i32"),X.addLocal("pCoef","i32"),X.addLocal("i","i32");let _=X.getCodeBuilder(),f=_.getLocal("ppreP"),R=_.i32_add(_.getLocal("ppreP"),_.i32_const(l)),G=_.getLocal("pCoef"),P=_.i32_add(_.getLocal("pCoef"),_.i32_const(s)),Z=_.i32_add(_.getLocal("pCoef"),_.i32_const(2*s)),T=t.alloc(s),D=_.i32_const(T),Y=t.alloc(s),tt=_.i32_const(Y),K=_.getLocal("r");X.addCode(_.call(at+"_one",K),_.setLocal("pCoef",_.i32_add(_.getLocal("ppreQ"),_.i32_const(s*3))),_.setLocal("i",_.i32_const(rt.length-2)),_.block(_.loop(_.call(at+"_square",K,K),_.call(x+"_mul1",P,R,D),_.call(x+"_mul1",Z,f,tt),_.call(a+"__mulBy024",G,D,tt,K),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))),_.if(_.i32_load8_s(_.getLocal("i"),ht),[..._.call(x+"_mul1",P,R,D),..._.call(x+"_mul1",Z,f,tt),..._.call(a+"__mulBy024",G,D,tt,K),..._.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A)))]),_.br_if(1,_.i32_eqz(_.getLocal("i"))),_.setLocal("i",_.i32_sub(_.getLocal("i"),_.i32_const(1))),_.br(0)))),X.addCode(_.call(x+"_mul1",P,R,D),_.call(x+"_mul1",Z,f,tt),_.call(a+"__mulBy024",G,D,tt,K),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))),_.call(x+"_mul1",P,R,D),_.call(x+"_mul1",Z,f,tt),_.call(a+"__mulBy024",G,D,tt,K),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))))}function bt(X){let _=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[8376118865763821496583973867626364092589906065868298776909617916018768340080n,16469823323077808223889137241176536799009286646108169935659301613961712198316n],[21888242871839275220042445260109153167277707414472061641714758635765020556617n,0n],[11697423496358154304825782922584725312912383441159505038794027105778954184319n,303847389135065887422783454877609941456349188919719272345083954437860409601n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3321304630594332808241809054958361220322477375291206261884409189760185844239n,5722266937896532885780051958958348231143373700109372999374820235121374419868n],[21888242871839275222246405745257275088696311157297823662689037894645226208582n,0n],[13512124006075453725662431877630910996106405091429524885779419978626457868503n,5418419548761466998357268504080738289687024511189653727029736280683514010267n],[2203960485148121921418603742825762020974279258880205651966n,0n],[10190819375481120917420622822672549775783927716138318623895010788866272024264n,21584395482704209334823622290379665147239961968378104390343953940207365798982n],[2203960485148121921418603742825762020974279258880205651967n,0n],[18566938241244942414004596690298913868373833782006617400804628704885040364344n,16165975933942742336466353786298926857552937457188450663314217659523851788715n]]],f=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[21575463638280843010398324269430826099269044274347216827212613867836435027261n,10307601595873709700152284273816112264069230130616436755625194854815875713954n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3772000881919853776433695186713858239009073593817195771773381919316419345261n,2236595495967245188281701248203181795121068902605861227855261137820944008926n],[2203960485148121921418603742825762020974279258880205651966n,0n],[18429021223477853657660792034369865839114504446431234726392080002137598044644n,9344045779998320333812420223237981029506012124075525679208581902008406485703n]],[[1n,0n],[2581911344467009335267311115468803099551665605076196740867805258568234346338n,19937756971775647987995932169929341994314640652964949448313374472400716661030n],[2203960485148121921418603742825762020974279258880205651966n,0n],[5324479202449903542726783395506214481928257762400643279780343368557297135718n,16208900380737693084919495127334387981393726419856888799917914180988844123039n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[13981852324922362344252311234282257507216387789820983642040889267519694726527n,7629828391165209371577384193250820201684255241773809077146787135900891633097n]]],R=t.addFunction(a+"__frobeniusMap"+X);R.addParam("x","i32"),R.addParam("r","i32");let G=R.getCodeBuilder();for(let Z=0;Z<6;Z++){let T=Z==0?G.getLocal("x"):G.i32_add(G.getLocal("x"),G.i32_const(Z*s)),D=T,Y=G.i32_add(G.getLocal("x"),G.i32_const(Z*s+l)),tt=Z==0?G.getLocal("r"):G.i32_add(G.getLocal("r"),G.i32_const(Z*s)),K=tt,it=G.i32_add(G.getLocal("r"),G.i32_const(Z*s+l)),mt=P(_[Math.floor(Z/3)][X%12],f[Z%3][X%6]),pt=t.alloc([...Yt.bigInt2BytesLE(O(mt[0]),32),...Yt.bigInt2BytesLE(O(mt[1]),32)]);X%2==1?R.addCode(G.call(p+"_copy",D,K),G.call(p+"_neg",Y,it),G.call(x+"_mul",tt,G.i32_const(pt),tt)):R.addCode(G.call(x+"_mul",T,G.i32_const(pt),tt))}function P(Z,T){let D=BigInt(Z[0]),Y=BigInt(Z[1]),tt=BigInt(T[0]),K=BigInt(T[1]),it=[(D*tt-Y*K)%o,(D*K+Y*tt)%o];return T1(it[0])&&(it[0]=it[0]+o),it}}function Et(){let X=t.addFunction(a+"__finalExponentiationFirstChunk");X.addParam("x","i32"),X.addParam("r","i32");let _=X.getCodeBuilder(),f=_.getLocal("x"),R=f,G=_.i32_add(f,_.i32_const(d*6)),P=_.getLocal("r"),Z=t.alloc(m),T=_.i32_const(Z),D=T,Y=_.i32_const(Z+d*6),tt=_.i32_const(t.alloc(m)),K=_.i32_const(t.alloc(m)),it=_.i32_const(t.alloc(m));X.addCode(_.call(ot+"_copy",R,D),_.call(ot+"_neg",G,Y),_.call(at+"_inverse",f,tt),_.call(at+"_mul",T,tt,K),_.call(a+"__frobeniusMap2",K,it),_.call(at+"_mul",K,it,P))}function It(){let X=t.addFunction(a+"__cyclotomicSquare");X.addParam("x","i32"),X.addParam("r","i32");let _=X.getCodeBuilder(),f=_.getLocal("x"),R=_.i32_add(_.getLocal("x"),_.i32_const(s)),G=_.i32_add(_.getLocal("x"),_.i32_const(2*s)),P=_.i32_add(_.getLocal("x"),_.i32_const(3*s)),Z=_.i32_add(_.getLocal("x"),_.i32_const(4*s)),T=_.i32_add(_.getLocal("x"),_.i32_const(5*s)),D=_.getLocal("r"),Y=_.i32_add(_.getLocal("r"),_.i32_const(s)),tt=_.i32_add(_.getLocal("r"),_.i32_const(2*s)),K=_.i32_add(_.getLocal("r"),_.i32_const(3*s)),it=_.i32_add(_.getLocal("r"),_.i32_const(4*s)),mt=_.i32_add(_.getLocal("r"),_.i32_const(5*s)),pt=_.i32_const(t.alloc(s)),dt=_.i32_const(t.alloc(s)),Ct=_.i32_const(t.alloc(s)),xt=_.i32_const(t.alloc(s)),St=_.i32_const(t.alloc(s)),Bt=_.i32_const(t.alloc(s)),At=_.i32_const(t.alloc(s)),wt=_.i32_const(t.alloc(s));X.addCode(_.call(x+"_mul",f,Z,At),_.call(x+"_mul",Z,_.i32_const(I),pt),_.call(x+"_add",f,pt,pt),_.call(x+"_add",f,Z,wt),_.call(x+"_mul",wt,pt,pt),_.call(x+"_mul",_.i32_const(I),At,wt),_.call(x+"_add",At,wt,wt),_.call(x+"_sub",pt,wt,pt),_.call(x+"_add",At,At,dt),_.call(x+"_mul",P,G,At),_.call(x+"_mul",G,_.i32_const(I),Ct),_.call(x+"_add",P,Ct,Ct),_.call(x+"_add",P,G,wt),_.call(x+"_mul",wt,Ct,Ct),_.call(x+"_mul",_.i32_const(I),At,wt),_.call(x+"_add",At,wt,wt),_.call(x+"_sub",Ct,wt,Ct),_.call(x+"_add",At,At,xt),_.call(x+"_mul",R,T,At),_.call(x+"_mul",T,_.i32_const(I),St),_.call(x+"_add",R,St,St),_.call(x+"_add",R,T,wt),_.call(x+"_mul",wt,St,St),_.call(x+"_mul",_.i32_const(I),At,wt),_.call(x+"_add",At,wt,wt),_.call(x+"_sub",St,wt,St),_.call(x+"_add",At,At,Bt),_.call(x+"_sub",pt,f,D),_.call(x+"_add",D,D,D),_.call(x+"_add",pt,D,D),_.call(x+"_add",dt,Z,it),_.call(x+"_add",it,it,it),_.call(x+"_add",dt,it,it),_.call(x+"_mul",Bt,_.i32_const(nt),wt),_.call(x+"_add",wt,P,K),_.call(x+"_add",K,K,K),_.call(x+"_add",wt,K,K),_.call(x+"_sub",St,G,tt),_.call(x+"_add",tt,tt,tt),_.call(x+"_add",St,tt,tt),_.call(x+"_sub",Ct,R,Y),_.call(x+"_add",Y,Y,Y),_.call(x+"_add",Ct,Y,Y),_.call(x+"_add",xt,T,mt),_.call(x+"_add",mt,mt,mt),_.call(x+"_add",xt,mt,mt))}function zt(X,_){let f=U(X).map(Y=>Y==-1?255:Y),R=t.alloc(f),G=t.addFunction(a+"__cyclotomicExp_"+_);G.addParam("x","i32"),G.addParam("r","i32"),G.addLocal("bit","i32"),G.addLocal("i","i32");let P=G.getCodeBuilder(),Z=P.getLocal("x"),T=P.getLocal("r"),D=P.i32_const(t.alloc(m));G.addCode(P.call(at+"_conjugate",Z,D),P.call(at+"_one",T),P.if(P.teeLocal("bit",P.i32_load8_s(P.i32_const(f.length-1),R)),P.if(P.i32_eq(P.getLocal("bit"),P.i32_const(1)),P.call(at+"_mul",T,Z,T),P.call(at+"_mul",T,D,T))),P.setLocal("i",P.i32_const(f.length-2)),P.block(P.loop(P.call(a+"__cyclotomicSquare",T,T),P.if(P.teeLocal("bit",P.i32_load8_s(P.getLocal("i"),R)),P.if(P.i32_eq(P.getLocal("bit"),P.i32_const(1)),P.call(at+"_mul",T,Z,T),P.call(at+"_mul",T,D,T))),P.br_if(1,P.i32_eqz(P.getLocal("i"))),P.setLocal("i",P.i32_sub(P.getLocal("i"),P.i32_const(1))),P.br(0))))}function Mt(){It(),zt(g,"w0");let X=t.addFunction(a+"__finalExponentiationLastChunk");X.addParam("x","i32"),X.addParam("r","i32");let _=X.getCodeBuilder(),f=_.getLocal("x"),R=_.getLocal("r"),G=_.i32_const(t.alloc(m)),P=_.i32_const(t.alloc(m)),Z=_.i32_const(t.alloc(m)),T=_.i32_const(t.alloc(m)),D=_.i32_const(t.alloc(m)),Y=_.i32_const(t.alloc(m)),tt=_.i32_const(t.alloc(m)),K=_.i32_const(t.alloc(m)),it=_.i32_const(t.alloc(m)),mt=_.i32_const(t.alloc(m)),pt=_.i32_const(t.alloc(m)),dt=_.i32_const(t.alloc(m)),Ct=_.i32_const(t.alloc(m)),xt=_.i32_const(t.alloc(m)),St=_.i32_const(t.alloc(m)),Bt=_.i32_const(t.alloc(m)),At=_.i32_const(t.alloc(m)),wt=_.i32_const(t.alloc(m)),Ot=_.i32_const(t.alloc(m)),Jt=_.i32_const(t.alloc(m)),cn=_.i32_const(t.alloc(m));X.addCode(_.call(a+"__cyclotomicExp_w0",f,G),_.call(at+"_conjugate",G,G),_.call(a+"__cyclotomicSquare",G,P),_.call(a+"__cyclotomicSquare",P,Z),_.call(at+"_mul",Z,P,T),_.call(a+"__cyclotomicExp_w0",T,D),_.call(at+"_conjugate",D,D),_.call(a+"__cyclotomicSquare",D,Y),_.call(a+"__cyclotomicExp_w0",Y,tt),_.call(at+"_conjugate",tt,tt),_.call(at+"_conjugate",T,K),_.call(at+"_conjugate",tt,it),_.call(at+"_mul",it,D,mt),_.call(at+"_mul",mt,K,pt),_.call(at+"_mul",pt,P,dt),_.call(at+"_mul",pt,D,Ct),_.call(at+"_mul",Ct,f,xt),_.call(a+"__frobeniusMap1",dt,St),_.call(at+"_mul",St,xt,Bt),_.call(a+"__frobeniusMap2",pt,At),_.call(at+"_mul",At,Bt,wt),_.call(at+"_conjugate",f,Ot),_.call(at+"_mul",Ot,dt,Jt),_.call(a+"__frobeniusMap3",Jt,cn),_.call(at+"_mul",cn,wt,R))}function kt(){Et(),Mt();let X=t.addFunction(a+"_finalExponentiation");X.addParam("x","i32"),X.addParam("r","i32");let _=X.getCodeBuilder(),f=_.getLocal("x"),R=_.getLocal("r"),G=_.i32_const(t.alloc(m));X.addCode(_.call(a+"__finalExponentiationFirstChunk",f,G),_.call(a+"__finalExponentiationLastChunk",G,R))}function Pt(){let X=t.addFunction(a+"_finalExponentiationOld");X.addParam("x","i32"),X.addParam("r","i32");let f=t.alloc(Yt.bigInt2BytesLE(552484233613224096312617126783173147097382103762957654188882734314196910839907541213974502761540629817009608548654680343627701153829446747810907373256841551006201639677726139946029199968412598804882391702273019083653272047566316584365559776493027495458238373902875937659943504873220554161550525926302303331747463515644711876653177129578303191095900909191624817826566688241804408081892785725967931714097716709526092261278071952560171111444072049229123565057483750161460024353346284167282452756217662335528813519139808291170539072125381230815729071544861602750936964829313608137325426383735122175229541155376346436093930287402089517426973178917569713384748081827255472576937471496195752727188261435633271238710131736096299798168852925540549342330775279877006784354801422249722573783561685179618816480037695005515426162362431072245638324744480n,352)),R=X.getCodeBuilder();X.addCode(R.call(at+"_exp",R.getLocal("x"),R.i32_const(f),R.i32_const(352),R.getLocal("r")))}let qt=t.alloc(z),Rt=t.alloc(E);function Kt(X){let _=t.addFunction(a+"_pairingEq"+X);for(let P=0;P<X;P++)_.addParam("p_"+P,"i32"),_.addParam("q_"+P,"i32");_.addParam("c","i32"),_.setReturnType("i32");let f=_.getCodeBuilder(),R=f.i32_const(t.alloc(m)),G=f.i32_const(t.alloc(m));_.addCode(f.call(at+"_one",R));for(let P=0;P<X;P++)_.addCode(f.call(a+"_prepareG1",f.getLocal("p_"+P),f.i32_const(qt))),_.addCode(f.call(a+"_prepareG2",f.getLocal("q_"+P),f.i32_const(Rt))),_.addCode(f.call(a+"_millerLoop",f.i32_const(qt),f.i32_const(Rt),G)),_.addCode(f.call(at+"_mul",R,G,R));_.addCode(f.call(a+"_finalExponentiation",R,R)),_.addCode(f.call(at+"_eq",R,f.getLocal("c")))}function Ut(){let X=t.addFunction(a+"_pairing");X.addParam("p","i32"),X.addParam("q","i32"),X.addParam("r","i32");let _=X.getCodeBuilder(),f=_.i32_const(t.alloc(m));X.addCode(_.call(a+"_prepareG1",_.getLocal("p"),_.i32_const(qt))),X.addCode(_.call(a+"_prepareG2",_.getLocal("q"),_.i32_const(Rt))),X.addCode(_.call(a+"_millerLoop",_.i32_const(qt),_.i32_const(Rt),f)),X.addCode(_.call(a+"_finalExponentiation",f,_.getLocal("r")))}ct(),ft(),et(),gt(),ut(),yt(),lt();for(let X=0;X<10;X++)bt(X),t.exportFunction(a+"__frobeniusMap"+X);Pt(),kt();for(let X=1;X<=5;X++)Kt(X),t.exportFunction(a+"_pairingEq"+X);Ut(),t.exportFunction(a+"_pairing"),t.exportFunction(a+"_prepareG1"),t.exportFunction(a+"_prepareG2"),t.exportFunction(a+"_millerLoop"),t.exportFunction(a+"_finalExponentiation"),t.exportFunction(a+"_finalExponentiationOld"),t.exportFunction(a+"__mulBy024"),t.exportFunction(a+"__mulBy024Old"),t.exportFunction(a+"__cyclotomicSquare"),t.exportFunction(a+"__cyclotomicExp_w0")},Zt=Na,k1=sl,U1=W2,y2=Q2,N1=X2,w2=H2,Is=D2,$1=K2,Z1=J2,li=Y2,{bitLength:F2,isOdd:C2,isNegative:j1}=Vn,V1=function(t,n){let a=n||"bls12381";if(t.modules[a])return a;let o=0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,e=0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,h=Math.floor((F2(o-1n)-1)/64)+1,d=h*8,b=d,l=b*2,s=b*12,m=Math.floor((F2(e-1n)-1)/64)+1,B=m*8,p=B,v=t.alloc(Zt.bigInt2BytesLE(e,p)),M=k1(t,o,"f1m","intq");U1(t,e,"fr","frm","intr");let x=t.alloc(Zt.bigInt2BytesLE(F(4n),b)),S=w2(t,"g1m","f1m",x);Is(t,"frm","frm","frm","frm_mul"),$1(t,"pol","frm"),Z1(t,"qap","frm");let w=y2(t,"f1m_neg","f2m","f1m"),k=t.alloc([...Zt.bigInt2BytesLE(F(4n),b),...Zt.bigInt2BytesLE(F(4n),b)]),O=w2(t,"g2m","f2m",k);function W(_,f){let R=t.addFunction(_);R.addParam("pG","i32"),R.addParam("pFr","i32"),R.addParam("pr","i32");let G=R.getCodeBuilder(),P=G.i32_const(t.alloc(B));R.addCode(G.call("frm_fromMontgomery",G.getLocal("pFr"),P),G.call(f,G.getLocal("pG"),P,G.i32_const(B),G.getLocal("pr"))),t.exportFunction(_)}W("g1m_timesFr","g1m_timesScalar"),Is(t,"g1m","g1m","frm","g1m_timesFr"),W("g2m_timesFr","g2m_timesScalar"),Is(t,"g2m","g2m","frm","g2m_timesFr"),W("g1m_timesFrAffine","g1m_timesScalarAffine"),W("g2m_timesFrAffine","g2m_timesScalarAffine"),li(t,"frm_batchApplyKey","fmr","frm",B,B,B,"frm_mul"),li(t,"g1m_batchApplyKey","g1m","frm",d*3,d*3,B,"g1m_timesFr"),li(t,"g1m_batchApplyKeyMixed","g1m","frm",d*2,d*3,B,"g1m_timesFrAffine"),li(t,"g2m_batchApplyKey","g2m","frm",d*2*3,d*3*2,B,"g2m_timesFr"),li(t,"g2m_batchApplyKeyMixed","g2m","frm",d*2*2,d*3*2,B,"g2m_timesFrAffine");function F(_){return BigInt(_)*(1n<<BigInt(b*8))%o}let u=[3685416753713387016781088315183077757961620795782546409894578378688607592378376318836054947676345821548104185464507n,1339506544944476473020471379941921221584933875938349620426543736416511423956333506472724655353366534992391756441569n,1n],L=t.alloc([...Zt.bigInt2BytesLE(F(u[0]),b),...Zt.bigInt2BytesLE(F(u[1]),b),...Zt.bigInt2BytesLE(F(u[2]),b)]),$=[0n,1n,0n],Q=t.alloc([...Zt.bigInt2BytesLE(F($[0]),b),...Zt.bigInt2BytesLE(F($[1]),b),...Zt.bigInt2BytesLE(F($[2]),b)]),H=[[352701069587466618187139116011060144890029952792775240219908644239793785735715026873347600343865175952761926303160n,3059144344244213709971259814753781636986470325476647558659373206291635324768958432433509563104347017837885763365758n],[1985150602287291935568054521177171638300868978215655730859378665066344726373823718423869104263333984641494340347905n,927553665492332455747201965776037880757740193453592970025027978793976877002675564980949289727957565575433344219582n],[1n,0n]],q=t.alloc([...Zt.bigInt2BytesLE(F(H[0][0]),b),...Zt.bigInt2BytesLE(F(H[0][1]),b),...Zt.bigInt2BytesLE(F(H[1][0]),b),...Zt.bigInt2BytesLE(F(H[1][1]),b),...Zt.bigInt2BytesLE(F(H[2][0]),b),...Zt.bigInt2BytesLE(F(H[2][1]),b)]),y=[[0n,0n],[1n,0n],[0n,0n]],I=t.alloc([...Zt.bigInt2BytesLE(F(y[0][0]),b),...Zt.bigInt2BytesLE(F(y[0][1]),b),...Zt.bigInt2BytesLE(F(y[1][0]),b),...Zt.bigInt2BytesLE(F(y[1][1]),b),...Zt.bigInt2BytesLE(F(y[2][0]),b),...Zt.bigInt2BytesLE(F(y[2][1]),b)]),N=t.alloc([...Zt.bigInt2BytesLE(F(1n),b),...Zt.bigInt2BytesLE(F(0n),b),...Zt.bigInt2BytesLE(F(0n),b),...Zt.bigInt2BytesLE(F(0n),b),...Zt.bigInt2BytesLE(F(0n),b),...Zt.bigInt2BytesLE(F(0n),b),...Zt.bigInt2BytesLE(F(0n),b),...Zt.bigInt2BytesLE(F(0n),b),...Zt.bigInt2BytesLE(F(0n),b),...Zt.bigInt2BytesLE(F(0n),b),...Zt.bigInt2BytesLE(F(0n),b),...Zt.bigInt2BytesLE(F(0n),b)]),nt=t.alloc([...Zt.bigInt2BytesLE(F(1n),b),...Zt.bigInt2BytesLE(F(1n),b)]);function J(){let _=t.addFunction(w+"_mulNR");_.addParam("x","i32"),_.addParam("pr","i32");let f=_.getCodeBuilder(),R=f.i32_const(t.alloc(b)),G=f.getLocal("x"),P=f.i32_add(f.getLocal("x"),f.i32_const(b)),Z=f.getLocal("pr"),T=f.i32_add(f.getLocal("pr"),f.i32_const(b));_.addCode(f.call(M+"_copy",G,R),f.call(M+"_sub",G,P,Z),f.call(M+"_add",R,P,T))}J();let j=N1(t,w+"_mulNR","f6m","f2m");function ot(){let _=t.addFunction(j+"_mulNR");_.addParam("x","i32"),_.addParam("pr","i32");let f=_.getCodeBuilder(),R=f.i32_const(t.alloc(b*2));_.addCode(f.call(w+"_copy",f.getLocal("x"),R),f.call(w+"_mulNR",f.i32_add(f.getLocal("x"),f.i32_const(d*4)),f.getLocal("pr")),f.call(w+"_copy",f.i32_add(f.getLocal("x"),f.i32_const(d*2)),f.i32_add(f.getLocal("pr"),f.i32_const(d*4))),f.call(w+"_copy",R,f.i32_add(f.getLocal("pr"),f.i32_const(d*2))))}ot();let V=y2(t,j+"_mulNR","ftm",j),Lt=st(0xd201000000010000n),rt=t.alloc(Lt),ht=3*l,A=Lt.length-1,C=Lt.reduce((_,f)=>_+(f!=0?1:0),0)+A+1,r=6*d,z=3*d*2+C*ht,E=!0,g=15132376222941642752n;t.modules[a]={n64q:h,n64r:m,n8q:d,n8r:B,pG1gen:L,pG1zero:Q,pG1b:x,pG2gen:q,pG2zero:I,pG2b:k,pq:t.modules.f1m.pq,pr:v,pOneT:N,r:e,q:o,prePSize:r,preQSize:z};function U(_){let f=_,R=[];for(;f>0n;){if(C2(f)){let G=2-Number(f%4n);R.push(G),f=f-BigInt(G)}else R.push(0);f=f>>1n}return R}function st(_){let f=_,R=[];for(;f>0n;)C2(f)?R.push(1):R.push(0),f=f>>1n;return R}function et(){let _=t.addFunction(a+"_prepareG1");_.addParam("pP","i32"),_.addParam("ppreP","i32");let f=_.getCodeBuilder();_.addCode(f.call(S+"_normalize",f.getLocal("pP"),f.getLocal("ppreP")))}function ct(){let _=t.addFunction(a+"_prepDblStep");_.addParam("R","i32"),_.addParam("r","i32");let f=_.getCodeBuilder(),R=f.getLocal("R"),G=f.i32_add(f.getLocal("R"),f.i32_const(2*d)),P=f.i32_add(f.getLocal("R"),f.i32_const(4*d)),Z=f.getLocal("r"),T=f.i32_add(f.getLocal("r"),f.i32_const(2*d)),D=f.i32_add(f.getLocal("r"),f.i32_const(4*d)),Y=f.i32_const(t.alloc(l)),tt=f.i32_const(t.alloc(l)),K=f.i32_const(t.alloc(l)),it=f.i32_const(t.alloc(l)),mt=f.i32_const(t.alloc(l));_.addCode(f.call(w+"_square",R,Z),f.call(w+"_square",G,tt),f.call(w+"_square",tt,K),f.call(w+"_add",tt,R,T),f.call(w+"_square",T,T),f.call(w+"_sub",T,Z,T),f.call(w+"_sub",T,K,T),f.call(w+"_add",T,T,T),f.call(w+"_add",Z,Z,it),f.call(w+"_add",it,Z,it),f.call(w+"_add",R,it,D),f.call(w+"_square",it,mt),f.call(w+"_square",P,Y),f.call(w+"_sub",mt,T,R),f.call(w+"_sub",R,T,R),f.call(w+"_add",P,G,P),f.call(w+"_square",P,P),f.call(w+"_sub",P,tt,P),f.call(w+"_sub",P,Y,P),f.call(w+"_sub",T,R,G),f.call(w+"_mul",G,it,G),f.call(w+"_add",K,K,K),f.call(w+"_add",K,K,K),f.call(w+"_add",K,K,K),f.call(w+"_sub",G,K,G),f.call(w+"_mul",it,Y,T),f.call(w+"_add",T,T,T),f.call(w+"_neg",T,T),f.call(w+"_square",D,D),f.call(w+"_sub",D,Z,D),f.call(w+"_sub",D,mt,D),f.call(w+"_add",tt,tt,tt),f.call(w+"_add",tt,tt,tt),f.call(w+"_sub",D,tt,D),f.call(w+"_mul",P,Y,Z),f.call(w+"_add",Z,Z,Z))}function ft(){let _=t.addFunction(a+"_prepAddStep");_.addParam("R","i32"),_.addParam("Q","i32"),_.addParam("r","i32");let f=_.getCodeBuilder(),R=f.getLocal("R"),G=f.i32_add(f.getLocal("R"),f.i32_const(2*d)),P=f.i32_add(f.getLocal("R"),f.i32_const(4*d)),Z=f.getLocal("Q"),T=f.i32_add(f.getLocal("Q"),f.i32_const(2*d)),D=f.getLocal("r"),Y=f.i32_add(f.getLocal("r"),f.i32_const(2*d)),tt=f.i32_add(f.getLocal("r"),f.i32_const(4*d)),K=f.i32_const(t.alloc(l)),it=f.i32_const(t.alloc(l)),mt=f.i32_const(t.alloc(l)),pt=f.i32_const(t.alloc(l)),dt=f.i32_const(t.alloc(l)),Ct=f.i32_const(t.alloc(l)),xt=f.i32_const(t.alloc(l)),St=f.i32_const(t.alloc(l)),Bt=f.i32_const(t.alloc(l)),At=f.i32_const(t.alloc(l)),wt=f.i32_const(t.alloc(l));_.addCode(f.call(w+"_square",P,K),f.call(w+"_square",T,it),f.call(w+"_mul",K,Z,pt),f.call(w+"_add",T,P,Y),f.call(w+"_square",Y,Y),f.call(w+"_sub",Y,it,Y),f.call(w+"_sub",Y,K,Y),f.call(w+"_mul",Y,K,Y),f.call(w+"_sub",pt,R,dt),f.call(w+"_square",dt,Ct),f.call(w+"_add",Ct,Ct,xt),f.call(w+"_add",xt,xt,xt),f.call(w+"_mul",xt,dt,St),f.call(w+"_sub",Y,G,Bt),f.call(w+"_sub",Bt,G,Bt),f.call(w+"_mul",Bt,Z,tt),f.call(w+"_mul",xt,R,At),f.call(w+"_square",Bt,R),f.call(w+"_sub",R,St,R),f.call(w+"_sub",R,At,R),f.call(w+"_sub",R,At,R),f.call(w+"_add",P,dt,P),f.call(w+"_square",P,P),f.call(w+"_sub",P,K,P),f.call(w+"_sub",P,Ct,P),f.call(w+"_add",T,P,D),f.call(w+"_sub",At,R,wt),f.call(w+"_mul",wt,Bt,wt),f.call(w+"_mul",G,St,pt),f.call(w+"_add",pt,pt,pt),f.call(w+"_sub",wt,pt,G),f.call(w+"_square",D,D),f.call(w+"_sub",D,it,D),f.call(w+"_square",P,mt),f.call(w+"_sub",D,mt,D),f.call(w+"_add",tt,tt,tt),f.call(w+"_sub",tt,D,tt),f.call(w+"_add",P,P,D),f.call(w+"_neg",Bt,Bt),f.call(w+"_add",Bt,Bt,Y))}function _t(){let _=t.addFunction(a+"_prepareG2");_.addParam("pQ","i32"),_.addParam("ppreQ","i32"),_.addLocal("pCoef","i32"),_.addLocal("i","i32");let f=_.getCodeBuilder(),R=f.getLocal("pQ"),G=t.alloc(l*3),P=f.i32_const(G),Z=f.getLocal("ppreQ");_.addCode(f.call(O+"_normalize",R,Z),f.if(f.call(O+"_isZero",Z),f.ret([])),f.call(O+"_copy",Z,P),f.setLocal("pCoef",f.i32_add(f.getLocal("ppreQ"),f.i32_const(l*3)))),_.addCode(f.setLocal("i",f.i32_const(Lt.length-2)),f.block(f.loop(f.call(a+"_prepDblStep",P,f.getLocal("pCoef")),f.setLocal("pCoef",f.i32_add(f.getLocal("pCoef"),f.i32_const(ht))),f.if(f.i32_load8_s(f.getLocal("i"),rt),[...f.call(a+"_prepAddStep",P,Z,f.getLocal("pCoef")),...f.setLocal("pCoef",f.i32_add(f.getLocal("pCoef"),f.i32_const(ht)))]),f.br_if(1,f.i32_eqz(f.getLocal("i"))),f.setLocal("i",f.i32_sub(f.getLocal("i"),f.i32_const(1))),f.br(0))))}function gt(){let _=t.addFunction(j+"_mul1");_.addParam("pA","i32"),_.addParam("pC1","i32"),_.addParam("pR","i32");let f=_.getCodeBuilder(),R=f.getLocal("pA"),G=f.i32_add(f.getLocal("pA"),f.i32_const(b*2)),P=f.i32_add(f.getLocal("pA"),f.i32_const(b*4)),Z=f.getLocal("pC1"),T=f.getLocal("pR"),D=f.i32_add(f.getLocal("pR"),f.i32_const(b*2)),Y=f.i32_add(f.getLocal("pR"),f.i32_const(b*4)),tt=f.i32_const(t.alloc(b*2)),K=f.i32_const(t.alloc(b*2));_.addCode(f.call(w+"_add",R,G,tt),f.call(w+"_add",G,P,K),f.call(w+"_mul",G,Z,Y),f.call(w+"_mul",K,Z,T),f.call(w+"_sub",T,Y,T),f.call(w+"_mulNR",T,T),f.call(w+"_mul",tt,Z,D),f.call(w+"_sub",D,Y,D))}gt();function yt(){let _=t.addFunction(j+"_mul01");_.addParam("pA","i32"),_.addParam("pC0","i32"),_.addParam("pC1","i32"),_.addParam("pR","i32");let f=_.getCodeBuilder(),R=f.getLocal("pA"),G=f.i32_add(f.getLocal("pA"),f.i32_const(b*2)),P=f.i32_add(f.getLocal("pA"),f.i32_const(b*4)),Z=f.getLocal("pC0"),T=f.getLocal("pC1"),D=f.getLocal("pR"),Y=f.i32_add(f.getLocal("pR"),f.i32_const(b*2)),tt=f.i32_add(f.getLocal("pR"),f.i32_const(b*4)),K=f.i32_const(t.alloc(b*2)),it=f.i32_const(t.alloc(b*2)),mt=f.i32_const(t.alloc(b*2)),pt=f.i32_const(t.alloc(b*2));_.addCode(f.call(w+"_mul",R,Z,K),f.call(w+"_mul",G,T,it),f.call(w+"_add",R,G,mt),f.call(w+"_add",R,P,pt),f.call(w+"_add",G,P,D),f.call(w+"_mul",D,T,D),f.call(w+"_sub",D,it,D),f.call(w+"_mulNR",D,D),f.call(w+"_add",D,K,D),f.call(w+"_add",Z,T,Y),f.call(w+"_mul",Y,mt,Y),f.call(w+"_sub",Y,K,Y),f.call(w+"_sub",Y,it,Y),f.call(w+"_mul",pt,Z,tt),f.call(w+"_sub",tt,K,tt),f.call(w+"_add",tt,it,tt))}yt();function ut(){let _=t.addFunction(V+"_mul014");_.addParam("pA","i32"),_.addParam("pC0","i32"),_.addParam("pC1","i32"),_.addParam("pC4","i32"),_.addParam("pR","i32");let f=_.getCodeBuilder(),R=f.getLocal("pA"),G=f.i32_add(f.getLocal("pA"),f.i32_const(b*6)),P=f.getLocal("pC0"),Z=f.getLocal("pC1"),T=f.getLocal("pC4"),D=f.i32_const(t.alloc(b*6)),Y=f.i32_const(t.alloc(b*6)),tt=f.i32_const(t.alloc(b*2)),K=f.getLocal("pR"),it=f.i32_add(f.getLocal("pR"),f.i32_const(b*6));_.addCode(f.call(j+"_mul01",R,P,Z,D),f.call(j+"_mul1",G,T,Y),f.call(w+"_add",Z,T,tt),f.call(j+"_add",G,R,it),f.call(j+"_mul01",it,P,tt,it),f.call(j+"_sub",it,D,it),f.call(j+"_sub",it,Y,it),f.call(j+"_copy",Y,K),f.call(j+"_mulNR",K,K),f.call(j+"_add",K,D,K))}ut();function lt(){let _=t.addFunction(a+"_ell");_.addParam("pP","i32"),_.addParam("pCoefs","i32"),_.addParam("pF","i32");let f=_.getCodeBuilder(),R=f.getLocal("pP"),G=f.i32_add(f.getLocal("pP"),f.i32_const(d)),P=f.getLocal("pF"),Z=f.getLocal("pCoefs"),T=f.i32_add(f.getLocal("pCoefs"),f.i32_const(b)),D=f.i32_add(f.getLocal("pCoefs"),f.i32_const(b*2)),Y=f.i32_add(f.getLocal("pCoefs"),f.i32_const(b*3)),tt=f.i32_add(f.getLocal("pCoefs"),f.i32_const(b*4)),K=t.alloc(b*2),it=f.i32_const(K),mt=f.i32_const(K),pt=f.i32_const(K+b),dt=t.alloc(b*2),Ct=f.i32_const(dt),xt=f.i32_const(dt),St=f.i32_const(dt+b);_.addCode(f.call(M+"_mul",Z,G,mt),f.call(M+"_mul",T,G,pt),f.call(M+"_mul",D,R,xt),f.call(M+"_mul",Y,R,St),f.call(V+"_mul014",P,tt,Ct,it,P))}lt();function bt(){let _=t.addFunction(a+"_millerLoop");_.addParam("ppreP","i32"),_.addParam("ppreQ","i32"),_.addParam("r","i32"),_.addLocal("pCoef","i32"),_.addLocal("i","i32");let f=_.getCodeBuilder(),R=f.getLocal("ppreP"),G=f.getLocal("pCoef"),P=f.getLocal("r");_.addCode(f.call(V+"_one",P),f.if(f.call(S+"_isZero",R),f.ret([])),f.if(f.call(S+"_isZero",f.getLocal("ppreQ")),f.ret([])),f.setLocal("pCoef",f.i32_add(f.getLocal("ppreQ"),f.i32_const(l*3))),f.setLocal("i",f.i32_const(Lt.length-2)),f.block(f.loop(f.call(a+"_ell",R,G,P),f.setLocal("pCoef",f.i32_add(f.getLocal("pCoef"),f.i32_const(ht))),f.if(f.i32_load8_s(f.getLocal("i"),rt),[...f.call(a+"_ell",R,G,P),...f.setLocal("pCoef",f.i32_add(f.getLocal("pCoef"),f.i32_const(ht)))]),f.call(V+"_square",P,P),f.br_if(1,f.i32_eq(f.getLocal("i"),f.i32_const(1))),f.setLocal("i",f.i32_sub(f.getLocal("i"),f.i32_const(1))),f.br(0))),f.call(a+"_ell",R,G,P)),_.addCode(f.call(V+"_conjugate",P,P))}function Et(_){let f=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n,151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n],[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n,877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n,3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n,3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n]]],R=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0n,4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[0n,1n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[0n,793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n]],[[1n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n]]],G=t.addFunction(V+"_frobeniusMap"+_);G.addParam("x","i32"),G.addParam("r","i32");let P=G.getCodeBuilder();for(let T=0;T<6;T++){let D=T==0?P.getLocal("x"):P.i32_add(P.getLocal("x"),P.i32_const(T*l)),Y=D,tt=P.i32_add(P.getLocal("x"),P.i32_const(T*l+b)),K=T==0?P.getLocal("r"):P.i32_add(P.getLocal("r"),P.i32_const(T*l)),it=K,mt=P.i32_add(P.getLocal("r"),P.i32_const(T*l+b)),pt=Z(f[Math.floor(T/3)][_%12],R[T%3][_%6]),dt=t.alloc([...Zt.bigInt2BytesLE(F(pt[0]),d),...Zt.bigInt2BytesLE(F(pt[1]),d)]);_%2==1?G.addCode(P.call(M+"_copy",Y,it),P.call(M+"_neg",tt,mt),P.call(w+"_mul",K,P.i32_const(dt),K)):G.addCode(P.call(w+"_mul",D,P.i32_const(dt),K))}function Z(T,D){let Y=T[0],tt=T[1],K=D[0],it=D[1],mt=[(Y*K-tt*it)%o,(Y*it+tt*K)%o];return j1(mt[0])&&(mt[0]=mt[0]+o),mt}}function It(){let _=t.addFunction(a+"__cyclotomicSquare");_.addParam("x","i32"),_.addParam("r","i32");let f=_.getCodeBuilder(),R=f.getLocal("x"),G=f.i32_add(f.getLocal("x"),f.i32_const(l)),P=f.i32_add(f.getLocal("x"),f.i32_const(2*l)),Z=f.i32_add(f.getLocal("x"),f.i32_const(3*l)),T=f.i32_add(f.getLocal("x"),f.i32_const(4*l)),D=f.i32_add(f.getLocal("x"),f.i32_const(5*l)),Y=f.getLocal("r"),tt=f.i32_add(f.getLocal("r"),f.i32_const(l)),K=f.i32_add(f.getLocal("r"),f.i32_const(2*l)),it=f.i32_add(f.getLocal("r"),f.i32_const(3*l)),mt=f.i32_add(f.getLocal("r"),f.i32_const(4*l)),pt=f.i32_add(f.getLocal("r"),f.i32_const(5*l)),dt=f.i32_const(t.alloc(l)),Ct=f.i32_const(t.alloc(l)),xt=f.i32_const(t.alloc(l)),St=f.i32_const(t.alloc(l)),Bt=f.i32_const(t.alloc(l)),At=f.i32_const(t.alloc(l)),wt=f.i32_const(t.alloc(l)),Ot=f.i32_const(t.alloc(l));_.addCode(f.call(w+"_mul",R,T,wt),f.call(w+"_mulNR",T,dt),f.call(w+"_add",R,dt,dt),f.call(w+"_add",R,T,Ot),f.call(w+"_mul",Ot,dt,dt),f.call(w+"_mulNR",wt,Ot),f.call(w+"_add",wt,Ot,Ot),f.call(w+"_sub",dt,Ot,dt),f.call(w+"_add",wt,wt,Ct),f.call(w+"_mul",Z,P,wt),f.call(w+"_mulNR",P,xt),f.call(w+"_add",Z,xt,xt),f.call(w+"_add",Z,P,Ot),f.call(w+"_mul",Ot,xt,xt),f.call(w+"_mulNR",wt,Ot),f.call(w+"_add",wt,Ot,Ot),f.call(w+"_sub",xt,Ot,xt),f.call(w+"_add",wt,wt,St),f.call(w+"_mul",G,D,wt),f.call(w+"_mulNR",D,Bt),f.call(w+"_add",G,Bt,Bt),f.call(w+"_add",G,D,Ot),f.call(w+"_mul",Ot,Bt,Bt),f.call(w+"_mulNR",wt,Ot),f.call(w+"_add",wt,Ot,Ot),f.call(w+"_sub",Bt,Ot,Bt),f.call(w+"_add",wt,wt,At),f.call(w+"_sub",dt,R,Y),f.call(w+"_add",Y,Y,Y),f.call(w+"_add",dt,Y,Y),f.call(w+"_add",Ct,T,mt),f.call(w+"_add",mt,mt,mt),f.call(w+"_add",Ct,mt,mt),f.call(w+"_mul",At,f.i32_const(nt),Ot),f.call(w+"_add",Ot,Z,it),f.call(w+"_add",it,it,it),f.call(w+"_add",Ot,it,it),f.call(w+"_sub",Bt,P,K),f.call(w+"_add",K,K,K),f.call(w+"_add",Bt,K,K),f.call(w+"_sub",xt,G,tt),f.call(w+"_add",tt,tt,tt),f.call(w+"_add",xt,tt,tt),f.call(w+"_add",St,D,pt),f.call(w+"_add",pt,pt,pt),f.call(w+"_add",St,pt,pt))}function zt(_,f,R){let G=U(_).map(K=>K==-1?255:K),P=t.alloc(G),Z=t.addFunction(a+"__cyclotomicExp_"+R);Z.addParam("x","i32"),Z.addParam("r","i32"),Z.addLocal("bit","i32"),Z.addLocal("i","i32");let T=Z.getCodeBuilder(),D=T.getLocal("x"),Y=T.getLocal("r"),tt=T.i32_const(t.alloc(s));Z.addCode(T.call(V+"_conjugate",D,tt),T.call(V+"_one",Y),T.if(T.teeLocal("bit",T.i32_load8_s(T.i32_const(G.length-1),P)),T.if(T.i32_eq(T.getLocal("bit"),T.i32_const(1)),T.call(V+"_mul",Y,D,Y),T.call(V+"_mul",Y,tt,Y))),T.setLocal("i",T.i32_const(G.length-2)),T.block(T.loop(T.call(a+"__cyclotomicSquare",Y,Y),T.if(T.teeLocal("bit",T.i32_load8_s(T.getLocal("i"),P)),T.if(T.i32_eq(T.getLocal("bit"),T.i32_const(1)),T.call(V+"_mul",Y,D,Y),T.call(V+"_mul",Y,tt,Y))),T.br_if(1,T.i32_eqz(T.getLocal("i"))),T.setLocal("i",T.i32_sub(T.getLocal("i"),T.i32_const(1))),T.br(0)))),f&&Z.addCode(T.call(V+"_conjugate",Y,Y))}function Mt(){It(),zt(g,E,"w0");let _=t.addFunction(a+"_finalExponentiation");_.addParam("x","i32"),_.addParam("r","i32");let f=_.getCodeBuilder(),R=f.getLocal("x"),G=f.getLocal("r"),P=f.i32_const(t.alloc(s)),Z=f.i32_const(t.alloc(s)),T=f.i32_const(t.alloc(s)),D=f.i32_const(t.alloc(s)),Y=f.i32_const(t.alloc(s)),tt=f.i32_const(t.alloc(s)),K=f.i32_const(t.alloc(s));_.addCode(f.call(V+"_frobeniusMap6",R,P),f.call(V+"_inverse",R,Z),f.call(V+"_mul",P,Z,T),f.call(V+"_copy",T,Z),f.call(V+"_frobeniusMap2",T,T),f.call(V+"_mul",T,Z,T),f.call(a+"__cyclotomicSquare",T,Z),f.call(V+"_conjugate",Z,Z),f.call(a+"__cyclotomicExp_w0",T,D),f.call(a+"__cyclotomicSquare",D,Y),f.call(V+"_mul",Z,D,tt),f.call(a+"__cyclotomicExp_w0",tt,Z),f.call(a+"__cyclotomicExp_w0",Z,P),f.call(a+"__cyclotomicExp_w0",P,K),f.call(V+"_mul",K,Y,K),f.call(a+"__cyclotomicExp_w0",K,Y),f.call(V+"_conjugate",tt,tt),f.call(V+"_mul",Y,tt,Y),f.call(V+"_mul",Y,T,Y),f.call(V+"_conjugate",T,tt),f.call(V+"_mul",Z,T,Z),f.call(V+"_frobeniusMap3",Z,Z),f.call(V+"_mul",K,tt,K),f.call(V+"_frobeniusMap1",K,K),f.call(V+"_mul",D,P,D),f.call(V+"_frobeniusMap2",D,D),f.call(V+"_mul",D,Z,D),f.call(V+"_mul",D,K,D),f.call(V+"_mul",D,Y,G))}function kt(){let _=t.addFunction(a+"_finalExponentiationOld");_.addParam("x","i32"),_.addParam("r","i32");let R=t.alloc(Zt.bigInt2BytesLE(322277361516934140462891564586510139908379969514828494218366688025288661041104682794998680497580008899973249814104447692778988208376779573819485263026159588510513834876303014016798809919343532899164848730280942609956670917565618115867287399623286813270357901731510188149934363360381614501334086825442271920079363289954510565375378443704372994881406797882676971082200626541916413184642520269678897559532260949334760604962086348898118982248842634379637598665468817769075878555493752214492790122785850202957575200176084204422751485957336465472324810982833638490904279282696134323072515220044451592646885410572234451732790590013479358343841220074174848221722017083597872017638514103174122784843925578370430843522959600095676285723737049438346544753168912974976791528535276317256904336520179281145394686565050419250614107803233314658825463117900250701199181529205942363159325765991819433914303908860460720581408201373164047773794825411011922305820065611121544561808414055302212057471395719432072209245600258134364584636810093520285711072578721435517884103526483832733289802426157301542744476740008494780363354305116978805620671467071400711358839553375340724899735460480144599782014906586543813292157922220645089192130209334926661588737007768565838519456601560804957985667880395221049249803753582637708560n,544)),G=_.getCodeBuilder();_.addCode(G.call(V+"_exp",G.getLocal("x"),G.i32_const(R),G.i32_const(544),G.getLocal("r")))}let Pt=t.alloc(r),qt=t.alloc(z);function Rt(_){let f=t.addFunction(a+"_pairingEq"+_);for(let Z=0;Z<_;Z++)f.addParam("p_"+Z,"i32"),f.addParam("q_"+Z,"i32");f.addParam("c","i32"),f.setReturnType("i32");let R=f.getCodeBuilder(),G=R.i32_const(t.alloc(s)),P=R.i32_const(t.alloc(s));f.addCode(R.call(V+"_one",G));for(let Z=0;Z<_;Z++)f.addCode(R.call(a+"_prepareG1",R.getLocal("p_"+Z),R.i32_const(Pt))),f.addCode(R.call(a+"_prepareG2",R.getLocal("q_"+Z),R.i32_const(qt))),f.addCode(R.if(R.i32_eqz(R.call(S+"_inGroupAffine",R.i32_const(Pt))),R.ret(R.i32_const(0))),R.if(R.i32_eqz(R.call(O+"_inGroupAffine",R.i32_const(qt))),R.ret(R.i32_const(0)))),f.addCode(R.call(a+"_millerLoop",R.i32_const(Pt),R.i32_const(qt),P)),f.addCode(R.call(V+"_mul",G,P,G));f.addCode(R.call(a+"_finalExponentiation",G,G)),f.addCode(R.call(V+"_eq",G,R.getLocal("c")))}function Kt(){let _=t.addFunction(a+"_pairing");_.addParam("p","i32"),_.addParam("q","i32"),_.addParam("r","i32");let f=_.getCodeBuilder(),R=f.i32_const(t.alloc(s));_.addCode(f.call(a+"_prepareG1",f.getLocal("p"),f.i32_const(Pt))),_.addCode(f.call(a+"_prepareG2",f.getLocal("q"),f.i32_const(qt))),_.addCode(f.call(a+"_millerLoop",f.i32_const(Pt),f.i32_const(qt),R)),_.addCode(f.call(a+"_finalExponentiation",R,f.getLocal("r")))}function Ut(){let _=t.addFunction(O+"_inGroupAffine");_.addParam("p","i32"),_.setReturnType("i32");let f=_.getCodeBuilder(),R=[2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279894n,2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279893n],G=4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,P=[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],Z=f.i32_const(t.alloc([...Zt.bigInt2BytesLE(F(R[0]),d),...Zt.bigInt2BytesLE(F(R[1]),d)])),T=f.i32_const(t.alloc(Zt.bigInt2BytesLE(F(G),d))),D=f.i32_const(t.alloc([...Zt.bigInt2BytesLE(F(P[0]),d),...Zt.bigInt2BytesLE(F(P[1]),d)])),Y=f.i32_const(t.alloc(Zt.bigInt2BytesLE(g,8))),tt=f.getLocal("p"),K=f.i32_add(f.getLocal("p"),f.i32_const(l)),it=f.i32_const(t.alloc(b)),mt=f.i32_const(t.alloc(l)),pt=f.i32_const(t.alloc(l)),dt=t.alloc(l*2),Ct=f.i32_const(dt),xt=f.i32_const(dt),St=f.i32_const(dt),Bt=f.i32_const(dt+b),At=f.i32_const(dt+l),wt=f.i32_const(dt+l),Ot=f.i32_const(dt+l+b),Jt=t.alloc(l*3),cn=f.i32_const(Jt),oo=f.i32_const(Jt),Nn=f.i32_const(Jt),$n=f.i32_const(Jt+b),io=f.i32_const(Jt+l),Zn=f.i32_const(Jt+l),jn=f.i32_const(Jt+l+b),eo=f.i32_const(Jt+l*2);_.addCode(f.if(f.call(O+"_isZeroAffine",f.getLocal("p")),f.ret(f.i32_const(1))),f.if(f.i32_eqz(f.call(O+"_inCurveAffine",f.getLocal("p"))),f.ret(f.i32_const(0))),f.call(w+"_mul",tt,Z,mt),f.call(w+"_mul",K,Z,pt),f.call(w+"_mul1",mt,T,xt),f.call(w+"_neg",pt,At),f.call(w+"_neg",mt,oo),f.call(w+"_mul",pt,D,io),f.call(M+"_sub",St,Bt,it),f.call(M+"_add",St,Bt,Bt),f.call(M+"_copy",it,St),f.call(M+"_sub",wt,Ot,it),f.call(M+"_add",wt,Ot,Ot),f.call(M+"_copy",it,wt),f.call(M+"_add",Nn,$n,it),f.call(M+"_sub",Nn,$n,$n),f.call(M+"_copy",it,Nn),f.call(M+"_sub",jn,Zn,it),f.call(M+"_add",Zn,jn,jn),f.call(M+"_copy",it,Zn),f.call(w+"_one",eo),f.call(O+"_timesScalar",cn,Y,f.i32_const(8),cn),f.call(O+"_addMixed",cn,Ct,cn),f.ret(f.call(O+"_eqMixed",cn,f.getLocal("p"))));let An=t.addFunction(O+"_inGroup");An.addParam("pIn","i32"),An.setReturnType("i32");let fn=An.getCodeBuilder(),da=fn.i32_const(t.alloc(l*2));An.addCode(fn.call(O+"_toAffine",fn.getLocal("pIn"),da),fn.ret(fn.call(O+"_inGroupAffine",da)))}function X(){let _=t.addFunction(S+"_inGroupAffine");_.addParam("p","i32"),_.setReturnType("i32");let f=_.getCodeBuilder(),R=4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,G=793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,P=(g*g-1n)/3n,Z=f.i32_const(t.alloc(Zt.bigInt2BytesLE(F(R),d))),T=f.i32_const(t.alloc(Zt.bigInt2BytesLE(F(G),d))),D=f.i32_const(t.alloc(Zt.bigInt2BytesLE(P,16))),Y=f.getLocal("p"),tt=f.i32_add(f.getLocal("p"),f.i32_const(b)),K=t.alloc(b*3),it=f.i32_const(K),mt=f.i32_const(K),pt=f.i32_const(K+b),dt=t.alloc(b*2),Ct=f.i32_const(dt),xt=f.i32_const(dt),St=f.i32_const(dt+b);_.addCode(f.if(f.call(S+"_isZeroAffine",f.getLocal("p")),f.ret(f.i32_const(1))),f.if(f.i32_eqz(f.call(S+"_inCurveAffine",f.getLocal("p"))),f.ret(f.i32_const(0))),f.call(M+"_mul",Y,Z,mt),f.call(M+"_copy",tt,pt),f.call(M+"_mul",Y,T,xt),f.call(M+"_copy",tt,St),f.call(S+"_doubleAffine",it,it),f.call(S+"_subMixed",it,f.getLocal("p"),it),f.call(S+"_subMixed",it,Ct,it),f.call(S+"_timesScalar",it,D,f.i32_const(16),it),f.ret(f.call(S+"_eqMixed",it,Ct)));let Bt=t.addFunction(S+"_inGroup");Bt.addParam("pIn","i32"),Bt.setReturnType("i32");let At=Bt.getCodeBuilder(),wt=At.i32_const(t.alloc(b*2));Bt.addCode(At.call(S+"_toAffine",At.getLocal("pIn"),wt),At.ret(At.call(S+"_inGroupAffine",wt)))}for(let _=0;_<10;_++)Et(_),t.exportFunction(V+"_frobeniusMap"+_);X(),Ut(),ft(),ct(),et(),_t(),bt(),kt(),Mt();for(let _=1;_<=5;_++)Rt(_),t.exportFunction(a+"_pairingEq"+_);Kt(),t.exportFunction(a+"_pairing"),t.exportFunction(a+"_prepareG1"),t.exportFunction(a+"_prepareG2"),t.exportFunction(a+"_millerLoop"),t.exportFunction(a+"_finalExponentiation"),t.exportFunction(a+"_finalExponentiationOld"),t.exportFunction(a+"__cyclotomicSquare"),t.exportFunction(a+"__cyclotomicExp_w0"),t.exportFunction(j+"_mul1"),t.exportFunction(j+"_mul01"),t.exportFunction(V+"_mul014"),t.exportFunction(S+"_inGroupAffine"),t.exportFunction(S+"_inGroup"),t.exportFunction(O+"_inGroupAffine"),t.exportFunction(O+"_inGroup")},W1=G1,Q1=V1;ui=[];for(let c=0;c<256;c++)ui[c]=K1(c,8);J1=Object.freeze({__proto__:null,array2buffer:ll,beBuff2int:X1,beInt2Buff:H1,bitReverse:nu,buffReverseBits:au,buffer2array:Te,leBuff2int:D1,leInt2Buff:tu,log2:Jn,stringifyBigInts:Zs,stringifyFElements:Vs,unstringifyBigInts:js,unstringifyFElements:Ws}),On=1<<30,gn=class c{constructor(t){this.buffers=[],this.byteLength=t;for(let n=0;n<t;n+=On){let a=Math.min(t-n,On);this.buffers.push(new Uint8Array(a))}}slice(t,n){n===void 0&&(n=this.byteLength),t===void 0&&(t=0);let a=n-t,o=Math.floor(t/On),e=Math.floor((t+a-1)/On);if(o==e||a==0)return this.buffers[o].slice(t%On,t%On+a);let h,d=o,b=t%On,l=a;for(;l>0;){let s=b+l>On?On-b:l,m=new Uint8Array(this.buffers[d].buffer,this.buffers[d].byteOffset+b,s);if(s==a)return m.slice();h||(a<=On?h=new Uint8Array(a):h=new c(a)),h.set(m,a-l),l=l-s,d++,b=0}return h}set(t,n){n===void 0&&(n=0);let a=t.byteLength;if(a==0)return;let o=Math.floor(n/On),e=Math.floor((n+a-1)/On);if(o==e)return t instanceof c&&t.buffers.length==1?this.buffers[o].set(t.buffers[0],n%On):this.buffers[o].set(t,n%On);let h=o,d=n%On,b=a;for(;b>0;){let l=d+b>On?On-d:b,s=t.slice(a-b,a-b+l);new Uint8Array(this.buffers[h].buffer,this.buffers[h].byteOffset+d,l).set(s),b=b-l,h++,d=0}}};Ge=class{constructor(t,n,a,o){if(this.tm=t,this.prefix=n,this.p=o,this.n8=a,this.type="F1",this.m=1,this.half=Fo(o,co),this.bitLength=fi(o),this.mask=Sa(Ie(co,this.bitLength),co),this.pOp1=t.alloc(a),this.pOp2=t.alloc(a),this.pOp3=t.alloc(a),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(a/8),this.n32=Math.floor(a/4),this.n64*8!=this.n8)throw new Error("n8 must be a multiple of 8");this.half=Fo(this.p,co),this.nqr=this.two;let e=this.exp(this.nqr,this.half);for(;!this.eq(e,this.negone);)this.nqr=this.add(this.nqr,this.one),e=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let h=Sa(this.p,co);for(;!Ys(h);)this.s=this.s+1,h=Fo(h,co);this.w=[],this.w[this.s]=this.exp(this.nqr,h);for(let d=this.s-1;d>=0;d--)this.w[d]=this.square(this.w[d+1]);if(!this.eq(this.w[0],this.one))throw new Error("Error calculating roots of unity");this.batchToMontgomery=Ua(t,n+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=Ua(t,n+"_batchFromMontgomery",this.n8,this.n8)}op2(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){return this.op2("_add",t,n)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=Bo(mn(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,n){if(t instanceof Uint8Array)return t;let a=mn(t,n);v2(a)?(a=O2(a),Oe(a,this.p)&&(a=ba(a,this.p)),a=Sa(this.p,a)):Oe(a,this.p)&&(a=ba(a,this.p));let o=tu(a,this.n8);return this.toMontgomery(o)}toString(t,n){let a=this.fromMontgomery(t),o=hi(a,0);return Ve(o,n)}fromRng(t){let n,a=new Uint8Array(this.n8);do{n=T2;for(let o=0;o<this.n64;o++)n=tl(n,Ie(t.nextU64(),64*o));n=nl(n,this.mask)}while(M2(n,this.p));return _i(a,0,n,this.n8),a}random(){return this.fromRng(al())}toObject(t){let n=this.fromMontgomery(t);return hi(n,0)}fromObject(t){let n=new Uint8Array(this.n8);return _i(n,0,t,this.n8),this.toMontgomery(n)}toRprLE(t,n,a){t.set(this.fromMontgomery(a),n)}toRprBE(t,n,a){let o=this.fromMontgomery(a);for(let e=0;e<this.n8/2;e++){let h=o[e];o[e]=o[this.n8-1-e],o[this.n8-1-e]=h}t.set(o,n)}fromRprLE(t,n){n=n||0;let a=t.slice(n,n+this.n8);return this.toMontgomery(a)}async batchInverse(t){let n=!1,a=this.n8,o=this.n8;Array.isArray(t)?(t=ll(t,a),n=!0):t=t.slice(0,t.byteLength);let e=Math.floor(t.byteLength/a);if(e*a!==t.byteLength)throw new Error("Invalid buffer size");let h=Math.floor(e/this.tm.concurrency),d=[];for(let m=0;m<this.tm.concurrency;m++){let B;if(m<this.tm.concurrency-1?B=h:B=e-m*h,B==0)continue;let v=[{cmd:"ALLOCSET",var:0,buff:t.slice(m*h*a,m*h*a+B*a)},{cmd:"ALLOC",var:1,len:o*B},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:a},{val:B},{var:1},{val:o}]},{cmd:"GET",out:0,var:1,len:o*B}];d.push(this.tm.queueAction(v))}let b=await Promise.all(d),l;t instanceof gn?l=new gn(e*o):l=new Uint8Array(e*o);let s=0;for(let m=0;m<b.length;m++)l.set(b[m][0],s),s+=b[m][0].byteLength;return n?Te(l,o):l}},ke=class{constructor(t,n,a){this.tm=t,this.prefix=n,this.F=a,this.type="F2",this.m=a.m*2,this.n8=this.F.n8*2,this.n32=this.F.n32*2,this.n64=this.F.n64*2,this.pOp1=t.alloc(a.n8*2),this.pOp2=t.alloc(a.n8*2),this.pOp3=t.alloc(a.n8*2),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){return this.op2("_add",t,n)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}mul1(t,n){return this.op2("_mul1",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=Bo(mn(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,n){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&t.length==2){let a=this.F.e(t[0],n),o=this.F.e(t[1],n),e=new Uint8Array(this.F.n8*2);return e.set(a),e.set(o,this.F.n8*2),e}else throw new Error("invalid F2")}toString(t,n){let a=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8),n);return`[${a}, ${o}]`}fromRng(t){let n=this.F.fromRng(t),a=this.F.fromRng(t),o=new Uint8Array(this.F.n8*2);return o.set(n),o.set(a,this.F.n8),o}random(){return this.fromRng(al())}toObject(t){let n=this.F.toObject(t.slice(0,this.F.n8)),a=this.F.toObject(t.slice(this.F.n8,this.F.n8*2));return[n,a]}fromObject(t){let n=new Uint8Array(this.F.n8*2),a=this.F.fromObject(t[0]),o=this.F.fromObject(t[1]);return n.set(a),n.set(o,this.F.n8),n}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}},Qs=class{constructor(t,n,a){this.tm=t,this.prefix=n,this.F=a,this.type="F3",this.m=a.m*3,this.n8=this.F.n8*3,this.n32=this.F.n32*3,this.n64=this.F.n64*3,this.pOp1=t.alloc(a.n8*3),this.pOp2=t.alloc(a.n8*3),this.pOp3=t.alloc(a.n8*3),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}add(t,n){return this.op2("_add",t,n)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=Bo(mn(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,n){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&t.length==3){let a=this.F.e(t[0],n),o=this.F.e(t[1],n),e=this.F.e(t[2],n),h=new Uint8Array(this.F.n8*3);return h.set(a),h.set(o,this.F.n8),h.set(e,this.F.n8*2),h}else throw new Error("invalid F3")}toString(t,n){let a=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8,this.F.n8*2),n),e=this.F.toString(t.slice(this.F.n8*2),n);return`[${a}, ${o}, ${e}]`}fromRng(t){let n=this.F.fromRng(t),a=this.F.fromRng(t),o=this.F.fromRng(t),e=new Uint8Array(this.F.n8*3);return e.set(n),e.set(a,this.F.n8),e.set(o,this.F.n8*2),e}random(){return this.fromRng(al())}toObject(t){let n=this.F.toObject(t.slice(0,this.F.n8)),a=this.F.toObject(t.slice(this.F.n8,this.F.n8*2)),o=this.F.toObject(t.slice(this.F.n8*2,this.F.n8*3));return[n,a,o]}fromObject(t){let n=new Uint8Array(this.F.n8*3),a=this.F.fromObject(t[0]),o=this.F.fromObject(t[1]),e=this.F.fromObject(t[2]);return n.set(a),n.set(o,this.F.n8),n.set(e,this.F.n8*2),n}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,this.F.n8*2)}c3(t){return t.slice(this.F.n8*2)}},Ue=class{constructor(t,n,a,o,e,h){this.tm=t,this.prefix=n,this.F=a,this.pOp1=t.alloc(a.n8*3),this.pOp2=t.alloc(a.n8*3),this.pOp3=t.alloc(a.n8*3),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,a.n8*3),this.tm.instance.exports[n+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,a.n8*2),this.one=this.tm.getBuff(o,a.n8*3),this.g=this.one,this.oneAffine=this.tm.getBuff(o,a.n8*2),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(e,a.n8),h&&(this.cofactor=Bo(h)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=Ua(t,n+"_batchLEMtoC",a.n8*2,a.n8),this.batchLEMtoU=Ua(t,n+"_batchLEMtoU",a.n8*2,a.n8*2),this.batchCtoLEM=Ua(t,n+"_batchCtoLEM",a.n8,a.n8*2),this.batchUtoLEM=Ua(t,n+"_batchUtoLEM",a.n8*2,a.n8*2),this.batchToJacobian=Ua(t,n+"_batchToJacobian",a.n8*2,a.n8*3),this.batchToAffine=Ua(t,n+"_batchToAffine",a.n8*3,a.n8*2)}op2(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}op2bool(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}op1Affine(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*2)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2("_add",t,n);if(n.byteLength==this.F.n8*2)return this.op2("_addMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2("_addMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2("_addAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}sub(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2("_sub",t,n);if(n.byteLength==this.F.n8*2)return this.op2("_subMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2("_subMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2("_subAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}neg(t){if(t.byteLength==this.F.n8*3)return this.op1("_neg",t);if(t.byteLength==this.F.n8*2)return this.op1Affine("_negAffine",t);throw new Error("invalid point size")}double(t){if(t.byteLength==this.F.n8*3)return this.op1("_double",t);if(t.byteLength==this.F.n8*2)return this.op1("_doubleAffine",t);throw new Error("invalid point size")}isZero(t){if(t.byteLength==this.F.n8*3)return this.op1Bool("_isZero",t);if(t.byteLength==this.F.n8*2)return this.op1Bool("_isZeroAffine",t);throw new Error("invalid point size")}timesScalar(t,n){n instanceof Uint8Array||(n=Bo(mn(n)));let a;if(t.byteLength==this.F.n8*3)a=this.prefix+"_timesScalar";else if(t.byteLength==this.F.n8*2)a=this.prefix+"_timesScalarAffine";else throw new Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[a](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}timesFr(t,n){let a;if(t.byteLength==this.F.n8*3)a=this.prefix+"_timesFr";else if(t.byteLength==this.F.n8*2)a=this.prefix+"_timesFrAffine";else throw new Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[a](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}eq(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2bool("_eq",t,n);if(n.byteLength==this.F.n8*2)return this.op2bool("_eqMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2bool("_eqMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2bool("_eqAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}toAffine(t){if(t.byteLength==this.F.n8*3)return this.op1Affine("_toAffine",t);if(t.byteLength==this.F.n8*2)return t;throw new Error("invalid point size")}toJacobian(t){if(t.byteLength==this.F.n8*3)return t;if(t.byteLength==this.F.n8*2)return this.op1("_toJacobian",t);throw new Error("invalid point size")}toRprUncompressed(t,n,a){if(this.tm.setBuff(this.pOp1,a),a.byteLength==this.F.n8*3)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(a.byteLength!=this.F.n8*2)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);let o=this.tm.getBuff(this.pOp1,this.F.n8*2);t.set(o,n)}fromRprUncompressed(t,n){let a=t.slice(n,n+this.F.n8*2);return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,this.F.n8*2)}toRprCompressed(t,n,a){if(this.tm.setBuff(this.pOp1,a),a.byteLength==this.F.n8*3)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(a.byteLength!=this.F.n8*2)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);let o=this.tm.getBuff(this.pOp1,this.F.n8);t.set(o,n)}fromRprCompressed(t,n){let a=t.slice(n,n+this.F.n8);return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,this.F.n8*2)}toUncompressed(t){let n=new Uint8Array(this.F.n8*2);return this.toRprUncompressed(n,0,t),n}toRprLEM(t,n,a){if(a.byteLength==this.F.n8*2){t.set(a,n);return}else if(a.byteLength==this.F.n8*3){this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);let o=this.tm.getBuff(this.pOp1,this.F.n8*2);t.set(o,n)}else throw new Error("invalid point size")}fromRprLEM(t,n){return n=n||0,t.slice(n,n+this.F.n8*2)}toString(t,n){if(t.byteLength==this.F.n8*3){let a=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8,this.F.n8*2),n),e=this.F.toString(t.slice(this.F.n8*2),n);return`[ ${a}, ${o}, ${e} ]`}else if(t.byteLength==this.F.n8*2){let a=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8),n);return`[ ${a}, ${o} ]`}else throw new Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;let n=this.F,a=this.toAffine(t),o=a.slice(0,this.F.n8),e=a.slice(this.F.n8,this.F.n8*2),h=n.add(n.mul(n.square(o),o),this.b),d=n.square(e);return n.eq(h,d)}fromRng(t){let n=this.F,a=[],o,e;do a[0]=n.fromRng(t),o=t.nextBool(),e=n.add(n.mul(n.square(a[0]),a[0]),this.b);while(!n.isSquare(e));a[1]=n.sqrt(e);let h=n.isNegative(a[1]);o^h&&(a[1]=n.neg(a[1]));let d=new Uint8Array(this.F.n8*2);return d.set(a[0]),d.set(a[1],this.F.n8),this.cofactor&&(d=this.timesScalar(d,this.cofactor)),d}toObject(t){if(this.isZero(t))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];let n=this.F.toObject(t.slice(0,this.F.n8)),a=this.F.toObject(t.slice(this.F.n8,this.F.n8*2)),o;return t.byteLength==this.F.n8*3?o=this.F.toObject(t.slice(this.F.n8*2,this.F.n8*3)):o=this.F.toObject(this.F.one),[n,a,o]}fromObject(t){let n=this.F.fromObject(t[0]),a=this.F.fromObject(t[1]),o;if(t.length==3?o=this.F.fromObject(t[2]):o=this.F.one,this.F.isZero(o,this.F.one))return this.zeroAffine;if(this.F.eq(o,this.F.one)){let e=new Uint8Array(this.F.n8*2);return e.set(n),e.set(a,this.F.n8),e}else{let e=new Uint8Array(this.F.n8*3);return e.set(n),e.set(a,this.F.n8),e.set(o,this.F.n8*2),e}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){return this.toAffine(t).slice(0,this.F.n8)}y(t){return this.toAffine(t).slice(this.F.n8)}};Os=25,Ne=class{constructor(){this.promise=new Promise((t,n)=>{this.reject=n,this.resolve=t})}};B2=`(function thread(self) {
    const MAXMEM = 32767;
    let instance;
    let memory;

    if (self) {
        self.onmessage = function(e) {
            let data;
            if (e.data) {
                data = e.data;
            } else {
                data = e;
            }

            if (data[0].cmd == "INIT") {
                init(data[0]).then(function() {
                    self.postMessage(data.result);
                });
            } else if (data[0].cmd == "TERMINATE") {
                self.close();
            } else {
                const res = runTask(data);
                self.postMessage(res);
            }
        };
    }

    async function init(data) {
        const code = new Uint8Array(data.code);
        const wasmModule = await WebAssembly.compile(code);
        memory = new WebAssembly.Memory({initial:data.init, maximum: MAXMEM});

        instance = await WebAssembly.instantiate(wasmModule, {
            env: {
                "memory": memory
            }
        });
    }



    function alloc(length) {
        const u32 = new Uint32Array(memory.buffer, 0, 1);
        while (u32[0] & 3) u32[0]++;  // Return always aligned pointers
        const res = u32[0];
        u32[0] += length;
        if (u32[0] + length > memory.buffer.byteLength) {
            const currentPages = memory.buffer.byteLength / 0x10000;
            let requiredPages = Math.floor((u32[0] + length) / 0x10000)+1;
            if (requiredPages>MAXMEM) requiredPages=MAXMEM;
            memory.grow(requiredPages-currentPages);
        }
        return res;
    }

    function allocBuffer(buffer) {
        const p = alloc(buffer.byteLength);
        setBuffer(p, buffer);
        return p;
    }

    function getBuffer(pointer, length) {
        const u8 = new Uint8Array(memory.buffer);
        return new Uint8Array(u8.buffer, u8.byteOffset + pointer, length);
    }

    function setBuffer(pointer, buffer) {
        const u8 = new Uint8Array(memory.buffer);
        u8.set(new Uint8Array(buffer), pointer);
    }

    function runTask(task) {
        if (task[0].cmd == "INIT") {
            return init(task[0]);
        }
        const ctx = {
            vars: [],
            out: []
        };
        const u32a = new Uint32Array(memory.buffer, 0, 1);
        const oldAlloc = u32a[0];
        for (let i=0; i<task.length; i++) {
            switch (task[i].cmd) {
            case "ALLOCSET":
                ctx.vars[task[i].var] = allocBuffer(task[i].buff);
                break;
            case "ALLOC":
                ctx.vars[task[i].var] = alloc(task[i].len);
                break;
            case "SET":
                setBuffer(ctx.vars[task[i].var], task[i].buff);
                break;
            case "CALL": {
                const params = [];
                for (let j=0; j<task[i].params.length; j++) {
                    const p = task[i].params[j];
                    if (typeof p.var !== "undefined") {
                        params.push(ctx.vars[p.var] + (p.offset || 0));
                    } else if (typeof p.val != "undefined") {
                        params.push(p.val);
                    }
                }
                instance.exports[task[i].fnName](...params);
                break;
            }
            case "GET":
                ctx.out[task[i].out] = getBuffer(ctx.vars[task[i].var], task[i].len).slice();
                break;
            default:
                throw new Error("Invalid cmd");
            }
        }
        const u32b = new Uint32Array(memory.buffer, 0, 1);
        u32b[0] = oldAlloc;
        return ctx.out;
    }


    return runTask;
})(self)`;if(globalThis?.Blob){let c=new TextEncoder().encode(B2),t=new Blob([c],{type:"application/javascript"});Xs=URL.createObjectURL(t)}else Xs="data:application/javascript;base64,"+globalThis.btoa(B2);Hs=class{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(this.oldPFree!=0)throw new Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(this.oldPFree==0)throw new Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,n,a,o){if(this.working[t])throw new Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=o||new Ne,this.workers[t].postMessage(n,a),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(this.working[t]==!1){let n=this.actionQueue.shift();this.postAction(t,n.data,n.transfers,n.deferred)}}queueAction(t,n){let a=new Ne;if(this.singleThread){let o=this.taskManager(t);a.resolve(o)}else this.actionQueue.push({data:t,transfers:n,deferred:a}),this.processWorks();return a.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){let n=this.alloc(t.byteLength);return this.setBuff(n,t),n}getBuff(t,n){return this.u8.slice(t,t+n)}setBuff(t,n){this.u8.set(new Uint8Array(n),t)}alloc(t){for(;this.u32[0]&3;)this.u32[0]++;let n=this.u32[0];return this.u32[0]+=t,n}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);await tg(200)}};x2=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];Ks=class{constructor(t){this.func=t,this.functionName=t.functionName,this.module=t.module}setLocal(t,n){let a=this.func.localIdxByName[t];if(a===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...n,33,...jt(a)]}teeLocal(t,n){let a=this.func.localIdxByName[t];if(a===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...n,34,...jt(a)]}getLocal(t){let n=this.func.localIdxByName[t];if(n===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[32,...jt(n)]}i64_load8_s(t,n,a){let o=n||0,e=a===void 0?0:a;return[...t,48,e,...jt(o)]}i64_load8_u(t,n,a){let o=n||0,e=a===void 0?0:a;return[...t,49,e,...jt(o)]}i64_load16_s(t,n,a){let o=n||0,e=a===void 0?1:a;return[...t,50,e,...jt(o)]}i64_load16_u(t,n,a){let o=n||0,e=a===void 0?1:a;return[...t,51,e,...jt(o)]}i64_load32_s(t,n,a){let o=n||0,e=a===void 0?2:a;return[...t,52,e,...jt(o)]}i64_load32_u(t,n,a){let o=n||0,e=a===void 0?2:a;return[...t,53,e,...jt(o)]}i64_load(t,n,a){let o=n||0,e=a===void 0?3:a;return[...t,41,e,...jt(o)]}i64_store(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=3,d=n):Array.isArray(a)?(e=n,h=3,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,55,h,...jt(e)]}i64_store32(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=2,d=n):Array.isArray(a)?(e=n,h=2,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,62,h,...jt(e)]}i64_store16(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=1,d=n):Array.isArray(a)?(e=n,h=1,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,61,h,...jt(e)]}i64_store8(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=0,d=n):Array.isArray(a)?(e=n,h=0,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,60,h,...jt(e)]}i32_load8_s(t,n,a){let o=n||0,e=a===void 0?0:a;return[...t,44,e,...jt(o)]}i32_load8_u(t,n,a){let o=n||0,e=a===void 0?0:a;return[...t,45,e,...jt(o)]}i32_load16_s(t,n,a){let o=n||0,e=a===void 0?1:a;return[...t,46,e,...jt(o)]}i32_load16_u(t,n,a){let o=n||0,e=a===void 0?1:a;return[...t,47,e,...jt(o)]}i32_load(t,n,a){let o=n||0,e=a===void 0?2:a;return[...t,40,e,...jt(o)]}i32_store(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=2,d=n):Array.isArray(a)?(e=n,h=2,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,54,h,...jt(e)]}i32_store16(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=1,d=n):Array.isArray(a)?(e=n,h=1,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,59,h,...jt(e)]}i32_store8(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=0,d=n):Array.isArray(a)?(e=n,h=0,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,58,h,...jt(e)]}call(t,...n){let a=this.module.functionIdxByName[t];if(a===void 0)throw new Error(`Function not defined: Function: ${t}`);return[...[].concat(...n),16,...jt(a)]}call_indirect(t,...n){return[...[].concat(...n),...t,17,0,0]}if(t,n,a){return a?[...t,4,64,...n,5,...a,11]:[...t,4,64,...n,11]}block(t){return[2,64,...t,11]}loop(...t){return[3,64,...[].concat(...t),11]}br_if(t,n){return[...n,13,...jt(t)]}br(t){return[12,...jt(t)]}ret(t){return[...t,15]}drop(t){return[...t,26]}i64_const(t){return[66,...cg(t)]}i32_const(t){return[65,...Ds(t)]}i64_eqz(t){return[...t,80]}i64_eq(t,n){return[...t,...n,81]}i64_ne(t,n){return[...t,...n,82]}i64_lt_s(t,n){return[...t,...n,83]}i64_lt_u(t,n){return[...t,...n,84]}i64_gt_s(t,n){return[...t,...n,85]}i64_gt_u(t,n){return[...t,...n,86]}i64_le_s(t,n){return[...t,...n,87]}i64_le_u(t,n){return[...t,...n,88]}i64_ge_s(t,n){return[...t,...n,89]}i64_ge_u(t,n){return[...t,...n,90]}i64_add(t,n){return[...t,...n,124]}i64_sub(t,n){return[...t,...n,125]}i64_mul(t,n){return[...t,...n,126]}i64_div_s(t,n){return[...t,...n,127]}i64_div_u(t,n){return[...t,...n,128]}i64_rem_s(t,n){return[...t,...n,129]}i64_rem_u(t,n){return[...t,...n,130]}i64_and(t,n){return[...t,...n,131]}i64_or(t,n){return[...t,...n,132]}i64_xor(t,n){return[...t,...n,133]}i64_shl(t,n){return[...t,...n,134]}i64_shr_s(t,n){return[...t,...n,135]}i64_shr_u(t,n){return[...t,...n,136]}i64_extend_i32_s(t){return[...t,172]}i64_extend_i32_u(t){return[...t,173]}i64_clz(t){return[...t,121]}i64_ctz(t){return[...t,122]}i32_eqz(t){return[...t,69]}i32_eq(t,n){return[...t,...n,70]}i32_ne(t,n){return[...t,...n,71]}i32_lt_s(t,n){return[...t,...n,72]}i32_lt_u(t,n){return[...t,...n,73]}i32_gt_s(t,n){return[...t,...n,74]}i32_gt_u(t,n){return[...t,...n,75]}i32_le_s(t,n){return[...t,...n,76]}i32_le_u(t,n){return[...t,...n,77]}i32_ge_s(t,n){return[...t,...n,78]}i32_ge_u(t,n){return[...t,...n,79]}i32_add(t,n){return[...t,...n,106]}i32_sub(t,n){return[...t,...n,107]}i32_mul(t,n){return[...t,...n,108]}i32_div_s(t,n){return[...t,...n,109]}i32_div_u(t,n){return[...t,...n,110]}i32_rem_s(t,n){return[...t,...n,111]}i32_rem_u(t,n){return[...t,...n,112]}i32_and(t,n){return[...t,...n,113]}i32_or(t,n){return[...t,...n,114]}i32_xor(t,n){return[...t,...n,115]}i32_shl(t,n){return[...t,...n,116]}i32_shr_s(t,n){return[...t,...n,117]}i32_shr_u(t,n){return[...t,...n,118]}i32_rotl(t,n){return[...t,...n,119]}i32_rotr(t,n){return[...t,...n,120]}i32_wrap_i64(t){return[...t,167]}i32_clz(t){return[...t,103]}i32_ctz(t){return[...t,104]}unreachable(){return[0]}current_memory(){return[63,0]}comment(){return[]}},zs={i32:127,i64:126,f32:125,f64:124,anyfunc:112,func:96,emptyblock:64},$e=class{constructor(t,n,a,o,e){if(a=="import")this.fnType="import",this.moduleName=o,this.fieldName=e;else if(a=="internal")this.fnType="internal";else throw new Error("Invalid function fnType: "+a);this.module=t,this.fnName=n,this.params=[],this.locals=[],this.localIdxByName={},this.code=[],this.returnType=null,this.nextLocal=0}addParam(t,n){if(this.localIdxByName[t])throw new Error(`param already exists. Function: ${this.fnName}, Param: ${t} `);let a=this.nextLocal++;this.localIdxByName[t]=a,this.params.push({type:n})}addLocal(t,n,a){let o=a||1;if(this.localIdxByName[t])throw new Error(`local already exists. Function: ${this.fnName}, Param: ${t} `);let e=this.nextLocal++;this.localIdxByName[t]=e,this.locals.push({type:n,length:o})}setReturnType(t){if(this.returnType)throw new Error(`returnType already defined. Function: ${this.fnName}`);this.returnType=t}getSignature(){let t=[...jt(this.params.length),...this.params.map(a=>zs[a.type])],n=this.returnType?[1,zs[this.returnType]]:[0];return[96,...t,...n]}getBody(){let t=this.locals.map(a=>[...jt(a.length),zs[a.type]]),n=[...jt(this.locals.length),...[].concat(...t),...this.code,11];return[...jt(n.length),...n]}addCode(...t){this.code.push(...[].concat(...t))}getCodeBuilder(){return new Ks(this)}},Ze=class{constructor(){this.functions=[],this.functionIdxByName={},this.nImportFunctions=0,this.nInternalFunctions=0,this.memory={pagesSize:1,moduleName:"env",fieldName:"memory"},this.free=8,this.datas=[],this.modules={},this.exports=[],this.functionsTable=[]}build(){return this._setSignatures(),new Uint8Array([...Rs(1836278016),...Rs(1),...this._buildType(),...this._buildImport(),...this._buildFunctionDeclarations(),...this._buildFunctionsTable(),...this._buildExports(),...this._buildElements(),...this._buildCode(),...this._buildData()])}addFunction(t){if(typeof this.functionIdxByName[t]<"u")throw new Error(`Function already defined: ${t}`);let n=this.functions.length;return this.functionIdxByName[t]=n,this.functions.push(new $e(this,t,"internal")),this.nInternalFunctions++,this.functions[n]}addIimportFunction(t,n,a){if(typeof this.functionIdxByName[t]<"u")throw new Error(`Function already defined: ${t}`);if(this.functions.length>0&&this.functions[this.functions.length-1].type=="internal")throw new Error(`Import functions must be declared before internal: ${t}`);let o=a||t,e=this.functions.length;return this.functionIdxByName[t]=e,this.functions.push(new $e(this,t,"import",n,o)),this.nImportFunctions++,this.functions[e]}setMemory(t,n,a){this.memory={pagesSize:t,moduleName:n||"env",fieldName:a||"memory"}}exportFunction(t,n){let a=n||t;if(typeof this.functionIdxByName[t]>"u")throw new Error(`Function not defined: ${t}`);let o=this.functionIdxByName[t];a!=t&&(this.functionIdxByName[a]=o),this.exports.push({exportName:a,idx:o})}addFunctionToTable(t){let n=this.functionIdxByName[t];this.functionsTable.push(n)}addData(t,n){this.datas.push({offset:t,bytes:n})}alloc(t,n){let a,o;(Array.isArray(t)||ArrayBuffer.isView(t))&&typeof n>"u"?(a=t.length,o=t):(a=t,o=n),a=(a-1>>3)+1<<3;let e=this.free;return this.free+=a,o&&this.addData(e,o),e}allocString(t){let a=new globalThis.TextEncoder().encode(t);return this.alloc([...a,0])}_setSignatures(){this.signatures=[];let t={};if(this.functionsTable.length>0){let n=this.functions[this.functionsTable[0]].getSignature(),a="s_"+E2(n);t[a]=0,this.signatures.push(n)}for(let n=0;n<this.functions.length;n++){let a=this.functions[n].getSignature(),o="s_"+E2(a);typeof t[o]>"u"&&(t[o]=this.signatures.length,this.signatures.push(a)),this.functions[n].signatureIdx=t[o]}}_buildSection(t,n){return[t,...jt(n.length),...n]}_buildType(){return this._buildSection(1,[...jt(this.signatures.length),...[].concat(...this.signatures)])}_buildImport(){let t=[];t.push([...ri(this.memory.moduleName),...ri(this.memory.fieldName),2,0,...jt(this.memory.pagesSize)]);for(let n=0;n<this.nImportFunctions;n++)t.push([...ri(this.functions[n].moduleName),...ri(this.functions[n].fieldName),0,...jt(this.functions[n].signatureIdx)]);return this._buildSection(2,jt(t.length).concat(...t))}_buildFunctionDeclarations(){let t=[];for(let n=this.nImportFunctions;n<this.nImportFunctions+this.nInternalFunctions;n++)t.push(...jt(this.functions[n].signatureIdx));return this._buildSection(3,[...jt(t.length),...t])}_buildFunctionsTable(){return this.functionsTable.length==0?[]:this._buildSection(4,[...jt(1),112,0,...jt(this.functionsTable.length)])}_buildElements(){if(this.functionsTable.length==0)return[];let t=[];for(let n=0;n<this.functionsTable.length;n++)t.push(...jt(this.functionsTable[n]));return this._buildSection(9,[...jt(1),...jt(0),65,...Ds(0),11,...jt(this.functionsTable.length),...t])}_buildExports(){let t=[];for(let n=0;n<this.exports.length;n++)t.push([...ri(this.exports[n].exportName),0,...jt(this.exports[n].idx)]);return this._buildSection(7,jt(t.length).concat(...t))}_buildCode(){let t=[];for(let n=this.nImportFunctions;n<this.nImportFunctions+this.nInternalFunctions;n++)t.push(this.functions[n].getBody());return this._buildSection(10,jt(t.length).concat(...t))}_buildData(){let t=[];t.push([0,65,0,11,4,...Rs(this.free)]);for(let n=0;n<this.datas.length;n++)t.push([0,65,...Ds(this.datas[n].offset),11,...jt(this.datas[n].bytes.length),...this.datas[n].bytes]);return this._buildSection(11,jt(t.length).concat(...t))}};globalThis.curve_bn128=null;globalThis.curve_bls12381=null;sg=mn("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),lg=mn("21888242871839275222246405745257275088548364400416034343698204186575808495617"),rg=mn("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),dg=mn("21888242871839275222246405745257275088696311157297823662689037894645226208583");fg=Q0,gg=J1});var lo=Sn((mw,ru)=>{"use strict";ru.exports={}});var _l=Sn(ro=>{"use strict";Object.defineProperty(ro,"__esModule",{value:!0});function Lg(c){return c&&typeof c=="object"&&"default"in c?c.default:c}var fu=Lg(lo()),aa=lo();async function mi(c,t,n,a){if(n=n||4096*64,typeof t!="number"&&["w+","wx+","r","ax+","a+"].indexOf(t)<0)throw new Error("Invalid open option");let o=await fu.promises.open(c,t),e=await o.stat();return new rl(o,e,n,a,c)}var rl=class{constructor(t,n,a,o,e){for(this.fileName=e,this.fd=t,this.pos=0,this.pageSize=o||256;this.pageSize<n.blksize;)this.pageSize*=2;this.totalSize=n.size,this.totalPages=Math.floor((n.size-1)/this.pageSize)+1,this.maxPagesLoaded=Math.floor(a/this.pageSize)+1,this.pages={},this.pendingLoads=[],this.writing=!1,this.reading=!1,this.avBuffs=[],this.history={}}_loadPage(t){let n=this,a=new Promise((o,e)=>{n.pendingLoads.push({page:t,resolve:o,reject:e})});return n.__statusPage("After Load request: ",t),a}__statusPage(t,n){let a=[],o=this;if(!o.logHistory)return;a.push("=="+t+" "+n);let e="";for(let h=0;h<o.pendingLoads.length;h++)o.pendingLoads[h].page==n&&(e=e+" "+h);if(e&&a.push("Pending loads:"+e),typeof o.pages[n]<"u"){let h=o.pages[n];a.push("Loaded"),a.push("pendingOps: "+h.pendingOps),h.loading&&a.push("loading: "+h.loading),h.writing&&a.push("writing"),h.dirty&&a.push("dirty")}a.push("=="),o.history[n]||(o.history[n]=[]),o.history[n].push(a)}__printHistory(t){let n=this;n.history[t]||console.log("Empty History ",t),console.log("History "+t);for(let a=0;a<n.history[t].length;a++)for(let o=0;o<n.history[t][a].length;o++)console.log("-> "+n.history[t][a][o])}_triggerLoad(){let t=this;if(t.reading||t.pendingLoads.length==0)return;let n=Object.keys(t.pages),a=[];for(let d=0;d<n.length;d++){let b=t.pages[parseInt(n[d])];b.dirty==!1&&b.pendingOps==0&&!b.writing&&!b.loading&&a.push(parseInt(n[d]))}let o=t.maxPagesLoaded-n.length,e=[];for(;t.pendingLoads.length>0&&(typeof t.pages[t.pendingLoads[0].page]<"u"||o>0||a.length>0);){let d=t.pendingLoads.shift();if(typeof t.pages[d.page]<"u"){t.pages[d.page].pendingOps++;let b=a.indexOf(d.page);b>=0&&a.splice(b,1),t.pages[d.page].loading?t.pages[d.page].loading.push(d):d.resolve(),t.__statusPage("After Load (cached): ",d.page)}else{if(o)o--;else{let b=a.shift();t.__statusPage("Before Unload: ",b),t.avBuffs.unshift(t.pages[b]),delete t.pages[b],t.__statusPage("After Unload: ",b)}d.page>=t.totalPages?(t.pages[d.page]=h(),d.resolve(),t.__statusPage("After Load (new): ",d.page)):(t.reading=!0,t.pages[d.page]=h(),t.pages[d.page].loading=[d],e.push(t.fd.read(t.pages[d.page].buff,0,t.pageSize,d.page*t.pageSize).then(b=>{t.pages[d.page].size=b.bytesRead;let l=t.pages[d.page].loading;delete t.pages[d.page].loading;for(let s=0;s<l.length;s++)l[s].resolve();return t.__statusPage("After Load (loaded): ",d.page),b},b=>{d.reject(b)})),t.__statusPage("After Load (loading): ",d.page))}}Promise.all(e).then(()=>{t.reading=!1,t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t)),t._tryClose()});function h(){if(t.avBuffs.length>0){let d=t.avBuffs.shift();return d.dirty=!1,d.pendingOps=1,d.size=0,d}else return{dirty:!1,buff:new Uint8Array(t.pageSize),pendingOps:1,size:0}}}_triggerWrite(){let t=this;if(t.writing)return;let n=Object.keys(t.pages),a=[];for(let o=0;o<n.length;o++){let e=t.pages[parseInt(n[o])];e.dirty&&(e.dirty=!1,e.writing=!0,t.writing=!0,a.push(t.fd.write(e.buff,0,e.size,parseInt(n[o])*t.pageSize).then(()=>{e.writing=!1},h=>{console.log("ERROR Writing: "+h),t.error=h,t._tryClose()})))}t.writing&&Promise.all(a).then(()=>{t.writing=!1,setImmediate(t._triggerWrite.bind(t)),t._tryClose(),t.pendingLoads.length>0&&setImmediate(t._triggerLoad.bind(t))})}_getDirtyPage(){for(let t in this.pages)if(this.pages[t].dirty)return t;return-1}async write(t,n){if(t.byteLength==0)return;let a=this;if(typeof n>"u"&&(n=a.pos),a.pos=n+t.byteLength,a.totalSize<n+t.byteLength&&(a.totalSize=n+t.byteLength),a.pendingClose)throw new Error("Writing a closing file");let o=Math.floor(n/a.pageSize),e=Math.floor((n+t.byteLength-1)/a.pageSize),h=[];for(let s=o;s<=e;s++)h.push(a._loadPage(s));a._triggerLoad();let d=o,b=n%a.pageSize,l=t.byteLength;for(;l>0;){await h[d-o];let s=b+l>a.pageSize?a.pageSize-b:l,m=t.slice(t.byteLength-l,t.byteLength-l+s);new Uint8Array(a.pages[d].buff.buffer,b,s).set(m),a.pages[d].dirty=!0,a.pages[d].pendingOps--,a.pages[d].size=Math.max(b+s,a.pages[d].size),d>=a.totalPages&&(a.totalPages=d+1),l=l-s,d++,b=0,a.writing||setImmediate(a._triggerWrite.bind(a))}}async read(t,n){let a=this,o=new Uint8Array(t);return await a.readToBuffer(o,0,t,n),o}async readToBuffer(t,n,a,o){if(a==0)return;let e=this;if(a>e.pageSize*e.maxPagesLoaded*.8){let B=Math.floor(a*1.1);this.maxPagesLoaded=Math.floor(B/e.pageSize)+1}if(typeof o>"u"&&(o=e.pos),e.pos=o+a,e.pendingClose)throw new Error("Reading a closing file");let h=Math.floor(o/e.pageSize),d=Math.floor((o+a-1)/e.pageSize),b=[];for(let B=h;B<=d;B++)b.push(e._loadPage(B));e._triggerLoad();let l=h,s=o%e.pageSize,m=o+a>e.totalSize?a-(o+a-e.totalSize):a;for(;m>0;){await b[l-h],e.__statusPage("After Await (read): ",l);let B=s+m>e.pageSize?e.pageSize-s:m,p=new Uint8Array(e.pages[l].buff.buffer,e.pages[l].buff.byteOffset+s,B);t.set(p,n+a-m),e.pages[l].pendingOps--,e.__statusPage("After Op done: ",l),m=m-B,l++,s=0,e.pendingLoads.length>0&&setImmediate(e._triggerLoad.bind(e))}this.pos=o+a}_tryClose(){let t=this;!t.pendingClose||(t.error&&t.pendingCloseReject(t.error),t._getDirtyPage()>=0||t.writing||t.reading||t.pendingLoads.length>0)||t.pendingClose()}close(){let t=this;if(t.pendingClose)throw new Error("Closing the file twice");return new Promise((n,a)=>{t.pendingClose=n,t.pendingCloseReject=a,t._tryClose()}).then(()=>{t.fd.close()},n=>{throw t.fd.close(),n})}async discard(){await this.close(),await fu.promises.unlink(this.fileName)}async writeULE32(t,n){let a=this,o=new Uint8Array(4);new DataView(o.buffer).setUint32(0,t,!0),await a.write(o,n)}async writeUBE32(t,n){let a=this,o=new Uint8Array(4);new DataView(o.buffer).setUint32(0,t,!1),await a.write(o,n)}async writeULE64(t,n){let a=this,o=new Uint8Array(8),e=new DataView(o.buffer);e.setUint32(0,t&4294967295,!0),e.setUint32(4,Math.floor(t/4294967296),!0),await a.write(o,n)}async readULE32(t){let a=await this.read(4,t);return new Uint32Array(a.buffer)[0]}async readUBE32(t){let a=await this.read(4,t);return new DataView(a.buffer).getUint32(0,!1)}async readULE64(t){let a=await this.read(8,t),o=new Uint32Array(a.buffer);return o[1]*4294967296+o[0]}async readString(t){let n=this;if(n.pendingClose)throw new Error("Reading a closing file");let a=typeof t>"u"?n.pos:t,o=Math.floor(a/n.pageSize),e=!1,h="";for(;!e;){let d=n._loadPage(o);n._triggerLoad(),await d,n.__statusPage("After Await (read): ",o);let b=a%n.pageSize,l=new Uint8Array(n.pages[o].buff.buffer,n.pages[o].buff.byteOffset+b,n.pageSize-b),s=l.findIndex(m=>m===0);e=s!==-1,e?(h+=new TextDecoder().decode(l.slice(0,s)),n.pos=o*this.pageSize+b+s+1):(h+=new TextDecoder().decode(l),n.pos=o*this.pageSize+b+l.length),n.pages[o].pendingOps--,n.__statusPage("After Op done: ",o),a=n.pos,o++,n.pendingLoads.length>0&&setImmediate(n._triggerLoad.bind(n))}return h}};function gu(c){let t=c.initialSize||1048576,n=new pi;return n.o=c,n.o.data=new Uint8Array(t),n.allocSize=t,n.totalSize=0,n.readOnly=!1,n.pos=0,n}function pg(c){let t=new pi;return t.o=c,t.allocSize=c.data.byteLength,t.totalSize=c.data.byteLength,t.readOnly=!0,t.pos=0,t}function Lu(c){let t=new pi;return t.o=c,t.allocSize=c.data.byteLength,t.totalSize=c.data.byteLength,t.readOnly=!1,t.pos=0,t}var dl=new Uint8Array(4),du=new DataView(dl.buffer),pu=new Uint8Array(8),uu=new DataView(pu.buffer),pi=class{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t>this.allocSize){let n=Math.max(this.allocSize+1048576,Math.floor(this.allocSize*1.1),t),a=new Uint8Array(n);a.set(this.o.data),this.o.data=a,this.allocSize=n}}async write(t,n){if(typeof n>"u"&&(n=this.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(n+t.byteLength),this.o.data.set(t.slice(),n),n+t.byteLength>this.totalSize&&(this.totalSize=n+t.byteLength),this.pos=n+t.byteLength}async readToBuffer(t,n,a,o){if(typeof o>"u"&&(o=this.pos),this.readOnly&&o+a>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(o+a);let h=new Uint8Array(this.o.data.buffer,this.o.data.byteOffset+o,a);t.set(h,n),this.pos=o+a}async read(t,n){let a=this,o=new Uint8Array(t);return await a.readToBuffer(o,0,t,n),o}close(){this.o.data.byteLength!=this.totalSize&&(this.o.data=this.o.data.slice(0,this.totalSize))}async discard(){}async writeULE32(t,n){let a=this;du.setUint32(0,t,!0),await a.write(dl,n)}async writeUBE32(t,n){let a=this;du.setUint32(0,t,!1),await a.write(dl,n)}async writeULE64(t,n){let a=this;uu.setUint32(0,t&4294967295,!0),uu.setUint32(4,Math.floor(t/4294967296),!0),await a.write(pu,n)}async readULE32(t){let a=await this.read(4,t);return new Uint32Array(a.buffer)[0]}async readUBE32(t){let a=await this.read(4,t);return new DataView(a.buffer).getUint32(0,!1)}async readULE64(t){let a=await this.read(8,t),o=new Uint32Array(a.buffer);return o[1]*4294967296+o[0]}async readString(t){let n=this,a=typeof t>"u"?n.pos:t;if(a>this.totalSize){if(this.readOnly)throw new Error("Reading out of bounds");this._resizeIfNeeded(t)}let o=new Uint8Array(n.o.data.buffer,a,this.totalSize-a),e=o.findIndex(b=>b===0),h=e!==-1,d="";return h?(d=new TextDecoder().decode(o.slice(0,e)),n.pos=a+e+1):n.pos=a,d}},Bn=1<<22;function bu(c){let t=c.initialSize||0,n=new bi;n.o=c;let a=t?Math.floor((t-1)/Bn)+1:0;n.o.data=[];for(let o=0;o<a-1;o++)n.o.data.push(new Uint8Array(Bn));return a&&n.o.data.push(new Uint8Array(t-Bn*(a-1))),n.totalSize=0,n.readOnly=!1,n.pos=0,n}function bg(c){let t=new bi;return t.o=c,t.totalSize=(c.data.length-1)*Bn+c.data[c.data.length-1].byteLength,t.readOnly=!0,t.pos=0,t}function mu(c){let t=new bi;return t.o=c,t.totalSize=(c.data.length-1)*Bn+c.data[c.data.length-1].byteLength,t.readOnly=!1,t.pos=0,t}var ul=new Uint8Array(4),_u=new DataView(ul.buffer),yu=new Uint8Array(8),hu=new DataView(yu.buffer),bi=class{constructor(){this.pageSize=16384}_resizeIfNeeded(t){if(t<=this.totalSize)return;if(this.readOnly)throw new Error("Reading out of file bounds");let n=Math.floor((t-1)/Bn)+1;for(let a=Math.max(this.o.data.length-1,0);a<n;a++){let o=a<n-1?Bn:t-(n-1)*Bn,e=new Uint8Array(o);a==this.o.data.length-1&&e.set(this.o.data[a]),this.o.data[a]=e}this.totalSize=t}async write(t,n){let a=this;if(typeof n>"u"&&(n=a.pos),this.readOnly)throw new Error("Writing a read only file");this._resizeIfNeeded(n+t.byteLength);let e=Math.floor(n/Bn),h=n%Bn,d=t.byteLength;for(;d>0;){let b=h+d>Bn?Bn-h:d,l=t.slice(t.byteLength-d,t.byteLength-d+b);new Uint8Array(a.o.data[e].buffer,h,b).set(l),d=d-b,e++,h=0}this.pos=n+t.byteLength}async readToBuffer(t,n,a,o){let e=this;if(typeof o>"u"&&(o=e.pos),this.readOnly&&o+a>this.totalSize)throw new Error("Reading out of bounds");this._resizeIfNeeded(o+a);let d=Math.floor(o/Bn),b=o%Bn,l=a;for(;l>0;){let s=b+l>Bn?Bn-b:l,m=new Uint8Array(e.o.data[d].buffer,b,s);t.set(m,n+a-l),l=l-s,d++,b=0}this.pos=o+a}async read(t,n){let a=this,o=new Uint8Array(t);return await a.readToBuffer(o,0,t,n),o}close(){}async discard(){}async writeULE32(t,n){let a=this;_u.setUint32(0,t,!0),await a.write(ul,n)}async writeUBE32(t,n){let a=this;_u.setUint32(0,t,!1),await a.write(ul,n)}async writeULE64(t,n){let a=this;hu.setUint32(0,t&4294967295,!0),hu.setUint32(4,Math.floor(t/4294967296),!0),await a.write(yu,n)}async readULE32(t){let a=await this.read(4,t);return new Uint32Array(a.buffer)[0]}async readUBE32(t){let a=await this.read(4,t);return new DataView(a.buffer).getUint32(0,!1)}async readULE64(t){let a=await this.read(8,t),o=new Uint32Array(a.buffer);return o[1]*4294967296+o[0]}async readString(t){let n=this,a=2048,o=typeof t>"u"?n.pos:t;if(o>this.totalSize){if(this.readOnly)throw new Error("Reading out of bounds");this._resizeIfNeeded(t)}let e=!1,h="";for(;!e;){let d=Math.floor(o/Bn),b=o%Bn;if(n.o.data[d]===void 0)throw new Error("ERROR");let l=Math.min(a,n.o.data[d].length-b),s=new Uint8Array(n.o.data[d].buffer,b,l),m=s.findIndex(B=>B===0);e=m!==-1,e?(h+=new TextDecoder().decode(s.slice(0,m)),n.pos=d*Bn+b+m+1):(h+=new TextDecoder().decode(s),n.pos=d*Bn+b+s.length),o=n.pos}return h}},yi=65536,wi=8192;async function mg(c,t,n){if(typeof c=="string"&&(c={type:"file",fileName:c,cacheSize:t||yi,pageSize:n||wi}),c.type=="file")return await mi(c.fileName,aa.O_TRUNC|aa.O_CREAT|aa.O_RDWR,c.cacheSize,c.pageSize);if(c.type=="mem")return gu(c);if(c.type=="bigMem")return bu(c);throw new Error("Invalid FastFile type: "+c.type)}function yg(c,t,n){if(typeof c=="string"&&(c={type:"file",fileName:c,cacheSize:t||yi,pageSize:n||wi}),c.type=="file")return mi(c.fileName,aa.O_TRUNC|aa.O_CREAT|aa.O_RDWR|aa.O_EXCL,c.cacheSize,c.pageSize);if(c.type=="mem")return gu(c);if(c.type=="bigMem")return bu(c);throw new Error("Invalid FastFile type: "+c.type)}async function wg(c,t,n){if(c instanceof Uint8Array&&(c={type:"mem",data:c}),process.browser?typeof c=="string"&&(c={type:"mem",data:await fetch(c).then(function(o){return o.arrayBuffer()}).then(function(o){return new Uint8Array(o)})}):typeof c=="string"&&(c={type:"file",fileName:c,cacheSize:t||yi,pageSize:n||wi}),c.type=="file")return await mi(c.fileName,aa.O_RDONLY,c.cacheSize,c.pageSize);if(c.type=="mem")return await pg(c);if(c.type=="bigMem")return await bg(c);throw new Error("Invalid FastFile type: "+c.type)}function Fg(c,t,n){if(typeof c=="string"&&(c={type:"file",fileName:c,cacheSize:t||yi,pageSize:n||wi}),c.type=="file")return mi(c.fileName,aa.O_CREAT|aa.O_RDWR,c.cacheSize,c.pageSize);if(c.type=="mem")return Lu(c);if(c.type=="bigMem")return mu(c);throw new Error("Invalid FastFile type: "+c.type)}function Cg(c,t,n){if(typeof c=="string"&&(c={type:"file",fileName:c,cacheSize:t||yi,pageSize:n||wi}),c.type=="file")return mi(c.fileName,aa.O_CREAT|aa.O_RDWR|aa.O_EXCL,c.cacheSize);if(c.type=="mem")return Lu(c);if(c.type=="bigMem")return mu(c);throw new Error("Invalid FastFile type: "+c.type)}ro.createNoOverride=yg;ro.createOverride=mg;ro.readExisting=wg;ro.readWriteExisting=Fg;ro.readWriteExistingOrCreate=Cg});var fl=Sn(oa=>{"use strict";Object.defineProperty(oa,"__esModule",{value:!0});var hl=(lu(),Ee(su)),Bg=_l();function xg(c){if(c&&c.__esModule)return c;var t=Object.create(null);return c&&Object.keys(c).forEach(function(n){if(n!=="default"){var a=Object.getOwnPropertyDescriptor(c,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return c[n]}})}}),t.default=c,Object.freeze(t)}var wu=xg(Bg);async function Ag(c,t,n,a,o){let e=await wu.readExisting(c,a,o),h=await e.read(4),d="";for(let m=0;m<4;m++)d+=String.fromCharCode(h[m]);if(d!=t)throw new Error(c+": Invalid File format");if(await e.readULE32()>n)throw new Error("Version not supported");let l=await e.readULE32(),s=[];for(let m=0;m<l;m++){let B=await e.readULE32(),p=await e.readULE64();typeof s[B]>"u"&&(s[B]=[]),s[B].push({p:e.pos,size:p}),e.pos+=p}return{fd:e,sections:s}}async function Eg(c,t,n,a,o,e){let h=await wu.createOverride(c,o,e),d=new Uint8Array(4);for(let b=0;b<4;b++)d[b]=t.charCodeAt(b);return await h.write(d,0),await h.writeULE32(n),await h.writeULE32(a),h}async function Fu(c,t){if(typeof c.writingSection<"u")throw new Error("Already writing a section");await c.writeULE32(t),c.writingSection={pSectionSize:c.pos},await c.writeULE64(0)}async function Cu(c){if(typeof c.writingSection>"u")throw new Error("Not writing a section");let t=c.pos-c.writingSection.pSectionSize-8,n=c.pos;c.pos=c.writingSection.pSectionSize,await c.writeULE64(t),c.pos=n,delete c.writingSection}async function He(c,t,n){if(typeof c.readingSection<"u")throw new Error("Already reading a section");if(!t[n])throw new Error(c.fileName+": Missing section "+n);if(t[n].length>1)throw new Error(c.fileName+": Section Duplicated "+n);c.pos=t[n][0].p,c.readingSection=t[n][0]}async function De(c,t){if(typeof c.readingSection>"u")throw new Error("Not reading a section");if(!t&&c.pos-c.readingSection.p!=c.readingSection.size)throw new Error("Invalid section size reading");delete c.readingSection}async function vg(c,t,n,a){let o=new Uint8Array(n);hl.Scalar.toRprLE(o,0,t,n),await c.write(o,a)}async function Sg(c,t,n){let a=await c.read(t,n);return hl.Scalar.fromRprLE(a,0,t)}async function qg(c,t,n,a,o){typeof o>"u"&&(o=t[a][0].size);let e=c.pageSize;await He(c,t,a),await Fu(n,a);for(let h=0;h<o;h+=e){let d=Math.min(o-h,e),b=await c.read(d);await n.write(b)}await Cu(n),await De(c,o!=t[a][0].size)}async function Ig(c,t,n,a,o){if(a=typeof a>"u"?0:a,o=typeof o>"u"?t[n][0].size-a:o,a+o>t[n][0].size)throw new Error("Reading out of the range of the section");let e;return o<1<<30?e=new Uint8Array(o):e=new hl.BigBuffer(o),await c.readToBuffer(e,0,o,t[n][0].p+a),e}async function Og(c,t,n,a,o){let e=c.pageSize*16;if(await He(c,t,o),await He(n,a,o),t[o][0].size!=a[o][0].size)return!1;let h=t[o][0].size;for(let d=0;d<h;d+=e){let b=Math.min(h-d,e),l=await c.read(b),s=await n.read(b);for(let m=0;m<b;m++)if(l[m]!=s[m])return!1}return await De(c),await De(n),!0}oa.copySection=qg;oa.createBinFile=Eg;oa.endReadSection=De;oa.endWriteSection=Cu;oa.readBigInt=Sg;oa.readBinFile=Ag;oa.readSection=Ig;oa.sectionIsEqual=Og;oa.startReadUniqueSection=He;oa.startWriteSection=Fu;oa.writeBigInt=vg});var C_={};Ae(C_,{BigBuffer:()=>Ln,ChaCha:()=>ic,EC:()=>Il,F1Field:()=>vl,F2Field:()=>Sl,F3Field:()=>ql,PolField:()=>Al,Scalar:()=>Lp,ZqField:()=>vl,buildBls12381:()=>pc,buildBn128:()=>Lc,getCurveFromName:()=>gp,getCurveFromQ:()=>fp,getCurveFromR:()=>hp,utils:()=>pp});function hc(c,t){if(!t||t==10)return BigInt(c);if(t==16)return c.slice(0,2)=="0x"?BigInt(c):BigInt("0x"+c)}function Mg(c,t){let n=BigInt(0);t=BigInt(t);for(let a=0;a<c.length;a++)n=n*t+BigInt(c[a]);return n}function Ii(c){let t=c.toString(16);return(t.length-1)*4+Pg[parseInt(t[0],16)]}function ju(c){return BigInt(c)<BigInt(0)}function Nl(c){return!c}function tc(c,t){return BigInt(c)<<BigInt(t)}function vo(c,t){return BigInt(c)>>BigInt(t)}function $l(c){return(BigInt(c)&BigInt(1))==BigInt(1)}function Vu(c){let t=BigInt(c),n=[];for(;t;){if(t&BigInt(1)){let a=2-Number(t%BigInt(4));n.push(a),t=t-BigInt(a)}else n.push(0);t=t>>BigInt(1)}return n}function Wu(c){let t=BigInt(c),n=[];for(;t;)t&BigInt(1)?n.push(1):n.push(0),t=t>>BigInt(1);return n}function Qu(c){if(c>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(c)}function Tg(c,t){let n=[],a=BigInt(c);for(t=BigInt(t);a;)n.unshift(Number(a%t)),a=a/t;return n}function Zl(c,t){return BigInt(c)+BigInt(t)}function Ia(c,t){return BigInt(c)-BigInt(t)}function Xu(c){return-BigInt(c)}function Hu(c,t){return BigInt(c)*BigInt(t)}function Gg(c){return BigInt(c)*BigInt(c)}function Oi(c,t){return BigInt(c)**BigInt(t)}function kg(c,t){return BigInt(c)**BigInt(t)}function Ug(c){return BigInt(c)>=0?BigInt(c):-BigInt(c)}function So(c,t){return BigInt(c)/BigInt(t)}function ya(c,t){return BigInt(c)%BigInt(t)}function _a(c,t){return BigInt(c)==BigInt(t)}function Ng(c,t){return BigInt(c)!=BigInt(t)}function $g(c,t){return BigInt(c)<BigInt(t)}function nc(c,t){return BigInt(c)>BigInt(t)}function Zg(c,t){return BigInt(c)<=BigInt(t)}function Du(c,t){return BigInt(c)>=BigInt(t)}function jl(c,t){return BigInt(c)&BigInt(t)}function jg(c,t){return BigInt(c)|BigInt(t)}function Vg(c,t){return BigInt(c)^BigInt(t)}function Wg(c,t){return BigInt(c)&&BigInt(t)}function Qg(c,t){return BigInt(c)||BigInt(t)}function Xg(c){return!BigInt(c)}function Si(c,t,n,a){let o="0000000"+n.toString(16),e=new Uint32Array(c.buffer,c.byteOffset+t,a/4),h=((o.length-7)*4-1>>5)+1;for(let d=0;d<h;d++)e[d]=parseInt(o.substring(o.length-8*d-8,o.length-8*d),16);for(let d=h;d<e.length;d++)e[d]=0;for(let d=e.length*4;d<a;d++)c[d]=Qu(jl(vo(n,d*8),255))}function Ku(c,t,n,a){let o="0000000"+n.toString(16),e=new DataView(c.buffer,c.byteOffset+t,a),h=((o.length-7)*4-1>>5)+1;for(let d=0;d<h;d++)e.setUint32(a-d*4-4,parseInt(o.substring(o.length-8*d-8,o.length-8*d),16),!1);for(let d=0;d<a/4-h;d++)e[d]=0}function qi(c,t,n){n=n||c.byteLength,t=t||0;let a=new Uint32Array(c.buffer,c.byteOffset+t,n/4),o=new Array(n/4);return a.forEach((e,h)=>o[o.length-h-1]=e.toString(16).padStart(8,"0")),hc(o.join(""),16)}function Ju(c,t,n){n=n||c.byteLength,t=t||0;let a=new DataView(c.buffer,c.byteOffset+t,n),o=new Array(n/4);for(let e=0;e<n/4;e++)o[e]=a.getUint32(e*4,!1).toString(16).padStart(8,"0");return hc(o.join(""),16)}function fc(c,t){return c.toString(t)}function qo(c){let t=new Uint8Array(Math.floor((Ii(c)-1)/8)+1);return Si(t,0,c,t.byteLength),t}function ma(c){return((c&4294901760)!==0?(c&=4294901760,16):0)|((c&4278255360)!==0?(c&=4278255360,8):0)|((c&4042322160)!==0?(c&=4042322160,4):0)|((c&3435973836)!==0?(c&=3435973836,2):0)|(c&2863311530)!==0}function _o(c,t,n,a,o){let e=1<<n;if(e==1)return[t[a]];if(e==2)return[c.F.add(t[a],t[a+o]),c.F.sub(t[a],t[a+o])];let h=e>>1,d=_o(c,t,n-1,a,o*2),b=_o(c,t,n-1,a+o,o*2),l=new Array(e);for(let s=0;s<h;s++)l[s]=c.F.add(d[s],c.F.mul(c.roots[n][s],b[s])),l[s+h]=c.F.sub(d[s],c.F.mul(c.roots[n][s],b[s]));return l}function ac(c,t,n){let a=1<<n;if(a==1)return[t[0]];let o=a>>1,e=ac(c,t.slice(0,o),n-1),h=ac(c,t.slice(o),n-1),d=new Array(a);for(let b=0;b<o;b++)d[b]=c.F.add(e[b],c.F.mul(c.roots[n][b],h[b])),d[b+o]=c.F.sub(e[b],c.F.mul(c.roots[n][b],h[b]));return d}function Dg(c,t){let n=0,a=c;for(let o=0;o<t;o++)n<<=1,n=n|a&1,a>>=1;return n}function Kg(c,t){return(Ei[c>>>24]|Ei[c>>>16&255]<<8|Ei[c>>>8&255]<<16|Ei[c&255]<<24)>>>32-t}function Bu(c,t){for(let n=0;n<c.length;n++){let a=Kg(n,t);if(a>n){let o=c[n];c[n]=c[a],c[a]=o}}}function oc(c,t,n){let a;if(Nl(n))return c.zero;let o=Vu(n);if(o[o.length-1]==1)a=t;else if(o[o.length-1]==-1)a=c.neg(t);else throw new Error("invlaud NAF");for(let e=o.length-2;e>=0;e--)a=c.double(a),o[e]==1?a=c.add(a,t):o[e]==-1&&(a=c.sub(a,t));return a}function Io(c,t,n){if(Nl(n))return c.one;let a=Wu(n);if(a.length==0)return c.one;let o=t;for(let e=a.length-2;e>=0;e--)o=c.square(o),a[e]&&(o=c.mul(o,t));return o}function t_(c){if(c.m%2==1)if(_a(ya(c.p,4),1))if(_a(ya(c.p,8),1))if(_a(ya(c.p,16),1))Jg(c);else if(_a(ya(c.p,16),9))Yg(c);else throw new Error("Field withot sqrt");else if(_a(ya(c.p,8),5))tL(c);else throw new Error("Field withot sqrt");else _a(ya(c.p,4),3)&&nL(c);else{let t=ya(Oi(c.p,c.m/2),4);t==1?aL(c):t==3?oL(c):iL(c)}}function Jg(c){for(c.sqrt_q=Oi(c.p,c.m),c.sqrt_s=0,c.sqrt_t=Ia(c.sqrt_q,1);!$l(c.sqrt_t);)c.sqrt_s=c.sqrt_s+1,c.sqrt_t=So(c.sqrt_t,2);let t=c.one;for(;c.eq(t,c.one);){let n=c.random();c.sqrt_z=c.pow(n,c.sqrt_t),t=c.pow(c.sqrt_z,2**(c.sqrt_s-1))}c.sqrt_tm1d2=So(Ia(c.sqrt_t,1),2),c.sqrt=function(n){let a=this;if(a.isZero(n))return a.zero;let o=a.pow(n,a.sqrt_tm1d2),e=a.pow(a.mul(a.square(o),n),2**(a.sqrt_s-1));if(a.eq(e,a.negone))return null;let h=a.sqrt_s,d=a.mul(n,o),b=a.mul(d,o),l=a.sqrt_z;for(;!a.eq(b,a.one);){let s=a.square(b),m=1;for(;!a.eq(s,a.one);)s=a.square(s),m++;o=l;for(let B=0;B<h-m-1;B++)o=a.square(o);l=a.square(o),b=a.mul(b,l),d=a.mul(d,o),h=m}return a.geq(d,a.zero)?d:a.neg(d)}}function Yg(c){c.sqrt=function(){throw new Error("Sqrt alg 4 not implemented")}}function tL(c){c.sqrt=function(){throw new Error("Sqrt alg 3 not implemented")}}function nL(c){c.sqrt_q=Oi(c.p,c.m),c.sqrt_e1=So(Ia(c.sqrt_q,3),4),c.sqrt=function(t){if(this.isZero(t))return this.zero;let n=this.pow(t,this.sqrt_e1),a=this.mul(this.square(n),t);if(this.eq(a,this.negone))return null;let o=this.mul(n,t);return c.geq(o,c.zero)?o:c.neg(o)}}function aL(c){c.sqrt=function(){throw new Error("Sqrt alg 10 not implemented")}}function oL(c){c.sqrt_q=Oi(c.p,c.m/2),c.sqrt_e34=So(Ia(c.sqrt_q,3),4),c.sqrt_e12=So(Ia(c.sqrt_q,1),2),c.frobenius=function(t,n){return t%2==1?c.conjugate(n):n},c.sqrt=function(t){let n=this,a=n.pow(t,n.sqrt_e34),o=n.mul(n.square(a),t),e=n.mul(n.frobenius(1,o),o);if(n.eq(e,n.negone))return null;let h=n.mul(a,t),d;if(n.eq(o,n.negone))d=n.mul(h,[n.F.zero,n.F.one]);else{let b=n.pow(n.add(n.one,o),n.sqrt_e12);d=n.mul(b,h)}return n.geq(d,n.zero)?d:n.neg(d)}}function iL(c){c.sqrt=function(){throw new Error("Sqrt alg 8 not implemented")}}function $a(c,t,n,a,o){c[t]=c[t]+c[n]>>>0,c[o]=(c[o]^c[t])>>>0,c[o]=(c[o]<<16|c[o]>>>16&65535)>>>0,c[a]=c[a]+c[o]>>>0,c[n]=(c[n]^c[a])>>>0,c[n]=(c[n]<<12|c[n]>>>20&4095)>>>0,c[t]=c[t]+c[n]>>>0,c[o]=(c[o]^c[t])>>>0,c[o]=(c[o]<<8|c[o]>>>24&255)>>>0,c[a]=c[a]+c[o]>>>0,c[n]=(c[n]^c[a])>>>0,c[n]=(c[n]<<7|c[n]>>>25&127)>>>0}function eL(c){$a(c,0,4,8,12),$a(c,1,5,9,13),$a(c,2,6,10,14),$a(c,3,7,11,15),$a(c,0,5,10,15),$a(c,1,6,11,12),$a(c,2,7,8,13),$a(c,3,4,9,14)}function n_(c){let t=new Uint8Array(c);if(typeof globalThis.crypto<"u")globalThis.crypto.getRandomValues(t);else for(let n=0;n<c;n++)t[n]=Math.random()*4294967296>>>0;return t}function cL(){let c=n_(32),t=new Uint32Array(c.buffer),n=[];for(let a=0;a<8;a++)n.push(t[a]);return n}function Vl(){return Ke||(Ke=new ic(cL()),Ke)}function xu(c){return((c&4294901760)!==0?(c&=4294901760,16):0)|((c&4278255360)!==0?(c&=4278255360,8):0)|((c&4042322160)!==0?(c&=4042322160,4):0)|((c&3435973836)!==0?(c&=3435973836,2):0)|(c&2863311530)!==0}function ec(c,t,n,a,o){let e=1<<n;if(e==1)return[t[a]];if(e==2)return[c.G.add(t[a],t[a+o]),c.G.sub(t[a],t[a+o])];let h=e>>1,d=ec(c,t,n-1,a,o*2),b=ec(c,t,n-1,a+o,o*2),l=new Array(e);for(let s=0;s<h;s++)l[s]=c.G.add(d[s],c.opMulGF(b[s],c.roots[n][s])),l[s+h]=c.G.sub(d[s],c.opMulGF(b[s],c.roots[n][s]));return l}function Ye(c,t){if(Array.isArray(t)){for(let n=t.length-1;n>=0;n--)if(!c.F.isZero(t[n]))return Ye(c.F,t[n]);return 0}else{let n=c.neg(t);return nc(t,n)}}function lL(c,t){let n=c.modules[t].n64*8,a=c.addFunction(t+"_batchInverse");a.addParam("pIn","i32"),a.addParam("inStep","i32"),a.addParam("n","i32"),a.addParam("pOut","i32"),a.addParam("outStep","i32"),a.addLocal("itAux","i32"),a.addLocal("itIn","i32"),a.addLocal("itOut","i32"),a.addLocal("i","i32");let o=a.getCodeBuilder(),e=o.i32_const(c.alloc(n));a.addCode(o.setLocal("itAux",o.i32_load(o.i32_const(0))),o.i32_store(o.i32_const(0),o.i32_add(o.getLocal("itAux"),o.i32_mul(o.i32_add(o.getLocal("n"),o.i32_const(1)),o.i32_const(n))))),a.addCode(o.call(t+"_one",o.getLocal("itAux")),o.setLocal("itIn",o.getLocal("pIn")),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.if(o.call(t+"_isZero",o.getLocal("itIn")),o.call(t+"_copy",o.i32_sub(o.getLocal("itAux"),o.i32_const(n)),o.getLocal("itAux")),o.call(t+"_mul",o.getLocal("itIn"),o.i32_sub(o.getLocal("itAux"),o.i32_const(n)),o.getLocal("itAux"))),o.setLocal("itIn",o.i32_add(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))),o.setLocal("itIn",o.i32_sub(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itAux",o.i32_sub(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("itOut",o.i32_add(o.getLocal("pOut"),o.i32_mul(o.i32_sub(o.getLocal("n"),o.i32_const(1)),o.getLocal("outStep")))),o.call(t+"_inverse",o.getLocal("itAux"),o.getLocal("itAux")),o.block(o.loop(o.br_if(1,o.i32_eqz(o.getLocal("i"))),o.if(o.call(t+"_isZero",o.getLocal("itIn")),[...o.call(t+"_copy",o.getLocal("itAux"),o.i32_sub(o.getLocal("itAux"),o.i32_const(n))),...o.call(t+"_zero",o.getLocal("itOut"))],[...o.call(t+"_copy",o.i32_sub(o.getLocal("itAux"),o.i32_const(n)),e),...o.call(t+"_mul",o.getLocal("itAux"),o.getLocal("itIn"),o.i32_sub(o.getLocal("itAux"),o.i32_const(n))),...o.call(t+"_mul",o.getLocal("itAux"),e,o.getLocal("itOut"))]),o.setLocal("itIn",o.i32_sub(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itOut",o.i32_sub(o.getLocal("itOut"),o.getLocal("outStep"))),o.setLocal("itAux",o.i32_sub(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("i",o.i32_sub(o.getLocal("i"),o.i32_const(1))),o.br(0)))),a.addCode(o.i32_store(o.i32_const(0),o.getLocal("itAux")))}function rL(c,t,n,a,o,e){typeof e>"u"&&(a<o?e=!0:e=!1);let h=c.addFunction(t);h.addParam("pIn","i32"),h.addParam("n","i32"),h.addParam("pOut","i32"),h.addLocal("i","i32"),h.addLocal("itIn","i32"),h.addLocal("itOut","i32");let d=h.getCodeBuilder();e?h.addCode(d.setLocal("itIn",d.i32_add(d.getLocal("pIn"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(a)))),d.setLocal("itOut",d.i32_add(d.getLocal("pOut"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(o)))),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn"),d.getLocal("itOut")),d.setLocal("itIn",d.i32_sub(d.getLocal("itIn"),d.i32_const(a))),d.setLocal("itOut",d.i32_sub(d.getLocal("itOut"),d.i32_const(o))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0)))):h.addCode(d.setLocal("itIn",d.getLocal("pIn")),d.setLocal("itOut",d.getLocal("pOut")),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn"),d.getLocal("itOut")),d.setLocal("itIn",d.i32_add(d.getLocal("itIn"),d.i32_const(a))),d.setLocal("itOut",d.i32_add(d.getLocal("itOut"),d.i32_const(o))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0))))}function uL(c,t,n,a,o,e){typeof e>"u"&&(a<o?e=!0:e=!1);let h=c.addFunction(t);h.addParam("pIn1","i32"),h.addParam("pIn2","i32"),h.addParam("n","i32"),h.addParam("pOut","i32"),h.addLocal("i","i32"),h.addLocal("itIn1","i32"),h.addLocal("itIn2","i32"),h.addLocal("itOut","i32");let d=h.getCodeBuilder();e?h.addCode(d.setLocal("itIn1",d.i32_add(d.getLocal("pIn1"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(a)))),d.setLocal("itIn2",d.i32_add(d.getLocal("pIn2"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(a)))),d.setLocal("itOut",d.i32_add(d.getLocal("pOut"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(o)))),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn1"),d.getLocal("itIn2"),d.getLocal("itOut")),d.setLocal("itIn1",d.i32_sub(d.getLocal("itIn1"),d.i32_const(a))),d.setLocal("itIn2",d.i32_sub(d.getLocal("itIn2"),d.i32_const(a))),d.setLocal("itOut",d.i32_sub(d.getLocal("itOut"),d.i32_const(o))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0)))):h.addCode(d.setLocal("itIn1",d.getLocal("pIn1")),d.setLocal("itIn2",d.getLocal("pIn2")),d.setLocal("itOut",d.getLocal("pOut")),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn1"),d.getLocal("itIn2"),d.getLocal("itOut")),d.setLocal("itIn1",d.i32_add(d.getLocal("itIn1"),d.i32_const(a))),d.setLocal("itIn2",d.i32_add(d.getLocal("itIn2"),d.i32_const(a))),d.setLocal("itOut",d.i32_add(d.getLocal("itOut"),d.i32_const(o))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0))))}function o_(c,t){return c===t?0:c>t?1:-1}function Xl(c){return c*c}function i_(c){return c%2n!==0n}function Hl(c){return c%2n===0n}function gc(c){return c<0n}function _L(c){return c>0n}function e_(c){return gc(c)?c.toString(2).length-1:c.toString(2).length}function Pi(c){return c<0n?-c:c}function Oo(c){return Pi(c)===1n}function c_(c,t){for(var n=0n,a=1n,o=t,e=Pi(c),h,d,b;e!==0n;)h=o/e,d=n,b=o,n=a,o=e,a=d-h*a,e=b-h*e;if(!Oo(o))throw new Error(c.toString()+" and "+t.toString()+" are not co-prime");return o_(n,0n)===-1&&(n=n+t),gc(c)?-n:n}function s_(c,t,n){if(n===0n)throw new Error("Cannot take modPow with modulus 0");var a=1n,o=c%n;for(gc(t)&&(t=t*-1n,o=c_(o,n));_L(t);){if(o===0n)return 0n;i_(t)&&(a=a*o%n),t=t/2n,o=Xl(o)%n}return a}function hL(c,t){return c=c>=0n?c:-c,t=t>=0n?t:-t,c===t?0:c>t?1:-1}function Au(c,t){return t===0n?!1:Oo(t)?!0:hL(t,2n)===0?Hl(c):c%t===0n}function fL(c){var t=Pi(c);if(Oo(t))return!1;if(t===2n||t===3n||t===5n)return!0;if(Hl(t)||Au(t,3n)||Au(t,5n))return!1;if(t<49n)return!0}function gL(c){return c-1n}function Eu(c,t){for(var n=gL(c),a=n,o=0,e,h,d;Hl(a);)a=a/2n,o++;t:for(h=0;h<t.length;h++)if(!(c<t[h])&&(d=s_(BigInt(t[h]),a,c),!(Oo(d)||d===n))){for(e=o-1;e!=0;e--){if(d=Xl(d)%c,Oo(d))return!1;if(d===n)continue t}return!1}return!0}function LL(c){var t=fL(c);if(t!==void 0)return t;var n=Pi(c),a=e_(n);if(a<=64)return Eu(n,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var o=Math.log(2)*Number(a),e=Math.ceil(o),h=[],d=0;d<e;d++)h.push(BigInt(d+2));return Eu(n,h)}function Ol(c){if(typeof c=="bigint"||c.eq!==void 0)return c.toString(10);if(c instanceof Uint8Array)return qi(c,0);if(Array.isArray(c))return c.map(Ol);if(typeof c=="object"){let t={};return Object.keys(c).forEach(a=>{t[a]=Ol(c[a])}),t}else return c}function Pl(c){if(typeof c=="string"&&/^[0-9]+$/.test(c))return BigInt(c);if(typeof c=="string"&&/^0x[0-9a-fA-F]+$/.test(c))return BigInt(c);if(Array.isArray(c))return c.map(Pl);if(typeof c=="object"){if(c===null)return null;let t={};return Object.keys(c).forEach(a=>{t[a]=Pl(c[a])}),t}else return c}function DL(c){let t=BigInt(0),n=c.length,a=0,o=new DataView(c.buffer,c.byteOffset,c.byteLength);for(;n>0;)n>=4?(n-=4,t+=BigInt(o.getUint32(n))<<BigInt(a*8),a+=4):n>=2?(n-=2,t+=BigInt(o.getUint16(n))<<BigInt(a*8),a+=2):(n-=1,t+=BigInt(o.getUint8(n))<<BigInt(a*8),a+=1);return t}function KL(c,t){let n=c,a=new Uint8Array(t),o=new DataView(a.buffer),e=t;for(;e>0;)e-4>=0?(e-=4,o.setUint32(e,Number(n&BigInt(4294967295))),n=n>>BigInt(32)):e-2>=0?(e-=2,o.setUint16(e,Number(n&BigInt(65535))),n=n>>BigInt(16)):(e-=1,o.setUint8(e,Number(n&BigInt(255))),n=n>>BigInt(8));if(n)throw new Error("Number does not fit in this length");return a}function JL(c){let t=BigInt(0),n=0,a=new DataView(c.buffer,c.byteOffset,c.byteLength);for(;n<c.length;)n+4<=c.length?(t+=BigInt(a.getUint32(n,!0))<<BigInt(n*8),n+=4):n+2<=c.length?(t+=BigInt(a.getUint16(n,!0))<<BigInt(n*8),n+=2):(t+=BigInt(a.getUint8(n,!0))<<BigInt(n*8),n+=1);return t}function L_(c,t){let n=c;typeof t>"u"&&(t=Math.floor((Ii(c)-1)/8)+1,t==0&&(t=1));let a=new Uint8Array(t),o=new DataView(a.buffer),e=0;for(;e<t;)e+4<=t?(o.setUint32(e,Number(n&BigInt(4294967295)),!0),e+=4,n=n>>BigInt(32)):e+2<=t?(o.setUint16(e,Number(n&BigInt(65535)),!0),e+=2,n=n>>BigInt(16)):(o.setUint8(e,Number(n&BigInt(255)),!0),e+=1,n=n>>BigInt(8));if(n)throw new Error("Number does not fit in this length");return a}function Ml(c,t){if(typeof t=="bigint"||t.eq!==void 0)return t.toString(10);if(t instanceof Uint8Array)return c.toString(c.e(t));if(Array.isArray(t))return t.map(Ml.bind(this,c));if(typeof t=="object"){let n={};return Object.keys(t).forEach(o=>{n[o]=Ml(c,t[o])}),n}else return t}function Rl(c,t){if(typeof t=="string"&&/^[0-9]+$/.test(t))return c.e(t);if(typeof t=="string"&&/^0x[0-9a-fA-F]+$/.test(t))return c.e(t);if(Array.isArray(t))return t.map(Rl.bind(this,c));if(typeof t=="object"){if(t===null)return null;let n={};return Object.keys(t).forEach(o=>{n[o]=Rl(c,t[o])}),n}else return t}function YL(c,t){let n=0,a=c;for(let o=0;o<t;o++)n<<=1,n=n|a&1,a>>=1;return n}function p_(c,t){return(vi[c>>>24]|vi[c>>>16&255]<<8|vi[c>>>8&255]<<16|vi[c&255]<<24)>>>32-t}function Yn(c){return((c&4294901760)!==0?(c&=4294901760,16):0)|((c&4278255360)!==0?(c&=4278255360,8):0)|((c&4042322160)!==0?(c&=4042322160,4):0)|((c&3435973836)!==0?(c&=3435973836,2):0)|(c&2863311530)!==0}function b_(c,t){let n=c.byteLength/t,a=Yn(n);if(n!=1<<a)throw new Error("Invalid number of pointers");for(let o=0;o<n;o++){let e=p_(o,a);if(o>e){let h=c.slice(o*t,(o+1)*t);c.set(c.slice(e*t,(e+1)*t),o*t),c.set(h,e*t)}}}function Kl(c,t){let n=new Uint8Array(t*c.length);for(let a=0;a<c.length;a++)n.set(c[a],a*t);return n}function cc(c,t){let n=c.byteLength/t,a=new Array(n);for(let o=0;o<n;o++)a[o]=c.slice(o*t,o*t+t);return a}function Za(c,t,n,a){return async function(e){let h=Math.floor(e.byteLength/n);if(h*n!==e.byteLength)throw new Error("Invalid buffer size");let d=Math.floor(h/c.concurrency),b=[];for(let B=0;B<c.concurrency;B++){let p;if(B<c.concurrency-1?p=d:p=h-B*d,p==0)continue;let M=[{cmd:"ALLOCSET",var:0,buff:e.slice(B*d*n,B*d*n+p*n)},{cmd:"ALLOC",var:1,len:a*p},{cmd:"CALL",fnName:t,params:[{var:0},{val:p},{var:1}]},{cmd:"GET",out:0,var:1,len:a*p}];b.push(c.queueAction(M))}let l=await Promise.all(b),s;e instanceof Ln?s=new Ln(h*a):s=new Uint8Array(h*a);let m=0;for(let B=0;B<l.length;B++)s.set(l[B][0],m),m+=l[B][0].byteLength;return s}}function np(c){let n,a;c&&(c.onmessage=function(s){let m;if(s.data?m=s.data:m=s,m[0].cmd=="INIT")o(m[0]).then(function(){c.postMessage(m.result)});else if(m[0].cmd=="TERMINATE")c.close();else{let B=l(m);c.postMessage(B)}});async function o(s){let m=new Uint8Array(s.code),B=await WebAssembly.compile(m);a=new WebAssembly.Memory({initial:s.init,maximum:32767}),n=await WebAssembly.instantiate(B,{env:{memory:a}})}function e(s){let m=new Uint32Array(a.buffer,0,1);for(;m[0]&3;)m[0]++;let B=m[0];if(m[0]+=s,m[0]+s>a.buffer.byteLength){let p=a.buffer.byteLength/65536,v=Math.floor((m[0]+s)/65536)+1;v>32767&&(v=32767),a.grow(v-p)}return B}function h(s){let m=e(s.byteLength);return b(m,s),m}function d(s,m){let B=new Uint8Array(a.buffer);return new Uint8Array(B.buffer,B.byteOffset+s,m)}function b(s,m){new Uint8Array(a.buffer).set(new Uint8Array(m),s)}function l(s){if(s[0].cmd=="INIT")return o(s[0]);let m={vars:[],out:[]},p=new Uint32Array(a.buffer,0,1)[0];for(let M=0;M<s.length;M++)switch(s[M].cmd){case"ALLOCSET":m.vars[s[M].var]=h(s[M].buff);break;case"ALLOC":m.vars[s[M].var]=e(s[M].len);break;case"SET":b(m.vars[s[M].var],s[M].buff);break;case"CALL":{let x=[];for(let S=0;S<s[M].params.length;S++){let w=s[M].params[S];typeof w.var<"u"?x.push(m.vars[w.var]+(w.offset||0)):typeof w.val<"u"&&x.push(w.val)}n.exports[s[M].fnName](...x);break}case"GET":m.out[s[M].out]=d(m.vars[s[M].var],s[M].len).slice();break;default:throw new Error("Invalid cmd")}let v=new Uint32Array(a.buffer,0,1);return v[0]=p,m.out}return l}function ap(c){return new Promise(t=>setTimeout(t,c))}async function op(c,t){let n=new Gl;n.memory=new WebAssembly.Memory({initial:wl}),n.u8=new Uint8Array(n.memory.buffer),n.u32=new Uint32Array(n.memory.buffer);let a=await WebAssembly.compile(c.code);if(n.instance=await WebAssembly.instantiate(a,{env:{memory:n.memory}}),globalThis?.Worker||(t=!0),n.singleThread=t,n.initalPFree=n.u32[0],n.pq=c.pq,n.pr=c.pr,n.pG1gen=c.pG1gen,n.pG1zero=c.pG1zero,n.pG2gen=c.pG2gen,n.pG2zero=c.pG2zero,n.pOneT=c.pOneT,t)n.code=c.code,n.taskManager=np(),await n.taskManager([{cmd:"INIT",init:wl,code:n.code.slice()}]),n.concurrency=1;else{n.workers=[],n.pendingDeferreds=[],n.working=[];let e=2;typeof navigator=="object"&&navigator.hardwareConcurrency&&(e=navigator.hardwareConcurrency),e==0&&(e=2),e>64&&(e=64),n.concurrency=e;for(let d=0;d<e;d++)n.workers[d]=new Worker(Tl),n.workers[d].addEventListener("message",o(d)),n.working[d]=!1;let h=[];for(let d=0;d<n.workers.length;d++){let b=c.code.slice();h.push(n.postAction(d,[{cmd:"INIT",init:wl,code:b}],[b.buffer]))}await Promise.all(h)}return n;function o(e){return function(h){let d;h&&h.data?d=h.data:d=h,n.working[e]=!1,n.pendingDeferreds[e].resolve(d),n.processWorks()}}}function Fl(c,t){let n=c[t],a=c.Fr,o=c.tm;c[t].batchApplyKey=async function(e,h,d,b,l){b=b||"affine",l=l||"affine";let s,m,B,p,v;if(t=="G1")b=="jacobian"?(B=n.F.n8*3,s="g1m_batchApplyKey"):(B=n.F.n8*2,s="g1m_batchApplyKeyMixed"),p=n.F.n8*3,l=="jacobian"?v=n.F.n8*3:(m="g1m_batchToAffine",v=n.F.n8*2);else if(t=="G2")b=="jacobian"?(B=n.F.n8*3,s="g2m_batchApplyKey"):(B=n.F.n8*2,s="g2m_batchApplyKeyMixed"),p=n.F.n8*3,l=="jacobian"?v=n.F.n8*3:(m="g2m_batchToAffine",v=n.F.n8*2);else if(t=="Fr")s="frm_batchApplyKey",B=n.n8,p=n.n8,v=n.n8;else throw new Error("Invalid group: "+t);let M=Math.floor(e.byteLength/B),x=Math.floor(M/o.concurrency),S=[];d=a.e(d);let w=a.e(h);for(let F=0;F<o.concurrency;F++){let u;if(F<o.concurrency-1?u=x:u=M-F*x,u==0)continue;let L=[];L.push({cmd:"ALLOCSET",var:0,buff:e.slice(F*x*B,F*x*B+u*B)}),L.push({cmd:"ALLOCSET",var:1,buff:w}),L.push({cmd:"ALLOCSET",var:2,buff:d}),L.push({cmd:"ALLOC",var:3,len:u*Math.max(p,v)}),L.push({cmd:"CALL",fnName:s,params:[{var:0},{val:u},{var:1},{var:2},{var:3}]}),m&&L.push({cmd:"CALL",fnName:m,params:[{var:3},{val:u},{var:3}]}),L.push({cmd:"GET",out:0,var:3,len:u*v}),S.push(o.queueAction(L)),w=a.mul(w,a.exp(d,u))}let k=await Promise.all(S),O;e instanceof Ln?O=new Ln(M*v):O=new Uint8Array(M*v);let W=0;for(let F=0;F<k.length;F++)O.set(k[F][0],W),W+=k[F][0].byteLength;return O}}function ip(c){let t=c.tm;c.pairing=function(a,o){t.startSyncOp();let e=t.allocBuff(c.G1.toJacobian(a)),h=t.allocBuff(c.G2.toJacobian(o)),d=t.alloc(c.Gt.n8);t.instance.exports[c.name+"_pairing"](e,h,d);let b=t.getBuff(d,c.Gt.n8);return t.endSyncOp(),b},c.pairingEq=async function(){let a,o;arguments.length%2==1?(a=arguments[arguments.length-1],o=(arguments.length-1)/2):(a=c.Gt.one,o=arguments.length/2);let e=[];for(let s=0;s<o;s++){let m=[],B=c.G1.toJacobian(arguments[s*2]);m.push({cmd:"ALLOCSET",var:0,buff:B}),m.push({cmd:"ALLOC",var:1,len:c.prePSize});let p=c.G2.toJacobian(arguments[s*2+1]);m.push({cmd:"ALLOCSET",var:2,buff:p}),m.push({cmd:"ALLOC",var:3,len:c.preQSize}),m.push({cmd:"ALLOC",var:4,len:c.Gt.n8}),m.push({cmd:"CALL",fnName:c.name+"_prepareG1",params:[{var:0},{var:1}]}),m.push({cmd:"CALL",fnName:c.name+"_prepareG2",params:[{var:2},{var:3}]}),m.push({cmd:"CALL",fnName:c.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),m.push({cmd:"GET",out:0,var:4,len:c.Gt.n8}),e.push(t.queueAction(m))}let h=await Promise.all(e);t.startSyncOp();let d=t.alloc(c.Gt.n8);t.instance.exports.ftm_one(d);for(let s=0;s<h.length;s++){let m=t.allocBuff(h[s][0]);t.instance.exports.ftm_mul(d,m,d)}t.instance.exports[c.name+"_finalExponentiation"](d,d);let b=t.allocBuff(a),l=!!t.instance.exports.ftm_eq(d,b);return t.endSyncOp(),l},c.prepareG1=function(n){this.tm.startSyncOp();let a=this.tm.allocBuff(n),o=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](a,o);let e=this.tm.getBuff(o,this.prePSize);return this.tm.endSyncOp(),e},c.prepareG2=function(n){this.tm.startSyncOp();let a=this.tm.allocBuff(n),o=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](a,o);let e=this.tm.getBuff(o,this.preQSize);return this.tm.endSyncOp(),e},c.millerLoop=function(n,a){this.tm.startSyncOp();let o=this.tm.allocBuff(n),e=this.tm.allocBuff(a),h=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](o,e,h);let d=this.tm.getBuff(h,this.Gt.n8);return this.tm.endSyncOp(),d},c.finalExponentiation=function(n){this.tm.startSyncOp();let a=this.tm.allocBuff(n),o=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](a,o);let e=this.tm.getBuff(o,this.Gt.n8);return this.tm.endSyncOp(),e}}function $u(c,t){let n=c[t],a=n.tm;async function o(h,d,b,l,s){if(!(h instanceof Uint8Array))throw l&&l.error(`${s} _multiExpChunk buffBases is not Uint8Array`),new Error(`${s} _multiExpChunk buffBases is not Uint8Array`);if(!(d instanceof Uint8Array))throw l&&l.error(`${s} _multiExpChunk buffScalars is not Uint8Array`),new Error(`${s} _multiExpChunk buffScalars is not Uint8Array`);b=b||"affine";let m,B;if(t=="G1")b=="affine"?(B="g1m_multiexpAffine_chunk",m=n.F.n8*2):(B="g1m_multiexp_chunk",m=n.F.n8*3);else if(t=="G2")b=="affine"?(B="g2m_multiexpAffine_chunk",m=n.F.n8*2):(B="g2m_multiexp_chunk",m=n.F.n8*3);else throw new Error("Invalid group");let p=Math.floor(h.byteLength/m);if(p==0)return n.zero;let v=Math.floor(d.byteLength/p);if(v*p!=d.byteLength)throw new Error("Scalar size does not match");let M=Nu[Yn(p)],x=Math.floor((v*8-1)/M)+1,S=[];for(let O=0;O<x;O++){let W=[{cmd:"ALLOCSET",var:0,buff:h},{cmd:"ALLOCSET",var:1,buff:d},{cmd:"ALLOC",var:2,len:n.F.n8*3},{cmd:"CALL",fnName:B,params:[{var:0},{var:1},{val:v},{val:p},{val:O*M},{val:Math.min(v*8-O*M,M)},{var:2}]},{cmd:"GET",out:0,var:2,len:n.F.n8*3}];S.push(n.tm.queueAction(W))}let w=await Promise.all(S),k=n.zero;for(let O=w.length-1;O>=0;O--){if(!n.isZero(k))for(let W=0;W<M;W++)k=n.double(k);k=n.add(k,w[O][0])}return k}async function e(h,d,b,l,s){let p;if(t=="G1")b=="affine"?p=n.F.n8*2:p=n.F.n8*3;else if(t=="G2")b=="affine"?p=n.F.n8*2:p=n.F.n8*3;else throw new Error("Invalid group");let v=Math.floor(h.byteLength/p);if(v==0)return n.zero;let M=Math.floor(d.byteLength/v);if(M*v!=d.byteLength)throw new Error("Scalar size does not match");let x=Nu[Yn(v)],S=Math.floor((M*8-1)/x)+1,w;w=Math.floor(v/(a.concurrency/S)),w>4194304&&(w=4194304),w<1024&&(w=1024);let k=[];for(let F=0;F<v;F+=w){l&&l.debug(`Multiexp start: ${s}: ${F}/${v}`);let u=Math.min(v-F,w),L=h.slice(F*p,(F+u)*p),$=d.slice(F*M,(F+u)*M);k.push(o(L,$,b,l,s).then(Q=>(l&&l.debug(`Multiexp end: ${s}: ${F}/${v}`),Q)))}let O=await Promise.all(k),W=n.zero;for(let F=O.length-1;F>=0;F--)W=n.add(W,O[F]);return W}n.multiExp=async function(d,b,l,s){return await e(d,b,"jacobian",l,s)},n.multiExpAffine=async function(d,b,l,s){return await e(d,b,"affine",l,s)}}function Cl(c,t){let n=c[t],a=c.Fr,o=n.tm;async function e(l,s,m,B,p,v){m=m||"affine",B=B||"affine";let M=14,x,S,w,k,O,W,F,u;t=="G1"?(m=="affine"?(x=n.F.n8*2,k="g1m_batchToJacobian"):x=n.F.n8*3,S=n.F.n8*3,s&&(u="g1m_fftFinal"),F="g1m_fftJoin",W="g1m_fftMix",B=="affine"?(w=n.F.n8*2,O="g1m_batchToAffine"):w=n.F.n8*3):t=="G2"?(m=="affine"?(x=n.F.n8*2,k="g2m_batchToJacobian"):x=n.F.n8*3,S=n.F.n8*3,s&&(u="g2m_fftFinal"),F="g2m_fftJoin",W="g2m_fftMix",B=="affine"?(w=n.F.n8*2,O="g2m_batchToAffine"):w=n.F.n8*3):t=="Fr"&&(x=n.n8,S=n.n8,w=n.n8,s&&(u="frm_fftFinal"),W="frm_fftMix",F="frm_fftJoin");let L=!1;Array.isArray(l)?(l=Kl(l,x),L=!0):l=l.slice(0,l.byteLength);let $=l.byteLength/x,Q=Yn($);if(1<<Q!=$)throw new Error("fft must be multiple of 2");if(Q==a.s+1){let j;return s?j=await d(l,m,B,p,v):j=await h(l,m,B,p,v),L?cc(j,w):j}let H;s&&(H=a.inv(a.e($)));let q;b_(l,x);let y,I=Math.min(1<<M,$),N=$/I;for(;N<o.concurrency&&I>=16;)N*=2,I/=2;let nt=Yn(I),J=[];for(let j=0;j<N;j++){p&&p.debug(`${v}: fft ${Q} mix start: ${j}/${N}`);let ot=[];ot.push({cmd:"ALLOC",var:0,len:S*I});let V=l.slice(I*j*x,I*(j+1)*x);ot.push({cmd:"SET",var:0,buff:V}),k&&ot.push({cmd:"CALL",fnName:k,params:[{var:0},{val:I},{var:0}]});for(let at=1;at<=nt;at++)ot.push({cmd:"CALL",fnName:W,params:[{var:0},{val:I},{val:at}]});nt==Q?(u&&(ot.push({cmd:"ALLOCSET",var:1,buff:H}),ot.push({cmd:"CALL",fnName:u,params:[{var:0},{val:I},{var:1}]})),O&&ot.push({cmd:"CALL",fnName:O,params:[{var:0},{val:I},{var:0}]}),ot.push({cmd:"GET",out:0,var:0,len:I*w})):ot.push({cmd:"GET",out:0,var:0,len:S*I}),J.push(o.queueAction(ot).then(at=>(p&&p.debug(`${v}: fft ${Q} mix end: ${j}/${N}`),at)))}y=await Promise.all(J);for(let j=0;j<N;j++)y[j]=y[j][0];for(let j=nt+1;j<=Q;j++){p&&p.debug(`${v}: fft  ${Q}  join: ${j}/${Q}`);let ot=1<<Q-j,V=N/ot,at=[];for(let rt=0;rt<ot;rt++)for(let ht=0;ht<V/2;ht++){let A=a.exp(a.w[j],ht*I),i=a.w[j],C=rt*V+ht,r=rt*V+ht+V/2,z=[];z.push({cmd:"ALLOCSET",var:0,buff:y[C]}),z.push({cmd:"ALLOCSET",var:1,buff:y[r]}),z.push({cmd:"ALLOCSET",var:2,buff:A}),z.push({cmd:"ALLOCSET",var:3,buff:i}),z.push({cmd:"CALL",fnName:F,params:[{var:0},{var:1},{val:I},{var:2},{var:3}]}),j==Q?(u&&(z.push({cmd:"ALLOCSET",var:4,buff:H}),z.push({cmd:"CALL",fnName:u,params:[{var:0},{val:I},{var:4}]}),z.push({cmd:"CALL",fnName:u,params:[{var:1},{val:I},{var:4}]})),O&&(z.push({cmd:"CALL",fnName:O,params:[{var:0},{val:I},{var:0}]}),z.push({cmd:"CALL",fnName:O,params:[{var:1},{val:I},{var:1}]})),z.push({cmd:"GET",out:0,var:0,len:I*w}),z.push({cmd:"GET",out:1,var:1,len:I*w})):(z.push({cmd:"GET",out:0,var:0,len:I*S}),z.push({cmd:"GET",out:1,var:1,len:I*S})),at.push(o.queueAction(z).then(E=>(p&&p.debug(`${v}: fft ${Q} join  ${j}/${Q}  ${rt+1}/${ot} ${ht}/${V/2}`),E)))}let Lt=await Promise.all(at);for(let rt=0;rt<ot;rt++)for(let ht=0;ht<V/2;ht++){let A=rt*V+ht,i=rt*V+ht+V/2,C=Lt.shift();y[A]=C[0],y[i]=C[1]}}if(l instanceof Ln?q=new Ln($*w):q=new Uint8Array($*w),s){q.set(y[0].slice((I-1)*w));let j=w;for(let ot=N-1;ot>0;ot--)q.set(y[ot],j),j+=I*w,delete y[ot];q.set(y[0].slice(0,(I-1)*w),j),delete y[0]}else for(let j=0;j<N;j++)q.set(y[j],I*w*j),delete y[j];return L?cc(q,w):q}async function h(l,s,m,B,p){let v,M;v=l.slice(0,l.byteLength/2),M=l.slice(l.byteLength/2,l.byteLength);let x=[];[v,M]=await b(v,M,"fftJoinExt",a.one,a.shift,s,"jacobian",B,p),x.push(e(v,!1,"jacobian",m,B,p)),x.push(e(M,!1,"jacobian",m,B,p));let S=await Promise.all(x),w;return S[0].byteLength>1<<28?w=new Ln(S[0].byteLength*2):w=new Uint8Array(S[0].byteLength*2),w.set(S[0]),w.set(S[1],S[0].byteLength),w}async function d(l,s,m,B,p){let v,M;v=l.slice(0,l.byteLength/2),M=l.slice(l.byteLength/2,l.byteLength);let x=[];x.push(e(v,!0,s,"jacobian",B,p)),x.push(e(M,!0,s,"jacobian",B,p)),[v,M]=await Promise.all(x);let S=await b(v,M,"fftJoinExtInv",a.one,a.shiftInv,"jacobian",m,B,p),w;return S[0].byteLength>1<<28?w=new Ln(S[0].byteLength*2):w=new Uint8Array(S[0].byteLength*2),w.set(S[0]),w.set(S[1],S[0].byteLength),w}async function b(l,s,m,B,p,v,M,x,S){let O,W,F,u,L,$;if(t=="G1")v=="affine"?(L=n.F.n8*2,W="g1m_batchToJacobian"):L=n.F.n8*3,$=n.F.n8*3,O="g1m_"+m,M=="affine"?(F="g1m_batchToAffine",u=n.F.n8*2):u=n.F.n8*3;else if(t=="G2")v=="affine"?(L=n.F.n8*2,W="g2m_batchToJacobian"):L=n.F.n8*3,O="g2m_"+m,$=n.F.n8*3,M=="affine"?(F="g2m_batchToAffine",u=n.F.n8*2):u=n.F.n8*3;else if(t=="Fr")L=a.n8,u=a.n8,$=a.n8,O="frm_"+m;else throw new Error("Invalid group");if(l.byteLength!=s.byteLength)throw new Error("Invalid buffer size");let Q=Math.floor(l.byteLength/L);if(Q!=1<<Yn(Q))throw new Error("Invalid number of points");let H=Math.floor(Q/o.concurrency);H<16&&(H=16),H>65536&&(H=65536);let q=[];for(let J=0;J<Q;J+=H){x&&x.debug(`${S}: fftJoinExt Start: ${J}/${Q}`);let j=Math.min(Q-J,H),ot=a.mul(B,a.exp(p,J)),V=[],at=l.slice(J*L,(J+j)*L),Lt=s.slice(J*L,(J+j)*L);V.push({cmd:"ALLOC",var:0,len:$*j}),V.push({cmd:"SET",var:0,buff:at}),V.push({cmd:"ALLOC",var:1,len:$*j}),V.push({cmd:"SET",var:1,buff:Lt}),V.push({cmd:"ALLOCSET",var:2,buff:ot}),V.push({cmd:"ALLOCSET",var:3,buff:p}),W&&(V.push({cmd:"CALL",fnName:W,params:[{var:0},{val:j},{var:0}]}),V.push({cmd:"CALL",fnName:W,params:[{var:1},{val:j},{var:1}]})),V.push({cmd:"CALL",fnName:O,params:[{var:0},{var:1},{val:j},{var:2},{var:3},{val:a.s}]}),F&&(V.push({cmd:"CALL",fnName:F,params:[{var:0},{val:j},{var:0}]}),V.push({cmd:"CALL",fnName:F,params:[{var:1},{val:j},{var:1}]})),V.push({cmd:"GET",out:0,var:0,len:j*u}),V.push({cmd:"GET",out:1,var:1,len:j*u}),q.push(o.queueAction(V).then(rt=>(x&&x.debug(`${S}: fftJoinExt End: ${J}/${Q}`),rt)))}let y=await Promise.all(q),I,N;Q*u>1<<28?(I=new Ln(Q*u),N=new Ln(Q*u)):(I=new Uint8Array(Q*u),N=new Uint8Array(Q*u));let nt=0;for(let J=0;J<y.length;J++)I.set(y[J][0],nt),N.set(y[J][1],nt),nt+=y[J][0].byteLength;return[I,N]}n.fft=async function(l,s,m,B,p){return await e(l,!1,s,m,B,p)},n.ifft=async function(l,s,m,B,p){return await e(l,!0,s,m,B,p)},n.lagrangeEvaluations=async function(l,s,m,B,p){s=s||"affine",m=m||"affine";let v;if(t=="G1")s=="affine"?v=n.F.n8*2:v=n.F.n8*3;else if(t=="G2")s=="affine"?v=n.F.n8*2:v=n.F.n8*3;else if(t=="Fr")v=a.n8;else throw new Error("Invalid group");let M=l.byteLength/v,x=Yn(M);if(2**x*v!=l.byteLength)throw B&&B.error("lagrangeEvaluations iinvalid input size"),new Error("lagrangeEvaluations invalid Input size");if(x<=a.s)return await n.ifft(l,s,m,B,p);if(x>a.s+1)throw B&&B.error("lagrangeEvaluations input too big"),new Error("lagrangeEvaluations input too big");let S=l.slice(0,l.byteLength/2),w=l.slice(l.byteLength/2,l.byteLength),k=a.exp(a.shift,M/2),O=a.inv(a.sub(a.one,k));[S,w]=await b(S,w,"prepareLagrangeEvaluation",O,a.shiftInv,s,"jacobian",B,p+" prep");let W=[];W.push(e(S,!0,"jacobian",m,B,p+" t0")),W.push(e(w,!0,"jacobian",m,B,p+" t1")),[S,w]=await Promise.all(W);let F;return S.byteLength>1<<28?F=new Ln(S.byteLength*2):F=new Uint8Array(S.byteLength*2),F.set(S),F.set(w,S.byteLength),F},n.fftMix=async function(s){let m=n.F.n8*3,B,p;if(t=="G1")B="g1m_fftMix",p="g1m_fftJoin";else if(t=="G2")B="g2m_fftMix",p="g2m_fftJoin";else if(t=="Fr")B="frm_fftMix",p="frm_fftJoin";else throw new Error("Invalid group");let v=Math.floor(s.byteLength/m),M=Yn(v),x=1<<Yn(o.concurrency);v<=x*2&&(x=1);let S=v/x,w=Yn(S),k=[];for(let L=0;L<x;L++){let $=[],Q=s.slice(L*S*m,(L+1)*S*m);$.push({cmd:"ALLOCSET",var:0,buff:Q});for(let H=1;H<=w;H++)$.push({cmd:"CALL",fnName:B,params:[{var:0},{val:S},{val:H}]});$.push({cmd:"GET",out:0,var:0,len:S*m}),k.push(o.queueAction($))}let O=await Promise.all(k),W=[];for(let L=0;L<O.length;L++)W[L]=O[L][0];for(let L=w+1;L<=M;L++){let $=1<<M-L,Q=x/$,H=[];for(let y=0;y<$;y++)for(let I=0;I<Q/2;I++){let N=a.exp(a.w[L],I*S),nt=a.w[L],J=y*Q+I,j=y*Q+I+Q/2,ot=[];ot.push({cmd:"ALLOCSET",var:0,buff:W[J]}),ot.push({cmd:"ALLOCSET",var:1,buff:W[j]}),ot.push({cmd:"ALLOCSET",var:2,buff:N}),ot.push({cmd:"ALLOCSET",var:3,buff:nt}),ot.push({cmd:"CALL",fnName:p,params:[{var:0},{var:1},{val:S},{var:2},{var:3}]}),ot.push({cmd:"GET",out:0,var:0,len:S*m}),ot.push({cmd:"GET",out:1,var:1,len:S*m}),H.push(o.queueAction(ot))}let q=await Promise.all(H);for(let y=0;y<$;y++)for(let I=0;I<Q/2;I++){let N=y*Q+I,nt=y*Q+I+Q/2,J=q.shift();W[N]=J[0],W[nt]=J[1]}}let F;s instanceof Ln?F=new Ln(v*m):F=new Uint8Array(v*m);let u=0;for(let L=0;L<x;L++)F.set(W[L],u),u+=W[L].byteLength;return F},n.fftJoin=async function(s,m,B,p){let v=n.F.n8*3,M;if(t=="G1")M="g1m_fftJoin";else if(t=="G2")M="g2m_fftJoin";else if(t=="Fr")M="frm_fftJoin";else throw new Error("Invalid group");if(s.byteLength!=m.byteLength)throw new Error("Invalid buffer size");let x=Math.floor(s.byteLength/v);if(x!=1<<Yn(x))throw new Error("Invalid number of points");let S=1<<Yn(o.concurrency);x<=S*2&&(S=1);let w=x/S,k=[];for(let L=0;L<S;L++){let $=[],Q=a.mul(B,a.exp(p,L*w)),H=s.slice(L*w*v,(L+1)*w*v),q=m.slice(L*w*v,(L+1)*w*v);$.push({cmd:"ALLOCSET",var:0,buff:H}),$.push({cmd:"ALLOCSET",var:1,buff:q}),$.push({cmd:"ALLOCSET",var:2,buff:Q}),$.push({cmd:"ALLOCSET",var:3,buff:p}),$.push({cmd:"CALL",fnName:M,params:[{var:0},{var:1},{val:w},{var:2},{var:3}]}),$.push({cmd:"GET",out:0,var:0,len:w*v}),$.push({cmd:"GET",out:1,var:1,len:w*v}),k.push(o.queueAction($))}let O=await Promise.all(k),W,F;s instanceof Ln?(W=new Ln(x*v),F=new Ln(x*v)):(W=new Uint8Array(x*v),F=new Uint8Array(x*v));let u=0;for(let L=0;L<O.length;L++)W.set(O[L][0],u),F.set(O[L][1],u),u+=O[L][0].byteLength;return[W,F]},n.fftFinal=async function(s,m){let B=n.F.n8*3,p=n.F.n8*2,v,M;if(t=="G1")v="g1m_fftFinal",M="g1m_batchToAffine";else if(t=="G2")v="g2m_fftFinal",M="g2m_batchToAffine";else throw new Error("Invalid group");let x=Math.floor(s.byteLength/B);if(x!=1<<Yn(x))throw new Error("Invalid number of points");let S=Math.floor(x/o.concurrency),w=[];for(let F=0;F<o.concurrency;F++){let u;if(F<o.concurrency-1?u=S:u=x-F*S,u==0)continue;let L=[],$=s.slice(F*S*B,(F*S+u)*B);L.push({cmd:"ALLOCSET",var:0,buff:$}),L.push({cmd:"ALLOCSET",var:1,buff:m}),L.push({cmd:"CALL",fnName:v,params:[{var:0},{val:u},{var:1}]}),L.push({cmd:"CALL",fnName:M,params:[{var:0},{val:u},{var:0}]}),L.push({cmd:"GET",out:0,var:0,len:u*p}),w.push(o.queueAction(L))}let k=await Promise.all(w),O;s instanceof Ln?O=new Ln(x*p):O=new Uint8Array(x*p);let W=0;for(let F=k.length-1;F>=0;F--)O.set(k[F][0],W),W+=k[F][0].byteLength;return O}}async function m_(c){let t=await op(c.wasm,c.singleThread),n={};return n.q=yn(c.wasm.q.toString()),n.r=yn(c.wasm.r.toString()),n.name=c.name,n.tm=t,n.prePSize=c.wasm.prePSize,n.preQSize=c.wasm.preQSize,n.Fr=new sc(t,"frm",c.n8r,c.r),n.F1=new sc(t,"f1m",c.n8q,c.q),n.F2=new lc(t,"f2m",n.F1),n.G1=new rc(t,"g1m",n.F1,c.wasm.pG1gen,c.wasm.pG1b,c.cofactorG1),n.G2=new rc(t,"g2m",n.F2,c.wasm.pG2gen,c.wasm.pG2b,c.cofactorG2),n.F6=new zl(t,"f6m",n.F2),n.F12=new lc(t,"ftm",n.F6),n.Gt=n.F12,Fl(n,"G1"),Fl(n,"G2"),Fl(n,"Fr"),$u(n,"G1"),$u(n,"G2"),Cl(n,"G1"),Cl(n,"G2"),Cl(n,"Fr"),ip(n),n.array2buffer=function(a,o){let e=new Uint8Array(o*a.length);for(let h=0;h<a.length;h++)e.set(a[h],h*o);return e},n.buffer2array=function(a,o){let e=a.byteLength/o,h=new Array(e);for(let d=0;d<e;d++)h[d]=a.slice(d*o,d*o+o);return h},n}function Po(c){return BigInt(c)}function y_(c){return c<0n}function ep(c){return c===0n}function cp(c){return y_(c)?c.toString(2).length-1:c.toString(2).length}function Bl(c){let t=[],n=Po(c);return t.push(Number(n&0xFFn)),t.push(Number(n>>8n&0xFFn)),t.push(Number(n>>16n&0xFFn)),t.push(Number(n>>24n&0xFFn)),t}function sp(c){for(var t=[],n=0;n<c.length;n++){var a=c.charCodeAt(n);a<128?t.push(a):a<2048?t.push(192|a>>6,128|a&63):a<55296||a>=57344?t.push(224|a>>12,128|a>>6&63,128|a&63):(n++,a=65536+((a&1023)<<10|c.charCodeAt(n)&1023),t.push(240|a>>18,128|a>>12&63,128|a>>6&63,128|a&63))}return t}function Ai(c){let t=sp(c);return[...Wt(t.length),...t]}function w_(c){let t=[],n=Po(c);if(y_(n))throw new Error("Number cannot be negative");for(;!ep(n);)t.push(Number(n&0x7Fn)),n=n>>7n;t.length==0&&t.push(0);for(let a=0;a<t.length-1;a++)t[a]=t[a]|128;return t}function F_(c){let t,n,a=cp(c);c<0?(n=!0,t=(1n<<BigInt(a))+c):(n=!1,t=Po(c));let o=7-a%7,e=(1n<<BigInt(o))-1n<<BigInt(a),h=(1<<7-o)-1|128,d=w_(t+e);return n||(d[d.length-1]=d[d.length-1]&h),d}function kl(c){let t=Po(c);if(t>0xFFFFFFFFn)throw new Error("Number too big");if(t>0x7FFFFFFFn&&(t=t-0x100000000n),t<-2147483648n)throw new Error("Number too small");return F_(t)}function lp(c){let t=Po(c);if(t>0xFFFFFFFFFFFFFFFFn)throw new Error("Number too big");if(t>0x7FFFFFFFFFFFFFFFn&&(t=t-0x10000000000000000n),t<-9223372036854775808n)throw new Error("Number too small");return F_(t)}function Wt(c){let t=Po(c);if(t>0xFFFFFFFFn)throw new Error("Number too big");return w_(t)}function Zu(c){return Array.from(c,function(t){return("0"+(t&255).toString(16)).slice(-2)}).join("")}async function Lc(c,t){if(!c&&globalThis.curve_bn128)return globalThis.curve_bn128;let n=new _c;n.setMemory(25),XL(n),t&&t(n);let a={};a.code=n.build(),a.pq=n.modules.f1m.pq,a.pr=n.modules.frm.pq,a.pG1gen=n.modules.bn128.pG1gen,a.pG1zero=n.modules.bn128.pG1zero,a.pG1b=n.modules.bn128.pG1b,a.pG2gen=n.modules.bn128.pG2gen,a.pG2zero=n.modules.bn128.pG2zero,a.pG2b=n.modules.bn128.pG2b,a.pOneT=n.modules.bn128.pOneT,a.prePSize=n.modules.bn128.prePSize,a.preQSize=n.modules.bn128.preQSize,a.n8q=32,a.n8r=32,a.q=n.modules.bn128.q,a.r=n.modules.bn128.r;let o={name:"bn128",wasm:a,q:yn("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:yn("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:yn("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!c},e=await m_(o);return e.terminate=async function(){o.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},c||(globalThis.curve_bn128=e),e}async function pc(c,t){if(!c&&globalThis.curve_bls12381)return globalThis.curve_bls12381;let n=new _c;n.setMemory(25),HL(n),t&&t(n);let a={};a.code=n.build(),a.pq=n.modules.f1m.pq,a.pr=n.modules.frm.pq,a.pG1gen=n.modules.bls12381.pG1gen,a.pG1zero=n.modules.bls12381.pG1zero,a.pG1b=n.modules.bls12381.pG1b,a.pG2gen=n.modules.bls12381.pG2gen,a.pG2zero=n.modules.bls12381.pG2zero,a.pG2b=n.modules.bls12381.pG2b,a.pOneT=n.modules.bls12381.pOneT,a.prePSize=n.modules.bls12381.prePSize,a.preQSize=n.modules.bls12381.preQSize,a.n8q=48,a.n8r=32,a.q=n.modules.bls12381.q,a.r=n.modules.bls12381.r;let o={name:"bls12381",wasm:a,q:yn("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:yn("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:yn("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:yn("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!c},e=await m_(o);return e.terminate=async function(){o.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},c||(globalThis.curve_bls12381=e),e}async function hp(c,t,n){let a;if(_a(c,dp))a=await Lc(t,n);else if(_a(c,rp))a=await pc(t,n);else throw new Error(`Curve not supported: ${fc(c)}`);return a}async function fp(c,t,n){let a;if(_a(c,_p))a=await Lc(t,n);else if(_a(c,up))a=await pc(t,n);else throw new Error(`Curve not supported: ${fc(c,16)}`);return a}async function gp(c,t,n){let a,o=e(c);if(["BN128","BN254","ALTBN128"].indexOf(o)>=0)a=await Lc(t,n);else if(["BLS12381"].indexOf(o)>=0)a=await pc(t,n);else throw new Error(`Curve not supported: ${c}`);return a;function e(h){return h.toUpperCase().match(/[A-Za-z0-9]+/g).join("")}}var Pg,yn,Rg,zg,Yu,uo,Hg,Al,Ei,ic,Ke,El,vl,Sl,ql,Il,ja,sL,Wl,Ql,a_,dL,Wn,pL,qa,bL,mL,gl,Ll,yL,pl,vu,Su,wL,FL,Dl,CL,BL,l_,xL,AL,bl,r_,EL,vL,d_,SL,qL,qu,Fi,Iu,u_,IL,Ou,Ci,Je,__,h_,f_,g_,tn,OL,PL,Pu,ML,Mu,ml,RL,zL,Bi,TL,GL,Ru,kL,UL,Vt,NL,$L,zu,ZL,Tu,yl,jL,VL,xi,Gu,ku,WL,QL,XL,HL,vi,tp,Pn,Ln,sc,lc,zl,rc,wl,dc,Tl,Uu,Gl,Nu,Ul,xl,uc,_c,rp,dp,up,_p,Lp,pp,B_=xe(()=>{Pg=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];yn=hc;Rg=tc,zg=vo;Yu=yn(0),uo=yn(1),Hg=Object.freeze({__proto__:null,abs:Ug,add:Zl,band:jl,bitLength:Ii,bits:Wu,bor:jg,bxor:Vg,div:So,e:yn,eq:_a,exp:kg,fromArray:Mg,fromRprBE:Ju,fromRprLE:qi,fromString:hc,geq:Du,gt:nc,isNegative:ju,isOdd:$l,isZero:Nl,land:Wg,leq:Zg,lnot:Xg,lor:Qg,lt:$g,mod:ya,mul:Hu,naf:Vu,neg:Xu,neq:Ng,one:uo,pow:Oi,shiftLeft:tc,shiftRight:vo,shl:Rg,shr:zg,square:Gg,sub:Ia,toArray:Tg,toLEBuff:qo,toNumber:Qu,toRprBE:Ku,toRprLE:Si,toString:fc,zero:Yu}),Al=class{constructor(t){this.F=t;let n=t.sqrt_t,a=t.sqrt_s,o=this.F.add(this.F.add(this.F.two,this.F.two),this.F.one);this.w=new Array(a+1),this.wi=new Array(a+1),this.w[a]=this.F.pow(o,n),this.wi[a]=this.F.inv(this.w[a]);let e=a-1;for(;e>=0;)this.w[e]=this.F.square(this.w[e+1]),this.wi[e]=this.F.square(this.wi[e+1]),e--;this.roots=[],this._setRoots(15)}_setRoots(t){t>this.F.sqrt_s&&(t=this.s);for(let n=t;n>=0&&!this.roots[n];n--){let a=this.F.one,o=1<<n,e=new Array(o);for(let h=0;h<o;h++)e[h]=a,a=this.F.mul(a,this.w[n]);this.roots[n]=e}}add(t,n){let a=Math.max(t.length,n.length),o=new Array(a);for(let e=0;e<a;e++)o[e]=this.F.add(t[e]||this.F.zero,n[e]||this.F.zero);return this.reduce(o)}double(t){return this.add(t,t)}sub(t,n){let a=Math.max(t.length,n.length),o=new Array(a);for(let e=0;e<a;e++)o[e]=this.F.sub(t[e]||this.F.zero,n[e]||this.F.zero);return this.reduce(o)}mulScalar(t,n){if(this.F.eq(n,this.F.zero))return[];if(this.F.eq(n,this.F.one))return t;let a=new Array(t.length);for(let o=0;o<t.length;o++)a[o]=this.F.mul(t[o],n);return a}mul(t,n){return t.length==0?[]:n.length==0?[]:t.length==1?this.mulScalar(n,t[0]):n.length==1?this.mulScalar(t,n[0]):(n.length>t.length&&([n,t]=[t,n]),n.length<=2||n.length<ma(t.length)?this.mulNormal(t,n):this.mulFFT(t,n))}mulNormal(t,n){let a=[];for(let o=0;o<n.length;o++)a=this.add(a,this.scaleX(this.mulScalar(t,n[o]),o));return a}mulFFT(t,n){let a=Math.max(t.length,n.length),o=ma(a-1)+2;this._setRoots(o);let e=1<<o,h=this.extend(t,e),d=this.extend(n,e),b=_o(this,h,o,0,1),l=_o(this,d,o,0,1),s=new Array(e);for(let v=0;v<e;v++)s[v]=this.F.mul(b[v],l[v]);let m=_o(this,s,o,0,1),B=this.F.inv(this.F.mulScalar(this.F.one,e)),p=new Array(e);for(let v=0;v<e;v++)p[v]=this.F.mul(m[(e-v)%e],B);return this.reduce(p)}square(t){return this.mul(t,t)}scaleX(t,n){return n==0?t:n>0?new Array(n).fill(this.F.zero).concat(t):-n>=t.length?[]:t.slice(-n)}eval2(t,n){let a=this.F.zero,o=this.F.one;for(let e=0;e<t.length;e++)a=this.F.add(a,this.F.mul(t[e],o)),o=this.F.mul(o,n);return a}evaluate(t,n){let a=this.F;if(t.length==0)return a.zero;let o=this._next2Power(t.length),e=this.extend(t,o);return h(e,n,0,1,o);function h(d,b,l,s,m){if(m==1)return d[l];let B=a.square(b);return a.add(h(d,B,l,s<<1,m>>1),a.mul(b,h(d,B,l+s,s<<1,m>>1)))}}lagrange(t){let n=[this.F.one];for(let o=0;o<t.length;o++)n=this.mul(n,[this.F.neg(t[o][0]),this.F.one]);let a=[];for(let o=0;o<t.length;o++){let e=this.ruffini(n,t[o][0]),h=this.F.mul(this.F.inv(this.evaluate(e,t[o][0])),t[o][1]);e=this.mulScalar(e,h),a=this.add(a,e)}return a}fft(t){if(t.length<=1)return t;let n=ma(t.length-1)+1;this._setRoots(n);let a=1<<n,o=this.extend(t,a);return _o(this,o,n,0,1)}fft2(t){if(t.length<=1)return t;let n=ma(t.length-1)+1;this._setRoots(n);let a=1<<n,o=this.extend(t,a);return Bu(o,n),ac(this,o,n)}ifft(t){if(t.length<=1)return t;let n=ma(t.length-1)+1;this._setRoots(n);let a=1<<n,o=this.extend(t,a),e=_o(this,o,n,0,1),h=this.F.inv(this.F.mulScalar(this.F.one,a)),d=new Array(a);for(let b=0;b<a;b++)d[b]=this.F.mul(e[(a-b)%a],h);return d}ifft2(t){if(t.length<=1)return t;let n=ma(t.length-1)+1;this._setRoots(n);let a=1<<n,o=this.extend(t,a);Bu(o,n);let e=ac(this,o,n),h=this.F.inv(this.F.mulScalar(this.F.one,a)),d=new Array(a);for(let b=0;b<a;b++)d[b]=this.F.mul(e[(a-b)%a],h);return d}_fft(t,n,a,o){let e=1<<n;if(e==1)return[t[a]];let h=e>>1,d=this._fft(t,n-1,a,o*2),b=this._fft(t,n-1,a+o,o*2),l=new Array(e),s=this.F.one;for(let m=0;m<h;m++)l[m]=this.F.add(d[m],this.F.mul(s,b[m])),l[m+h]=this.F.sub(d[m],this.F.mul(s,b[m])),s=this.F.mul(s,this.w[n]);return l}extend(t,n){if(n==t.length)return t;let a=new Array(n-t.length).fill(this.F.zero);return t.concat(a)}reduce(t){if(t.length==0||!this.F.eq(t[t.length-1],this.F.zero))return t;let n=t.length-1;for(;n>0&&this.F.eq(t[n],this.F.zero);)n--;return t.slice(0,n+1)}eq(t,n){let a=this.reduce(t),o=this.reduce(n);if(a.length!=o.length)return!1;for(let e=0;e<o.length;e++)if(!this.F.eq(a[e],o[e]))return!1;return!0}ruffini(t,n){let a=new Array(t.length-1);a[a.length-1]=t[t.length-1];for(let o=a.length-2;o>=0;o--)a[o]=this.F.add(this.F.mul(a[o+1],n),t[o+1]);return a}_next2Power(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t++,t}toString(t){let n=this.normalize(t),a="";for(let o=n.length-1;o>=0;o--)this.F.eq(t[o],this.F.zero)||(a!=""&&(a+=" + "),a=a+t[o].toString(10),o>0&&(a=a+"x",o>1&&(a=a+"^"+o)));return a}normalize(t){let n=new Array(t.length);for(let a=0;a<t.length;a++)n[a]=this.F.normalize(t[a]);return n}_reciprocal(t,n){let a=1<<n;if(a==1)return[this.F.inv(t[0])];let o=this.scaleX(t,-a/2),e=this._reciprocal(o,n-1),h=this.scaleX(this.double(e),3*a/2-2),d=this.mul(this.square(e),t);return this.scaleX(this.sub(h,d),-(a-2))}_div2(t,n){let a=ma(n.length-1)+1,o=1<<a,e=o-n.length,h=this._reciprocal(this.scaleX(n,e),a);return this.scaleX(h,t-2*o+2+e)}div(t,n){if(t.length<n.length)return[];let a=ma(n.length-1)+1,o=1<<a,e=this.scaleX(t,o-n.length),h=this.scaleX(n,o-n.length),d=h.length-1,b=e.length-1,l=this._reciprocal(h,a),s;b>2*d&&(s=this.sub(this.scaleX([this.F.one],2*d),this.mul(l,h)));let m=[],B=e,p,v,M=!1;for(;!M;)p=this.mul(B,l),m=this.add(m,this.scaleX(p,-2*d)),b>2*d?(v=this.mul(B,s),B=this.scaleX(v,-2*d),b=B.length-1):M=!0;return m}oneRoot(t,n){let a=ma(t-1)+1,o=this.F.one,e=n;if(n>=t)throw new Error("Given 'i' should be lower than 'n'");if(1<<a!==t)throw new Error(`Internal errlr: ${t} should equal ${1<<a}`);for(;e>0;)e&!0&&(o=this.F.mul(o,this.w[a])),e=e>>1,a--;return o}computeVanishingPolinomial(t,n){let a=1<<t;return this.F.sub(this.F.pow(n,a),this.F.one)}evaluateLagrangePolynomials(t,n){let a=1<<t,o=this.F.pow(n,a),e=new Array(a).fill(this.F.zero);this._setRoots(t);let h=this.w[t];if(this.F.eq(o,this.F.one)){for(let l=0;l<a;l++)if(this.F.eq(this.roots[t][0],n))return e[l]=this.F.one,e}let d=this.F.sub(o,this.F.one),b=this.F.mul(d,this.F.inv(this.F.e(a)));for(let l=0;l<a;l++)e[l]=this.F.mul(b,this.F.inv(this.F.sub(n,this.roots[t][l]))),b=this.F.mul(b,h);return e}log2(t){return ma(t)}};Ei=[];for(let c=0;c<256;c++)Ei[c]=Dg(c,8);ic=class{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=new Array(16)}nextU32(){return this.idx==16&&this.update(),this.buff[this.idx++]}nextU64(){return Zl(Hu(this.nextU32(),4294967296),this.nextU32())}nextBool(){return(this.nextU32()&1)==1}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let t=0;t<10;t++)eL(this.buff);for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,this.state[12]==0&&(this.state[13]=this.state[13]+1>>>0,this.state[13]==0&&(this.state[14]=this.state[14]+1>>>0,this.state[14]==0&&(this.state[15]=this.state[15]+1>>>0)))}};Ke=null;El=class{constructor(t,n,a){this.F=n,this.G=t,this.opMulGF=a;let o=n.sqrt_t||n.t,e=n.sqrt_s||n.s,h=n.one;for(;n.eq(n.pow(h,n.half),n.one);)h=n.add(h,n.one);this.w=new Array(e+1),this.wi=new Array(e+1),this.w[e]=this.F.pow(h,o),this.wi[e]=this.F.inv(this.w[e]);let d=e-1;for(;d>=0;)this.w[d]=this.F.square(this.w[d+1]),this.wi[d]=this.F.square(this.wi[d+1]),d--;this.roots=[],this._setRoots(Math.min(e,15))}_setRoots(t){for(let n=t;n>=0&&!this.roots[n];n--){let a=this.F.one,o=1<<n,e=new Array(o);for(let h=0;h<o;h++)e[h]=a,a=this.F.mul(a,this.w[n]);this.roots[n]=e}}fft(t){if(t.length<=1)return t;let n=xu(t.length-1)+1;this._setRoots(n);let a=1<<n;if(t.length!=a)throw new Error("Size must be multiple of 2");return ec(this,t,n,0,1)}ifft(t){if(t.length<=1)return t;let n=xu(t.length-1)+1;this._setRoots(n);let a=1<<n;if(t.length!=a)throw new Error("Size must be multiple of 2");let o=ec(this,t,n,0,1),e=this.F.inv(this.F.mulScalar(this.F.one,a)),h=new Array(a);for(let d=0;d<a;d++)h[d]=this.opMulGF(o[(a-d)%a],e);return h}};vl=class{constructor(t){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(t),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=Ii(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=this.n64*2,this.n8=this.n64*8,this.R=this.e(this.one<<BigInt(this.n64*64)),this.Ri=this.inv(this.R);let n=this.negone>>this.one;this.nqr=this.two;let a=this.pow(this.nqr,n);for(;!this.eq(a,this.negone);)this.nqr=this.nqr+this.one,a=this.pow(this.nqr,n);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),t_(this),this.FFT=new El(this,this,this.mul.bind(this)),this.fft=this.FFT.fft.bind(this.FFT),this.ifft=this.FFT.ifft.bind(this.FFT),this.w=this.FFT.w,this.wi=this.FFT.wi,this.shift=this.square(this.nqr),this.k=this.exp(this.nqr,2**this.s)}e(t,n){let a;if(n?n==16&&(a=BigInt("0x"+t)):a=BigInt(t),a<0){let o=-a;return o>=this.p&&(o=o%this.p),this.p-o}else return a>=this.p?a%this.p:a}add(t,n){let a=t+n;return a>=this.p?a-this.p:a}sub(t,n){return t>=n?t-n:this.p-n+t}neg(t){return t&&this.p-t}mul(t,n){return t*n%this.p}mulScalar(t,n){return t*this.e(n)%this.p}square(t){return t*t%this.p}eq(t,n){return t==n}neq(t,n){return t!=n}lt(t,n){let a=t>this.half?t-this.p:t,o=n>this.half?n-this.p:n;return a<o}gt(t,n){let a=t>this.half?t-this.p:t,o=n>this.half?n-this.p:n;return a>o}leq(t,n){let a=t>this.half?t-this.p:t,o=n>this.half?n-this.p:n;return a<=o}geq(t,n){let a=t>this.half?t-this.p:t,o=n>this.half?n-this.p:n;return a>=o}div(t,n){return this.mul(t,this.inv(n))}idiv(t,n){if(!n)throw new Error("Division by zero");return t/n}inv(t){if(!t)throw new Error("Division by zero");let n=this.zero,a=this.p,o=this.one,e=t%this.p;for(;e;){let h=a/e;[n,o]=[o,n-h*o],[a,e]=[e,a-h*e]}return n<this.zero&&(n+=this.p),n}mod(t,n){return t%n}pow(t,n){return Io(this,t,n)}exp(t,n){return Io(this,t,n)}band(t,n){let a=t&n&this.mask;return a>=this.p?a-this.p:a}bor(t,n){let a=(t|n)&this.mask;return a>=this.p?a-this.p:a}bxor(t,n){let a=(t^n)&this.mask;return a>=this.p?a-this.p:a}bnot(t){let n=t^this.mask;return n>=this.p?n-this.p:n}shl(t,n){if(Number(n)<this.bitLength){let a=t<<n&this.mask;return a>=this.p?a-this.p:a}else{let a=this.p-n;return Number(a)<this.bitLength?t>>a:this.zero}}shr(t,n){if(Number(n)<this.bitLength)return t>>n;{let a=this.p-n;if(Number(a)<this.bitLength){let o=t<<a&this.mask;return o>=this.p?o-this.p:o}else return 0}}land(t,n){return t&&n?this.one:this.zero}lor(t,n){return t||n?this.one:this.zero}lnot(t){return t?this.zero:this.one}sqrt_old(t){if(t==this.zero)return this.zero;if(this.pow(t,this.negone>>this.one)!=this.one)return null;let a=this.s,o=this.nqr_to_t,e=this.pow(t,this.t),h=this.pow(t,this.add(this.t,this.one)>>this.one);for(;e!=this.one;){let d=this.square(e),b=1;for(;d!=this.one;)b++,d=this.square(d);let l=o;for(let s=0;s<a-b-1;s++)l=this.square(l);a=b,o=this.square(l),e=this.mul(e,o),h=this.mul(h,l)}return h>this.p>>this.one&&(h=this.neg(h)),h}normalize(t,n){if(t=BigInt(t,n),t<0){let a=-t;return a>=this.p&&(a=a%this.p),this.p-a}else return t>=this.p?t%this.p:t}random(){let t=this.bitLength*2/8,n=this.zero;for(let a=0;a<t;a++)n=(n<<BigInt(8))+BigInt(n_(1)[0]);return n%this.p}toString(t,n){n=n||10;let a;return t>this.half&&n==10?a="-"+(this.p-t).toString(n):a=t.toString(n),a}isZero(t){return t==this.zero}fromRng(t){let n;do{n=this.zero;for(let a=0;a<this.n64;a++)n+=t.nextU64()<<BigInt(64*a);n&=this.mask}while(n>=this.p);return n=n*this.Ri%this.p,n}fft(t){return this.FFT.fft(t)}ifft(t){return this.FFT.ifft(t)}toRprLE(t,n,a){Si(t,n,a,this.n64*8)}toRprBE(t,n,a){Ku(t,n,a,this.n64*8)}toRprBEM(t,n,a){return this.toRprBE(t,n,this.mul(this.R,a))}toRprLEM(t,n,a){return this.toRprLE(t,n,this.mul(this.R,a))}fromRprLE(t,n){return qi(t,n,this.n8)}fromRprBE(t,n){return Ju(t,n,this.n8)}fromRprLEM(t,n){return this.mul(this.fromRprLE(t,n),this.Ri)}fromRprBEM(t,n){return this.mul(this.fromRprBE(t,n),this.Ri)}toObject(t){return t}},Sl=class{constructor(t,n){this.type="F2",this.F=t,this.zero=[this.F.zero,this.F.zero],this.one=[this.F.one,this.F.zero],this.negone=this.neg(this.one),this.nonResidue=n,this.m=t.m*2,this.p=t.p,this.n64=t.n64*2,this.n32=this.n64*2,this.n8=this.n64*8,t_(this)}_mulByNonResidue(t){return this.F.mul(this.nonResidue,t)}copy(t){return[this.F.copy(t[0]),this.F.copy(t[1])]}add(t,n){return[this.F.add(t[0],n[0]),this.F.add(t[1],n[1])]}double(t){return this.add(t,t)}sub(t,n){return[this.F.sub(t[0],n[0]),this.F.sub(t[1],n[1])]}neg(t){return this.sub(this.zero,t)}conjugate(t){return[t[0],this.F.neg(t[1])]}mul(t,n){let a=this.F.mul(t[0],n[0]),o=this.F.mul(t[1],n[1]);return[this.F.add(a,this._mulByNonResidue(o)),this.F.sub(this.F.mul(this.F.add(t[0],t[1]),this.F.add(n[0],n[1])),this.F.add(a,o))]}inv(t){let n=this.F.square(t[0]),a=this.F.square(t[1]),o=this.F.sub(n,this._mulByNonResidue(a)),e=this.F.inv(o);return[this.F.mul(t[0],e),this.F.neg(this.F.mul(t[1],e))]}div(t,n){return this.mul(t,this.inv(n))}square(t){let n=this.F.mul(t[0],t[1]);return[this.F.sub(this.F.mul(this.F.add(t[0],t[1]),this.F.add(t[0],this._mulByNonResidue(t[1]))),this.F.add(n,this._mulByNonResidue(n))),this.F.add(n,n)]}isZero(t){return this.F.isZero(t[0])&&this.F.isZero(t[1])}eq(t,n){return this.F.eq(t[0],n[0])&&this.F.eq(t[1],n[1])}mulScalar(t,n){return oc(this,t,n)}pow(t,n){return Io(this,t,n)}exp(t,n){return Io(this,t,n)}toString(t){return`[ ${this.F.toString(t[0])} , ${this.F.toString(t[1])} ]`}fromRng(t){let n=this.F.fromRng(t),a=this.F.fromRng(t);return[n,a]}gt(t,n){return this.F.gt(t[0],n[0])?!0:this.F.gt(n[0],t[0])?!1:!!this.F.gt(t[1],n[1])}geq(t,n){return this.gt(t,n)||this.eq(t,n)}lt(t,n){return!this.geq(t,n)}leq(t,n){return!this.gt(t,n)}neq(t,n){return!this.eq(t,n)}random(){return[this.F.random(),this.F.random()]}toRprLE(t,n,a){this.F.toRprLE(t,n,a[0]),this.F.toRprLE(t,n+this.F.n8,a[1])}toRprBE(t,n,a){this.F.toRprBE(t,n,a[1]),this.F.toRprBE(t,n+this.F.n8,a[0])}toRprLEM(t,n,a){this.F.toRprLEM(t,n,a[0]),this.F.toRprLEM(t,n+this.F.n8,a[1])}toRprBEM(t,n,a){this.F.toRprBEM(t,n,a[1]),this.F.toRprBEM(t,n+this.F.n8,a[0])}fromRprLE(t,n){n=n||0;let a=this.F.fromRprLE(t,n),o=this.F.fromRprLE(t,n+this.F.n8);return[a,o]}fromRprBE(t,n){n=n||0;let a=this.F.fromRprBE(t,n);return[this.F.fromRprBE(t,n+this.F.n8),a]}fromRprLEM(t,n){n=n||0;let a=this.F.fromRprLEM(t,n),o=this.F.fromRprLEM(t,n+this.F.n8);return[a,o]}fromRprBEM(t,n){n=n||0;let a=this.F.fromRprBEM(t,n);return[this.F.fromRprBEM(t,n+this.F.n8),a]}toObject(t){return t}},ql=class{constructor(t,n){this.type="F3",this.F=t,this.zero=[this.F.zero,this.F.zero,this.F.zero],this.one=[this.F.one,this.F.zero,this.F.zero],this.negone=this.neg(this.one),this.nonResidue=n,this.m=t.m*3,this.p=t.p,this.n64=t.n64*3,this.n32=this.n64*2,this.n8=this.n64*8}_mulByNonResidue(t){return this.F.mul(this.nonResidue,t)}copy(t){return[this.F.copy(t[0]),this.F.copy(t[1]),this.F.copy(t[2])]}add(t,n){return[this.F.add(t[0],n[0]),this.F.add(t[1],n[1]),this.F.add(t[2],n[2])]}double(t){return this.add(t,t)}sub(t,n){return[this.F.sub(t[0],n[0]),this.F.sub(t[1],n[1]),this.F.sub(t[2],n[2])]}neg(t){return this.sub(this.zero,t)}mul(t,n){let a=this.F.mul(t[0],n[0]),o=this.F.mul(t[1],n[1]),e=this.F.mul(t[2],n[2]);return[this.F.add(a,this._mulByNonResidue(this.F.sub(this.F.mul(this.F.add(t[1],t[2]),this.F.add(n[1],n[2])),this.F.add(o,e)))),this.F.add(this.F.sub(this.F.mul(this.F.add(t[0],t[1]),this.F.add(n[0],n[1])),this.F.add(a,o)),this._mulByNonResidue(e)),this.F.add(this.F.sub(this.F.mul(this.F.add(t[0],t[2]),this.F.add(n[0],n[2])),this.F.add(a,e)),o)]}inv(t){let n=this.F.square(t[0]),a=this.F.square(t[1]),o=this.F.square(t[2]),e=this.F.mul(t[0],t[1]),h=this.F.mul(t[0],t[2]),d=this.F.mul(t[1],t[2]),b=this.F.sub(n,this._mulByNonResidue(d)),l=this.F.sub(this._mulByNonResidue(o),e),s=this.F.sub(a,h),m=this.F.inv(this.F.add(this.F.mul(t[0],b),this._mulByNonResidue(this.F.add(this.F.mul(t[2],l),this.F.mul(t[1],s)))));return[this.F.mul(m,b),this.F.mul(m,l),this.F.mul(m,s)]}div(t,n){return this.mul(t,this.inv(n))}square(t){let n=this.F.square(t[0]),a=this.F.mul(t[0],t[1]),o=this.F.add(a,a),e=this.F.square(this.F.add(this.F.sub(t[0],t[1]),t[2])),h=this.F.mul(t[1],t[2]),d=this.F.add(h,h),b=this.F.square(t[2]);return[this.F.add(n,this._mulByNonResidue(d)),this.F.add(o,this._mulByNonResidue(b)),this.F.sub(this.F.add(this.F.add(o,e),d),this.F.add(n,b))]}isZero(t){return this.F.isZero(t[0])&&this.F.isZero(t[1])&&this.F.isZero(t[2])}eq(t,n){return this.F.eq(t[0],n[0])&&this.F.eq(t[1],n[1])&&this.F.eq(t[2],n[2])}affine(t){return[this.F.affine(t[0]),this.F.affine(t[1]),this.F.affine(t[2])]}mulScalar(t,n){return oc(this,t,n)}pow(t,n){return Io(this,t,n)}exp(t,n){return Io(this,t,n)}toString(t){return`[ ${this.F.toString(t[0])} , ${this.F.toString(t[1])}, ${this.F.toString(t[2])} ]`}fromRng(t){let n=this.F.fromRng(t),a=this.F.fromRng(t),o=this.F.fromRng(t);return[n,a,o]}gt(t,n){return this.F.gt(t[0],n[0])?!0:this.F.gt(n[0],t[0])?!1:this.F.gt(t[1],n[1])?!0:this.F.gt(n[1],t[1])?!1:!!this.F.gt(t[2],n[2])}geq(t,n){return this.gt(t,n)||this.eq(t,n)}lt(t,n){return!this.geq(t,n)}leq(t,n){return!this.gt(t,n)}neq(t,n){return!this.eq(t,n)}random(){return[this.F.random(),this.F.random(),this.F.random()]}toRprLE(t,n,a){this.F.toRprLE(t,n,a[0]),this.F.toRprLE(t,n+this.F.n8,a[1]),this.F.toRprLE(t,n+this.F.n8*2,a[2])}toRprBE(t,n,a){this.F.toRprBE(t,n,a[2]),this.F.toRprBE(t,n+this.F.n8,a[1]),this.F.toRprBE(t,n+this.F.n8*2,a[0])}toRprLEM(t,n,a){this.F.toRprLEM(t,n,a[0]),this.F.toRprLEM(t,n+this.F.n8,a[1]),this.F.toRprLEM(t,n+this.F.n8*2,a[2])}toRprBEM(t,n,a){this.F.toRprBEM(t,n,a[2]),this.F.toRprBEM(t,n+this.F.n8,a[1]),this.F.toRprBEM(t,n+this.F.n8*2,a[0])}fromRprLE(t,n){n=n||0;let a=this.F.fromRprLE(t,n),o=this.F.fromRprLE(t,n+this.n8),e=this.F.fromRprLE(t,n+this.n8*2);return[a,o,e]}fromRprBE(t,n){n=n||0;let a=this.F.fromRprBE(t,n),o=this.F.fromRprBE(t,n+this.n8);return[this.F.fromRprBE(t,n+this.n8*2),o,a]}fromRprLEM(t,n){n=n||0;let a=this.F.fromRprLEM(t,n),o=this.F.fromRprLEM(t,n+this.n8),e=this.F.fromRprLEM(t,n+this.n8*2);return[a,o,e]}fromRprBEM(t,n){n=n||0;let a=this.F.fromRprBEM(t,n),o=this.F.fromRprBEM(t,n+this.n8);return[this.F.fromRprBEM(t,n+this.n8*2),o,a]}toObject(t){return t}};Il=class{constructor(t,n){this.F=t,this.g=n,this.g.length==2&&(this.g[2]=this.F.one),this.zero=[this.F.zero,this.F.one,this.F.zero]}add(t,n){let a=this.F;if(this.eq(t,this.zero))return n;if(this.eq(n,this.zero))return t;let o=new Array(3),e=a.square(t[2]),h=a.square(n[2]),d=a.mul(t[0],h),b=a.mul(n[0],e),l=a.mul(t[2],e),s=a.mul(n[2],h),m=a.mul(t[1],s),B=a.mul(n[1],l);if(a.eq(d,b)&&a.eq(m,B))return this.double(t);let p=a.sub(b,d),v=a.sub(B,m),M=a.square(a.add(p,p)),x=a.mul(p,M),S=a.add(v,v),w=a.mul(d,M);o[0]=a.sub(a.sub(a.square(S),x),a.add(w,w));let k=a.mul(m,x);return o[1]=a.sub(a.mul(S,a.sub(w,o[0])),a.add(k,k)),o[2]=a.mul(p,a.sub(a.square(a.add(t[2],n[2])),a.add(e,h))),o}neg(t){return[t[0],this.F.neg(t[1]),t[2]]}sub(t,n){return this.add(t,this.neg(n))}double(t){let n=this.F,a=new Array(3);if(this.eq(t,this.zero))return t;let o=n.square(t[0]),e=n.square(t[1]),h=n.square(e),d=n.sub(n.square(n.add(t[0],e)),n.add(o,h));d=n.add(d,d);let b=n.add(n.add(o,o),o),l=n.square(b);a[0]=n.sub(l,n.add(d,d));let s=n.add(h,h);s=n.add(s,s),s=n.add(s,s),a[1]=n.sub(n.mul(b,n.sub(d,a[0])),s);let m=n.mul(t[1],t[2]);return a[2]=n.add(m,m),a}timesScalar(t,n){return oc(this,t,n)}mulScalar(t,n){return oc(this,t,n)}affine(t){let n=this.F;if(this.isZero(t))return this.zero;if(n.eq(t[2],n.one))return t;{let a=n.inv(t[2]),o=n.square(a),e=n.mul(o,a),h=new Array(3);return h[0]=n.mul(t[0],o),h[1]=n.mul(t[1],e),h[2]=n.one,h}}multiAffine(t){let n=Object.keys(t),a=this.F,o=new Array(n.length+1);o[0]=a.one;for(let e=0;e<n.length;e++)a.eq(t[n[e]][2],a.zero)?o[e+1]=o[e]:o[e+1]=a.mul(o[e],t[n[e]][2]);o[n.length]=a.inv(o[n.length]);for(let e=n.length-1;e>=0;e--)if(a.eq(t[n[e]][2],a.zero))o[e]=o[e+1],t[n[e]]=this.zero;else{let h=a.mul(o[e],o[e+1]);o[e]=a.mul(t[n[e]][2],o[e+1]);let d=a.square(h),b=a.mul(d,h);t[n[e]][0]=a.mul(t[n[e]][0],d),t[n[e]][1]=a.mul(t[n[e]][1],b),t[n[e]][2]=a.one}}eq(t,n){let a=this.F;if(this.F.eq(t[2],this.F.zero))return this.F.eq(n[2],this.F.zero);if(this.F.eq(n[2],this.F.zero))return!1;let o=a.square(t[2]),e=a.square(n[2]),h=a.mul(t[0],e),d=a.mul(n[0],o),b=a.mul(t[2],o),l=a.mul(n[2],e),s=a.mul(t[1],l),m=a.mul(n[1],b);return a.eq(h,d)&&a.eq(s,m)}isZero(t){return this.F.isZero(t[2])}toString(t){let n=this.affine(t);return`[ ${this.F.toString(n[0])} , ${this.F.toString(n[1])} ]`}fromRng(t){let n=this.F,a=[],o;do{a[0]=n.fromRng(t),o=t.nextBool();let h=n.add(n.mul(n.square(a[0]),a[0]),this.b);a[1]=n.sqrt(h)}while(a[1]==null||n.isZero[a]);let e=Ye(n,a[1]);return o^e&&(a[1]=n.neg(a[1])),a[2]=n.one,this.cofactor&&(a=this.mulScalar(a,this.cofactor)),a=this.affine(a),a}toRprLE(t,n,a){if(a=this.affine(a),this.isZero(a)){new Uint8Array(t,n,this.F.n8*2).fill(0);return}this.F.toRprLE(t,n,a[0]),this.F.toRprLE(t,n+this.F.n8,a[1])}toRprBE(t,n,a){if(a=this.affine(a),this.isZero(a)){new Uint8Array(t,n,this.F.n8*2).fill(0);return}this.F.toRprBE(t,n,a[0]),this.F.toRprBE(t,n+this.F.n8,a[1])}toRprLEM(t,n,a){if(a=this.affine(a),this.isZero(a)){new Uint8Array(t,n,this.F.n8*2).fill(0);return}this.F.toRprLEM(t,n,a[0]),this.F.toRprLEM(t,n+this.F.n8,a[1])}toRprLEJM(t,n,a){if(a=this.affine(a),this.isZero(a)){new Uint8Array(t,n,this.F.n8*2).fill(0);return}this.F.toRprLEM(t,n,a[0]),this.F.toRprLEM(t,n+this.F.n8,a[1]),this.F.toRprLEM(t,n+2*this.F.n8,a[2])}toRprBEM(t,n,a){if(a=this.affine(a),this.isZero(a)){new Uint8Array(t,n,this.F.n8*2).fill(0);return}this.F.toRprBEM(t,n,a[0]),this.F.toRprBEM(t,n+this.F.n8,a[1])}fromRprLE(t,n){n=n||0;let a=this.F.fromRprLE(t,n),o=this.F.fromRprLE(t,n+this.F.n8);return this.F.isZero(a)&&this.F.isZero(o)?this.zero:[a,o,this.F.one]}fromRprBE(t,n){n=n||0;let a=this.F.fromRprBE(t,n),o=this.F.fromRprBE(t,n+this.F.n8);return this.F.isZero(a)&&this.F.isZero(o)?this.zero:[a,o,this.F.one]}fromRprLEM(t,n){n=n||0;let a=this.F.fromRprLEM(t,n),o=this.F.fromRprLEM(t,n+this.F.n8);return this.F.isZero(a)&&this.F.isZero(o)?this.zero:[a,o,this.F.one]}fromRprLEJM(t,n){n=n||0;let a=this.F.fromRprLEM(t,n),o=this.F.fromRprLEM(t,n+this.F.n8),e=this.F.fromRprLEM(t,n+this.F.n8*2);return this.F.isZero(a)&&this.F.isZero(o)?this.zero:[a,o,e]}fromRprBEM(t,n){n=n||0;let a=this.F.fromRprBEM(t,n),o=this.F.fromRprBEM(t,n+this.F.n8);return this.F.isZero(a)&&this.F.isZero(o)?this.zero:[a,o,this.F.one]}fromRprCompressed(t,n){let a=this.F,o=new Uint8Array(t.buffer,n,a.n8);if(o[0]&64)return this.zero;let e=new Array(3),h=(o[0]&128)!=0;o[0]=o[0]&127,e[0]=a.fromRprBE(t,n),h&&(o[0]=o[0]|128);let d=a.add(a.mul(a.square(e[0]),e[0]),this.b);if(e[1]=a.sqrt(d),e[1]===null)throw new Error("Invalid Point!");let b=Ye(a,e[1]);return h^b&&(e[1]=a.neg(e[1])),e[2]=a.one,e}toRprCompressed(t,n,a){a=this.affine(a);let o=new Uint8Array(t.buffer,n,this.F.n8);if(this.isZero(a)){o.fill(0),o[0]=64;return}this.F.toRprBE(t,n,a[0]),Ye(this.F,a[1])&&(o[0]=o[0]|128)}fromRprUncompressed(t,n){return t[0]&64?this.zero:this.fromRprBE(t,n)}toRprUncompressed(t,n,a){this.toRprBE(t,n,a),this.isZero(a)&&(t[n]=t[n]|64)}},ja={};ja.bigInt2BytesLE=function(t,n){let a=Array(n),o=BigInt(t);for(let e=0;e<n;e++)a[e]=Number(o&0xFFn),o=o>>8n;return a};ja.bigInt2U32LE=function(t,n){let a=Array(n),o=BigInt(t);for(let e=0;e<n;e++)a[e]=Number(o&0xFFFFFFFFn),o=o>>32n;return a};ja.isOcamNum=function(c){return!(!Array.isArray(c)||c.length!=3||typeof c[0]!="number"||typeof c[1]!="number"||!Array.isArray(c[2]))};sL=function(t,n,a){let o=a||"int";if(t.modules[o])return o;t.modules[o]={};let e=n*2,h=n*8;function d(){let F=t.addFunction(o+"_copy");F.addParam("px","i32"),F.addParam("pr","i32");let u=F.getCodeBuilder();for(let L=0;L<n;L++)F.addCode(u.i64_store(u.getLocal("pr"),L*8,u.i64_load(u.getLocal("px"),L*8)))}function b(){let F=t.addFunction(o+"_zero");F.addParam("pr","i32");let u=F.getCodeBuilder();for(let L=0;L<n;L++)F.addCode(u.i64_store(u.getLocal("pr"),L*8,u.i64_const(0)))}function l(){let F=t.addFunction(o+"_one");F.addParam("pr","i32");let u=F.getCodeBuilder();F.addCode(u.i64_store(u.getLocal("pr"),0,u.i64_const(1)));for(let L=1;L<n;L++)F.addCode(u.i64_store(u.getLocal("pr"),L*8,u.i64_const(0)))}function s(){let F=t.addFunction(o+"_isZero");F.addParam("px","i32"),F.setReturnType("i32");let u=F.getCodeBuilder();function L($){return $==0?u.ret(u.i64_eqz(u.i64_load(u.getLocal("px")))):u.if(u.i64_eqz(u.i64_load(u.getLocal("px"),$*8)),L($-1),u.ret(u.i32_const(0)))}F.addCode(L(n-1)),F.addCode(u.ret(u.i32_const(0)))}function m(){let F=t.addFunction(o+"_eq");F.addParam("px","i32"),F.addParam("py","i32"),F.setReturnType("i32");let u=F.getCodeBuilder();function L($){return $==0?u.ret(u.i64_eq(u.i64_load(u.getLocal("px")),u.i64_load(u.getLocal("py")))):u.if(u.i64_eq(u.i64_load(u.getLocal("px"),$*8),u.i64_load(u.getLocal("py"),$*8)),L($-1),u.ret(u.i32_const(0)))}F.addCode(L(n-1)),F.addCode(u.ret(u.i32_const(0)))}function B(){let F=t.addFunction(o+"_gte");F.addParam("px","i32"),F.addParam("py","i32"),F.setReturnType("i32");let u=F.getCodeBuilder();function L($){return $==0?u.ret(u.i64_ge_u(u.i64_load(u.getLocal("px")),u.i64_load(u.getLocal("py")))):u.if(u.i64_lt_u(u.i64_load(u.getLocal("px"),$*8),u.i64_load(u.getLocal("py"),$*8)),u.ret(u.i32_const(0)),u.if(u.i64_gt_u(u.i64_load(u.getLocal("px"),$*8),u.i64_load(u.getLocal("py"),$*8)),u.ret(u.i32_const(1)),L($-1)))}F.addCode(L(n-1)),F.addCode(u.ret(u.i32_const(0)))}function p(){let F=t.addFunction(o+"_add");F.addParam("x","i32"),F.addParam("y","i32"),F.addParam("r","i32"),F.setReturnType("i32"),F.addLocal("c","i64");let u=F.getCodeBuilder();F.addCode(u.setLocal("c",u.i64_add(u.i64_load32_u(u.getLocal("x")),u.i64_load32_u(u.getLocal("y"))))),F.addCode(u.i64_store32(u.getLocal("r"),u.getLocal("c")));for(let L=1;L<e;L++)F.addCode(u.setLocal("c",u.i64_add(u.i64_add(u.i64_load32_u(u.getLocal("x"),4*L),u.i64_load32_u(u.getLocal("y"),4*L)),u.i64_shr_u(u.getLocal("c"),u.i64_const(32))))),F.addCode(u.i64_store32(u.getLocal("r"),L*4,u.getLocal("c")));F.addCode(u.i32_wrap_i64(u.i64_shr_u(u.getLocal("c"),u.i64_const(32))))}function v(){let F=t.addFunction(o+"_sub");F.addParam("x","i32"),F.addParam("y","i32"),F.addParam("r","i32"),F.setReturnType("i32"),F.addLocal("c","i64");let u=F.getCodeBuilder();F.addCode(u.setLocal("c",u.i64_sub(u.i64_load32_u(u.getLocal("x")),u.i64_load32_u(u.getLocal("y"))))),F.addCode(u.i64_store32(u.getLocal("r"),u.i64_and(u.getLocal("c"),u.i64_const("0xFFFFFFFF"))));for(let L=1;L<e;L++)F.addCode(u.setLocal("c",u.i64_add(u.i64_sub(u.i64_load32_u(u.getLocal("x"),4*L),u.i64_load32_u(u.getLocal("y"),4*L)),u.i64_shr_s(u.getLocal("c"),u.i64_const(32))))),F.addCode(u.i64_store32(u.getLocal("r"),L*4,u.i64_and(u.getLocal("c"),u.i64_const("0xFFFFFFFF"))));F.addCode(u.i32_wrap_i64(u.i64_shr_s(u.getLocal("c"),u.i64_const(32))))}function M(){let F=t.addFunction(o+"_mul");F.addParam("x","i32"),F.addParam("y","i32"),F.addParam("r","i32"),F.addLocal("c0","i64"),F.addLocal("c1","i64");for(let y=0;y<e;y++)F.addLocal("x"+y,"i64"),F.addLocal("y"+y,"i64");let u=F.getCodeBuilder(),L=[],$=[];function Q(y,I){let N,nt;return L[y]?N=u.getLocal("x"+y):(N=u.teeLocal("x"+y,u.i64_load32_u(u.getLocal("x"),y*4)),L[y]=!0),$[I]?nt=u.getLocal("y"+I):(nt=u.teeLocal("y"+I,u.i64_load32_u(u.getLocal("y"),I*4)),$[I]=!0),u.i64_mul(N,nt)}let H="c0",q="c1";for(let y=0;y<e*2-1;y++){for(let I=Math.max(0,y-e+1);I<=y&&I<e;I++){let N=y-I;F.addCode(u.setLocal(H,u.i64_add(u.i64_and(u.getLocal(H),u.i64_const(4294967295)),Q(I,N)))),F.addCode(u.setLocal(q,u.i64_add(u.getLocal(q),u.i64_shr_u(u.getLocal(H),u.i64_const(32)))))}F.addCode(u.i64_store32(u.getLocal("r"),y*4,u.getLocal(H))),[H,q]=[q,H],F.addCode(u.setLocal(q,u.i64_shr_u(u.getLocal(H),u.i64_const(32))))}F.addCode(u.i64_store32(u.getLocal("r"),e*4*2-4,u.getLocal(H)))}function x(){let F=t.addFunction(o+"_square");F.addParam("x","i32"),F.addParam("r","i32"),F.addLocal("c0","i64"),F.addLocal("c1","i64"),F.addLocal("c0_old","i64"),F.addLocal("c1_old","i64");for(let I=0;I<e;I++)F.addLocal("x"+I,"i64");let u=F.getCodeBuilder(),L=[];function $(I,N){let nt,J;return L[I]?nt=u.getLocal("x"+I):(nt=u.teeLocal("x"+I,u.i64_load32_u(u.getLocal("x"),I*4)),L[I]=!0),L[N]?J=u.getLocal("x"+N):(J=u.teeLocal("x"+N,u.i64_load32_u(u.getLocal("x"),N*4)),L[N]=!0),u.i64_mul(nt,J)}let Q="c0",H="c1",q="c0_old",y="c1_old";for(let I=0;I<e*2-1;I++){F.addCode(u.setLocal(Q,u.i64_const(0)),u.setLocal(H,u.i64_const(0)));for(let N=Math.max(0,I-e+1);N<I+1>>1&&N<e;N++){let nt=I-N;F.addCode(u.setLocal(Q,u.i64_add(u.i64_and(u.getLocal(Q),u.i64_const(4294967295)),$(N,nt)))),F.addCode(u.setLocal(H,u.i64_add(u.getLocal(H),u.i64_shr_u(u.getLocal(Q),u.i64_const(32)))))}F.addCode(u.setLocal(Q,u.i64_shl(u.i64_and(u.getLocal(Q),u.i64_const(4294967295)),u.i64_const(1)))),F.addCode(u.setLocal(H,u.i64_add(u.i64_shl(u.getLocal(H),u.i64_const(1)),u.i64_shr_u(u.getLocal(Q),u.i64_const(32))))),I%2==0&&(F.addCode(u.setLocal(Q,u.i64_add(u.i64_and(u.getLocal(Q),u.i64_const(4294967295)),$(I>>1,I>>1)))),F.addCode(u.setLocal(H,u.i64_add(u.getLocal(H),u.i64_shr_u(u.getLocal(Q),u.i64_const(32)))))),I>0&&(F.addCode(u.setLocal(Q,u.i64_add(u.i64_and(u.getLocal(Q),u.i64_const(4294967295)),u.i64_and(u.getLocal(q),u.i64_const(4294967295))))),F.addCode(u.setLocal(H,u.i64_add(u.i64_add(u.getLocal(H),u.i64_shr_u(u.getLocal(Q),u.i64_const(32))),u.getLocal(y))))),F.addCode(u.i64_store32(u.getLocal("r"),I*4,u.getLocal(Q))),F.addCode(u.setLocal(q,u.getLocal(H)),u.setLocal(y,u.i64_shr_u(u.getLocal(q),u.i64_const(32))))}F.addCode(u.i64_store32(u.getLocal("r"),e*4*2-4,u.getLocal(q)))}function S(){let F=t.addFunction(o+"_squareOld");F.addParam("x","i32"),F.addParam("r","i32");let u=F.getCodeBuilder();F.addCode(u.call(o+"_mul",u.getLocal("x"),u.getLocal("x"),u.getLocal("r")))}function w(){let F=t.addFunction(o+"__mul1");F.addParam("px","i32"),F.addParam("y","i64"),F.addParam("pr","i32"),F.addLocal("c","i64");let u=F.getCodeBuilder();F.addCode(u.setLocal("c",u.i64_mul(u.i64_load32_u(u.getLocal("px"),0,0),u.getLocal("y")))),F.addCode(u.i64_store32(u.getLocal("pr"),0,0,u.getLocal("c")));for(let L=1;L<e;L++)F.addCode(u.setLocal("c",u.i64_add(u.i64_mul(u.i64_load32_u(u.getLocal("px"),4*L,0),u.getLocal("y")),u.i64_shr_u(u.getLocal("c"),u.i64_const(32))))),F.addCode(u.i64_store32(u.getLocal("pr"),L*4,0,u.getLocal("c")))}function k(){let F=t.addFunction(o+"__add1");F.addParam("x","i32"),F.addParam("y","i64"),F.addLocal("c","i64"),F.addLocal("px","i32");let u=F.getCodeBuilder();F.addCode(u.setLocal("px",u.getLocal("x"))),F.addCode(u.setLocal("c",u.i64_add(u.i64_load32_u(u.getLocal("px"),0,0),u.getLocal("y")))),F.addCode(u.i64_store32(u.getLocal("px"),0,0,u.getLocal("c"))),F.addCode(u.setLocal("c",u.i64_shr_u(u.getLocal("c"),u.i64_const(32)))),F.addCode(u.block(u.loop(u.br_if(1,u.i64_eqz(u.getLocal("c"))),u.setLocal("px",u.i32_add(u.getLocal("px"),u.i32_const(4))),u.setLocal("c",u.i64_add(u.i64_load32_u(u.getLocal("px"),0,0),u.getLocal("c"))),u.i64_store32(u.getLocal("px"),0,0,u.getLocal("c")),u.setLocal("c",u.i64_shr_u(u.getLocal("c"),u.i64_const(32))),u.br(0))))}function O(){w(),k();let F=t.addFunction(o+"_div");F.addParam("x","i32"),F.addParam("y","i32"),F.addParam("c","i32"),F.addParam("r","i32"),F.addLocal("rr","i32"),F.addLocal("cc","i32"),F.addLocal("eX","i32"),F.addLocal("eY","i32"),F.addLocal("sy","i64"),F.addLocal("sx","i64"),F.addLocal("ec","i32");let u=F.getCodeBuilder(),L=u.i32_const(t.alloc(h)),$=u.i32_const(t.alloc(h)),Q=u.i32_const(t.alloc(h)),H=u.getLocal("cc"),q=u.getLocal("rr"),y=t.alloc(h*2),I=u.i32_const(y),N=u.i32_const(y+h);F.addCode(u.if(u.getLocal("c"),u.setLocal("cc",u.getLocal("c")),u.setLocal("cc",$))),F.addCode(u.if(u.getLocal("r"),u.setLocal("rr",u.getLocal("r")),u.setLocal("rr",Q))),F.addCode(u.call(o+"_copy",u.getLocal("x"),q)),F.addCode(u.call(o+"_copy",u.getLocal("y"),L)),F.addCode(u.call(o+"_zero",H)),F.addCode(u.call(o+"_zero",I)),F.addCode(u.setLocal("eX",u.i32_const(h-1))),F.addCode(u.setLocal("eY",u.i32_const(h-1))),F.addCode(u.block(u.loop(u.br_if(1,u.i32_or(u.i32_load8_u(u.i32_add(L,u.getLocal("eY")),0,0),u.i32_eq(u.getLocal("eY"),u.i32_const(3)))),u.setLocal("eY",u.i32_sub(u.getLocal("eY"),u.i32_const(1))),u.br(0)))),F.addCode(u.setLocal("sy",u.i64_add(u.i64_load32_u(u.i32_sub(u.i32_add(L,u.getLocal("eY")),u.i32_const(3)),0,0),u.i64_const(1)))),F.addCode(u.if(u.i64_eq(u.getLocal("sy"),u.i64_const(1)),u.drop(u.i64_div_u(u.i64_const(0),u.i64_const(0))))),F.addCode(u.block(u.loop(u.block(u.loop(u.br_if(1,u.i32_or(u.i32_load8_u(u.i32_add(q,u.getLocal("eX")),0,0),u.i32_eq(u.getLocal("eX"),u.i32_const(7)))),u.setLocal("eX",u.i32_sub(u.getLocal("eX"),u.i32_const(1))),u.br(0))),u.setLocal("sx",u.i64_load(u.i32_sub(u.i32_add(q,u.getLocal("eX")),u.i32_const(7)),0,0)),u.setLocal("sx",u.i64_div_u(u.getLocal("sx"),u.getLocal("sy"))),u.setLocal("ec",u.i32_sub(u.i32_sub(u.getLocal("eX"),u.getLocal("eY")),u.i32_const(4))),u.block(u.loop(u.br_if(1,u.i32_and(u.i64_eqz(u.i64_and(u.getLocal("sx"),u.i64_const("0xFFFFFFFF00000000"))),u.i32_ge_s(u.getLocal("ec"),u.i32_const(0)))),u.setLocal("sx",u.i64_shr_u(u.getLocal("sx"),u.i64_const(8))),u.setLocal("ec",u.i32_add(u.getLocal("ec"),u.i32_const(1))),u.br(0))),u.if(u.i64_eqz(u.getLocal("sx")),[...u.br_if(2,u.i32_eqz(u.call(o+"_gte",q,L))),...u.setLocal("sx",u.i64_const(1)),...u.setLocal("ec",u.i32_const(0))]),u.call(o+"__mul1",L,u.getLocal("sx"),N),u.drop(u.call(o+"_sub",q,u.i32_sub(N,u.getLocal("ec")),q)),u.call(o+"__add1",u.i32_add(H,u.getLocal("ec")),u.getLocal("sx")),u.br(0))))}function W(){let F=t.addFunction(o+"_inverseMod");F.addParam("px","i32"),F.addParam("pm","i32"),F.addParam("pr","i32"),F.addLocal("t","i32"),F.addLocal("newt","i32"),F.addLocal("r","i32"),F.addLocal("qq","i32"),F.addLocal("qr","i32"),F.addLocal("newr","i32"),F.addLocal("swp","i32"),F.addLocal("x","i32"),F.addLocal("signt","i32"),F.addLocal("signnewt","i32"),F.addLocal("signx","i32");let u=F.getCodeBuilder(),L=u.i32_const(t.alloc(h)),$=u.i32_const(t.alloc(h)),Q=u.i32_const(t.alloc(h)),H=u.i32_const(t.alloc(h)),q=u.i32_const(t.alloc(h)),y=u.i32_const(t.alloc(h)),I=u.i32_const(t.alloc(h*2)),N=u.i32_const(t.alloc(h));F.addCode(u.setLocal("t",L),u.call(o+"_zero",L),u.setLocal("signt",u.i32_const(0))),F.addCode(u.setLocal("r",$),u.call(o+"_copy",u.getLocal("pm"),$)),F.addCode(u.setLocal("newt",Q),u.call(o+"_one",Q),u.setLocal("signnewt",u.i32_const(0))),F.addCode(u.setLocal("newr",H),u.call(o+"_copy",u.getLocal("px"),H)),F.addCode(u.setLocal("qq",q)),F.addCode(u.setLocal("qr",y)),F.addCode(u.setLocal("x",N)),F.addCode(u.block(u.loop(u.br_if(1,u.call(o+"_isZero",u.getLocal("newr"))),u.call(o+"_div",u.getLocal("r"),u.getLocal("newr"),u.getLocal("qq"),u.getLocal("qr")),u.call(o+"_mul",u.getLocal("qq"),u.getLocal("newt"),I),u.if(u.getLocal("signt"),u.if(u.getLocal("signnewt"),u.if(u.call(o+"_gte",I,u.getLocal("t")),[...u.drop(u.call(o+"_sub",I,u.getLocal("t"),u.getLocal("x"))),...u.setLocal("signx",u.i32_const(0))],[...u.drop(u.call(o+"_sub",u.getLocal("t"),I,u.getLocal("x"))),...u.setLocal("signx",u.i32_const(1))]),[...u.drop(u.call(o+"_add",I,u.getLocal("t"),u.getLocal("x"))),...u.setLocal("signx",u.i32_const(1))]),u.if(u.getLocal("signnewt"),[...u.drop(u.call(o+"_add",I,u.getLocal("t"),u.getLocal("x"))),...u.setLocal("signx",u.i32_const(0))],u.if(u.call(o+"_gte",u.getLocal("t"),I),[...u.drop(u.call(o+"_sub",u.getLocal("t"),I,u.getLocal("x"))),...u.setLocal("signx",u.i32_const(0))],[...u.drop(u.call(o+"_sub",I,u.getLocal("t"),u.getLocal("x"))),...u.setLocal("signx",u.i32_const(1))]))),u.setLocal("swp",u.getLocal("t")),u.setLocal("t",u.getLocal("newt")),u.setLocal("newt",u.getLocal("x")),u.setLocal("x",u.getLocal("swp")),u.setLocal("signt",u.getLocal("signnewt")),u.setLocal("signnewt",u.getLocal("signx")),u.setLocal("swp",u.getLocal("r")),u.setLocal("r",u.getLocal("newr")),u.setLocal("newr",u.getLocal("qr")),u.setLocal("qr",u.getLocal("swp")),u.br(0)))),F.addCode(u.if(u.getLocal("signt"),u.drop(u.call(o+"_sub",u.getLocal("pm"),u.getLocal("t"),u.getLocal("pr"))),u.call(o+"_copy",u.getLocal("t"),u.getLocal("pr"))))}return d(),b(),s(),l(),m(),B(),p(),v(),M(),x(),S(),O(),W(),t.exportFunction(o+"_copy"),t.exportFunction(o+"_zero"),t.exportFunction(o+"_one"),t.exportFunction(o+"_isZero"),t.exportFunction(o+"_eq"),t.exportFunction(o+"_gte"),t.exportFunction(o+"_add"),t.exportFunction(o+"_sub"),t.exportFunction(o+"_mul"),t.exportFunction(o+"_square"),t.exportFunction(o+"_squareOld"),t.exportFunction(o+"_div"),t.exportFunction(o+"_inverseMod"),o},Wl=function(t,n,a,o,e,h,d){let b=t.addFunction(n);b.addParam("base","i32"),b.addParam("scalar","i32"),b.addParam("scalarLength","i32"),b.addParam("r","i32"),b.addLocal("i","i32"),b.addLocal("b","i32");let l=b.getCodeBuilder(),s=l.i32_const(t.alloc(a));b.addCode(l.if(l.i32_eqz(l.getLocal("scalarLength")),[...l.call(d,l.getLocal("r")),...l.ret([])])),b.addCode(l.call(h,l.getLocal("base"),s)),b.addCode(l.call(d,l.getLocal("r"))),b.addCode(l.setLocal("i",l.getLocal("scalarLength"))),b.addCode(l.block(l.loop(l.setLocal("i",l.i32_sub(l.getLocal("i"),l.i32_const(1))),l.setLocal("b",l.i32_load8_u(l.i32_add(l.getLocal("scalar"),l.getLocal("i")))),...m(),l.br_if(1,l.i32_eqz(l.getLocal("i"))),l.br(0))));function m(){let B=[];for(let p=0;p<8;p++)B.push(...l.call(e,l.getLocal("r"),l.getLocal("r")),...l.if(l.i32_ge_u(l.getLocal("b"),l.i32_const(128>>p)),[...l.setLocal("b",l.i32_sub(l.getLocal("b"),l.i32_const(128>>p))),...l.call(o,l.getLocal("r"),s,l.getLocal("r"))]));return B}},Ql=lL;a_=rL;dL=uL;Wn={};Wn.bitLength=e_;Wn.isOdd=i_;Wn.isNegative=gc;Wn.abs=Pi;Wn.isUnit=Oo;Wn.compare=o_;Wn.modInv=c_;Wn.modPow=s_;Wn.isPrime=LL;Wn.square=Xl;pL=sL,qa=ja,bL=Wl,mL=Ql,gl=a_,Ll=dL,{bitLength:yL,modInv:pl,modPow:vu,isPrime:Su,isOdd:wL,square:FL}=Wn,Dl=function(t,n,a,o){let e=BigInt(n),h=Math.floor((yL(e-1n)-1)/64)+1,d=h*2,b=h*8,l=a||"f1m";if(t.modules[l])return l;let s=pL(t,h,o),m=t.alloc(b,qa.bigInt2BytesLE(e,b)),B=t.alloc(qa.bigInt2BytesLE(FL(1n<<BigInt(h*64))%e,b)),p=t.alloc(qa.bigInt2BytesLE((1n<<BigInt(h*64))%e,b)),v=t.alloc(qa.bigInt2BytesLE(0n,b)),M=e-1n,x=M>>1n,S=t.alloc(b,qa.bigInt2BytesLE(x,b)),w=x+1n,k=t.alloc(b,qa.bigInt2BytesLE(w,b));t.modules[l]={pq:m,pR2:B,n64:h,q:e,pOne:p,pZero:v,pePlusOne:k};function O(){let E=t.addFunction(l+"_one");E.addParam("pr","i32");let g=E.getCodeBuilder();E.addCode(g.call(s+"_copy",g.i32_const(p),g.getLocal("pr")))}function W(){let E=t.addFunction(l+"_add");E.addParam("x","i32"),E.addParam("y","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.if(g.call(s+"_add",g.getLocal("x"),g.getLocal("y"),g.getLocal("r")),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))),g.if(g.call(s+"_gte",g.getLocal("r"),g.i32_const(m)),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))))))}function F(){let E=t.addFunction(l+"_sub");E.addParam("x","i32"),E.addParam("y","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.if(g.call(s+"_sub",g.getLocal("x"),g.getLocal("y"),g.getLocal("r")),g.drop(g.call(s+"_add",g.getLocal("r"),g.i32_const(m),g.getLocal("r")))))}function u(){let E=t.addFunction(l+"_neg");E.addParam("x","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.call(l+"_sub",g.i32_const(v),g.getLocal("x"),g.getLocal("r")))}function L(){let E=t.addFunction(l+"_isNegative");E.addParam("x","i32"),E.setReturnType("i32");let g=E.getCodeBuilder(),U=g.i32_const(t.alloc(b));E.addCode(g.call(l+"_fromMontgomery",g.getLocal("x"),U),g.call(s+"_gte",U,g.i32_const(k)))}function $(){let E=t.addFunction(l+"_sign");E.addParam("x","i32"),E.setReturnType("i32");let g=E.getCodeBuilder(),U=g.i32_const(t.alloc(b));E.addCode(g.if(g.call(s+"_isZero",g.getLocal("x")),g.ret(g.i32_const(0))),g.call(l+"_fromMontgomery",g.getLocal("x"),U),g.if(g.call(s+"_gte",U,g.i32_const(k)),g.ret(g.i32_const(-1))),g.ret(g.i32_const(1)))}function Q(){let E=t.alloc(d*d*8),g=t.addFunction(l+"_mReduct");g.addParam("t","i32"),g.addParam("r","i32"),g.addLocal("np32","i64"),g.addLocal("c","i64"),g.addLocal("m","i64");let U=g.getCodeBuilder(),st=Number(0x100000000n-pl(e,0x100000000n));g.addCode(U.setLocal("np32",U.i64_const(st)));for(let et=0;et<d;et++){g.addCode(U.setLocal("c",U.i64_const(0))),g.addCode(U.setLocal("m",U.i64_and(U.i64_mul(U.i64_load32_u(U.getLocal("t"),et*4),U.getLocal("np32")),U.i64_const("0xFFFFFFFF"))));for(let ct=0;ct<d;ct++)g.addCode(U.setLocal("c",U.i64_add(U.i64_add(U.i64_load32_u(U.getLocal("t"),(et+ct)*4),U.i64_shr_u(U.getLocal("c"),U.i64_const(32))),U.i64_mul(U.i64_load32_u(U.i32_const(m),ct*4),U.getLocal("m"))))),g.addCode(U.i64_store32(U.getLocal("t"),(et+ct)*4,U.getLocal("c")));g.addCode(U.i64_store32(U.i32_const(E),et*4,U.i64_shr_u(U.getLocal("c"),U.i64_const(32))))}g.addCode(U.call(l+"_add",U.i32_const(E),U.i32_add(U.getLocal("t"),U.i32_const(d*4)),U.getLocal("r")))}function H(){let E=t.addFunction(l+"_mul");E.addParam("x","i32"),E.addParam("y","i32"),E.addParam("r","i32"),E.addLocal("c0","i64"),E.addLocal("c1","i64"),E.addLocal("np32","i64");for(let ut=0;ut<d;ut++)E.addLocal("x"+ut,"i64"),E.addLocal("y"+ut,"i64"),E.addLocal("m"+ut,"i64"),E.addLocal("q"+ut,"i64");let g=E.getCodeBuilder(),U=Number(0x100000000n-pl(e,0x100000000n));E.addCode(g.setLocal("np32",g.i64_const(U)));let st=[],et=[],ct=[];function ft(ut,lt){let bt,Et;return st[ut]?bt=g.getLocal("x"+ut):(bt=g.teeLocal("x"+ut,g.i64_load32_u(g.getLocal("x"),ut*4)),st[ut]=!0),et[lt]?Et=g.getLocal("y"+lt):(Et=g.teeLocal("y"+lt,g.i64_load32_u(g.getLocal("y"),lt*4)),et[lt]=!0),g.i64_mul(bt,Et)}function _t(ut,lt){let bt,Et;return ct[ut]?bt=g.getLocal("q"+ut):(bt=g.teeLocal("q"+ut,g.i64_load32_u(g.i32_const(0),m+ut*4)),ct[ut]=!0),Et=g.getLocal("m"+lt),g.i64_mul(bt,Et)}let gt="c0",yt="c1";for(let ut=0;ut<d*2-1;ut++){for(let lt=Math.max(0,ut-d+1);lt<=ut&&lt<d;lt++){let bt=ut-lt;E.addCode(g.setLocal(gt,g.i64_add(g.i64_and(g.getLocal(gt),g.i64_const(4294967295)),ft(lt,bt)))),E.addCode(g.setLocal(yt,g.i64_add(g.getLocal(yt),g.i64_shr_u(g.getLocal(gt),g.i64_const(32)))))}for(let lt=Math.max(1,ut-d+1);lt<=ut&&lt<d;lt++){let bt=ut-lt;E.addCode(g.setLocal(gt,g.i64_add(g.i64_and(g.getLocal(gt),g.i64_const(4294967295)),_t(lt,bt)))),E.addCode(g.setLocal(yt,g.i64_add(g.getLocal(yt),g.i64_shr_u(g.getLocal(gt),g.i64_const(32)))))}ut<d&&(E.addCode(g.setLocal("m"+ut,g.i64_and(g.i64_mul(g.i64_and(g.getLocal(gt),g.i64_const(4294967295)),g.getLocal("np32")),g.i64_const("0xFFFFFFFF")))),E.addCode(g.setLocal(gt,g.i64_add(g.i64_and(g.getLocal(gt),g.i64_const(4294967295)),_t(0,ut)))),E.addCode(g.setLocal(yt,g.i64_add(g.getLocal(yt),g.i64_shr_u(g.getLocal(gt),g.i64_const(32)))))),ut>=d&&E.addCode(g.i64_store32(g.getLocal("r"),(ut-d)*4,g.getLocal(gt))),[gt,yt]=[yt,gt],E.addCode(g.setLocal(yt,g.i64_shr_u(g.getLocal(gt),g.i64_const(32))))}E.addCode(g.i64_store32(g.getLocal("r"),d*4-4,g.getLocal(gt))),E.addCode(g.if(g.i32_wrap_i64(g.getLocal(yt)),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))),g.if(g.call(s+"_gte",g.getLocal("r"),g.i32_const(m)),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))))))}function q(){let E=t.addFunction(l+"_square");E.addParam("x","i32"),E.addParam("r","i32"),E.addLocal("c0","i64"),E.addLocal("c1","i64"),E.addLocal("c0_old","i64"),E.addLocal("c1_old","i64"),E.addLocal("np32","i64");for(let lt=0;lt<d;lt++)E.addLocal("x"+lt,"i64"),E.addLocal("m"+lt,"i64"),E.addLocal("q"+lt,"i64");let g=E.getCodeBuilder(),U=Number(0x100000000n-pl(e,0x100000000n));E.addCode(g.setLocal("np32",g.i64_const(U)));let st=[],et=[];function ct(lt,bt){let Et,It;return st[lt]?Et=g.getLocal("x"+lt):(Et=g.teeLocal("x"+lt,g.i64_load32_u(g.getLocal("x"),lt*4)),st[lt]=!0),st[bt]?It=g.getLocal("x"+bt):(It=g.teeLocal("x"+bt,g.i64_load32_u(g.getLocal("x"),bt*4)),st[bt]=!0),g.i64_mul(Et,It)}function ft(lt,bt){let Et,It;return et[lt]?Et=g.getLocal("q"+lt):(Et=g.teeLocal("q"+lt,g.i64_load32_u(g.i32_const(0),m+lt*4)),et[lt]=!0),It=g.getLocal("m"+bt),g.i64_mul(Et,It)}let _t="c0",gt="c1",yt="c0_old",ut="c1_old";for(let lt=0;lt<d*2-1;lt++){E.addCode(g.setLocal(_t,g.i64_const(0)),g.setLocal(gt,g.i64_const(0)));for(let bt=Math.max(0,lt-d+1);bt<lt+1>>1&&bt<d;bt++){let Et=lt-bt;E.addCode(g.setLocal(_t,g.i64_add(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),ct(bt,Et)))),E.addCode(g.setLocal(gt,g.i64_add(g.getLocal(gt),g.i64_shr_u(g.getLocal(_t),g.i64_const(32)))))}E.addCode(g.setLocal(_t,g.i64_shl(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),g.i64_const(1)))),E.addCode(g.setLocal(gt,g.i64_add(g.i64_shl(g.getLocal(gt),g.i64_const(1)),g.i64_shr_u(g.getLocal(_t),g.i64_const(32))))),lt%2==0&&(E.addCode(g.setLocal(_t,g.i64_add(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),ct(lt>>1,lt>>1)))),E.addCode(g.setLocal(gt,g.i64_add(g.getLocal(gt),g.i64_shr_u(g.getLocal(_t),g.i64_const(32)))))),lt>0&&(E.addCode(g.setLocal(_t,g.i64_add(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),g.i64_and(g.getLocal(yt),g.i64_const(4294967295))))),E.addCode(g.setLocal(gt,g.i64_add(g.i64_add(g.getLocal(gt),g.i64_shr_u(g.getLocal(_t),g.i64_const(32))),g.getLocal(ut)))));for(let bt=Math.max(1,lt-d+1);bt<=lt&&bt<d;bt++){let Et=lt-bt;E.addCode(g.setLocal(_t,g.i64_add(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),ft(bt,Et)))),E.addCode(g.setLocal(gt,g.i64_add(g.getLocal(gt),g.i64_shr_u(g.getLocal(_t),g.i64_const(32)))))}lt<d&&(E.addCode(g.setLocal("m"+lt,g.i64_and(g.i64_mul(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),g.getLocal("np32")),g.i64_const("0xFFFFFFFF")))),E.addCode(g.setLocal(_t,g.i64_add(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),ft(0,lt)))),E.addCode(g.setLocal(gt,g.i64_add(g.getLocal(gt),g.i64_shr_u(g.getLocal(_t),g.i64_const(32)))))),lt>=d&&E.addCode(g.i64_store32(g.getLocal("r"),(lt-d)*4,g.getLocal(_t))),E.addCode(g.setLocal(yt,g.getLocal(gt)),g.setLocal(ut,g.i64_shr_u(g.getLocal(yt),g.i64_const(32))))}E.addCode(g.i64_store32(g.getLocal("r"),d*4-4,g.getLocal(yt))),E.addCode(g.if(g.i32_wrap_i64(g.getLocal(ut)),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))),g.if(g.call(s+"_gte",g.getLocal("r"),g.i32_const(m)),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))))))}function y(){let E=t.addFunction(l+"_squareOld");E.addParam("x","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.call(l+"_mul",g.getLocal("x"),g.getLocal("x"),g.getLocal("r")))}function I(){let E=t.addFunction(l+"_toMontgomery");E.addParam("x","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.call(l+"_mul",g.getLocal("x"),g.i32_const(B),g.getLocal("r")))}function N(){let E=t.alloc(b*2),g=t.addFunction(l+"_fromMontgomery");g.addParam("x","i32"),g.addParam("r","i32");let U=g.getCodeBuilder();g.addCode(U.call(s+"_copy",U.getLocal("x"),U.i32_const(E))),g.addCode(U.call(s+"_zero",U.i32_const(E+b))),g.addCode(U.call(l+"_mReduct",U.i32_const(E),U.getLocal("r")))}function nt(){let E=t.addFunction(l+"_inverse");E.addParam("x","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.call(l+"_fromMontgomery",g.getLocal("x"),g.getLocal("r"))),E.addCode(g.call(s+"_inverseMod",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))),E.addCode(g.call(l+"_toMontgomery",g.getLocal("r"),g.getLocal("r")))}let J=2n;if(Su(e))for(;vu(J,x,e)!==M;)J=J+1n;let j=0,ot=M;for(;!wL(ot)&&ot!==0n;)j++,ot=ot>>1n;let V=t.alloc(b,qa.bigInt2BytesLE(ot,b)),at=vu(J,ot,e),Lt=t.alloc(qa.bigInt2BytesLE((at<<BigInt(h*64))%e,b)),rt=ot+1n>>1n,ht=t.alloc(b,qa.bigInt2BytesLE(rt,b));function A(){let E=t.addFunction(l+"_sqrt");E.addParam("n","i32"),E.addParam("r","i32"),E.addLocal("m","i32"),E.addLocal("i","i32"),E.addLocal("j","i32");let g=E.getCodeBuilder(),U=g.i32_const(p),st=g.i32_const(t.alloc(b)),et=g.i32_const(t.alloc(b)),ct=g.i32_const(t.alloc(b)),ft=g.i32_const(t.alloc(b)),_t=g.i32_const(t.alloc(b));E.addCode(g.if(g.call(l+"_isZero",g.getLocal("n")),g.ret(g.call(l+"_zero",g.getLocal("r")))),g.setLocal("m",g.i32_const(j)),g.call(l+"_copy",g.i32_const(Lt),st),g.call(l+"_exp",g.getLocal("n"),g.i32_const(V),g.i32_const(b),et),g.call(l+"_exp",g.getLocal("n"),g.i32_const(ht),g.i32_const(b),ct),g.block(g.loop(g.br_if(1,g.call(l+"_eq",et,U)),g.call(l+"_square",et,ft),g.setLocal("i",g.i32_const(1)),g.block(g.loop(g.br_if(1,g.call(l+"_eq",ft,U)),g.call(l+"_square",ft,ft),g.setLocal("i",g.i32_add(g.getLocal("i"),g.i32_const(1))),g.br(0))),g.call(l+"_copy",st,_t),g.setLocal("j",g.i32_sub(g.i32_sub(g.getLocal("m"),g.getLocal("i")),g.i32_const(1))),g.block(g.loop(g.br_if(1,g.i32_eqz(g.getLocal("j"))),g.call(l+"_square",_t,_t),g.setLocal("j",g.i32_sub(g.getLocal("j"),g.i32_const(1))),g.br(0))),g.setLocal("m",g.getLocal("i")),g.call(l+"_square",_t,st),g.call(l+"_mul",et,st,et),g.call(l+"_mul",ct,_t,ct),g.br(0))),g.if(g.call(l+"_isNegative",ct),g.call(l+"_neg",ct,g.getLocal("r")),g.call(l+"_copy",ct,g.getLocal("r"))))}function i(){let E=t.addFunction(l+"_isSquare");E.addParam("n","i32"),E.setReturnType("i32");let g=E.getCodeBuilder(),U=g.i32_const(p),st=g.i32_const(t.alloc(b));E.addCode(g.if(g.call(l+"_isZero",g.getLocal("n")),g.ret(g.i32_const(1))),g.call(l+"_exp",g.getLocal("n"),g.i32_const(S),g.i32_const(b),st),g.call(l+"_eq",st,U))}function C(){let E=t.addFunction(l+"_load");E.addParam("scalar","i32"),E.addParam("scalarLen","i32"),E.addParam("r","i32"),E.addLocal("p","i32"),E.addLocal("l","i32"),E.addLocal("i","i32"),E.addLocal("j","i32");let g=E.getCodeBuilder(),U=g.i32_const(t.alloc(b)),st=t.alloc(b),et=g.i32_const(st);E.addCode(g.call(s+"_zero",g.getLocal("r")),g.setLocal("i",g.i32_const(b)),g.setLocal("p",g.getLocal("scalar")),g.block(g.loop(g.br_if(1,g.i32_gt_u(g.getLocal("i"),g.getLocal("scalarLen"))),g.if(g.i32_eq(g.getLocal("i"),g.i32_const(b)),g.call(l+"_one",U),g.call(l+"_mul",U,g.i32_const(B),U)),g.call(l+"_mul",g.getLocal("p"),U,et),g.call(l+"_add",g.getLocal("r"),et,g.getLocal("r")),g.setLocal("p",g.i32_add(g.getLocal("p"),g.i32_const(b))),g.setLocal("i",g.i32_add(g.getLocal("i"),g.i32_const(b))),g.br(0))),g.setLocal("l",g.i32_rem_u(g.getLocal("scalarLen"),g.i32_const(b))),g.if(g.i32_eqz(g.getLocal("l")),g.ret([])),g.call(s+"_zero",et),g.setLocal("j",g.i32_const(0)),g.block(g.loop(g.br_if(1,g.i32_eq(g.getLocal("j"),g.getLocal("l"))),g.i32_store8(g.getLocal("j"),st,g.i32_load8_u(g.getLocal("p"))),g.setLocal("p",g.i32_add(g.getLocal("p"),g.i32_const(1))),g.setLocal("j",g.i32_add(g.getLocal("j"),g.i32_const(1))),g.br(0))),g.if(g.i32_eq(g.getLocal("i"),g.i32_const(b)),g.call(l+"_one",U),g.call(l+"_mul",U,g.i32_const(B),U)),g.call(l+"_mul",et,U,et),g.call(l+"_add",g.getLocal("r"),et,g.getLocal("r")))}function r(){let E=t.addFunction(l+"_timesScalar");E.addParam("x","i32"),E.addParam("scalar","i32"),E.addParam("scalarLen","i32"),E.addParam("r","i32");let g=E.getCodeBuilder(),U=g.i32_const(t.alloc(b));E.addCode(g.call(l+"_load",g.getLocal("scalar"),g.getLocal("scalarLen"),U),g.call(l+"_toMontgomery",U,U),g.call(l+"_mul",g.getLocal("x"),U,g.getLocal("r")))}function z(){let E=t.addFunction(l+"_isOne");E.addParam("x","i32"),E.setReturnType("i32");let g=E.getCodeBuilder();E.addCode(g.ret(g.call(s+"_eq",g.getLocal("x"),g.i32_const(p))))}return t.exportFunction(s+"_copy",l+"_copy"),t.exportFunction(s+"_zero",l+"_zero"),t.exportFunction(s+"_isZero",l+"_isZero"),t.exportFunction(s+"_eq",l+"_eq"),z(),W(),F(),u(),Q(),H(),q(),y(),I(),N(),L(),$(),nt(),O(),C(),r(),mL(t,l),gl(t,l+"_batchToMontgomery",l+"_toMontgomery",b,b),gl(t,l+"_batchFromMontgomery",l+"_fromMontgomery",b,b),gl(t,l+"_batchNeg",l+"_neg",b,b),Ll(t,l+"_batchAdd",l+"_add",b,b),Ll(t,l+"_batchSub",l+"_sub",b,b),Ll(t,l+"_batchMul",l+"_mul",b,b),t.exportFunction(l+"_add"),t.exportFunction(l+"_sub"),t.exportFunction(l+"_neg"),t.exportFunction(l+"_isNegative"),t.exportFunction(l+"_isOne"),t.exportFunction(l+"_sign"),t.exportFunction(l+"_mReduct"),t.exportFunction(l+"_mul"),t.exportFunction(l+"_square"),t.exportFunction(l+"_squareOld"),t.exportFunction(l+"_fromMontgomery"),t.exportFunction(l+"_toMontgomery"),t.exportFunction(l+"_inverse"),t.exportFunction(l+"_one"),t.exportFunction(l+"_load"),t.exportFunction(l+"_timesScalar"),bL(t,l+"_exp",b,l+"_mul",l+"_square",s+"_copy",l+"_one"),t.exportFunction(l+"_exp"),t.exportFunction(l+"_batchInverse"),Su(e)&&(A(),i(),t.exportFunction(l+"_sqrt"),t.exportFunction(l+"_isSquare")),t.exportFunction(l+"_batchToMontgomery"),t.exportFunction(l+"_batchFromMontgomery"),l},CL=Dl,{bitLength:BL}=Wn,l_=function(t,n,a,o,e){let h=BigInt(n),d=Math.floor((BL(h-1n)-1)/64)+1,b=d*8,l=a||"f1";if(t.modules[l])return l;t.modules[l]={n64:d};let s=e||"int",m=CL(t,h,o,s),B=t.modules[m].pR2,p=t.modules[m].pq,v=t.modules[m].pePlusOne;function M(){let k=t.alloc(b),O=t.addFunction(l+"_mul");O.addParam("x","i32"),O.addParam("y","i32"),O.addParam("r","i32");let W=O.getCodeBuilder();O.addCode(W.call(m+"_mul",W.getLocal("x"),W.getLocal("y"),W.i32_const(k))),O.addCode(W.call(m+"_mul",W.i32_const(k),W.i32_const(B),W.getLocal("r")))}function x(){let k=t.addFunction(l+"_square");k.addParam("x","i32"),k.addParam("r","i32");let O=k.getCodeBuilder();k.addCode(O.call(l+"_mul",O.getLocal("x"),O.getLocal("x"),O.getLocal("r")))}function S(){let k=t.addFunction(l+"_inverse");k.addParam("x","i32"),k.addParam("r","i32");let O=k.getCodeBuilder();k.addCode(O.call(s+"_inverseMod",O.getLocal("x"),O.i32_const(p),O.getLocal("r")))}function w(){let k=t.addFunction(l+"_isNegative");k.addParam("x","i32"),k.setReturnType("i32");let O=k.getCodeBuilder();k.addCode(O.call(s+"_gte",O.getLocal("x"),O.i32_const(v)))}return M(),x(),S(),w(),t.exportFunction(m+"_add",l+"_add"),t.exportFunction(m+"_sub",l+"_sub"),t.exportFunction(m+"_neg",l+"_neg"),t.exportFunction(l+"_mul"),t.exportFunction(l+"_square"),t.exportFunction(l+"_inverse"),t.exportFunction(l+"_isNegative"),t.exportFunction(m+"_copy",l+"_copy"),t.exportFunction(m+"_zero",l+"_zero"),t.exportFunction(m+"_one",l+"_one"),t.exportFunction(m+"_isZero",l+"_isZero"),t.exportFunction(m+"_eq",l+"_eq"),l},xL=Wl,AL=Ql,bl=ja,r_=function(t,n,a,o){if(t.modules[a])return a;let e=t.modules[o].n64*8,h=t.modules[o].q;t.modules[a]={n64:t.modules[o].n64*2};function d(){let q=t.addFunction(a+"_add");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("y"),J=y.i32_add(y.getLocal("y"),y.i32_const(e)),j=y.getLocal("r"),ot=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_add",I,nt,j),y.call(o+"_add",N,J,ot))}function b(){let q=t.addFunction(a+"_timesScalar");q.addParam("x","i32"),q.addParam("scalar","i32"),q.addParam("scalarLen","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_timesScalar",I,y.getLocal("scalar"),y.getLocal("scalarLen"),nt),y.call(o+"_timesScalar",N,y.getLocal("scalar"),y.getLocal("scalarLen"),J))}function l(){let q=t.addFunction(a+"_sub");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("y"),J=y.i32_add(y.getLocal("y"),y.i32_const(e)),j=y.getLocal("r"),ot=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_sub",I,nt,j),y.call(o+"_sub",N,J,ot))}function s(){let q=t.addFunction(a+"_neg");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_neg",I,nt),y.call(o+"_neg",N,J))}function m(){let q=t.addFunction(a+"_conjugate");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_copy",I,nt),y.call(o+"_neg",N,J))}function B(){let q=t.addFunction(a+"_isNegative");q.addParam("x","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.if(y.call(o+"_isZero",N),y.ret(y.call(o+"_isNegative",I))),y.ret(y.call(o+"_isNegative",N)))}function p(){let q=t.addFunction(a+"_mul");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("y"),J=y.i32_add(y.getLocal("y"),y.i32_const(e)),j=y.getLocal("r"),ot=y.i32_add(y.getLocal("r"),y.i32_const(e)),V=y.i32_const(t.alloc(e)),at=y.i32_const(t.alloc(e)),Lt=y.i32_const(t.alloc(e)),rt=y.i32_const(t.alloc(e));q.addCode(y.call(o+"_mul",I,nt,V),y.call(o+"_mul",N,J,at),y.call(o+"_add",I,N,Lt),y.call(o+"_add",nt,J,rt),y.call(o+"_mul",Lt,rt,Lt),y.call(n,at,j),y.call(o+"_add",V,j,j),y.call(o+"_add",V,at,ot),y.call(o+"_sub",Lt,ot,ot))}function v(){let q=t.addFunction(a+"_mul1");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("y"),J=y.getLocal("r"),j=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_mul",I,nt,J),y.call(o+"_mul",N,nt,j))}function M(){let q=t.addFunction(a+"_square");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e)),j=y.i32_const(t.alloc(e)),ot=y.i32_const(t.alloc(e)),V=y.i32_const(t.alloc(e)),at=y.i32_const(t.alloc(e));q.addCode(y.call(o+"_mul",I,N,j),y.call(o+"_add",I,N,ot),y.call(n,N,V),y.call(o+"_add",I,V,V),y.call(n,j,at),y.call(o+"_add",at,j,at),y.call(o+"_mul",ot,V,nt),y.call(o+"_sub",nt,at,nt),y.call(o+"_add",j,j,J))}function x(){let q=t.addFunction(a+"_toMontgomery");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_toMontgomery",I,nt),y.call(o+"_toMontgomery",N,J))}function S(){let q=t.addFunction(a+"_fromMontgomery");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_fromMontgomery",I,nt),y.call(o+"_fromMontgomery",N,J))}function w(){let q=t.addFunction(a+"_copy");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_copy",I,nt),y.call(o+"_copy",N,J))}function k(){let q=t.addFunction(a+"_zero");q.addParam("x","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.call(o+"_zero",I),y.call(o+"_zero",N))}function O(){let q=t.addFunction(a+"_one");q.addParam("x","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.call(o+"_one",I),y.call(o+"_zero",N))}function W(){let q=t.addFunction(a+"_eq");q.addParam("x","i32"),q.addParam("y","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("y"),J=y.i32_add(y.getLocal("y"),y.i32_const(e));q.addCode(y.i32_and(y.call(o+"_eq",I,nt),y.call(o+"_eq",N,J)))}function F(){let q=t.addFunction(a+"_isZero");q.addParam("x","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.i32_and(y.call(o+"_isZero",I),y.call(o+"_isZero",N)))}function u(){let q=t.addFunction(a+"_inverse");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e)),j=y.i32_const(t.alloc(e)),ot=y.i32_const(t.alloc(e)),V=y.i32_const(t.alloc(e)),at=y.i32_const(t.alloc(e));q.addCode(y.call(o+"_square",I,j),y.call(o+"_square",N,ot),y.call(n,ot,V),y.call(o+"_sub",j,V,V),y.call(o+"_inverse",V,at),y.call(o+"_mul",I,at,nt),y.call(o+"_mul",N,at,J),y.call(o+"_neg",J,J))}function L(){let q=t.addFunction(a+"_sign");q.addParam("x","i32"),q.addLocal("s","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.setLocal("s",y.call(o+"_sign",N)),y.if(y.getLocal("s"),y.ret(y.getLocal("s"))),y.ret(y.call(o+"_sign",I)))}function $(){let q=t.addFunction(a+"_isOne");q.addParam("x","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.ret(y.i32_and(y.call(o+"_isOne",I),y.call(o+"_isZero",N))))}function Q(){let q=t.addFunction(a+"_sqrt");q.addParam("a","i32"),q.addParam("pr","i32");let y=q.getCodeBuilder(),I=y.i32_const(t.alloc(bl.bigInt2BytesLE((BigInt(h||0)-3n)/4n,e))),N=y.i32_const(t.alloc(bl.bigInt2BytesLE((BigInt(h||0)-1n)/2n,e))),nt=y.getLocal("a"),J=y.i32_const(t.alloc(e*2)),j=y.i32_const(t.alloc(e*2)),ot=y.i32_const(t.alloc(e*2)),V=t.alloc(e*2),at=y.i32_const(V),Lt=y.i32_const(V),rt=y.i32_const(V+e),ht=y.i32_const(t.alloc(e*2)),A=y.i32_const(t.alloc(e*2));q.addCode(y.call(a+"_one",at),y.call(a+"_neg",at,at),y.call(a+"_exp",nt,I,y.i32_const(e),J),y.call(a+"_square",J,j),y.call(a+"_mul",nt,j,j),y.call(a+"_conjugate",j,ot),y.call(a+"_mul",ot,j,ot),y.if(y.call(a+"_eq",ot,at),y.unreachable()),y.call(a+"_mul",J,nt,ht),y.if(y.call(a+"_eq",j,at),[...y.call(o+"_zero",Lt),...y.call(o+"_one",rt),...y.call(a+"_mul",at,ht,y.getLocal("pr"))],[...y.call(a+"_one",A),...y.call(a+"_add",A,j,A),...y.call(a+"_exp",A,N,y.i32_const(e),A),...y.call(a+"_mul",A,ht,y.getLocal("pr"))]))}function H(){let q=t.addFunction(a+"_isSquare");q.addParam("a","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.i32_const(t.alloc(bl.bigInt2BytesLE((BigInt(h||0)-3n)/4n,e))),N=y.getLocal("a"),nt=y.i32_const(t.alloc(e*2)),J=y.i32_const(t.alloc(e*2)),j=y.i32_const(t.alloc(e*2)),ot=t.alloc(e*2),V=y.i32_const(ot);q.addCode(y.call(a+"_one",V),y.call(a+"_neg",V,V),y.call(a+"_exp",N,I,y.i32_const(e),nt),y.call(a+"_square",nt,J),y.call(a+"_mul",N,J,J),y.call(a+"_conjugate",J,j),y.call(a+"_mul",j,J,j),y.if(y.call(a+"_eq",j,V),y.ret(y.i32_const(0))),y.ret(y.i32_const(1)))}return F(),$(),k(),O(),w(),p(),v(),M(),d(),l(),s(),m(),x(),S(),W(),u(),b(),L(),B(),t.exportFunction(a+"_isZero"),t.exportFunction(a+"_isOne"),t.exportFunction(a+"_zero"),t.exportFunction(a+"_one"),t.exportFunction(a+"_copy"),t.exportFunction(a+"_mul"),t.exportFunction(a+"_mul1"),t.exportFunction(a+"_square"),t.exportFunction(a+"_add"),t.exportFunction(a+"_sub"),t.exportFunction(a+"_neg"),t.exportFunction(a+"_sign"),t.exportFunction(a+"_conjugate"),t.exportFunction(a+"_fromMontgomery"),t.exportFunction(a+"_toMontgomery"),t.exportFunction(a+"_eq"),t.exportFunction(a+"_inverse"),AL(t,a),xL(t,a+"_exp",e*2,a+"_mul",a+"_square",a+"_copy",a+"_one"),Q(),H(),t.exportFunction(a+"_exp"),t.exportFunction(a+"_timesScalar"),t.exportFunction(a+"_batchInverse"),t.exportFunction(a+"_sqrt"),t.exportFunction(a+"_isSquare"),t.exportFunction(a+"_isNegative"),a},EL=Wl,vL=Ql,d_=function(t,n,a,o){if(t.modules[a])return a;let e=t.modules[o].n64*8;t.modules[a]={n64:t.modules[o].n64*3};function h(){let u=t.addFunction(a+"_add");u.addParam("x","i32"),u.addParam("y","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("y"),y=L.i32_add(L.getLocal("y"),L.i32_const(e)),I=L.i32_add(L.getLocal("y"),L.i32_const(2*e)),N=L.getLocal("r"),nt=L.i32_add(L.getLocal("r"),L.i32_const(e)),J=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_add",$,q,N),L.call(o+"_add",Q,y,nt),L.call(o+"_add",H,I,J))}function d(){let u=t.addFunction(a+"_timesScalar");u.addParam("x","i32"),u.addParam("scalar","i32"),u.addParam("scalarLen","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_timesScalar",$,L.getLocal("scalar"),L.getLocal("scalarLen"),q),L.call(o+"_timesScalar",Q,L.getLocal("scalar"),L.getLocal("scalarLen"),y),L.call(o+"_timesScalar",H,L.getLocal("scalar"),L.getLocal("scalarLen"),I))}function b(){let u=t.addFunction(a+"_sub");u.addParam("x","i32"),u.addParam("y","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("y"),y=L.i32_add(L.getLocal("y"),L.i32_const(e)),I=L.i32_add(L.getLocal("y"),L.i32_const(2*e)),N=L.getLocal("r"),nt=L.i32_add(L.getLocal("r"),L.i32_const(e)),J=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_sub",$,q,N),L.call(o+"_sub",Q,y,nt),L.call(o+"_sub",H,I,J))}function l(){let u=t.addFunction(a+"_neg");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_neg",$,q),L.call(o+"_neg",Q,y),L.call(o+"_neg",H,I))}function s(){let u=t.addFunction(a+"_isNegative");u.addParam("x","i32"),u.setReturnType("i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e));u.addCode(L.if(L.call(o+"_isZero",H),L.if(L.call(o+"_isZero",Q),L.ret(L.call(o+"_isNegative",$)),L.ret(L.call(o+"_isNegative",Q)))),L.ret(L.call(o+"_isNegative",H)))}function m(){let u=t.addFunction(a+"_mul");u.addParam("x","i32"),u.addParam("y","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("y"),y=L.i32_add(L.getLocal("y"),L.i32_const(e)),I=L.i32_add(L.getLocal("y"),L.i32_const(2*e)),N=L.getLocal("r"),nt=L.i32_add(L.getLocal("r"),L.i32_const(e)),J=L.i32_add(L.getLocal("r"),L.i32_const(2*e)),j=L.i32_const(t.alloc(e)),ot=L.i32_const(t.alloc(e)),V=L.i32_const(t.alloc(e)),at=L.i32_const(t.alloc(e)),Lt=L.i32_const(t.alloc(e)),rt=L.i32_const(t.alloc(e)),ht=L.i32_const(t.alloc(e)),A=L.i32_const(t.alloc(e)),i=L.i32_const(t.alloc(e)),C=L.i32_const(t.alloc(e)),r=L.i32_const(t.alloc(e)),z=L.i32_const(t.alloc(e)),E=L.i32_const(t.alloc(e));u.addCode(L.call(o+"_mul",$,q,j),L.call(o+"_mul",Q,y,ot),L.call(o+"_mul",H,I,V),L.call(o+"_add",$,Q,at),L.call(o+"_add",q,y,Lt),L.call(o+"_add",$,H,rt),L.call(o+"_add",q,I,ht),L.call(o+"_add",Q,H,A),L.call(o+"_add",y,I,i),L.call(o+"_add",j,ot,C),L.call(o+"_add",j,V,r),L.call(o+"_add",ot,V,z),L.call(o+"_mul",A,i,N),L.call(o+"_sub",N,z,N),L.call(n,N,N),L.call(o+"_add",j,N,N),L.call(o+"_mul",at,Lt,nt),L.call(o+"_sub",nt,C,nt),L.call(n,V,E),L.call(o+"_add",nt,E,nt),L.call(o+"_mul",rt,ht,J),L.call(o+"_sub",J,r,J),L.call(o+"_add",J,ot,J))}function B(){let u=t.addFunction(a+"_square");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e)),N=L.i32_const(t.alloc(e)),nt=L.i32_const(t.alloc(e)),J=L.i32_const(t.alloc(e)),j=L.i32_const(t.alloc(e)),ot=L.i32_const(t.alloc(e)),V=L.i32_const(t.alloc(e)),at=L.i32_const(t.alloc(e));u.addCode(L.call(o+"_square",$,N),L.call(o+"_mul",$,Q,nt),L.call(o+"_add",nt,nt,J),L.call(o+"_sub",$,Q,j),L.call(o+"_add",j,H,j),L.call(o+"_square",j,j),L.call(o+"_mul",Q,H,ot),L.call(o+"_add",ot,ot,V),L.call(o+"_square",H,at),L.call(n,V,q),L.call(o+"_add",N,q,q),L.call(n,at,y),L.call(o+"_add",J,y,y),L.call(o+"_add",N,at,I),L.call(o+"_sub",V,I,I),L.call(o+"_add",j,I,I),L.call(o+"_add",J,I,I))}function p(){let u=t.addFunction(a+"_toMontgomery");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_toMontgomery",$,q),L.call(o+"_toMontgomery",Q,y),L.call(o+"_toMontgomery",H,I))}function v(){let u=t.addFunction(a+"_fromMontgomery");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_fromMontgomery",$,q),L.call(o+"_fromMontgomery",Q,y),L.call(o+"_fromMontgomery",H,I))}function M(){let u=t.addFunction(a+"_copy");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_copy",$,q),L.call(o+"_copy",Q,y),L.call(o+"_copy",H,I))}function x(){let u=t.addFunction(a+"_zero");u.addParam("x","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e));u.addCode(L.call(o+"_zero",$),L.call(o+"_zero",Q),L.call(o+"_zero",H))}function S(){let u=t.addFunction(a+"_one");u.addParam("x","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e));u.addCode(L.call(o+"_one",$),L.call(o+"_zero",Q),L.call(o+"_zero",H))}function w(){let u=t.addFunction(a+"_eq");u.addParam("x","i32"),u.addParam("y","i32"),u.setReturnType("i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("y"),y=L.i32_add(L.getLocal("y"),L.i32_const(e)),I=L.i32_add(L.getLocal("y"),L.i32_const(2*e));u.addCode(L.i32_and(L.i32_and(L.call(o+"_eq",$,q),L.call(o+"_eq",Q,y)),L.call(o+"_eq",H,I)))}function k(){let u=t.addFunction(a+"_isZero");u.addParam("x","i32"),u.setReturnType("i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e));u.addCode(L.i32_and(L.i32_and(L.call(o+"_isZero",$),L.call(o+"_isZero",Q)),L.call(o+"_isZero",H)))}function O(){let u=t.addFunction(a+"_inverse");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e)),N=L.i32_const(t.alloc(e)),nt=L.i32_const(t.alloc(e)),J=L.i32_const(t.alloc(e)),j=L.i32_const(t.alloc(e)),ot=L.i32_const(t.alloc(e)),V=L.i32_const(t.alloc(e)),at=L.i32_const(t.alloc(e)),Lt=L.i32_const(t.alloc(e)),rt=L.i32_const(t.alloc(e)),ht=L.i32_const(t.alloc(e)),A=L.i32_const(t.alloc(e));u.addCode(L.call(o+"_square",$,N),L.call(o+"_square",Q,nt),L.call(o+"_square",H,J),L.call(o+"_mul",$,Q,j),L.call(o+"_mul",$,H,ot),L.call(o+"_mul",Q,H,V),L.call(n,V,at),L.call(o+"_sub",N,at,at),L.call(n,J,Lt),L.call(o+"_sub",Lt,j,Lt),L.call(o+"_sub",nt,ot,rt),L.call(o+"_mul",H,Lt,ht),L.call(o+"_mul",Q,rt,A),L.call(o+"_add",ht,A,ht),L.call(n,ht,ht),L.call(o+"_mul",$,at,A),L.call(o+"_add",A,ht,ht),L.call(o+"_inverse",ht,ht),L.call(o+"_mul",ht,at,q),L.call(o+"_mul",ht,Lt,y),L.call(o+"_mul",ht,rt,I))}function W(){let u=t.addFunction(a+"_sign");u.addParam("x","i32"),u.addLocal("s","i32"),u.setReturnType("i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e));u.addCode(L.setLocal("s",L.call(o+"_sign",H)),L.if(L.getLocal("s"),L.ret(L.getLocal("s"))),L.setLocal("s",L.call(o+"_sign",Q)),L.if(L.getLocal("s"),L.ret(L.getLocal("s"))),L.ret(L.call(o+"_sign",$)))}function F(){let u=t.addFunction(a+"_isOne");u.addParam("x","i32"),u.setReturnType("i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(e*2));u.addCode(L.ret(L.i32_and(L.i32_and(L.call(o+"_isOne",$),L.call(o+"_isZero",Q)),L.call(o+"_isZero",H))))}return k(),F(),x(),S(),M(),m(),B(),h(),b(),l(),W(),p(),v(),w(),O(),d(),s(),t.exportFunction(a+"_isZero"),t.exportFunction(a+"_isOne"),t.exportFunction(a+"_zero"),t.exportFunction(a+"_one"),t.exportFunction(a+"_copy"),t.exportFunction(a+"_mul"),t.exportFunction(a+"_square"),t.exportFunction(a+"_add"),t.exportFunction(a+"_sub"),t.exportFunction(a+"_neg"),t.exportFunction(a+"_sign"),t.exportFunction(a+"_fromMontgomery"),t.exportFunction(a+"_toMontgomery"),t.exportFunction(a+"_eq"),t.exportFunction(a+"_inverse"),vL(t,a),EL(t,a+"_exp",e*3,a+"_mul",a+"_square",a+"_copy",a+"_one"),t.exportFunction(a+"_exp"),t.exportFunction(a+"_timesScalar"),t.exportFunction(a+"_batchInverse"),t.exportFunction(a+"_isNegative"),a},SL=function(t,n,a,o,e,h,d,b){let l=t.addFunction(n);l.addParam("base","i32"),l.addParam("scalar","i32"),l.addParam("scalarLength","i32"),l.addParam("r","i32"),l.addLocal("old0","i32"),l.addLocal("nbits","i32"),l.addLocal("i","i32"),l.addLocal("last","i32"),l.addLocal("cur","i32"),l.addLocal("carry","i32"),l.addLocal("p","i32");let s=l.getCodeBuilder(),m=s.i32_const(t.alloc(a));function B(v){return s.i32_and(s.i32_shr_u(s.i32_load(s.i32_add(s.getLocal("scalar"),s.i32_and(s.i32_shr_u(v,s.i32_const(3)),s.i32_const(4294967292)))),s.i32_and(v,s.i32_const(31))),s.i32_const(1))}function p(v){return[...s.i32_store8(s.getLocal("p"),s.i32_const(v)),...s.setLocal("p",s.i32_add(s.getLocal("p"),s.i32_const(1)))]}l.addCode(s.if(s.i32_eqz(s.getLocal("scalarLength")),[...s.call(b,s.getLocal("r")),...s.ret([])]),s.setLocal("nbits",s.i32_shl(s.getLocal("scalarLength"),s.i32_const(3))),s.setLocal("old0",s.i32_load(s.i32_const(0))),s.setLocal("p",s.getLocal("old0")),s.i32_store(s.i32_const(0),s.i32_and(s.i32_add(s.i32_add(s.getLocal("old0"),s.i32_const(32)),s.getLocal("nbits")),s.i32_const(4294967288))),s.setLocal("i",s.i32_const(1)),s.setLocal("last",B(s.i32_const(0))),s.setLocal("carry",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("nbits"))),s.setLocal("cur",B(s.getLocal("i"))),s.if(s.getLocal("last"),s.if(s.getLocal("cur"),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...p(1)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...p(255)]),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...p(255)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(0)),...p(1)])),s.if(s.getLocal("cur"),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...p(0)],[...s.setLocal("last",s.i32_const(1)),...s.setLocal("carry",s.i32_const(0)),...p(0)]),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(1)),...s.setLocal("carry",s.i32_const(0)),...p(0)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(0)),...p(0)]))),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0))),s.if(s.getLocal("last"),s.if(s.getLocal("carry"),[...p(255),...p(0),...p(1)],[...p(1)]),s.if(s.getLocal("carry"),[...p(0),...p(1)])),s.setLocal("p",s.i32_sub(s.getLocal("p"),s.i32_const(1))),s.call(d,s.getLocal("base"),m),s.call(b,s.getLocal("r")),s.block(s.loop(s.call(e,s.getLocal("r"),s.getLocal("r")),s.setLocal("cur",s.i32_load8_u(s.getLocal("p"))),s.if(s.getLocal("cur"),s.if(s.i32_eq(s.getLocal("cur"),s.i32_const(1)),s.call(o,s.getLocal("r"),m,s.getLocal("r")),s.call(h,s.getLocal("r"),m,s.getLocal("r")))),s.br_if(1,s.i32_eq(s.getLocal("old0"),s.getLocal("p"))),s.setLocal("p",s.i32_sub(s.getLocal("p"),s.i32_const(1))),s.br(0))),s.i32_store(s.i32_const(0),s.getLocal("old0")))},qL=function(t,n,a,o,e){let d=t.modules[n].n64*8;function b(){let B=t.addFunction(a+"_getChunk");B.addParam("pScalar","i32"),B.addParam("scalarSize","i32"),B.addParam("startBit","i32"),B.addParam("chunkSize","i32"),B.addLocal("bitsToEnd","i32"),B.addLocal("mask","i32"),B.setReturnType("i32");let p=B.getCodeBuilder();B.addCode(p.setLocal("bitsToEnd",p.i32_sub(p.i32_mul(p.getLocal("scalarSize"),p.i32_const(8)),p.getLocal("startBit"))),p.if(p.i32_gt_s(p.getLocal("chunkSize"),p.getLocal("bitsToEnd")),p.setLocal("mask",p.i32_sub(p.i32_shl(p.i32_const(1),p.getLocal("bitsToEnd")),p.i32_const(1))),p.setLocal("mask",p.i32_sub(p.i32_shl(p.i32_const(1),p.getLocal("chunkSize")),p.i32_const(1)))),p.i32_and(p.i32_shr_u(p.i32_load(p.i32_add(p.getLocal("pScalar"),p.i32_shr_u(p.getLocal("startBit"),p.i32_const(3))),0,0),p.i32_and(p.getLocal("startBit"),p.i32_const(7))),p.getLocal("mask")))}function l(){let B=t.addFunction(a+"_chunk");B.addParam("pBases","i32"),B.addParam("pScalars","i32"),B.addParam("scalarSize","i32"),B.addParam("n","i32"),B.addParam("startBit","i32"),B.addParam("chunkSize","i32"),B.addParam("pr","i32"),B.addLocal("nChunks","i32"),B.addLocal("itScalar","i32"),B.addLocal("endScalar","i32"),B.addLocal("itBase","i32"),B.addLocal("i","i32"),B.addLocal("j","i32"),B.addLocal("nTable","i32"),B.addLocal("pTable","i32"),B.addLocal("idx","i32"),B.addLocal("pIdxTable","i32");let p=B.getCodeBuilder();B.addCode(p.if(p.i32_eqz(p.getLocal("n")),[...p.call(n+"_zero",p.getLocal("pr")),...p.ret([])]),p.setLocal("nTable",p.i32_shl(p.i32_const(1),p.getLocal("chunkSize"))),p.setLocal("pTable",p.i32_load(p.i32_const(0))),p.i32_store(p.i32_const(0),p.i32_add(p.getLocal("pTable"),p.i32_mul(p.getLocal("nTable"),p.i32_const(d)))),p.setLocal("j",p.i32_const(0)),p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("j"),p.getLocal("nTable"))),p.call(n+"_zero",p.i32_add(p.getLocal("pTable"),p.i32_mul(p.getLocal("j"),p.i32_const(d)))),p.setLocal("j",p.i32_add(p.getLocal("j"),p.i32_const(1))),p.br(0))),p.setLocal("itBase",p.getLocal("pBases")),p.setLocal("itScalar",p.getLocal("pScalars")),p.setLocal("endScalar",p.i32_add(p.getLocal("pScalars"),p.i32_mul(p.getLocal("n"),p.getLocal("scalarSize")))),p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("itScalar"),p.getLocal("endScalar"))),p.setLocal("idx",p.call(a+"_getChunk",p.getLocal("itScalar"),p.getLocal("scalarSize"),p.getLocal("startBit"),p.getLocal("chunkSize"))),p.if(p.getLocal("idx"),[...p.setLocal("pIdxTable",p.i32_add(p.getLocal("pTable"),p.i32_mul(p.i32_sub(p.getLocal("idx"),p.i32_const(1)),p.i32_const(d)))),...p.call(o,p.getLocal("pIdxTable"),p.getLocal("itBase"),p.getLocal("pIdxTable"))]),p.setLocal("itScalar",p.i32_add(p.getLocal("itScalar"),p.getLocal("scalarSize"))),p.setLocal("itBase",p.i32_add(p.getLocal("itBase"),p.i32_const(e))),p.br(0))),p.call(a+"_reduceTable",p.getLocal("pTable"),p.getLocal("chunkSize")),p.call(n+"_copy",p.getLocal("pTable"),p.getLocal("pr")),p.i32_store(p.i32_const(0),p.getLocal("pTable")))}function s(){let B=t.addFunction(a);B.addParam("pBases","i32"),B.addParam("pScalars","i32"),B.addParam("scalarSize","i32"),B.addParam("n","i32"),B.addParam("pr","i32"),B.addLocal("chunkSize","i32"),B.addLocal("nChunks","i32"),B.addLocal("itScalar","i32"),B.addLocal("endScalar","i32"),B.addLocal("itBase","i32"),B.addLocal("itBit","i32"),B.addLocal("i","i32"),B.addLocal("j","i32"),B.addLocal("nTable","i32"),B.addLocal("pTable","i32"),B.addLocal("idx","i32"),B.addLocal("pIdxTable","i32");let p=B.getCodeBuilder(),v=p.i32_const(t.alloc(d)),M=t.alloc([17,17,17,17,17,17,17,17,17,17,16,16,15,14,13,13,12,11,10,9,8,7,7,6,5,4,3,2,1,1,1,1]);B.addCode(p.call(n+"_zero",p.getLocal("pr")),p.if(p.i32_eqz(p.getLocal("n")),p.ret([])),p.setLocal("chunkSize",p.i32_load8_u(p.i32_clz(p.getLocal("n")),M)),p.setLocal("nChunks",p.i32_add(p.i32_div_u(p.i32_sub(p.i32_shl(p.getLocal("scalarSize"),p.i32_const(3)),p.i32_const(1)),p.getLocal("chunkSize")),p.i32_const(1))),p.setLocal("itBit",p.i32_mul(p.i32_sub(p.getLocal("nChunks"),p.i32_const(1)),p.getLocal("chunkSize"))),p.block(p.loop(p.br_if(1,p.i32_lt_s(p.getLocal("itBit"),p.i32_const(0))),p.if(p.i32_eqz(p.call(n+"_isZero",p.getLocal("pr"))),[...p.setLocal("j",p.i32_const(0)),...p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("j"),p.getLocal("chunkSize"))),p.call(n+"_double",p.getLocal("pr"),p.getLocal("pr")),p.setLocal("j",p.i32_add(p.getLocal("j"),p.i32_const(1))),p.br(0)))]),p.call(a+"_chunk",p.getLocal("pBases"),p.getLocal("pScalars"),p.getLocal("scalarSize"),p.getLocal("n"),p.getLocal("itBit"),p.getLocal("chunkSize"),v),p.call(n+"_add",p.getLocal("pr"),v,p.getLocal("pr")),p.setLocal("itBit",p.i32_sub(p.getLocal("itBit"),p.getLocal("chunkSize"))),p.br(0))))}function m(){let B=t.addFunction(a+"_reduceTable");B.addParam("pTable","i32"),B.addParam("p","i32"),B.addLocal("half","i32"),B.addLocal("it1","i32"),B.addLocal("it2","i32"),B.addLocal("pAcc","i32");let p=B.getCodeBuilder();B.addCode(p.if(p.i32_eq(p.getLocal("p"),p.i32_const(1)),p.ret([])),p.setLocal("half",p.i32_shl(p.i32_const(1),p.i32_sub(p.getLocal("p"),p.i32_const(1)))),p.setLocal("it1",p.getLocal("pTable")),p.setLocal("it2",p.i32_add(p.getLocal("pTable"),p.i32_mul(p.getLocal("half"),p.i32_const(d)))),p.setLocal("pAcc",p.i32_sub(p.getLocal("it2"),p.i32_const(d))),p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("it1"),p.getLocal("pAcc"))),p.call(n+"_add",p.getLocal("it1"),p.getLocal("it2"),p.getLocal("it1")),p.call(n+"_add",p.getLocal("pAcc"),p.getLocal("it2"),p.getLocal("pAcc")),p.setLocal("it1",p.i32_add(p.getLocal("it1"),p.i32_const(d))),p.setLocal("it2",p.i32_add(p.getLocal("it2"),p.i32_const(d))),p.br(0))),p.call(a+"_reduceTable",p.getLocal("pTable"),p.i32_sub(p.getLocal("p"),p.i32_const(1))),p.setLocal("p",p.i32_sub(p.getLocal("p"),p.i32_const(1))),p.block(p.loop(p.br_if(1,p.i32_eqz(p.getLocal("p"))),p.call(n+"_double",p.getLocal("pAcc"),p.getLocal("pAcc")),p.setLocal("p",p.i32_sub(p.getLocal("p"),p.i32_const(1))),p.br(0))),p.call(n+"_add",p.getLocal("pTable"),p.getLocal("pAcc"),p.getLocal("pTable")))}b(),m(),l(),s(),t.exportFunction(a),t.exportFunction(a+"_chunk")},qu=SL,Fi=a_,Iu=qL,u_=function(t,n,a,o){let e=t.modules[a].n64,h=e*8;if(t.modules[n])return n;t.modules[n]={n64:e*3};function d(){let A=t.addFunction(n+"_isZero");A.addParam("p1","i32"),A.setReturnType("i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_isZero",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))))}function b(){let A=t.addFunction(n+"_isZeroAffine");A.addParam("p1","i32"),A.setReturnType("i32");let i=A.getCodeBuilder();A.addCode(i.i32_and(i.call(a+"_isZero",i.getLocal("p1")),i.call(a+"_isZero",i.i32_add(i.getLocal("p1"),i.i32_const(h)))))}function l(){let A=t.addFunction(n+"_copy");A.addParam("ps","i32"),A.addParam("pd","i32");let i=A.getCodeBuilder();for(let C=0;C<e*3;C++)A.addCode(i.i64_store(i.getLocal("pd"),C*8,i.i64_load(i.getLocal("ps"),C*8)))}function s(){let A=t.addFunction(n+"_copyAffine");A.addParam("ps","i32"),A.addParam("pd","i32");let i=A.getCodeBuilder();for(let C=0;C<e*2;C++)A.addCode(i.i64_store(i.getLocal("pd"),C*8,i.i64_load(i.getLocal("ps"),C*8)))}function m(){let A=t.addFunction(n+"_zero");A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_zero",i.getLocal("pr"))),A.addCode(i.call(a+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(h)))),A.addCode(i.call(a+"_zero",i.i32_add(i.getLocal("pr"),i.i32_const(h*2))))}function B(){let A=t.addFunction(n+"_zeroAffine");A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_zero",i.getLocal("pr"))),A.addCode(i.call(a+"_zero",i.i32_add(i.getLocal("pr"),i.i32_const(h))))}function p(){let A=t.addFunction(n+"_eq");A.addParam("p1","i32"),A.addParam("p2","i32"),A.setReturnType("i32"),A.addLocal("z1","i32"),A.addLocal("z2","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h));A.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));let z=i.getLocal("z1"),E=i.getLocal("p2"),g=i.i32_add(i.getLocal("p2"),i.i32_const(h));A.addCode(i.setLocal("z2",i.i32_add(i.getLocal("p2"),i.i32_const(h*2))));let U=i.getLocal("z2"),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),yt=i.i32_const(t.alloc(h)),ut=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),i.ret(i.call(n+"_isZero",i.getLocal("p2")))),i.if(i.call(n+"_isZero",i.getLocal("p2")),i.ret(i.i32_const(0))),i.if(i.call(a+"_isOne",z),i.ret(i.call(n+"_eqMixed",i.getLocal("p2"),i.getLocal("p1")))),i.if(i.call(a+"_isOne",U),i.ret(i.call(n+"_eqMixed",i.getLocal("p1"),i.getLocal("p2")))),i.call(a+"_square",z,st),i.call(a+"_square",U,et),i.call(a+"_mul",C,et,ct),i.call(a+"_mul",E,st,ft),i.call(a+"_mul",z,st,_t),i.call(a+"_mul",U,et,gt),i.call(a+"_mul",r,gt,yt),i.call(a+"_mul",g,_t,ut),i.if(i.call(a+"_eq",ct,ft),i.if(i.call(a+"_eq",yt,ut),i.ret(i.i32_const(1)))),i.ret(i.i32_const(0)))}function v(){let A=t.addFunction(n+"_eqMixed");A.addParam("p1","i32"),A.addParam("p2","i32"),A.setReturnType("i32"),A.addLocal("z1","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h));A.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));let z=i.getLocal("z1"),E=i.getLocal("p2"),g=i.i32_add(i.getLocal("p2"),i.i32_const(h)),U=i.i32_const(t.alloc(h)),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),i.ret(i.call(n+"_isZeroAffine",i.getLocal("p2")))),i.if(i.call(n+"_isZeroAffine",i.getLocal("p2")),i.ret(i.i32_const(0))),i.if(i.call(a+"_isOne",z),i.ret(i.call(n+"_eqAffine",i.getLocal("p1"),i.getLocal("p2")))),i.call(a+"_square",z,U),i.call(a+"_mul",E,U,st),i.call(a+"_mul",z,U,et),i.call(a+"_mul",g,et,ct),i.if(i.call(a+"_eq",C,st),i.if(i.call(a+"_eq",r,ct),i.ret(i.i32_const(1)))),i.ret(i.i32_const(0)))}function M(){let A=t.addFunction(n+"_double");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.i32_add(i.getLocal("p1"),i.i32_const(h*2)),E=i.getLocal("pr"),g=i.i32_add(i.getLocal("pr"),i.i32_const(h)),U=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),yt=i.i32_const(t.alloc(h)),ut=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(n+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(a+"_isOne",z),[...i.ret(i.call(n+"_doubleAffine",i.getLocal("p1"),i.getLocal("pr"))),...i.ret([])]),i.call(a+"_square",C,st),i.call(a+"_square",r,et),i.call(a+"_square",et,ct),i.call(a+"_add",C,et,ft),i.call(a+"_square",ft,ft),i.call(a+"_sub",ft,st,ft),i.call(a+"_sub",ft,ct,ft),i.call(a+"_add",ft,ft,ft),i.call(a+"_add",st,st,_t),i.call(a+"_add",_t,st,_t),i.call(a+"_square",_t,gt),i.call(a+"_mul",r,z,yt),i.call(a+"_add",ft,ft,E),i.call(a+"_sub",gt,E,E),i.call(a+"_add",ct,ct,ut),i.call(a+"_add",ut,ut,ut),i.call(a+"_add",ut,ut,ut),i.call(a+"_sub",ft,E,g),i.call(a+"_mul",g,_t,g),i.call(a+"_sub",g,ut,g),i.call(a+"_add",yt,yt,U))}function x(){let A=t.addFunction(n+"_doubleAffine");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.getLocal("pr"),E=i.i32_add(i.getLocal("pr"),i.i32_const(h)),g=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),U=i.i32_const(t.alloc(h)),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("p1")),[...i.call(n+"_toJacobian",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.call(a+"_square",C,U),i.call(a+"_square",r,st),i.call(a+"_square",st,et),i.call(a+"_add",C,st,ct),i.call(a+"_square",ct,ct),i.call(a+"_sub",ct,U,ct),i.call(a+"_sub",ct,et,ct),i.call(a+"_add",ct,ct,ct),i.call(a+"_add",U,U,ft),i.call(a+"_add",ft,U,ft),i.call(a+"_add",r,r,g),i.call(a+"_square",ft,z),i.call(a+"_sub",z,ct,z),i.call(a+"_sub",z,ct,z),i.call(a+"_add",et,et,_t),i.call(a+"_add",_t,_t,_t),i.call(a+"_add",_t,_t,_t),i.call(a+"_sub",ct,z,E),i.call(a+"_mul",E,ft,E),i.call(a+"_sub",E,_t,E))}function S(){let A=t.addFunction(n+"_eqAffine");A.addParam("p1","i32"),A.addParam("p2","i32"),A.setReturnType("i32"),A.addLocal("z1","i32");let i=A.getCodeBuilder();A.addCode(i.ret(i.i32_and(i.call(a+"_eq",i.getLocal("p1"),i.getLocal("p2")),i.call(a+"_eq",i.i32_add(i.getLocal("p1"),i.i32_const(h)),i.i32_add(i.getLocal("p2"),i.i32_const(h))))))}function w(){let A=t.addFunction(n+"_toMontgomery");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_toMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<3;C++)A.addCode(i.call(a+"_toMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*h)),i.i32_add(i.getLocal("pr"),i.i32_const(C*h))))}function k(){let A=t.addFunction(n+"_toMontgomeryAffine");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_toMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<2;C++)A.addCode(i.call(a+"_toMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*h)),i.i32_add(i.getLocal("pr"),i.i32_const(C*h))))}function O(){let A=t.addFunction(n+"_fromMontgomery");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_fromMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<3;C++)A.addCode(i.call(a+"_fromMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*h)),i.i32_add(i.getLocal("pr"),i.i32_const(C*h))))}function W(){let A=t.addFunction(n+"_fromMontgomeryAffine");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_fromMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<2;C++)A.addCode(i.call(a+"_fromMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*h)),i.i32_add(i.getLocal("pr"),i.i32_const(C*h))))}function F(){let A=t.addFunction(n+"_add");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32"),A.addLocal("z1","i32"),A.addLocal("z2","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h));A.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));let z=i.getLocal("z1"),E=i.getLocal("p2"),g=i.i32_add(i.getLocal("p2"),i.i32_const(h));A.addCode(i.setLocal("z2",i.i32_add(i.getLocal("p2"),i.i32_const(h*2))));let U=i.getLocal("z2"),st=i.getLocal("pr"),et=i.i32_add(i.getLocal("pr"),i.i32_const(h)),ct=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),yt=i.i32_const(t.alloc(h)),ut=i.i32_const(t.alloc(h)),lt=i.i32_const(t.alloc(h)),bt=i.i32_const(t.alloc(h)),Et=i.i32_const(t.alloc(h)),It=i.i32_const(t.alloc(h)),zt=i.i32_const(t.alloc(h)),Mt=i.i32_const(t.alloc(h)),kt=i.i32_const(t.alloc(h)),Pt=i.i32_const(t.alloc(h)),qt=i.i32_const(t.alloc(h)),Rt=i.i32_const(t.alloc(h)),Kt=i.i32_const(t.alloc(h)),Ut=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(n+"_copy",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(n+"_isZero",i.getLocal("p2")),[...i.call(n+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(a+"_isOne",z),[...i.call(n+"_addMixed",E,C,st),...i.ret([])]),i.if(i.call(a+"_isOne",U),[...i.call(n+"_addMixed",C,E,st),...i.ret([])]),i.call(a+"_square",z,ft),i.call(a+"_square",U,_t),i.call(a+"_mul",C,_t,gt),i.call(a+"_mul",E,ft,yt),i.call(a+"_mul",z,ft,ut),i.call(a+"_mul",U,_t,lt),i.call(a+"_mul",r,lt,bt),i.call(a+"_mul",g,ut,Et),i.if(i.call(a+"_eq",gt,yt),i.if(i.call(a+"_eq",bt,Et),[...i.call(n+"_double",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])])),i.call(a+"_sub",yt,gt,It),i.call(a+"_sub",Et,bt,zt),i.call(a+"_add",It,It,Mt),i.call(a+"_square",Mt,Mt),i.call(a+"_mul",It,Mt,kt),i.call(a+"_add",zt,zt,Pt),i.call(a+"_mul",gt,Mt,Rt),i.call(a+"_square",Pt,qt),i.call(a+"_add",Rt,Rt,Kt),i.call(a+"_sub",qt,kt,st),i.call(a+"_sub",st,Kt,st),i.call(a+"_mul",bt,kt,Ut),i.call(a+"_add",Ut,Ut,Ut),i.call(a+"_sub",Rt,st,et),i.call(a+"_mul",et,Pt,et),i.call(a+"_sub",et,Ut,et),i.call(a+"_add",z,U,ct),i.call(a+"_square",ct,ct),i.call(a+"_sub",ct,ft,ct),i.call(a+"_sub",ct,_t,ct),i.call(a+"_mul",ct,It,ct))}function u(){let A=t.addFunction(n+"_addMixed");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32"),A.addLocal("z1","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h));A.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));let z=i.getLocal("z1"),E=i.getLocal("p2"),g=i.i32_add(i.getLocal("p2"),i.i32_const(h)),U=i.getLocal("pr"),st=i.i32_add(i.getLocal("pr"),i.i32_const(h)),et=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),ct=i.i32_const(t.alloc(h)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),yt=i.i32_const(t.alloc(h)),ut=i.i32_const(t.alloc(h)),lt=i.i32_const(t.alloc(h)),bt=i.i32_const(t.alloc(h)),Et=i.i32_const(t.alloc(h)),It=i.i32_const(t.alloc(h)),zt=i.i32_const(t.alloc(h)),Mt=i.i32_const(t.alloc(h)),kt=i.i32_const(t.alloc(h)),Pt=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(n+"_copyAffine",i.getLocal("p2"),i.getLocal("pr")),...i.call(a+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(h*2))),...i.ret([])]),i.if(i.call(n+"_isZeroAffine",i.getLocal("p2")),[...i.call(n+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(a+"_isOne",z),[...i.call(n+"_addAffine",C,E,U),...i.ret([])]),i.call(a+"_square",z,ct),i.call(a+"_mul",E,ct,ft),i.call(a+"_mul",z,ct,_t),i.call(a+"_mul",g,_t,gt),i.if(i.call(a+"_eq",C,ft),i.if(i.call(a+"_eq",r,gt),[...i.call(n+"_doubleAffine",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])])),i.call(a+"_sub",ft,C,yt),i.call(a+"_sub",gt,r,lt),i.call(a+"_square",yt,ut),i.call(a+"_add",ut,ut,bt),i.call(a+"_add",bt,bt,bt),i.call(a+"_mul",yt,bt,Et),i.call(a+"_add",lt,lt,It),i.call(a+"_mul",C,bt,Mt),i.call(a+"_square",It,zt),i.call(a+"_add",Mt,Mt,kt),i.call(a+"_sub",zt,Et,U),i.call(a+"_sub",U,kt,U),i.call(a+"_mul",r,Et,Pt),i.call(a+"_add",Pt,Pt,Pt),i.call(a+"_sub",Mt,U,st),i.call(a+"_mul",st,It,st),i.call(a+"_sub",st,Pt,st),i.call(a+"_add",z,yt,et),i.call(a+"_square",et,et),i.call(a+"_sub",et,ct,et),i.call(a+"_sub",et,ut,et))}function L(){let A=t.addFunction(n+"_addAffine");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32"),A.addLocal("z1","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h));A.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));let z=i.getLocal("p2"),E=i.i32_add(i.getLocal("p2"),i.i32_const(h)),g=i.getLocal("pr"),U=i.i32_add(i.getLocal("pr"),i.i32_const(h)),st=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),yt=i.i32_const(t.alloc(h)),ut=i.i32_const(t.alloc(h)),lt=i.i32_const(t.alloc(h)),bt=i.i32_const(t.alloc(h)),Et=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("p1")),[...i.call(n+"_copyAffine",i.getLocal("p2"),i.getLocal("pr")),...i.call(a+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(h*2))),...i.ret([])]),i.if(i.call(n+"_isZeroAffine",i.getLocal("p2")),[...i.call(n+"_copyAffine",i.getLocal("p1"),i.getLocal("pr")),...i.call(a+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(h*2))),...i.ret([])]),i.if(i.call(a+"_eq",C,z),i.if(i.call(a+"_eq",r,E),[...i.call(n+"_doubleAffine",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])])),i.call(a+"_sub",z,C,et),i.call(a+"_sub",E,r,ft),i.call(a+"_square",et,ct),i.call(a+"_add",ct,ct,_t),i.call(a+"_add",_t,_t,_t),i.call(a+"_mul",et,_t,gt),i.call(a+"_add",ft,ft,yt),i.call(a+"_mul",C,_t,lt),i.call(a+"_square",yt,ut),i.call(a+"_add",lt,lt,bt),i.call(a+"_sub",ut,gt,g),i.call(a+"_sub",g,bt,g),i.call(a+"_mul",r,gt,Et),i.call(a+"_add",Et,Et,Et),i.call(a+"_sub",lt,g,U),i.call(a+"_mul",U,yt,U),i.call(a+"_sub",U,Et,U),i.call(a+"_add",et,et,st))}function $(){let A=t.addFunction(n+"_neg");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.i32_add(i.getLocal("p1"),i.i32_const(h*2)),E=i.getLocal("pr"),g=i.i32_add(i.getLocal("pr"),i.i32_const(h)),U=i.i32_add(i.getLocal("pr"),i.i32_const(h*2));A.addCode(i.call(a+"_copy",C,E),i.call(a+"_neg",r,g),i.call(a+"_copy",z,U))}function Q(){let A=t.addFunction(n+"_negAffine");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.getLocal("pr"),E=i.i32_add(i.getLocal("pr"),i.i32_const(h));A.addCode(i.call(a+"_copy",C,z),i.call(a+"_neg",r,E))}function H(){let A=t.addFunction(n+"_sub");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h*3));A.addCode(i.call(n+"_neg",i.getLocal("p2"),C),i.call(n+"_add",i.getLocal("p1"),C,i.getLocal("pr")))}function q(){let A=t.addFunction(n+"_subMixed");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h*3));A.addCode(i.call(n+"_negAffine",i.getLocal("p2"),C),i.call(n+"_addMixed",i.getLocal("p1"),C,i.getLocal("pr")))}function y(){let A=t.addFunction(n+"_subAffine");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h*3));A.addCode(i.call(n+"_negAffine",i.getLocal("p2"),C),i.call(n+"_addAffine",i.getLocal("p1"),C,i.getLocal("pr")))}function I(){let A=t.addFunction(n+"_normalize");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.i32_add(i.getLocal("p1"),i.i32_const(h*2)),E=i.getLocal("pr"),g=i.i32_add(i.getLocal("pr"),i.i32_const(h)),U=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),i.call(n+"_zero",i.getLocal("pr")),[...i.call(a+"_inverse",z,st),...i.call(a+"_square",st,et),...i.call(a+"_mul",st,et,ct),...i.call(a+"_mul",C,et,E),...i.call(a+"_mul",r,ct,g),...i.call(a+"_one",U)]))}function N(){let A=t.addFunction(n+"_toAffine");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.i32_add(i.getLocal("p1"),i.i32_const(h*2)),E=i.getLocal("pr"),g=i.i32_add(i.getLocal("pr"),i.i32_const(h)),U=i.i32_const(t.alloc(h)),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(a+"_zero",E),...i.call(a+"_zero",g)],[...i.call(a+"_inverse",z,U),...i.call(a+"_square",U,st),...i.call(a+"_mul",U,st,et),...i.call(a+"_mul",C,st,E),...i.call(a+"_mul",r,et,g)]))}function nt(){let A=t.addFunction(n+"_toJacobian");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.getLocal("pr"),E=i.i32_add(i.getLocal("pr"),i.i32_const(h)),g=i.i32_add(i.getLocal("pr"),i.i32_const(h*2));A.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("p1")),i.call(n+"_zero",i.getLocal("pr")),[...i.call(a+"_one",g),...i.call(a+"_copy",r,E),...i.call(a+"_copy",C,z)]))}function J(){let A=t.addFunction(n+"_batchToAffine");A.addParam("pIn","i32"),A.addParam("n","i32"),A.addParam("pOut","i32"),A.addLocal("pAux","i32"),A.addLocal("itIn","i32"),A.addLocal("itAux","i32"),A.addLocal("itOut","i32"),A.addLocal("i","i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h));A.addCode(i.setLocal("pAux",i.i32_load(i.i32_const(0))),i.i32_store(i.i32_const(0),i.i32_add(i.getLocal("pAux"),i.i32_mul(i.getLocal("n"),i.i32_const(h)))),i.call(a+"_batchInverse",i.i32_add(i.getLocal("pIn"),i.i32_const(h*2)),i.i32_const(h*3),i.getLocal("n"),i.getLocal("pAux"),i.i32_const(h)),i.setLocal("itIn",i.getLocal("pIn")),i.setLocal("itAux",i.getLocal("pAux")),i.setLocal("itOut",i.getLocal("pOut")),i.setLocal("i",i.i32_const(0)),i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("i"),i.getLocal("n"))),i.if(i.call(a+"_isZero",i.getLocal("itAux")),[...i.call(a+"_zero",i.getLocal("itOut")),...i.call(a+"_zero",i.i32_add(i.getLocal("itOut"),i.i32_const(h)))],[...i.call(a+"_mul",i.getLocal("itAux"),i.i32_add(i.getLocal("itIn"),i.i32_const(h)),C),...i.call(a+"_square",i.getLocal("itAux"),i.getLocal("itAux")),...i.call(a+"_mul",i.getLocal("itAux"),i.getLocal("itIn"),i.getLocal("itOut")),...i.call(a+"_mul",i.getLocal("itAux"),C,i.i32_add(i.getLocal("itOut"),i.i32_const(h)))]),i.setLocal("itIn",i.i32_add(i.getLocal("itIn"),i.i32_const(h*3))),i.setLocal("itOut",i.i32_add(i.getLocal("itOut"),i.i32_const(h*2))),i.setLocal("itAux",i.i32_add(i.getLocal("itAux"),i.i32_const(h))),i.setLocal("i",i.i32_add(i.getLocal("i"),i.i32_const(1))),i.br(0))),i.i32_store(i.i32_const(0),i.getLocal("pAux")))}function j(){let A=t.addFunction(n+"__reverseBytes");A.addParam("pIn","i32"),A.addParam("n","i32"),A.addParam("pOut","i32"),A.addLocal("itOut","i32"),A.addLocal("itIn","i32");let i=A.getCodeBuilder();A.addCode(i.setLocal("itOut",i.i32_sub(i.i32_add(i.getLocal("pOut"),i.getLocal("n")),i.i32_const(1))),i.setLocal("itIn",i.getLocal("pIn")),i.block(i.loop(i.br_if(1,i.i32_lt_s(i.getLocal("itOut"),i.getLocal("pOut"))),i.i32_store8(i.getLocal("itOut"),i.i32_load8_u(i.getLocal("itIn"))),i.setLocal("itOut",i.i32_sub(i.getLocal("itOut"),i.i32_const(1))),i.setLocal("itIn",i.i32_add(i.getLocal("itIn"),i.i32_const(1))),i.br(0))))}function ot(){let A=t.addFunction(n+"_LEMtoC");A.addParam("pIn","i32"),A.addParam("pOut","i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("pIn")),[...i.call(a+"_zero",i.getLocal("pOut")),...i.i32_store8(i.getLocal("pOut"),i.i32_const(64)),...i.ret([])]),i.call(a+"_fromMontgomery",i.getLocal("pIn"),C),i.call(n+"__reverseBytes",C,i.i32_const(h),i.getLocal("pOut")),i.if(i.i32_eq(i.call(a+"_sign",i.i32_add(i.getLocal("pIn"),i.i32_const(h))),i.i32_const(-1)),i.i32_store8(i.getLocal("pOut"),i.i32_or(i.i32_load8_u(i.getLocal("pOut")),i.i32_const(128)))))}function V(){let A=t.addFunction(n+"_LEMtoU");A.addParam("pIn","i32"),A.addParam("pOut","i32");let i=A.getCodeBuilder(),C=t.alloc(h*2),r=i.i32_const(C),z=i.i32_const(C),E=i.i32_const(C+h);A.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("pIn")),[...i.call(n+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.call(n+"_fromMontgomeryAffine",i.getLocal("pIn"),r),i.call(n+"__reverseBytes",z,i.i32_const(h),i.getLocal("pOut")),i.call(n+"__reverseBytes",E,i.i32_const(h),i.i32_add(i.getLocal("pOut"),i.i32_const(h))))}function at(){let A=t.addFunction(n+"_UtoLEM");A.addParam("pIn","i32"),A.addParam("pOut","i32");let i=A.getCodeBuilder(),C=t.alloc(h*2),r=i.i32_const(C),z=i.i32_const(C),E=i.i32_const(C+h);A.addCode(i.if(i.i32_and(i.i32_load8_u(i.getLocal("pIn")),i.i32_const(64)),[...i.call(n+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.call(n+"__reverseBytes",i.getLocal("pIn"),i.i32_const(h),z),i.call(n+"__reverseBytes",i.i32_add(i.getLocal("pIn"),i.i32_const(h)),i.i32_const(h),E),i.call(n+"_toMontgomeryAffine",r,i.getLocal("pOut")))}function Lt(){let A=t.addFunction(n+"_CtoLEM");A.addParam("pIn","i32"),A.addParam("pOut","i32"),A.addLocal("firstByte","i32"),A.addLocal("greatest","i32");let i=A.getCodeBuilder(),C=t.alloc(h*2),r=i.i32_const(C),z=i.i32_const(C+h);A.addCode(i.setLocal("firstByte",i.i32_load8_u(i.getLocal("pIn"))),i.if(i.i32_and(i.getLocal("firstByte"),i.i32_const(64)),[...i.call(n+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.setLocal("greatest",i.i32_and(i.getLocal("firstByte"),i.i32_const(128))),i.call(a+"_copy",i.getLocal("pIn"),z),i.i32_store8(z,i.i32_and(i.getLocal("firstByte"),i.i32_const(63))),i.call(n+"__reverseBytes",z,i.i32_const(h),r),i.call(a+"_toMontgomery",r,i.getLocal("pOut")),i.call(a+"_square",i.getLocal("pOut"),z),i.call(a+"_mul",i.getLocal("pOut"),z,z),i.call(a+"_add",z,i.i32_const(o),z),i.call(a+"_sqrt",z,z),i.call(a+"_neg",z,r),i.if(i.i32_eq(i.call(a+"_sign",z),i.i32_const(-1)),i.if(i.getLocal("greatest"),i.call(a+"_copy",z,i.i32_add(i.getLocal("pOut"),i.i32_const(h))),i.call(a+"_neg",z,i.i32_add(i.getLocal("pOut"),i.i32_const(h)))),i.if(i.getLocal("greatest"),i.call(a+"_neg",z,i.i32_add(i.getLocal("pOut"),i.i32_const(h))),i.call(a+"_copy",z,i.i32_add(i.getLocal("pOut"),i.i32_const(h))))))}function rt(){let A=t.addFunction(n+"_inCurveAffine");A.addParam("pIn","i32"),A.setReturnType("i32");let i=A.getCodeBuilder(),C=i.getLocal("pIn"),r=i.i32_add(i.getLocal("pIn"),i.i32_const(h)),z=i.i32_const(t.alloc(h)),E=i.i32_const(t.alloc(h));A.addCode(i.call(a+"_square",r,z),i.call(a+"_square",C,E),i.call(a+"_mul",C,E,E),i.call(a+"_add",E,i.i32_const(o),E),i.ret(i.call(a+"_eq",z,E)))}function ht(){let A=t.addFunction(n+"_inCurve");A.addParam("pIn","i32"),A.setReturnType("i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h*2));A.addCode(i.call(n+"_toAffine",i.getLocal("pIn"),C),i.ret(i.call(n+"_inCurveAffine",C)))}return b(),d(),B(),m(),s(),l(),nt(),S(),v(),p(),x(),M(),L(),u(),F(),Q(),$(),y(),q(),H(),W(),O(),k(),w(),N(),rt(),ht(),J(),I(),j(),V(),ot(),at(),Lt(),Fi(t,n+"_batchLEMtoU",n+"_LEMtoU",h*2,h*2),Fi(t,n+"_batchLEMtoC",n+"_LEMtoC",h*2,h),Fi(t,n+"_batchUtoLEM",n+"_UtoLEM",h*2,h*2),Fi(t,n+"_batchCtoLEM",n+"_CtoLEM",h,h*2,!0),Fi(t,n+"_batchToJacobian",n+"_toJacobian",h*2,h*3,!0),Iu(t,n,n+"_multiexp",n+"_add",h*3),Iu(t,n,n+"_multiexpAffine",n+"_addMixed",h*2),qu(t,n+"_timesScalar",h*3,n+"_add",n+"_double",n+"_sub",n+"_copy",n+"_zero"),qu(t,n+"_timesScalarAffine",h*2,n+"_addMixed",n+"_double",n+"_subMixed",n+"_copyAffine",n+"_zero"),t.exportFunction(n+"_isZero"),t.exportFunction(n+"_isZeroAffine"),t.exportFunction(n+"_eq"),t.exportFunction(n+"_eqMixed"),t.exportFunction(n+"_eqAffine"),t.exportFunction(n+"_copy"),t.exportFunction(n+"_copyAffine"),t.exportFunction(n+"_zero"),t.exportFunction(n+"_zeroAffine"),t.exportFunction(n+"_double"),t.exportFunction(n+"_doubleAffine"),t.exportFunction(n+"_add"),t.exportFunction(n+"_addMixed"),t.exportFunction(n+"_addAffine"),t.exportFunction(n+"_neg"),t.exportFunction(n+"_negAffine"),t.exportFunction(n+"_sub"),t.exportFunction(n+"_subMixed"),t.exportFunction(n+"_subAffine"),t.exportFunction(n+"_fromMontgomery"),t.exportFunction(n+"_fromMontgomeryAffine"),t.exportFunction(n+"_toMontgomery"),t.exportFunction(n+"_toMontgomeryAffine"),t.exportFunction(n+"_timesScalar"),t.exportFunction(n+"_timesScalarAffine"),t.exportFunction(n+"_normalize"),t.exportFunction(n+"_LEMtoU"),t.exportFunction(n+"_LEMtoC"),t.exportFunction(n+"_UtoLEM"),t.exportFunction(n+"_CtoLEM"),t.exportFunction(n+"_batchLEMtoU"),t.exportFunction(n+"_batchLEMtoC"),t.exportFunction(n+"_batchUtoLEM"),t.exportFunction(n+"_batchCtoLEM"),t.exportFunction(n+"_toAffine"),t.exportFunction(n+"_toJacobian"),t.exportFunction(n+"_batchToAffine"),t.exportFunction(n+"_batchToJacobian"),t.exportFunction(n+"_inCurve"),t.exportFunction(n+"_inCurveAffine"),n},{isOdd:IL,modInv:Ou,modPow:Ci}=Wn,Je=ja,__=function(t,n,a,o,e){let d=t.modules[o].n64*8,l=t.modules[a].n64*8,s=t.modules[o].q,m=s-1n,B=0;for(;!IL(m);)B++,m=m>>1n;let p=2n;for(;Ci(p,s>>1n,s)===1n;)p=p+1n;let v=new Array(B+1);v[B]=Ci(p,m,s);let M=B-1;for(;M>=0;)v[M]=Ci(v[M+1],2n,s),M--;let x=[],S=(1n<<BigInt(d*8))%s;for(let C=0;C<v.length;C++){let r=v[C]*S%s;x.push(...Je.bigInt2BytesLE(r,d))}let w=t.alloc(x),k=new Array(B+1);k[0]=1n;for(let C=1;C<=B;C++)k[C]=k[C-1]*2n;let O=[];for(let C=0;C<=B;C++){let r=Ou(k[C],s)*S%s;O.push(...Je.bigInt2BytesLE(r,d))}let W=t.alloc(O),F=Ci(p,2n,s),u=[],L=[];for(let C=0;C<=B;C++){let r=Ci(F,2n**BigInt(C),s),z=Ou(s+1n-r,s);u.push(...Je.bigInt2BytesLE(r*S%s,d)),L.push(...Je.bigInt2BytesLE(z*S%s,d))}let $=t.alloc(u),Q=t.alloc(L);function H(C){let r=0;for(let z=0;z<8;z++)C&1<<z&&(r=r|128>>z);return r}let q=Array(256);for(let C=0;C<256;C++)q[C]=H(C);let y=t.alloc(q);function I(){let C=t.addFunction(n+"__log2");C.addParam("n","i32"),C.setReturnType("i32"),C.addLocal("bits","i32"),C.addLocal("aux","i32");let r=C.getCodeBuilder();C.addCode(r.setLocal("aux",r.i32_shr_u(r.getLocal("n"),r.i32_const(1)))),C.addCode(r.setLocal("bits",r.i32_const(0))),C.addCode(r.block(r.loop(r.br_if(1,r.i32_eqz(r.getLocal("aux"))),r.setLocal("aux",r.i32_shr_u(r.getLocal("aux"),r.i32_const(1))),r.setLocal("bits",r.i32_add(r.getLocal("bits"),r.i32_const(1))),r.br(0)))),C.addCode(r.if(r.i32_ne(r.getLocal("n"),r.i32_shl(r.i32_const(1),r.getLocal("bits"))),r.unreachable())),C.addCode(r.if(r.i32_gt_u(r.getLocal("bits"),r.i32_const(B)),r.unreachable())),C.addCode(r.getLocal("bits"))}function N(){let C=t.addFunction(n+"_fft");C.addParam("px","i32"),C.addParam("n","i32"),C.addLocal("bits","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d));C.addCode(r.setLocal("bits",r.call(n+"__log2",r.getLocal("n"))),r.call(o+"_one",z),r.call(n+"_rawfft",r.getLocal("px"),r.getLocal("bits"),r.i32_const(0),z))}function nt(){let C=t.addFunction(n+"_ifft");C.addParam("px","i32"),C.addParam("n","i32"),C.addLocal("bits","i32"),C.addLocal("pInv2","i32");let r=C.getCodeBuilder();C.addCode(r.setLocal("bits",r.call(n+"__log2",r.getLocal("n"))),r.setLocal("pInv2",r.i32_add(r.i32_const(W),r.i32_mul(r.getLocal("bits"),r.i32_const(d)))),r.call(n+"_rawfft",r.getLocal("px"),r.getLocal("bits"),r.i32_const(1),r.getLocal("pInv2")))}function J(){let C=t.addFunction(n+"_rawfft");C.addParam("px","i32"),C.addParam("bits","i32"),C.addParam("reverse","i32"),C.addParam("mulFactor","i32"),C.addLocal("s","i32"),C.addLocal("k","i32"),C.addLocal("j","i32"),C.addLocal("m","i32"),C.addLocal("mdiv2","i32"),C.addLocal("n","i32"),C.addLocal("pwm","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l)),g=r.i32_const(t.alloc(l));C.addCode(r.call(n+"__reversePermutation",r.getLocal("px"),r.getLocal("bits")),r.setLocal("n",r.i32_shl(r.i32_const(1),r.getLocal("bits"))),r.setLocal("s",r.i32_const(1)),r.block(r.loop(r.br_if(1,r.i32_gt_u(r.getLocal("s"),r.getLocal("bits"))),r.setLocal("m",r.i32_shl(r.i32_const(1),r.getLocal("s"))),r.setLocal("pwm",r.i32_add(r.i32_const(w),r.i32_mul(r.getLocal("s"),r.i32_const(d)))),r.setLocal("k",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_ge_u(r.getLocal("k"),r.getLocal("n"))),r.call(o+"_one",z),r.setLocal("mdiv2",r.i32_shr_u(r.getLocal("m"),r.i32_const(1))),r.setLocal("j",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_ge_u(r.getLocal("j"),r.getLocal("mdiv2"))),r.setLocal("idx1",r.i32_add(r.getLocal("px"),r.i32_mul(r.i32_add(r.getLocal("k"),r.getLocal("j")),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("idx1"),r.i32_mul(r.getLocal("mdiv2"),r.i32_const(l)))),r.call(e,r.getLocal("idx2"),z,E),r.call(a+"_copy",r.getLocal("idx1"),g),r.call(a+"_add",g,E,r.getLocal("idx1")),r.call(a+"_sub",g,E,r.getLocal("idx2")),r.call(o+"_mul",z,r.getLocal("pwm"),z),r.setLocal("j",r.i32_add(r.getLocal("j"),r.i32_const(1))),r.br(0))),r.setLocal("k",r.i32_add(r.getLocal("k"),r.getLocal("m"))),r.br(0))),r.setLocal("s",r.i32_add(r.getLocal("s"),r.i32_const(1))),r.br(0))),r.call(n+"__fftFinal",r.getLocal("px"),r.getLocal("bits"),r.getLocal("reverse"),r.getLocal("mulFactor")))}function j(){let C=t.addFunction(n+"__fftFinal");C.addParam("px","i32"),C.addParam("bits","i32"),C.addParam("reverse","i32"),C.addParam("mulFactor","i32"),C.addLocal("n","i32"),C.addLocal("ndiv2","i32"),C.addLocal("pInv2","i32"),C.addLocal("i","i32"),C.addLocal("mask","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(l));C.addCode(r.if(r.i32_and(r.i32_eqz(r.getLocal("reverse")),r.call(o+"_isOne",r.getLocal("mulFactor"))),r.ret([])),r.setLocal("n",r.i32_shl(r.i32_const(1),r.getLocal("bits"))),r.setLocal("mask",r.i32_sub(r.getLocal("n"),r.i32_const(1))),r.setLocal("i",r.i32_const(1)),r.setLocal("ndiv2",r.i32_shr_u(r.getLocal("n"),r.i32_const(1))),r.block(r.loop(r.br_if(1,r.i32_ge_u(r.getLocal("i"),r.getLocal("ndiv2"))),r.setLocal("idx1",r.i32_add(r.getLocal("px"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("px"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.getLocal("i")),r.i32_const(l)))),r.if(r.getLocal("reverse"),r.if(r.call(o+"_isOne",r.getLocal("mulFactor")),[...r.call(a+"_copy",r.getLocal("idx1"),z),...r.call(a+"_copy",r.getLocal("idx2"),r.getLocal("idx1")),...r.call(a+"_copy",z,r.getLocal("idx2"))],[...r.call(a+"_copy",r.getLocal("idx1"),z),...r.call(e,r.getLocal("idx2"),r.getLocal("mulFactor"),r.getLocal("idx1")),...r.call(e,z,r.getLocal("mulFactor"),r.getLocal("idx2"))]),r.if(r.call(o+"_isOne",r.getLocal("mulFactor")),[],[...r.call(e,r.getLocal("idx1"),r.getLocal("mulFactor"),r.getLocal("idx1")),...r.call(e,r.getLocal("idx2"),r.getLocal("mulFactor"),r.getLocal("idx2"))])),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))),r.if(r.call(o+"_isOne",r.getLocal("mulFactor")),[],[...r.call(e,r.getLocal("px"),r.getLocal("mulFactor"),r.getLocal("px")),...r.setLocal("idx2",r.i32_add(r.getLocal("px"),r.i32_mul(r.getLocal("ndiv2"),r.i32_const(l)))),...r.call(e,r.getLocal("idx2"),r.getLocal("mulFactor"),r.getLocal("idx2"))]))}function ot(){let C=t.addFunction(n+"__reversePermutation");C.addParam("px","i32"),C.addParam("bits","i32"),C.addLocal("n","i32"),C.addLocal("i","i32"),C.addLocal("ri","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(l));C.addCode(r.setLocal("n",r.i32_shl(r.i32_const(1),r.getLocal("bits"))),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.setLocal("idx1",r.i32_add(r.getLocal("px"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("ri",r.call(n+"__rev",r.getLocal("i"),r.getLocal("bits"))),r.setLocal("idx2",r.i32_add(r.getLocal("px"),r.i32_mul(r.getLocal("ri"),r.i32_const(l)))),r.if(r.i32_lt_u(r.getLocal("i"),r.getLocal("ri")),[...r.call(a+"_copy",r.getLocal("idx1"),z),...r.call(a+"_copy",r.getLocal("idx2"),r.getLocal("idx1")),...r.call(a+"_copy",z,r.getLocal("idx2"))]),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function V(){let C=t.addFunction(n+"__rev");C.addParam("x","i32"),C.addParam("bits","i32"),C.setReturnType("i32");let r=C.getCodeBuilder();C.addCode(r.i32_rotl(r.i32_add(r.i32_add(r.i32_shl(r.i32_load8_u(r.i32_and(r.getLocal("x"),r.i32_const(255)),y,0),r.i32_const(24)),r.i32_shl(r.i32_load8_u(r.i32_and(r.i32_shr_u(r.getLocal("x"),r.i32_const(8)),r.i32_const(255)),y,0),r.i32_const(16))),r.i32_add(r.i32_shl(r.i32_load8_u(r.i32_and(r.i32_shr_u(r.getLocal("x"),r.i32_const(16)),r.i32_const(255)),y,0),r.i32_const(8)),r.i32_load8_u(r.i32_and(r.i32_shr_u(r.getLocal("x"),r.i32_const(24)),r.i32_const(255)),y,0))),r.getLocal("bits")))}function at(){let C=t.addFunction(n+"_fftJoin");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l)),g=r.i32_const(t.alloc(l));C.addCode(r.call(o+"_copy",r.getLocal("first"),z),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff1"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("pBuff2"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.call(e,r.getLocal("idx2"),z,E),r.call(a+"_copy",r.getLocal("idx1"),g),r.call(a+"_add",g,E,r.getLocal("idx1")),r.call(a+"_sub",g,E,r.getLocal("idx2")),r.call(o+"_mul",z,r.getLocal("inc"),z),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function Lt(){let C=t.addFunction(n+"_fftJoinExt");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addParam("totalBits","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("pShiftToM","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l));C.addCode(r.setLocal("pShiftToM",r.i32_add(r.i32_const($),r.i32_mul(r.getLocal("totalBits"),r.i32_const(d)))),r.call(o+"_copy",r.getLocal("first"),z),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff1"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("pBuff2"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.call(a+"_add",r.getLocal("idx1"),r.getLocal("idx2"),E),r.call(e,r.getLocal("idx2"),r.getLocal("pShiftToM"),r.getLocal("idx2")),r.call(a+"_add",r.getLocal("idx1"),r.getLocal("idx2"),r.getLocal("idx2")),r.call(e,r.getLocal("idx2"),z,r.getLocal("idx2")),r.call(a+"_copy",E,r.getLocal("idx1")),r.call(o+"_mul",z,r.getLocal("inc"),z),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function rt(){let C=t.addFunction(n+"_fftJoinExtInv");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addParam("totalBits","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("pShiftToM","i32"),C.addLocal("pSConst","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l));C.addCode(r.setLocal("pShiftToM",r.i32_add(r.i32_const($),r.i32_mul(r.getLocal("totalBits"),r.i32_const(d)))),r.setLocal("pSConst",r.i32_add(r.i32_const(Q),r.i32_mul(r.getLocal("totalBits"),r.i32_const(d)))),r.call(o+"_copy",r.getLocal("first"),z),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff1"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("pBuff2"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.call(e,r.getLocal("idx2"),z,E),r.call(a+"_sub",r.getLocal("idx1"),E,r.getLocal("idx2")),r.call(e,r.getLocal("idx2"),r.getLocal("pSConst"),r.getLocal("idx2")),r.call(e,r.getLocal("idx1"),r.getLocal("pShiftToM"),r.getLocal("idx1")),r.call(a+"_sub",E,r.getLocal("idx1"),r.getLocal("idx1")),r.call(e,r.getLocal("idx1"),r.getLocal("pSConst"),r.getLocal("idx1")),r.call(o+"_mul",z,r.getLocal("inc"),z),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function ht(){let C=t.addFunction(n+"_prepareLagrangeEvaluation");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addParam("totalBits","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("pShiftToM","i32"),C.addLocal("pSConst","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l));C.addCode(r.setLocal("pShiftToM",r.i32_add(r.i32_const($),r.i32_mul(r.getLocal("totalBits"),r.i32_const(d)))),r.setLocal("pSConst",r.i32_add(r.i32_const(Q),r.i32_mul(r.getLocal("totalBits"),r.i32_const(d)))),r.call(o+"_copy",r.getLocal("first"),z),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff1"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("pBuff2"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.call(e,r.getLocal("idx1"),r.getLocal("pShiftToM"),E),r.call(a+"_sub",r.getLocal("idx2"),E,E),r.call(a+"_sub",r.getLocal("idx1"),r.getLocal("idx2"),r.getLocal("idx2")),r.call(e,E,r.getLocal("pSConst"),r.getLocal("idx1")),r.call(e,r.getLocal("idx2"),z,r.getLocal("idx2")),r.call(o+"_mul",z,r.getLocal("inc"),z),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function A(){let C=t.addFunction(n+"_fftMix");C.addParam("pBuff","i32"),C.addParam("n","i32"),C.addParam("exp","i32"),C.addLocal("nGroups","i32"),C.addLocal("nPerGroup","i32"),C.addLocal("nPerGroupDiv2","i32"),C.addLocal("pairOffset","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("j","i32"),C.addLocal("pwm","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l)),g=r.i32_const(t.alloc(l));C.addCode(r.setLocal("nPerGroup",r.i32_shl(r.i32_const(1),r.getLocal("exp"))),r.setLocal("nPerGroupDiv2",r.i32_shr_u(r.getLocal("nPerGroup"),r.i32_const(1))),r.setLocal("nGroups",r.i32_shr_u(r.getLocal("n"),r.getLocal("exp"))),r.setLocal("pairOffset",r.i32_mul(r.getLocal("nPerGroupDiv2"),r.i32_const(l))),r.setLocal("pwm",r.i32_add(r.i32_const(w),r.i32_mul(r.getLocal("exp"),r.i32_const(d)))),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("nGroups"))),r.call(o+"_one",z),r.setLocal("j",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("j"),r.getLocal("nPerGroupDiv2"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff"),r.i32_mul(r.i32_add(r.i32_mul(r.getLocal("i"),r.getLocal("nPerGroup")),r.getLocal("j")),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("idx1"),r.getLocal("pairOffset"))),r.call(e,r.getLocal("idx2"),z,E),r.call(a+"_copy",r.getLocal("idx1"),g),r.call(a+"_add",g,E,r.getLocal("idx1")),r.call(a+"_sub",g,E,r.getLocal("idx2")),r.call(o+"_mul",z,r.getLocal("pwm"),z),r.setLocal("j",r.i32_add(r.getLocal("j"),r.i32_const(1))),r.br(0))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function i(){let C=t.addFunction(n+"_fftFinal");C.addParam("pBuff","i32"),C.addParam("n","i32"),C.addParam("factor","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("ndiv2","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(l));C.addCode(r.setLocal("ndiv2",r.i32_shr_u(r.getLocal("n"),r.i32_const(1))),r.if(r.i32_and(r.getLocal("n"),r.i32_const(1)),r.call(e,r.i32_add(r.getLocal("pBuff"),r.i32_mul(r.getLocal("ndiv2"),r.i32_const(l))),r.getLocal("factor"),r.i32_add(r.getLocal("pBuff"),r.i32_mul(r.getLocal("ndiv2"),r.i32_const(l))))),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_ge_u(r.getLocal("i"),r.getLocal("ndiv2"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("pBuff"),r.i32_mul(r.i32_sub(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.getLocal("i")),r.i32_const(l)))),r.call(e,r.getLocal("idx2"),r.getLocal("factor"),z),r.call(e,r.getLocal("idx1"),r.getLocal("factor"),r.getLocal("idx2")),r.call(a+"_copy",z,r.getLocal("idx1")),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}V(),ot(),j(),J(),I(),N(),nt(),at(),Lt(),rt(),A(),i(),ht(),t.exportFunction(n+"_fft"),t.exportFunction(n+"_ifft"),t.exportFunction(n+"_rawfft"),t.exportFunction(n+"_fftJoin"),t.exportFunction(n+"_fftJoinExt"),t.exportFunction(n+"_fftJoinExtInv"),t.exportFunction(n+"_fftMix"),t.exportFunction(n+"_fftFinal"),t.exportFunction(n+"_prepareLagrangeEvaluation")},h_=function(t,n,a){let e=t.modules[a].n64*8;function h(){let b=t.addFunction(n+"_zero");b.addParam("px","i32"),b.addParam("n","i32"),b.addLocal("lastp","i32"),b.addLocal("p","i32");let l=b.getCodeBuilder();b.addCode(l.setLocal("p",l.getLocal("px")),l.setLocal("lastp",l.i32_add(l.getLocal("px"),l.i32_mul(l.getLocal("n"),l.i32_const(e)))),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("p"),l.getLocal("lastp"))),l.call(a+"_zero",l.getLocal("p")),l.setLocal("p",l.i32_add(l.getLocal("p"),l.i32_const(e))),l.br(0))))}function d(){let b=t.addFunction(n+"_constructLC");b.addParam("ppolynomials","i32"),b.addParam("psignals","i32"),b.addParam("nSignals","i32"),b.addParam("pres","i32"),b.addLocal("i","i32"),b.addLocal("j","i32"),b.addLocal("pp","i32"),b.addLocal("ps","i32"),b.addLocal("pd","i32"),b.addLocal("ncoefs","i32");let l=b.getCodeBuilder(),s=l.i32_const(t.alloc(e));b.addCode(l.setLocal("i",l.i32_const(0)),l.setLocal("pp",l.getLocal("ppolynomials")),l.setLocal("ps",l.getLocal("psignals")),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("nSignals"))),l.setLocal("ncoefs",l.i32_load(l.getLocal("pp"))),l.setLocal("pp",l.i32_add(l.getLocal("pp"),l.i32_const(4))),l.setLocal("j",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("j"),l.getLocal("ncoefs"))),l.setLocal("pd",l.i32_add(l.getLocal("pres"),l.i32_mul(l.i32_load(l.getLocal("pp")),l.i32_const(e)))),l.setLocal("pp",l.i32_add(l.getLocal("pp"),l.i32_const(4))),l.call(a+"_mul",l.getLocal("ps"),l.getLocal("pp"),s),l.call(a+"_add",s,l.getLocal("pd"),l.getLocal("pd")),l.setLocal("pp",l.i32_add(l.getLocal("pp"),l.i32_const(e))),l.setLocal("j",l.i32_add(l.getLocal("j"),l.i32_const(1))),l.br(0))),l.setLocal("ps",l.i32_add(l.getLocal("ps"),l.i32_const(e))),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))))}return h(),d(),t.exportFunction(n+"_zero"),t.exportFunction(n+"_constructLC"),n},f_=function(t,n,a){let e=t.modules[a].n64*8;function h(){let l=t.addFunction(n+"_buildABC");l.addParam("pCoefs","i32"),l.addParam("nCoefs","i32"),l.addParam("pWitness","i32"),l.addParam("pA","i32"),l.addParam("pB","i32"),l.addParam("pC","i32"),l.addParam("offsetOut","i32"),l.addParam("nOut","i32"),l.addParam("offsetWitness","i32"),l.addParam("nWitness","i32"),l.addLocal("it","i32"),l.addLocal("ita","i32"),l.addLocal("itb","i32"),l.addLocal("last","i32"),l.addLocal("m","i32"),l.addLocal("c","i32"),l.addLocal("s","i32"),l.addLocal("pOut","i32");let s=l.getCodeBuilder(),m=s.i32_const(t.alloc(e));l.addCode(s.setLocal("ita",s.getLocal("pA")),s.setLocal("itb",s.getLocal("pB")),s.setLocal("last",s.i32_add(s.getLocal("pA"),s.i32_mul(s.getLocal("nOut"),s.i32_const(e)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(a+"_zero",s.getLocal("ita")),s.call(a+"_zero",s.getLocal("itb")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(e))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(e))),s.br(0))),s.setLocal("it",s.getLocal("pCoefs")),s.setLocal("last",s.i32_add(s.getLocal("pCoefs"),s.i32_mul(s.getLocal("nCoefs"),s.i32_const(e+12)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("it"),s.getLocal("last"))),s.setLocal("s",s.i32_load(s.getLocal("it"),8)),s.if(s.i32_or(s.i32_lt_u(s.getLocal("s"),s.getLocal("offsetWitness")),s.i32_ge_u(s.getLocal("s"),s.i32_add(s.getLocal("offsetWitness"),s.getLocal("nWitness")))),[...s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(e+12))),...s.br(1)]),s.setLocal("m",s.i32_load(s.getLocal("it"))),s.if(s.i32_eq(s.getLocal("m"),s.i32_const(0)),s.setLocal("pOut",s.getLocal("pA")),s.if(s.i32_eq(s.getLocal("m"),s.i32_const(1)),s.setLocal("pOut",s.getLocal("pB")),[...s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(e+12))),...s.br(1)])),s.setLocal("c",s.i32_load(s.getLocal("it"),4)),s.if(s.i32_or(s.i32_lt_u(s.getLocal("c"),s.getLocal("offsetOut")),s.i32_ge_u(s.getLocal("c"),s.i32_add(s.getLocal("offsetOut"),s.getLocal("nOut")))),[...s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(e+12))),...s.br(1)]),s.setLocal("pOut",s.i32_add(s.getLocal("pOut"),s.i32_mul(s.i32_sub(s.getLocal("c"),s.getLocal("offsetOut")),s.i32_const(e)))),s.call(a+"_mul",s.i32_add(s.getLocal("pWitness"),s.i32_mul(s.i32_sub(s.getLocal("s"),s.getLocal("offsetWitness")),s.i32_const(e))),s.i32_add(s.getLocal("it"),s.i32_const(12)),m),s.call(a+"_add",s.getLocal("pOut"),m,s.getLocal("pOut")),s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(e+12))),s.br(0))),s.setLocal("ita",s.getLocal("pA")),s.setLocal("itb",s.getLocal("pB")),s.setLocal("it",s.getLocal("pC")),s.setLocal("last",s.i32_add(s.getLocal("pA"),s.i32_mul(s.getLocal("nOut"),s.i32_const(e)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(a+"_mul",s.getLocal("ita"),s.getLocal("itb"),s.getLocal("it")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(e))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(e))),s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(e))),s.br(0))))}function d(){let l=t.addFunction(n+"_joinABC");l.addParam("pA","i32"),l.addParam("pB","i32"),l.addParam("pC","i32"),l.addParam("n","i32"),l.addParam("pP","i32"),l.addLocal("ita","i32"),l.addLocal("itb","i32"),l.addLocal("itc","i32"),l.addLocal("itp","i32"),l.addLocal("last","i32");let s=l.getCodeBuilder(),m=s.i32_const(t.alloc(e));l.addCode(s.setLocal("ita",s.getLocal("pA")),s.setLocal("itb",s.getLocal("pB")),s.setLocal("itc",s.getLocal("pC")),s.setLocal("itp",s.getLocal("pP")),s.setLocal("last",s.i32_add(s.getLocal("pA"),s.i32_mul(s.getLocal("n"),s.i32_const(e)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(a+"_mul",s.getLocal("ita"),s.getLocal("itb"),m),s.call(a+"_sub",m,s.getLocal("itc"),s.getLocal("itp")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(e))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(e))),s.setLocal("itc",s.i32_add(s.getLocal("itc"),s.i32_const(e))),s.setLocal("itp",s.i32_add(s.getLocal("itp"),s.i32_const(e))),s.br(0))))}function b(){let l=t.addFunction(n+"_batchAdd");l.addParam("pa","i32"),l.addParam("pb","i32"),l.addParam("n","i32"),l.addParam("pr","i32"),l.addLocal("ita","i32"),l.addLocal("itb","i32"),l.addLocal("itr","i32"),l.addLocal("last","i32");let s=l.getCodeBuilder();l.addCode(s.setLocal("ita",s.getLocal("pa")),s.setLocal("itb",s.getLocal("pb")),s.setLocal("itr",s.getLocal("pr")),s.setLocal("last",s.i32_add(s.getLocal("pa"),s.i32_mul(s.getLocal("n"),s.i32_const(e)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(a+"_add",s.getLocal("ita"),s.getLocal("itb"),s.getLocal("itr")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(e))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(e))),s.setLocal("itr",s.i32_add(s.getLocal("itr"),s.i32_const(e))),s.br(0))))}return h(),d(),b(),t.exportFunction(n+"_buildABC"),t.exportFunction(n+"_joinABC"),t.exportFunction(n+"_batchAdd"),n},g_=function(t,n,a,o,e,h,d,b){let l=t.addFunction(n);l.addParam("pIn","i32"),l.addParam("n","i32"),l.addParam("pFirst","i32"),l.addParam("pInc","i32"),l.addParam("pOut","i32"),l.addLocal("pOldFree","i32"),l.addLocal("i","i32"),l.addLocal("pFrom","i32"),l.addLocal("pTo","i32");let s=l.getCodeBuilder(),m=s.i32_const(t.alloc(d));l.addCode(s.setLocal("pFrom",s.getLocal("pIn")),s.setLocal("pTo",s.getLocal("pOut"))),l.addCode(s.call(o+"_copy",s.getLocal("pFirst"),m)),l.addCode(s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.call(b,s.getLocal("pFrom"),m,s.getLocal("pTo")),s.setLocal("pFrom",s.i32_add(s.getLocal("pFrom"),s.i32_const(e))),s.setLocal("pTo",s.i32_add(s.getLocal("pTo"),s.i32_const(h))),s.call(o+"_mul",m,s.getLocal("pInc"),m),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0)))),t.exportFunction(n)},tn=ja,OL=Dl,PL=l_,Pu=r_,ML=d_,Mu=u_,ml=__,RL=h_,zL=f_,Bi=g_,{bitLength:TL,modInv:GL,isOdd:Ru,isNegative:kL}=Wn,UL=function(t,n){let a=n||"bn128";if(t.modules[a])return a;let o=21888242871839275222246405745257275088696311157297823662689037894645226208583n,e=21888242871839275222246405745257275088548364400416034343698204186575808495617n,h=Math.floor((TL(o-1n)-1)/64)+1,d=h*8,b=d,l=d,s=l*2,m=l*12,B=t.alloc(tn.bigInt2BytesLE(e,b)),p=OL(t,o,"f1m");PL(t,e,"fr","frm");let v=t.alloc(tn.bigInt2BytesLE(O(3n),l)),M=Mu(t,"g1m","f1m",v);ml(t,"frm","frm","frm","frm_mul"),RL(t,"pol","frm"),zL(t,"qap","frm");let x=Pu(t,"f1m_neg","f2m","f1m"),S=t.alloc([...tn.bigInt2BytesLE(O(19485874751759354771024239261021720505790618469301721065564631296452457478373n),l),...tn.bigInt2BytesLE(O(266929791119991161246907387137283842545076965332900288569378510910307636690n),l)]),w=Mu(t,"g2m","f2m",S);function k(X,_){let f=t.addFunction(X);f.addParam("pG","i32"),f.addParam("pFr","i32"),f.addParam("pr","i32");let R=f.getCodeBuilder(),G=R.i32_const(t.alloc(d));f.addCode(R.call("frm_fromMontgomery",R.getLocal("pFr"),G),R.call(_,R.getLocal("pG"),G,R.i32_const(d),R.getLocal("pr"))),t.exportFunction(X)}k("g1m_timesFr","g1m_timesScalar"),ml(t,"g1m","g1m","frm","g1m_timesFr"),k("g2m_timesFr","g2m_timesScalar"),ml(t,"g2m","g2m","frm","g2m_timesFr"),k("g1m_timesFrAffine","g1m_timesScalarAffine"),k("g2m_timesFrAffine","g2m_timesScalarAffine"),Bi(t,"frm_batchApplyKey","fmr","frm",d,d,d,"frm_mul"),Bi(t,"g1m_batchApplyKey","g1m","frm",d*3,d*3,d,"g1m_timesFr"),Bi(t,"g1m_batchApplyKeyMixed","g1m","frm",d*2,d*3,d,"g1m_timesFrAffine"),Bi(t,"g2m_batchApplyKey","g2m","frm",d*2*3,d*3*2,d,"g2m_timesFr"),Bi(t,"g2m_batchApplyKeyMixed","g2m","frm",d*2*2,d*3*2,d,"g2m_timesFrAffine");function O(X){return BigInt(X)*(1n<<BigInt(l*8))%o}let W=[1n,2n,1n],F=t.alloc([...tn.bigInt2BytesLE(O(W[0]),l),...tn.bigInt2BytesLE(O(W[1]),l),...tn.bigInt2BytesLE(O(W[2]),l)]),u=[0n,1n,0n],L=t.alloc([...tn.bigInt2BytesLE(O(u[0]),l),...tn.bigInt2BytesLE(O(u[1]),l),...tn.bigInt2BytesLE(O(u[2]),l)]),$=[[10857046999023057135944570762232829481370756359578518086990519993285655852781n,11559732032986387107991004021392285783925812861821192530917403151452391805634n],[8495653923123431417604973247489272438418190587263600148770280649306958101930n,4082367875863433681332203403145435568316851327593401208105741076214120093531n],[1n,0n]],Q=t.alloc([...tn.bigInt2BytesLE(O($[0][0]),l),...tn.bigInt2BytesLE(O($[0][1]),l),...tn.bigInt2BytesLE(O($[1][0]),l),...tn.bigInt2BytesLE(O($[1][1]),l),...tn.bigInt2BytesLE(O($[2][0]),l),...tn.bigInt2BytesLE(O($[2][1]),l)]),H=[[0n,0n],[1n,0n],[0n,0n]],q=t.alloc([...tn.bigInt2BytesLE(O(H[0][0]),l),...tn.bigInt2BytesLE(O(H[0][1]),l),...tn.bigInt2BytesLE(O(H[1][0]),l),...tn.bigInt2BytesLE(O(H[1][1]),l),...tn.bigInt2BytesLE(O(H[2][0]),l),...tn.bigInt2BytesLE(O(H[2][1]),l)]),y=t.alloc([...tn.bigInt2BytesLE(O(1),l),...tn.bigInt2BytesLE(O(0),l),...tn.bigInt2BytesLE(O(0),l),...tn.bigInt2BytesLE(O(0),l),...tn.bigInt2BytesLE(O(0),l),...tn.bigInt2BytesLE(O(0),l),...tn.bigInt2BytesLE(O(0),l),...tn.bigInt2BytesLE(O(0),l),...tn.bigInt2BytesLE(O(0),l),...tn.bigInt2BytesLE(O(0),l),...tn.bigInt2BytesLE(O(0),l),...tn.bigInt2BytesLE(O(0),l)]),I=t.alloc([...tn.bigInt2BytesLE(O(9),l),...tn.bigInt2BytesLE(O(1),l)]),N=t.alloc([...tn.bigInt2BytesLE(O(GL(2n,o)),l),...tn.bigInt2BytesLE(0n,l)]),nt=I,J=t.alloc([...tn.bigInt2BytesLE(O(19485874751759354771024239261021720505790618469301721065564631296452457478373n),l),...tn.bigInt2BytesLE(O(266929791119991161246907387137283842545076965332900288569378510910307636690n),l)]);function j(){let X=t.addFunction(a+"_mulNR6");X.addParam("x","i32"),X.addParam("pr","i32");let _=X.getCodeBuilder();X.addCode(_.call(x+"_mul",_.i32_const(I),_.getLocal("x"),_.getLocal("pr")))}j();let ot=ML(t,a+"_mulNR6","f6m","f2m");function V(){let X=t.addFunction(a+"_mulNR12");X.addParam("x","i32"),X.addParam("pr","i32");let _=X.getCodeBuilder();X.addCode(_.call(x+"_mul",_.i32_const(I),_.i32_add(_.getLocal("x"),_.i32_const(d*4)),_.getLocal("pr")),_.call(x+"_copy",_.getLocal("x"),_.i32_add(_.getLocal("pr"),_.i32_const(d*2))),_.call(x+"_copy",_.i32_add(_.getLocal("x"),_.i32_const(d*2)),_.i32_add(_.getLocal("pr"),_.i32_const(d*4))))}V();let at=Pu(t,a+"_mulNR12","ftm",ot),rt=st(29793968203157093288n),ht=t.alloc(rt),A=3*s,i=rt.length-1,r=rt.reduce((X,_)=>X+(_!=0?1:0),0)+i+1,z=6*d,E=3*d*2+r*A;t.modules[a]={n64:h,pG1gen:F,pG1zero:L,pG1b:v,pG2gen:Q,pG2zero:q,pG2b:S,pq:t.modules.f1m.pq,pr:B,pOneT:y,prePSize:z,preQSize:E,r:e.toString(),q:o.toString()};let g=4965661367192848881n;function U(X){let _=X,f=[];for(;_>0n;){if(Ru(_)){let R=2-Number(_%4n);f.push(R),_=_-BigInt(R)}else f.push(0);_=_>>1n}return f}function st(X){let _=X,f=[];for(;_>0n;)Ru(_)?f.push(1):f.push(0),_=_>>1n;return f}function et(){let X=t.addFunction(a+"_prepareG1");X.addParam("pP","i32"),X.addParam("ppreP","i32");let _=X.getCodeBuilder();X.addCode(_.call(M+"_normalize",_.getLocal("pP"),_.getLocal("ppreP")))}function ct(){let X=t.addFunction(a+"_prepAddStep");X.addParam("pQ","i32"),X.addParam("pR","i32"),X.addParam("pCoef","i32");let _=X.getCodeBuilder(),f=_.getLocal("pQ"),R=_.i32_add(_.getLocal("pQ"),_.i32_const(s)),G=_.getLocal("pR"),P=_.i32_add(_.getLocal("pR"),_.i32_const(s)),Z=_.i32_add(_.getLocal("pR"),_.i32_const(2*s)),T=_.getLocal("pCoef"),D=_.i32_add(_.getLocal("pCoef"),_.i32_const(s)),Y=_.i32_add(_.getLocal("pCoef"),_.i32_const(2*s)),tt=D,K=_.i32_const(t.alloc(s)),it=_.i32_const(t.alloc(s)),mt=_.i32_const(t.alloc(s)),pt=_.i32_const(t.alloc(s)),dt=_.i32_const(t.alloc(s)),Ct=_.i32_const(t.alloc(s)),xt=_.i32_const(t.alloc(s));X.addCode(_.call(x+"_mul",f,Z,tt),_.call(x+"_sub",G,tt,tt),_.call(x+"_mul",R,Z,K),_.call(x+"_sub",P,K,K),_.call(x+"_square",tt,it),_.call(x+"_square",K,mt),_.call(x+"_mul",tt,it,pt),_.call(x+"_mul",G,it,dt),_.call(x+"_add",dt,dt,xt),_.call(x+"_mul",Z,mt,Ct),_.call(x+"_add",pt,Ct,Ct),_.call(x+"_sub",Ct,xt,Ct),_.call(x+"_mul",tt,Ct,G),_.call(x+"_mul",pt,P,P),_.call(x+"_sub",dt,Ct,xt),_.call(x+"_mul",K,xt,xt),_.call(x+"_sub",xt,P,P),_.call(x+"_mul",Z,pt,Z),_.call(x+"_mul",tt,R,xt),_.call(x+"_mul",K,f,T),_.call(x+"_sub",T,xt,T),_.call(x+"_mul",T,_.i32_const(nt),T),_.call(x+"_neg",K,Y))}function ft(){let X=t.addFunction(a+"_prepDblStep");X.addParam("pR","i32"),X.addParam("pCoef","i32");let _=X.getCodeBuilder(),f=_.getLocal("pR"),R=_.i32_add(_.getLocal("pR"),_.i32_const(s)),G=_.i32_add(_.getLocal("pR"),_.i32_const(2*s)),P=_.getLocal("pCoef"),Z=_.i32_add(_.getLocal("pCoef"),_.i32_const(s)),T=_.i32_add(_.getLocal("pCoef"),_.i32_const(2*s)),D=_.i32_const(t.alloc(s)),Y=_.i32_const(t.alloc(s)),tt=_.i32_const(t.alloc(s)),K=_.i32_const(t.alloc(s)),it=_.i32_const(t.alloc(s)),mt=_.i32_const(t.alloc(s)),pt=_.i32_const(t.alloc(s)),dt=_.i32_const(t.alloc(s)),Ct=_.i32_const(t.alloc(s)),xt=_.i32_const(t.alloc(s)),St=_.i32_const(t.alloc(s)),Bt=_.i32_const(t.alloc(s));X.addCode(_.call(x+"_mul",R,_.i32_const(N),D),_.call(x+"_mul",f,D,D),_.call(x+"_square",R,Y),_.call(x+"_square",G,tt),_.call(x+"_add",tt,tt,K),_.call(x+"_add",K,tt,K),_.call(x+"_mul",_.i32_const(J),K,it),_.call(x+"_add",it,it,mt),_.call(x+"_add",it,mt,mt),_.call(x+"_add",Y,mt,pt),_.call(x+"_mul",pt,_.i32_const(N),pt),_.call(x+"_add",Y,tt,Bt),_.call(x+"_add",R,G,dt),_.call(x+"_square",dt,dt),_.call(x+"_sub",dt,Bt,dt),_.call(x+"_sub",it,Y,Ct),_.call(x+"_square",f,xt),_.call(x+"_square",it,St),_.call(x+"_sub",Y,mt,Bt),_.call(x+"_mul",D,Bt,f),_.call(x+"_add",St,St,Bt),_.call(x+"_add",St,Bt,Bt),_.call(x+"_square",pt,R),_.call(x+"_sub",R,Bt,R),_.call(x+"_mul",Y,dt,G),_.call(x+"_mul",_.i32_const(nt),Ct,P),_.call(x+"_neg",dt,Z),_.call(x+"_add",xt,xt,T),_.call(x+"_add",xt,T,T))}function _t(){let X=t.addFunction(a+"_mulByQ");X.addParam("p1","i32"),X.addParam("pr","i32");let _=X.getCodeBuilder(),f=_.getLocal("p1"),R=_.i32_add(_.getLocal("p1"),_.i32_const(s)),G=_.i32_add(_.getLocal("p1"),_.i32_const(s*2)),P=_.getLocal("pr"),Z=_.i32_add(_.getLocal("pr"),_.i32_const(s)),T=_.i32_add(_.getLocal("pr"),_.i32_const(s*2)),D=_.i32_const(t.alloc([...tn.bigInt2BytesLE(O("21575463638280843010398324269430826099269044274347216827212613867836435027261"),l),...tn.bigInt2BytesLE(O("10307601595873709700152284273816112264069230130616436755625194854815875713954"),l)])),Y=_.i32_const(t.alloc([...tn.bigInt2BytesLE(O("2821565182194536844548159561693502659359617185244120367078079554186484126554"),l),...tn.bigInt2BytesLE(O("3505843767911556378687030309984248845540243509899259641013678093033130930403"),l)]));X.addCode(_.call(x+"_conjugate",f,P),_.call(x+"_mul",D,P,P),_.call(x+"_conjugate",R,Z),_.call(x+"_mul",Y,Z,Z),_.call(x+"_conjugate",G,T))}function gt(){_t();let X=t.addFunction(a+"_prepareG2");X.addParam("pQ","i32"),X.addParam("ppreQ","i32"),X.addLocal("pCoef","i32"),X.addLocal("i","i32");let _=X.getCodeBuilder(),f=_.getLocal("pQ"),R=t.alloc(s*3),G=_.i32_const(R),P=_.i32_const(R),Z=_.i32_const(R+s),T=_.i32_const(R+2*s),D=_.i32_add(_.getLocal("ppreQ"),_.i32_const(0)),Y=_.i32_add(_.getLocal("ppreQ"),_.i32_const(s)),tt=t.alloc(s*3),K=_.i32_const(tt),it=t.alloc(s*3),mt=_.i32_const(it),pt=_.i32_const(it+s);X.addCode(_.call(w+"_normalize",f,D),_.call(x+"_copy",D,P),_.call(x+"_copy",Y,Z),_.call(x+"_one",T)),X.addCode(_.setLocal("pCoef",_.i32_add(_.getLocal("ppreQ"),_.i32_const(s*3))),_.setLocal("i",_.i32_const(rt.length-2)),_.block(_.loop(_.call(a+"_prepDblStep",G,_.getLocal("pCoef")),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))),_.if(_.i32_load8_s(_.getLocal("i"),ht),[..._.call(a+"_prepAddStep",D,G,_.getLocal("pCoef")),..._.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A)))]),_.br_if(1,_.i32_eqz(_.getLocal("i"))),_.setLocal("i",_.i32_sub(_.getLocal("i"),_.i32_const(1))),_.br(0)))),X.addCode(_.call(a+"_mulByQ",D,K),_.call(a+"_mulByQ",K,mt)),X.addCode(_.call(x+"_neg",pt,pt),_.call(a+"_prepAddStep",K,G,_.getLocal("pCoef")),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))),_.call(a+"_prepAddStep",mt,G,_.getLocal("pCoef")),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))))}function yt(){let X=t.addFunction(a+"__mulBy024Old");X.addParam("pEll0","i32"),X.addParam("pEllVW","i32"),X.addParam("pEllVV","i32"),X.addParam("pR","i32");let _=X.getCodeBuilder(),f=_.getLocal("pEll0"),R=_.getLocal("pEllVV"),G=_.getLocal("pEllVW"),P=_.getLocal("pR"),Z=t.alloc(m),T=_.i32_const(Z),D=_.i32_const(Z),Y=_.i32_const(Z+s),tt=_.i32_const(Z+s*2),K=_.i32_const(Z+s*3),it=_.i32_const(Z+s*4),mt=_.i32_const(Z+s*5);X.addCode(_.call(x+"_copy",f,D),_.call(x+"_zero",Y),_.call(x+"_copy",R,tt),_.call(x+"_zero",K),_.call(x+"_copy",G,it),_.call(x+"_zero",mt),_.call(at+"_mul",T,P,P))}function ut(){let X=t.addFunction(a+"__mulBy024");X.addParam("pEll0","i32"),X.addParam("pEllVW","i32"),X.addParam("pEllVV","i32"),X.addParam("pR","i32");let _=X.getCodeBuilder(),f=_.getLocal("pEll0"),R=_.getLocal("pEllVV"),G=_.getLocal("pEllVW"),P=_.getLocal("pR"),Z=_.i32_add(_.getLocal("pR"),_.i32_const(2*d)),T=_.i32_add(_.getLocal("pR"),_.i32_const(4*d)),D=_.i32_add(_.getLocal("pR"),_.i32_const(6*d)),Y=_.i32_add(_.getLocal("pR"),_.i32_const(8*d)),tt=_.i32_add(_.getLocal("pR"),_.i32_const(10*d)),K=_.i32_const(t.alloc(s)),it=_.i32_const(t.alloc(s)),mt=_.i32_const(t.alloc(s)),pt=_.i32_const(t.alloc(s)),dt=_.i32_const(t.alloc(s)),Ct=_.i32_const(t.alloc(s)),xt=_.i32_const(t.alloc(s)),St=_.i32_const(t.alloc(s)),Bt=_.i32_const(t.alloc(s)),At=_.i32_const(t.alloc(s)),wt=_.i32_const(t.alloc(s));X.addCode(_.call(x+"_mul",P,f,xt),_.call(x+"_mul",T,R,St),_.call(x+"_mul",Y,G,Bt),_.call(x+"_add",P,Y,mt),_.call(x+"_add",P,T,it),_.call(x+"_add",Z,D,pt),_.call(x+"_add",pt,tt,pt),_.call(x+"_mul",Z,R,At),_.call(x+"_add",At,Bt,dt),_.call(x+"_mul",_.i32_const(I),dt,Ct),_.call(x+"_add",Ct,xt,P),_.call(x+"_mul",tt,G,dt),_.call(x+"_add",At,dt,At),_.call(x+"_add",dt,St,dt),_.call(x+"_mul",_.i32_const(I),dt,Ct),_.call(x+"_mul",Z,f,dt),_.call(x+"_add",At,dt,At),_.call(x+"_add",Ct,dt,Z),_.call(x+"_add",f,R,K),_.call(x+"_mul",it,K,dt),_.call(x+"_add",xt,St,wt),_.call(x+"_sub",dt,wt,dt),_.call(x+"_mul",D,G,Ct),_.call(x+"_add",At,Ct,At),_.call(x+"_add",T,Y,K),_.call(x+"_add",dt,Ct,T),_.call(x+"_add",R,G,it),_.call(x+"_mul",it,K,dt),_.call(x+"_add",St,Bt,wt),_.call(x+"_sub",dt,wt,dt),_.call(x+"_mul",_.i32_const(I),dt,Ct),_.call(x+"_mul",D,f,dt),_.call(x+"_add",At,dt,At),_.call(x+"_add",Ct,dt,D),_.call(x+"_mul",tt,R,dt),_.call(x+"_add",At,dt,At),_.call(x+"_mul",_.i32_const(I),dt,Ct),_.call(x+"_add",f,G,K),_.call(x+"_mul",mt,K,dt),_.call(x+"_add",xt,Bt,wt),_.call(x+"_sub",dt,wt,dt),_.call(x+"_add",Ct,dt,Y),_.call(x+"_add",f,R,K),_.call(x+"_add",K,G,K),_.call(x+"_mul",pt,K,dt),_.call(x+"_sub",dt,At,tt))}function lt(){let X=t.addFunction(a+"_millerLoop");X.addParam("ppreP","i32"),X.addParam("ppreQ","i32"),X.addParam("r","i32"),X.addLocal("pCoef","i32"),X.addLocal("i","i32");let _=X.getCodeBuilder(),f=_.getLocal("ppreP"),R=_.i32_add(_.getLocal("ppreP"),_.i32_const(l)),G=_.getLocal("pCoef"),P=_.i32_add(_.getLocal("pCoef"),_.i32_const(s)),Z=_.i32_add(_.getLocal("pCoef"),_.i32_const(2*s)),T=t.alloc(s),D=_.i32_const(T),Y=t.alloc(s),tt=_.i32_const(Y),K=_.getLocal("r");X.addCode(_.call(at+"_one",K),_.setLocal("pCoef",_.i32_add(_.getLocal("ppreQ"),_.i32_const(s*3))),_.setLocal("i",_.i32_const(rt.length-2)),_.block(_.loop(_.call(at+"_square",K,K),_.call(x+"_mul1",P,R,D),_.call(x+"_mul1",Z,f,tt),_.call(a+"__mulBy024",G,D,tt,K),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))),_.if(_.i32_load8_s(_.getLocal("i"),ht),[..._.call(x+"_mul1",P,R,D),..._.call(x+"_mul1",Z,f,tt),..._.call(a+"__mulBy024",G,D,tt,K),..._.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A)))]),_.br_if(1,_.i32_eqz(_.getLocal("i"))),_.setLocal("i",_.i32_sub(_.getLocal("i"),_.i32_const(1))),_.br(0)))),X.addCode(_.call(x+"_mul1",P,R,D),_.call(x+"_mul1",Z,f,tt),_.call(a+"__mulBy024",G,D,tt,K),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))),_.call(x+"_mul1",P,R,D),_.call(x+"_mul1",Z,f,tt),_.call(a+"__mulBy024",G,D,tt,K),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))))}function bt(X){let _=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[8376118865763821496583973867626364092589906065868298776909617916018768340080n,16469823323077808223889137241176536799009286646108169935659301613961712198316n],[21888242871839275220042445260109153167277707414472061641714758635765020556617n,0n],[11697423496358154304825782922584725312912383441159505038794027105778954184319n,303847389135065887422783454877609941456349188919719272345083954437860409601n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3321304630594332808241809054958361220322477375291206261884409189760185844239n,5722266937896532885780051958958348231143373700109372999374820235121374419868n],[21888242871839275222246405745257275088696311157297823662689037894645226208582n,0n],[13512124006075453725662431877630910996106405091429524885779419978626457868503n,5418419548761466998357268504080738289687024511189653727029736280683514010267n],[2203960485148121921418603742825762020974279258880205651966n,0n],[10190819375481120917420622822672549775783927716138318623895010788866272024264n,21584395482704209334823622290379665147239961968378104390343953940207365798982n],[2203960485148121921418603742825762020974279258880205651967n,0n],[18566938241244942414004596690298913868373833782006617400804628704885040364344n,16165975933942742336466353786298926857552937457188450663314217659523851788715n]]],f=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[21575463638280843010398324269430826099269044274347216827212613867836435027261n,10307601595873709700152284273816112264069230130616436755625194854815875713954n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3772000881919853776433695186713858239009073593817195771773381919316419345261n,2236595495967245188281701248203181795121068902605861227855261137820944008926n],[2203960485148121921418603742825762020974279258880205651966n,0n],[18429021223477853657660792034369865839114504446431234726392080002137598044644n,9344045779998320333812420223237981029506012124075525679208581902008406485703n]],[[1n,0n],[2581911344467009335267311115468803099551665605076196740867805258568234346338n,19937756971775647987995932169929341994314640652964949448313374472400716661030n],[2203960485148121921418603742825762020974279258880205651966n,0n],[5324479202449903542726783395506214481928257762400643279780343368557297135718n,16208900380737693084919495127334387981393726419856888799917914180988844123039n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[13981852324922362344252311234282257507216387789820983642040889267519694726527n,7629828391165209371577384193250820201684255241773809077146787135900891633097n]]],R=t.addFunction(a+"__frobeniusMap"+X);R.addParam("x","i32"),R.addParam("r","i32");let G=R.getCodeBuilder();for(let Z=0;Z<6;Z++){let T=Z==0?G.getLocal("x"):G.i32_add(G.getLocal("x"),G.i32_const(Z*s)),D=T,Y=G.i32_add(G.getLocal("x"),G.i32_const(Z*s+l)),tt=Z==0?G.getLocal("r"):G.i32_add(G.getLocal("r"),G.i32_const(Z*s)),K=tt,it=G.i32_add(G.getLocal("r"),G.i32_const(Z*s+l)),mt=P(_[Math.floor(Z/3)][X%12],f[Z%3][X%6]),pt=t.alloc([...tn.bigInt2BytesLE(O(mt[0]),32),...tn.bigInt2BytesLE(O(mt[1]),32)]);X%2==1?R.addCode(G.call(p+"_copy",D,K),G.call(p+"_neg",Y,it),G.call(x+"_mul",tt,G.i32_const(pt),tt)):R.addCode(G.call(x+"_mul",T,G.i32_const(pt),tt))}function P(Z,T){let D=BigInt(Z[0]),Y=BigInt(Z[1]),tt=BigInt(T[0]),K=BigInt(T[1]),it=[(D*tt-Y*K)%o,(D*K+Y*tt)%o];return kL(it[0])&&(it[0]=it[0]+o),it}}function Et(){let X=t.addFunction(a+"__finalExponentiationFirstChunk");X.addParam("x","i32"),X.addParam("r","i32");let _=X.getCodeBuilder(),f=_.getLocal("x"),R=f,G=_.i32_add(f,_.i32_const(d*6)),P=_.getLocal("r"),Z=t.alloc(m),T=_.i32_const(Z),D=T,Y=_.i32_const(Z+d*6),tt=_.i32_const(t.alloc(m)),K=_.i32_const(t.alloc(m)),it=_.i32_const(t.alloc(m));X.addCode(_.call(ot+"_copy",R,D),_.call(ot+"_neg",G,Y),_.call(at+"_inverse",f,tt),_.call(at+"_mul",T,tt,K),_.call(a+"__frobeniusMap2",K,it),_.call(at+"_mul",K,it,P))}function It(){let X=t.addFunction(a+"__cyclotomicSquare");X.addParam("x","i32"),X.addParam("r","i32");let _=X.getCodeBuilder(),f=_.getLocal("x"),R=_.i32_add(_.getLocal("x"),_.i32_const(s)),G=_.i32_add(_.getLocal("x"),_.i32_const(2*s)),P=_.i32_add(_.getLocal("x"),_.i32_const(3*s)),Z=_.i32_add(_.getLocal("x"),_.i32_const(4*s)),T=_.i32_add(_.getLocal("x"),_.i32_const(5*s)),D=_.getLocal("r"),Y=_.i32_add(_.getLocal("r"),_.i32_const(s)),tt=_.i32_add(_.getLocal("r"),_.i32_const(2*s)),K=_.i32_add(_.getLocal("r"),_.i32_const(3*s)),it=_.i32_add(_.getLocal("r"),_.i32_const(4*s)),mt=_.i32_add(_.getLocal("r"),_.i32_const(5*s)),pt=_.i32_const(t.alloc(s)),dt=_.i32_const(t.alloc(s)),Ct=_.i32_const(t.alloc(s)),xt=_.i32_const(t.alloc(s)),St=_.i32_const(t.alloc(s)),Bt=_.i32_const(t.alloc(s)),At=_.i32_const(t.alloc(s)),wt=_.i32_const(t.alloc(s));X.addCode(_.call(x+"_mul",f,Z,At),_.call(x+"_mul",Z,_.i32_const(I),pt),_.call(x+"_add",f,pt,pt),_.call(x+"_add",f,Z,wt),_.call(x+"_mul",wt,pt,pt),_.call(x+"_mul",_.i32_const(I),At,wt),_.call(x+"_add",At,wt,wt),_.call(x+"_sub",pt,wt,pt),_.call(x+"_add",At,At,dt),_.call(x+"_mul",P,G,At),_.call(x+"_mul",G,_.i32_const(I),Ct),_.call(x+"_add",P,Ct,Ct),_.call(x+"_add",P,G,wt),_.call(x+"_mul",wt,Ct,Ct),_.call(x+"_mul",_.i32_const(I),At,wt),_.call(x+"_add",At,wt,wt),_.call(x+"_sub",Ct,wt,Ct),_.call(x+"_add",At,At,xt),_.call(x+"_mul",R,T,At),_.call(x+"_mul",T,_.i32_const(I),St),_.call(x+"_add",R,St,St),_.call(x+"_add",R,T,wt),_.call(x+"_mul",wt,St,St),_.call(x+"_mul",_.i32_const(I),At,wt),_.call(x+"_add",At,wt,wt),_.call(x+"_sub",St,wt,St),_.call(x+"_add",At,At,Bt),_.call(x+"_sub",pt,f,D),_.call(x+"_add",D,D,D),_.call(x+"_add",pt,D,D),_.call(x+"_add",dt,Z,it),_.call(x+"_add",it,it,it),_.call(x+"_add",dt,it,it),_.call(x+"_mul",Bt,_.i32_const(nt),wt),_.call(x+"_add",wt,P,K),_.call(x+"_add",K,K,K),_.call(x+"_add",wt,K,K),_.call(x+"_sub",St,G,tt),_.call(x+"_add",tt,tt,tt),_.call(x+"_add",St,tt,tt),_.call(x+"_sub",Ct,R,Y),_.call(x+"_add",Y,Y,Y),_.call(x+"_add",Ct,Y,Y),_.call(x+"_add",xt,T,mt),_.call(x+"_add",mt,mt,mt),_.call(x+"_add",xt,mt,mt))}function zt(X,_){let f=U(X).map(Y=>Y==-1?255:Y),R=t.alloc(f),G=t.addFunction(a+"__cyclotomicExp_"+_);G.addParam("x","i32"),G.addParam("r","i32"),G.addLocal("bit","i32"),G.addLocal("i","i32");let P=G.getCodeBuilder(),Z=P.getLocal("x"),T=P.getLocal("r"),D=P.i32_const(t.alloc(m));G.addCode(P.call(at+"_conjugate",Z,D),P.call(at+"_one",T),P.if(P.teeLocal("bit",P.i32_load8_s(P.i32_const(f.length-1),R)),P.if(P.i32_eq(P.getLocal("bit"),P.i32_const(1)),P.call(at+"_mul",T,Z,T),P.call(at+"_mul",T,D,T))),P.setLocal("i",P.i32_const(f.length-2)),P.block(P.loop(P.call(a+"__cyclotomicSquare",T,T),P.if(P.teeLocal("bit",P.i32_load8_s(P.getLocal("i"),R)),P.if(P.i32_eq(P.getLocal("bit"),P.i32_const(1)),P.call(at+"_mul",T,Z,T),P.call(at+"_mul",T,D,T))),P.br_if(1,P.i32_eqz(P.getLocal("i"))),P.setLocal("i",P.i32_sub(P.getLocal("i"),P.i32_const(1))),P.br(0))))}function Mt(){It(),zt(g,"w0");let X=t.addFunction(a+"__finalExponentiationLastChunk");X.addParam("x","i32"),X.addParam("r","i32");let _=X.getCodeBuilder(),f=_.getLocal("x"),R=_.getLocal("r"),G=_.i32_const(t.alloc(m)),P=_.i32_const(t.alloc(m)),Z=_.i32_const(t.alloc(m)),T=_.i32_const(t.alloc(m)),D=_.i32_const(t.alloc(m)),Y=_.i32_const(t.alloc(m)),tt=_.i32_const(t.alloc(m)),K=_.i32_const(t.alloc(m)),it=_.i32_const(t.alloc(m)),mt=_.i32_const(t.alloc(m)),pt=_.i32_const(t.alloc(m)),dt=_.i32_const(t.alloc(m)),Ct=_.i32_const(t.alloc(m)),xt=_.i32_const(t.alloc(m)),St=_.i32_const(t.alloc(m)),Bt=_.i32_const(t.alloc(m)),At=_.i32_const(t.alloc(m)),wt=_.i32_const(t.alloc(m)),Ot=_.i32_const(t.alloc(m)),Jt=_.i32_const(t.alloc(m)),cn=_.i32_const(t.alloc(m));X.addCode(_.call(a+"__cyclotomicExp_w0",f,G),_.call(at+"_conjugate",G,G),_.call(a+"__cyclotomicSquare",G,P),_.call(a+"__cyclotomicSquare",P,Z),_.call(at+"_mul",Z,P,T),_.call(a+"__cyclotomicExp_w0",T,D),_.call(at+"_conjugate",D,D),_.call(a+"__cyclotomicSquare",D,Y),_.call(a+"__cyclotomicExp_w0",Y,tt),_.call(at+"_conjugate",tt,tt),_.call(at+"_conjugate",T,K),_.call(at+"_conjugate",tt,it),_.call(at+"_mul",it,D,mt),_.call(at+"_mul",mt,K,pt),_.call(at+"_mul",pt,P,dt),_.call(at+"_mul",pt,D,Ct),_.call(at+"_mul",Ct,f,xt),_.call(a+"__frobeniusMap1",dt,St),_.call(at+"_mul",St,xt,Bt),_.call(a+"__frobeniusMap2",pt,At),_.call(at+"_mul",At,Bt,wt),_.call(at+"_conjugate",f,Ot),_.call(at+"_mul",Ot,dt,Jt),_.call(a+"__frobeniusMap3",Jt,cn),_.call(at+"_mul",cn,wt,R))}function kt(){Et(),Mt();let X=t.addFunction(a+"_finalExponentiation");X.addParam("x","i32"),X.addParam("r","i32");let _=X.getCodeBuilder(),f=_.getLocal("x"),R=_.getLocal("r"),G=_.i32_const(t.alloc(m));X.addCode(_.call(a+"__finalExponentiationFirstChunk",f,G),_.call(a+"__finalExponentiationLastChunk",G,R))}function Pt(){let X=t.addFunction(a+"_finalExponentiationOld");X.addParam("x","i32"),X.addParam("r","i32");let f=t.alloc(tn.bigInt2BytesLE(552484233613224096312617126783173147097382103762957654188882734314196910839907541213974502761540629817009608548654680343627701153829446747810907373256841551006201639677726139946029199968412598804882391702273019083653272047566316584365559776493027495458238373902875937659943504873220554161550525926302303331747463515644711876653177129578303191095900909191624817826566688241804408081892785725967931714097716709526092261278071952560171111444072049229123565057483750161460024353346284167282452756217662335528813519139808291170539072125381230815729071544861602750936964829313608137325426383735122175229541155376346436093930287402089517426973178917569713384748081827255472576937471496195752727188261435633271238710131736096299798168852925540549342330775279877006784354801422249722573783561685179618816480037695005515426162362431072245638324744480n,352)),R=X.getCodeBuilder();X.addCode(R.call(at+"_exp",R.getLocal("x"),R.i32_const(f),R.i32_const(352),R.getLocal("r")))}let qt=t.alloc(z),Rt=t.alloc(E);function Kt(X){let _=t.addFunction(a+"_pairingEq"+X);for(let P=0;P<X;P++)_.addParam("p_"+P,"i32"),_.addParam("q_"+P,"i32");_.addParam("c","i32"),_.setReturnType("i32");let f=_.getCodeBuilder(),R=f.i32_const(t.alloc(m)),G=f.i32_const(t.alloc(m));_.addCode(f.call(at+"_one",R));for(let P=0;P<X;P++)_.addCode(f.call(a+"_prepareG1",f.getLocal("p_"+P),f.i32_const(qt))),_.addCode(f.call(a+"_prepareG2",f.getLocal("q_"+P),f.i32_const(Rt))),_.addCode(f.call(a+"_millerLoop",f.i32_const(qt),f.i32_const(Rt),G)),_.addCode(f.call(at+"_mul",R,G,R));_.addCode(f.call(a+"_finalExponentiation",R,R)),_.addCode(f.call(at+"_eq",R,f.getLocal("c")))}function Ut(){let X=t.addFunction(a+"_pairing");X.addParam("p","i32"),X.addParam("q","i32"),X.addParam("r","i32");let _=X.getCodeBuilder(),f=_.i32_const(t.alloc(m));X.addCode(_.call(a+"_prepareG1",_.getLocal("p"),_.i32_const(qt))),X.addCode(_.call(a+"_prepareG2",_.getLocal("q"),_.i32_const(Rt))),X.addCode(_.call(a+"_millerLoop",_.i32_const(qt),_.i32_const(Rt),f)),X.addCode(_.call(a+"_finalExponentiation",f,_.getLocal("r")))}ct(),ft(),et(),gt(),ut(),yt(),lt();for(let X=0;X<10;X++)bt(X),t.exportFunction(a+"__frobeniusMap"+X);Pt(),kt();for(let X=1;X<=5;X++)Kt(X),t.exportFunction(a+"_pairingEq"+X);Ut(),t.exportFunction(a+"_pairing"),t.exportFunction(a+"_prepareG1"),t.exportFunction(a+"_prepareG2"),t.exportFunction(a+"_millerLoop"),t.exportFunction(a+"_finalExponentiation"),t.exportFunction(a+"_finalExponentiationOld"),t.exportFunction(a+"__mulBy024"),t.exportFunction(a+"__mulBy024Old"),t.exportFunction(a+"__cyclotomicSquare"),t.exportFunction(a+"__cyclotomicExp_w0")},Vt=ja,NL=Dl,$L=l_,zu=r_,ZL=d_,Tu=u_,yl=__,jL=h_,VL=f_,xi=g_,{bitLength:Gu,isOdd:ku,isNegative:WL}=Wn,QL=function(t,n){let a=n||"bls12381";if(t.modules[a])return a;let o=0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,e=0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,h=Math.floor((Gu(o-1n)-1)/64)+1,d=h*8,b=d,l=b*2,s=b*12,m=Math.floor((Gu(e-1n)-1)/64)+1,B=m*8,p=B,v=t.alloc(Vt.bigInt2BytesLE(e,p)),M=NL(t,o,"f1m","intq");$L(t,e,"fr","frm","intr");let x=t.alloc(Vt.bigInt2BytesLE(F(4n),b)),S=Tu(t,"g1m","f1m",x);yl(t,"frm","frm","frm","frm_mul"),jL(t,"pol","frm"),VL(t,"qap","frm");let w=zu(t,"f1m_neg","f2m","f1m"),k=t.alloc([...Vt.bigInt2BytesLE(F(4n),b),...Vt.bigInt2BytesLE(F(4n),b)]),O=Tu(t,"g2m","f2m",k);function W(_,f){let R=t.addFunction(_);R.addParam("pG","i32"),R.addParam("pFr","i32"),R.addParam("pr","i32");let G=R.getCodeBuilder(),P=G.i32_const(t.alloc(B));R.addCode(G.call("frm_fromMontgomery",G.getLocal("pFr"),P),G.call(f,G.getLocal("pG"),P,G.i32_const(B),G.getLocal("pr"))),t.exportFunction(_)}W("g1m_timesFr","g1m_timesScalar"),yl(t,"g1m","g1m","frm","g1m_timesFr"),W("g2m_timesFr","g2m_timesScalar"),yl(t,"g2m","g2m","frm","g2m_timesFr"),W("g1m_timesFrAffine","g1m_timesScalarAffine"),W("g2m_timesFrAffine","g2m_timesScalarAffine"),xi(t,"frm_batchApplyKey","fmr","frm",B,B,B,"frm_mul"),xi(t,"g1m_batchApplyKey","g1m","frm",d*3,d*3,B,"g1m_timesFr"),xi(t,"g1m_batchApplyKeyMixed","g1m","frm",d*2,d*3,B,"g1m_timesFrAffine"),xi(t,"g2m_batchApplyKey","g2m","frm",d*2*3,d*3*2,B,"g2m_timesFr"),xi(t,"g2m_batchApplyKeyMixed","g2m","frm",d*2*2,d*3*2,B,"g2m_timesFrAffine");function F(_){return BigInt(_)*(1n<<BigInt(b*8))%o}let u=[3685416753713387016781088315183077757961620795782546409894578378688607592378376318836054947676345821548104185464507n,1339506544944476473020471379941921221584933875938349620426543736416511423956333506472724655353366534992391756441569n,1n],L=t.alloc([...Vt.bigInt2BytesLE(F(u[0]),b),...Vt.bigInt2BytesLE(F(u[1]),b),...Vt.bigInt2BytesLE(F(u[2]),b)]),$=[0n,1n,0n],Q=t.alloc([...Vt.bigInt2BytesLE(F($[0]),b),...Vt.bigInt2BytesLE(F($[1]),b),...Vt.bigInt2BytesLE(F($[2]),b)]),H=[[352701069587466618187139116011060144890029952792775240219908644239793785735715026873347600343865175952761926303160n,3059144344244213709971259814753781636986470325476647558659373206291635324768958432433509563104347017837885763365758n],[1985150602287291935568054521177171638300868978215655730859378665066344726373823718423869104263333984641494340347905n,927553665492332455747201965776037880757740193453592970025027978793976877002675564980949289727957565575433344219582n],[1n,0n]],q=t.alloc([...Vt.bigInt2BytesLE(F(H[0][0]),b),...Vt.bigInt2BytesLE(F(H[0][1]),b),...Vt.bigInt2BytesLE(F(H[1][0]),b),...Vt.bigInt2BytesLE(F(H[1][1]),b),...Vt.bigInt2BytesLE(F(H[2][0]),b),...Vt.bigInt2BytesLE(F(H[2][1]),b)]),y=[[0n,0n],[1n,0n],[0n,0n]],I=t.alloc([...Vt.bigInt2BytesLE(F(y[0][0]),b),...Vt.bigInt2BytesLE(F(y[0][1]),b),...Vt.bigInt2BytesLE(F(y[1][0]),b),...Vt.bigInt2BytesLE(F(y[1][1]),b),...Vt.bigInt2BytesLE(F(y[2][0]),b),...Vt.bigInt2BytesLE(F(y[2][1]),b)]),N=t.alloc([...Vt.bigInt2BytesLE(F(1n),b),...Vt.bigInt2BytesLE(F(0n),b),...Vt.bigInt2BytesLE(F(0n),b),...Vt.bigInt2BytesLE(F(0n),b),...Vt.bigInt2BytesLE(F(0n),b),...Vt.bigInt2BytesLE(F(0n),b),...Vt.bigInt2BytesLE(F(0n),b),...Vt.bigInt2BytesLE(F(0n),b),...Vt.bigInt2BytesLE(F(0n),b),...Vt.bigInt2BytesLE(F(0n),b),...Vt.bigInt2BytesLE(F(0n),b),...Vt.bigInt2BytesLE(F(0n),b)]),nt=t.alloc([...Vt.bigInt2BytesLE(F(1n),b),...Vt.bigInt2BytesLE(F(1n),b)]);function J(){let _=t.addFunction(w+"_mulNR");_.addParam("x","i32"),_.addParam("pr","i32");let f=_.getCodeBuilder(),R=f.i32_const(t.alloc(b)),G=f.getLocal("x"),P=f.i32_add(f.getLocal("x"),f.i32_const(b)),Z=f.getLocal("pr"),T=f.i32_add(f.getLocal("pr"),f.i32_const(b));_.addCode(f.call(M+"_copy",G,R),f.call(M+"_sub",G,P,Z),f.call(M+"_add",R,P,T))}J();let j=ZL(t,w+"_mulNR","f6m","f2m");function ot(){let _=t.addFunction(j+"_mulNR");_.addParam("x","i32"),_.addParam("pr","i32");let f=_.getCodeBuilder(),R=f.i32_const(t.alloc(b*2));_.addCode(f.call(w+"_copy",f.getLocal("x"),R),f.call(w+"_mulNR",f.i32_add(f.getLocal("x"),f.i32_const(d*4)),f.getLocal("pr")),f.call(w+"_copy",f.i32_add(f.getLocal("x"),f.i32_const(d*2)),f.i32_add(f.getLocal("pr"),f.i32_const(d*4))),f.call(w+"_copy",R,f.i32_add(f.getLocal("pr"),f.i32_const(d*2))))}ot();let V=zu(t,j+"_mulNR","ftm",j),Lt=st(0xd201000000010000n),rt=t.alloc(Lt),ht=3*l,A=Lt.length-1,C=Lt.reduce((_,f)=>_+(f!=0?1:0),0)+A+1,r=6*d,z=3*d*2+C*ht,E=!0,g=15132376222941642752n;t.modules[a]={n64q:h,n64r:m,n8q:d,n8r:B,pG1gen:L,pG1zero:Q,pG1b:x,pG2gen:q,pG2zero:I,pG2b:k,pq:t.modules.f1m.pq,pr:v,pOneT:N,r:e,q:o,prePSize:r,preQSize:z};function U(_){let f=_,R=[];for(;f>0n;){if(ku(f)){let G=2-Number(f%4n);R.push(G),f=f-BigInt(G)}else R.push(0);f=f>>1n}return R}function st(_){let f=_,R=[];for(;f>0n;)ku(f)?R.push(1):R.push(0),f=f>>1n;return R}function et(){let _=t.addFunction(a+"_prepareG1");_.addParam("pP","i32"),_.addParam("ppreP","i32");let f=_.getCodeBuilder();_.addCode(f.call(S+"_normalize",f.getLocal("pP"),f.getLocal("ppreP")))}function ct(){let _=t.addFunction(a+"_prepDblStep");_.addParam("R","i32"),_.addParam("r","i32");let f=_.getCodeBuilder(),R=f.getLocal("R"),G=f.i32_add(f.getLocal("R"),f.i32_const(2*d)),P=f.i32_add(f.getLocal("R"),f.i32_const(4*d)),Z=f.getLocal("r"),T=f.i32_add(f.getLocal("r"),f.i32_const(2*d)),D=f.i32_add(f.getLocal("r"),f.i32_const(4*d)),Y=f.i32_const(t.alloc(l)),tt=f.i32_const(t.alloc(l)),K=f.i32_const(t.alloc(l)),it=f.i32_const(t.alloc(l)),mt=f.i32_const(t.alloc(l));_.addCode(f.call(w+"_square",R,Z),f.call(w+"_square",G,tt),f.call(w+"_square",tt,K),f.call(w+"_add",tt,R,T),f.call(w+"_square",T,T),f.call(w+"_sub",T,Z,T),f.call(w+"_sub",T,K,T),f.call(w+"_add",T,T,T),f.call(w+"_add",Z,Z,it),f.call(w+"_add",it,Z,it),f.call(w+"_add",R,it,D),f.call(w+"_square",it,mt),f.call(w+"_square",P,Y),f.call(w+"_sub",mt,T,R),f.call(w+"_sub",R,T,R),f.call(w+"_add",P,G,P),f.call(w+"_square",P,P),f.call(w+"_sub",P,tt,P),f.call(w+"_sub",P,Y,P),f.call(w+"_sub",T,R,G),f.call(w+"_mul",G,it,G),f.call(w+"_add",K,K,K),f.call(w+"_add",K,K,K),f.call(w+"_add",K,K,K),f.call(w+"_sub",G,K,G),f.call(w+"_mul",it,Y,T),f.call(w+"_add",T,T,T),f.call(w+"_neg",T,T),f.call(w+"_square",D,D),f.call(w+"_sub",D,Z,D),f.call(w+"_sub",D,mt,D),f.call(w+"_add",tt,tt,tt),f.call(w+"_add",tt,tt,tt),f.call(w+"_sub",D,tt,D),f.call(w+"_mul",P,Y,Z),f.call(w+"_add",Z,Z,Z))}function ft(){let _=t.addFunction(a+"_prepAddStep");_.addParam("R","i32"),_.addParam("Q","i32"),_.addParam("r","i32");let f=_.getCodeBuilder(),R=f.getLocal("R"),G=f.i32_add(f.getLocal("R"),f.i32_const(2*d)),P=f.i32_add(f.getLocal("R"),f.i32_const(4*d)),Z=f.getLocal("Q"),T=f.i32_add(f.getLocal("Q"),f.i32_const(2*d)),D=f.getLocal("r"),Y=f.i32_add(f.getLocal("r"),f.i32_const(2*d)),tt=f.i32_add(f.getLocal("r"),f.i32_const(4*d)),K=f.i32_const(t.alloc(l)),it=f.i32_const(t.alloc(l)),mt=f.i32_const(t.alloc(l)),pt=f.i32_const(t.alloc(l)),dt=f.i32_const(t.alloc(l)),Ct=f.i32_const(t.alloc(l)),xt=f.i32_const(t.alloc(l)),St=f.i32_const(t.alloc(l)),Bt=f.i32_const(t.alloc(l)),At=f.i32_const(t.alloc(l)),wt=f.i32_const(t.alloc(l));_.addCode(f.call(w+"_square",P,K),f.call(w+"_square",T,it),f.call(w+"_mul",K,Z,pt),f.call(w+"_add",T,P,Y),f.call(w+"_square",Y,Y),f.call(w+"_sub",Y,it,Y),f.call(w+"_sub",Y,K,Y),f.call(w+"_mul",Y,K,Y),f.call(w+"_sub",pt,R,dt),f.call(w+"_square",dt,Ct),f.call(w+"_add",Ct,Ct,xt),f.call(w+"_add",xt,xt,xt),f.call(w+"_mul",xt,dt,St),f.call(w+"_sub",Y,G,Bt),f.call(w+"_sub",Bt,G,Bt),f.call(w+"_mul",Bt,Z,tt),f.call(w+"_mul",xt,R,At),f.call(w+"_square",Bt,R),f.call(w+"_sub",R,St,R),f.call(w+"_sub",R,At,R),f.call(w+"_sub",R,At,R),f.call(w+"_add",P,dt,P),f.call(w+"_square",P,P),f.call(w+"_sub",P,K,P),f.call(w+"_sub",P,Ct,P),f.call(w+"_add",T,P,D),f.call(w+"_sub",At,R,wt),f.call(w+"_mul",wt,Bt,wt),f.call(w+"_mul",G,St,pt),f.call(w+"_add",pt,pt,pt),f.call(w+"_sub",wt,pt,G),f.call(w+"_square",D,D),f.call(w+"_sub",D,it,D),f.call(w+"_square",P,mt),f.call(w+"_sub",D,mt,D),f.call(w+"_add",tt,tt,tt),f.call(w+"_sub",tt,D,tt),f.call(w+"_add",P,P,D),f.call(w+"_neg",Bt,Bt),f.call(w+"_add",Bt,Bt,Y))}function _t(){let _=t.addFunction(a+"_prepareG2");_.addParam("pQ","i32"),_.addParam("ppreQ","i32"),_.addLocal("pCoef","i32"),_.addLocal("i","i32");let f=_.getCodeBuilder(),R=f.getLocal("pQ"),G=t.alloc(l*3),P=f.i32_const(G),Z=f.getLocal("ppreQ");_.addCode(f.call(O+"_normalize",R,Z),f.if(f.call(O+"_isZero",Z),f.ret([])),f.call(O+"_copy",Z,P),f.setLocal("pCoef",f.i32_add(f.getLocal("ppreQ"),f.i32_const(l*3)))),_.addCode(f.setLocal("i",f.i32_const(Lt.length-2)),f.block(f.loop(f.call(a+"_prepDblStep",P,f.getLocal("pCoef")),f.setLocal("pCoef",f.i32_add(f.getLocal("pCoef"),f.i32_const(ht))),f.if(f.i32_load8_s(f.getLocal("i"),rt),[...f.call(a+"_prepAddStep",P,Z,f.getLocal("pCoef")),...f.setLocal("pCoef",f.i32_add(f.getLocal("pCoef"),f.i32_const(ht)))]),f.br_if(1,f.i32_eqz(f.getLocal("i"))),f.setLocal("i",f.i32_sub(f.getLocal("i"),f.i32_const(1))),f.br(0))))}function gt(){let _=t.addFunction(j+"_mul1");_.addParam("pA","i32"),_.addParam("pC1","i32"),_.addParam("pR","i32");let f=_.getCodeBuilder(),R=f.getLocal("pA"),G=f.i32_add(f.getLocal("pA"),f.i32_const(b*2)),P=f.i32_add(f.getLocal("pA"),f.i32_const(b*4)),Z=f.getLocal("pC1"),T=f.getLocal("pR"),D=f.i32_add(f.getLocal("pR"),f.i32_const(b*2)),Y=f.i32_add(f.getLocal("pR"),f.i32_const(b*4)),tt=f.i32_const(t.alloc(b*2)),K=f.i32_const(t.alloc(b*2));_.addCode(f.call(w+"_add",R,G,tt),f.call(w+"_add",G,P,K),f.call(w+"_mul",G,Z,Y),f.call(w+"_mul",K,Z,T),f.call(w+"_sub",T,Y,T),f.call(w+"_mulNR",T,T),f.call(w+"_mul",tt,Z,D),f.call(w+"_sub",D,Y,D))}gt();function yt(){let _=t.addFunction(j+"_mul01");_.addParam("pA","i32"),_.addParam("pC0","i32"),_.addParam("pC1","i32"),_.addParam("pR","i32");let f=_.getCodeBuilder(),R=f.getLocal("pA"),G=f.i32_add(f.getLocal("pA"),f.i32_const(b*2)),P=f.i32_add(f.getLocal("pA"),f.i32_const(b*4)),Z=f.getLocal("pC0"),T=f.getLocal("pC1"),D=f.getLocal("pR"),Y=f.i32_add(f.getLocal("pR"),f.i32_const(b*2)),tt=f.i32_add(f.getLocal("pR"),f.i32_const(b*4)),K=f.i32_const(t.alloc(b*2)),it=f.i32_const(t.alloc(b*2)),mt=f.i32_const(t.alloc(b*2)),pt=f.i32_const(t.alloc(b*2));_.addCode(f.call(w+"_mul",R,Z,K),f.call(w+"_mul",G,T,it),f.call(w+"_add",R,G,mt),f.call(w+"_add",R,P,pt),f.call(w+"_add",G,P,D),f.call(w+"_mul",D,T,D),f.call(w+"_sub",D,it,D),f.call(w+"_mulNR",D,D),f.call(w+"_add",D,K,D),f.call(w+"_add",Z,T,Y),f.call(w+"_mul",Y,mt,Y),f.call(w+"_sub",Y,K,Y),f.call(w+"_sub",Y,it,Y),f.call(w+"_mul",pt,Z,tt),f.call(w+"_sub",tt,K,tt),f.call(w+"_add",tt,it,tt))}yt();function ut(){let _=t.addFunction(V+"_mul014");_.addParam("pA","i32"),_.addParam("pC0","i32"),_.addParam("pC1","i32"),_.addParam("pC4","i32"),_.addParam("pR","i32");let f=_.getCodeBuilder(),R=f.getLocal("pA"),G=f.i32_add(f.getLocal("pA"),f.i32_const(b*6)),P=f.getLocal("pC0"),Z=f.getLocal("pC1"),T=f.getLocal("pC4"),D=f.i32_const(t.alloc(b*6)),Y=f.i32_const(t.alloc(b*6)),tt=f.i32_const(t.alloc(b*2)),K=f.getLocal("pR"),it=f.i32_add(f.getLocal("pR"),f.i32_const(b*6));_.addCode(f.call(j+"_mul01",R,P,Z,D),f.call(j+"_mul1",G,T,Y),f.call(w+"_add",Z,T,tt),f.call(j+"_add",G,R,it),f.call(j+"_mul01",it,P,tt,it),f.call(j+"_sub",it,D,it),f.call(j+"_sub",it,Y,it),f.call(j+"_copy",Y,K),f.call(j+"_mulNR",K,K),f.call(j+"_add",K,D,K))}ut();function lt(){let _=t.addFunction(a+"_ell");_.addParam("pP","i32"),_.addParam("pCoefs","i32"),_.addParam("pF","i32");let f=_.getCodeBuilder(),R=f.getLocal("pP"),G=f.i32_add(f.getLocal("pP"),f.i32_const(d)),P=f.getLocal("pF"),Z=f.getLocal("pCoefs"),T=f.i32_add(f.getLocal("pCoefs"),f.i32_const(b)),D=f.i32_add(f.getLocal("pCoefs"),f.i32_const(b*2)),Y=f.i32_add(f.getLocal("pCoefs"),f.i32_const(b*3)),tt=f.i32_add(f.getLocal("pCoefs"),f.i32_const(b*4)),K=t.alloc(b*2),it=f.i32_const(K),mt=f.i32_const(K),pt=f.i32_const(K+b),dt=t.alloc(b*2),Ct=f.i32_const(dt),xt=f.i32_const(dt),St=f.i32_const(dt+b);_.addCode(f.call(M+"_mul",Z,G,mt),f.call(M+"_mul",T,G,pt),f.call(M+"_mul",D,R,xt),f.call(M+"_mul",Y,R,St),f.call(V+"_mul014",P,tt,Ct,it,P))}lt();function bt(){let _=t.addFunction(a+"_millerLoop");_.addParam("ppreP","i32"),_.addParam("ppreQ","i32"),_.addParam("r","i32"),_.addLocal("pCoef","i32"),_.addLocal("i","i32");let f=_.getCodeBuilder(),R=f.getLocal("ppreP"),G=f.getLocal("pCoef"),P=f.getLocal("r");_.addCode(f.call(V+"_one",P),f.if(f.call(S+"_isZero",R),f.ret([])),f.if(f.call(S+"_isZero",f.getLocal("ppreQ")),f.ret([])),f.setLocal("pCoef",f.i32_add(f.getLocal("ppreQ"),f.i32_const(l*3))),f.setLocal("i",f.i32_const(Lt.length-2)),f.block(f.loop(f.call(a+"_ell",R,G,P),f.setLocal("pCoef",f.i32_add(f.getLocal("pCoef"),f.i32_const(ht))),f.if(f.i32_load8_s(f.getLocal("i"),rt),[...f.call(a+"_ell",R,G,P),...f.setLocal("pCoef",f.i32_add(f.getLocal("pCoef"),f.i32_const(ht)))]),f.call(V+"_square",P,P),f.br_if(1,f.i32_eq(f.getLocal("i"),f.i32_const(1))),f.setLocal("i",f.i32_sub(f.getLocal("i"),f.i32_const(1))),f.br(0))),f.call(a+"_ell",R,G,P)),_.addCode(f.call(V+"_conjugate",P,P))}function Et(_){let f=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n,151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n],[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n,877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n,3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n,3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n]]],R=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0n,4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[0n,1n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[0n,793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n]],[[1n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n]]],G=t.addFunction(V+"_frobeniusMap"+_);G.addParam("x","i32"),G.addParam("r","i32");let P=G.getCodeBuilder();for(let T=0;T<6;T++){let D=T==0?P.getLocal("x"):P.i32_add(P.getLocal("x"),P.i32_const(T*l)),Y=D,tt=P.i32_add(P.getLocal("x"),P.i32_const(T*l+b)),K=T==0?P.getLocal("r"):P.i32_add(P.getLocal("r"),P.i32_const(T*l)),it=K,mt=P.i32_add(P.getLocal("r"),P.i32_const(T*l+b)),pt=Z(f[Math.floor(T/3)][_%12],R[T%3][_%6]),dt=t.alloc([...Vt.bigInt2BytesLE(F(pt[0]),d),...Vt.bigInt2BytesLE(F(pt[1]),d)]);_%2==1?G.addCode(P.call(M+"_copy",Y,it),P.call(M+"_neg",tt,mt),P.call(w+"_mul",K,P.i32_const(dt),K)):G.addCode(P.call(w+"_mul",D,P.i32_const(dt),K))}function Z(T,D){let Y=T[0],tt=T[1],K=D[0],it=D[1],mt=[(Y*K-tt*it)%o,(Y*it+tt*K)%o];return WL(mt[0])&&(mt[0]=mt[0]+o),mt}}function It(){let _=t.addFunction(a+"__cyclotomicSquare");_.addParam("x","i32"),_.addParam("r","i32");let f=_.getCodeBuilder(),R=f.getLocal("x"),G=f.i32_add(f.getLocal("x"),f.i32_const(l)),P=f.i32_add(f.getLocal("x"),f.i32_const(2*l)),Z=f.i32_add(f.getLocal("x"),f.i32_const(3*l)),T=f.i32_add(f.getLocal("x"),f.i32_const(4*l)),D=f.i32_add(f.getLocal("x"),f.i32_const(5*l)),Y=f.getLocal("r"),tt=f.i32_add(f.getLocal("r"),f.i32_const(l)),K=f.i32_add(f.getLocal("r"),f.i32_const(2*l)),it=f.i32_add(f.getLocal("r"),f.i32_const(3*l)),mt=f.i32_add(f.getLocal("r"),f.i32_const(4*l)),pt=f.i32_add(f.getLocal("r"),f.i32_const(5*l)),dt=f.i32_const(t.alloc(l)),Ct=f.i32_const(t.alloc(l)),xt=f.i32_const(t.alloc(l)),St=f.i32_const(t.alloc(l)),Bt=f.i32_const(t.alloc(l)),At=f.i32_const(t.alloc(l)),wt=f.i32_const(t.alloc(l)),Ot=f.i32_const(t.alloc(l));_.addCode(f.call(w+"_mul",R,T,wt),f.call(w+"_mulNR",T,dt),f.call(w+"_add",R,dt,dt),f.call(w+"_add",R,T,Ot),f.call(w+"_mul",Ot,dt,dt),f.call(w+"_mulNR",wt,Ot),f.call(w+"_add",wt,Ot,Ot),f.call(w+"_sub",dt,Ot,dt),f.call(w+"_add",wt,wt,Ct),f.call(w+"_mul",Z,P,wt),f.call(w+"_mulNR",P,xt),f.call(w+"_add",Z,xt,xt),f.call(w+"_add",Z,P,Ot),f.call(w+"_mul",Ot,xt,xt),f.call(w+"_mulNR",wt,Ot),f.call(w+"_add",wt,Ot,Ot),f.call(w+"_sub",xt,Ot,xt),f.call(w+"_add",wt,wt,St),f.call(w+"_mul",G,D,wt),f.call(w+"_mulNR",D,Bt),f.call(w+"_add",G,Bt,Bt),f.call(w+"_add",G,D,Ot),f.call(w+"_mul",Ot,Bt,Bt),f.call(w+"_mulNR",wt,Ot),f.call(w+"_add",wt,Ot,Ot),f.call(w+"_sub",Bt,Ot,Bt),f.call(w+"_add",wt,wt,At),f.call(w+"_sub",dt,R,Y),f.call(w+"_add",Y,Y,Y),f.call(w+"_add",dt,Y,Y),f.call(w+"_add",Ct,T,mt),f.call(w+"_add",mt,mt,mt),f.call(w+"_add",Ct,mt,mt),f.call(w+"_mul",At,f.i32_const(nt),Ot),f.call(w+"_add",Ot,Z,it),f.call(w+"_add",it,it,it),f.call(w+"_add",Ot,it,it),f.call(w+"_sub",Bt,P,K),f.call(w+"_add",K,K,K),f.call(w+"_add",Bt,K,K),f.call(w+"_sub",xt,G,tt),f.call(w+"_add",tt,tt,tt),f.call(w+"_add",xt,tt,tt),f.call(w+"_add",St,D,pt),f.call(w+"_add",pt,pt,pt),f.call(w+"_add",St,pt,pt))}function zt(_,f,R){let G=U(_).map(K=>K==-1?255:K),P=t.alloc(G),Z=t.addFunction(a+"__cyclotomicExp_"+R);Z.addParam("x","i32"),Z.addParam("r","i32"),Z.addLocal("bit","i32"),Z.addLocal("i","i32");let T=Z.getCodeBuilder(),D=T.getLocal("x"),Y=T.getLocal("r"),tt=T.i32_const(t.alloc(s));Z.addCode(T.call(V+"_conjugate",D,tt),T.call(V+"_one",Y),T.if(T.teeLocal("bit",T.i32_load8_s(T.i32_const(G.length-1),P)),T.if(T.i32_eq(T.getLocal("bit"),T.i32_const(1)),T.call(V+"_mul",Y,D,Y),T.call(V+"_mul",Y,tt,Y))),T.setLocal("i",T.i32_const(G.length-2)),T.block(T.loop(T.call(a+"__cyclotomicSquare",Y,Y),T.if(T.teeLocal("bit",T.i32_load8_s(T.getLocal("i"),P)),T.if(T.i32_eq(T.getLocal("bit"),T.i32_const(1)),T.call(V+"_mul",Y,D,Y),T.call(V+"_mul",Y,tt,Y))),T.br_if(1,T.i32_eqz(T.getLocal("i"))),T.setLocal("i",T.i32_sub(T.getLocal("i"),T.i32_const(1))),T.br(0)))),f&&Z.addCode(T.call(V+"_conjugate",Y,Y))}function Mt(){It(),zt(g,E,"w0");let _=t.addFunction(a+"_finalExponentiation");_.addParam("x","i32"),_.addParam("r","i32");let f=_.getCodeBuilder(),R=f.getLocal("x"),G=f.getLocal("r"),P=f.i32_const(t.alloc(s)),Z=f.i32_const(t.alloc(s)),T=f.i32_const(t.alloc(s)),D=f.i32_const(t.alloc(s)),Y=f.i32_const(t.alloc(s)),tt=f.i32_const(t.alloc(s)),K=f.i32_const(t.alloc(s));_.addCode(f.call(V+"_frobeniusMap6",R,P),f.call(V+"_inverse",R,Z),f.call(V+"_mul",P,Z,T),f.call(V+"_copy",T,Z),f.call(V+"_frobeniusMap2",T,T),f.call(V+"_mul",T,Z,T),f.call(a+"__cyclotomicSquare",T,Z),f.call(V+"_conjugate",Z,Z),f.call(a+"__cyclotomicExp_w0",T,D),f.call(a+"__cyclotomicSquare",D,Y),f.call(V+"_mul",Z,D,tt),f.call(a+"__cyclotomicExp_w0",tt,Z),f.call(a+"__cyclotomicExp_w0",Z,P),f.call(a+"__cyclotomicExp_w0",P,K),f.call(V+"_mul",K,Y,K),f.call(a+"__cyclotomicExp_w0",K,Y),f.call(V+"_conjugate",tt,tt),f.call(V+"_mul",Y,tt,Y),f.call(V+"_mul",Y,T,Y),f.call(V+"_conjugate",T,tt),f.call(V+"_mul",Z,T,Z),f.call(V+"_frobeniusMap3",Z,Z),f.call(V+"_mul",K,tt,K),f.call(V+"_frobeniusMap1",K,K),f.call(V+"_mul",D,P,D),f.call(V+"_frobeniusMap2",D,D),f.call(V+"_mul",D,Z,D),f.call(V+"_mul",D,K,D),f.call(V+"_mul",D,Y,G))}function kt(){let _=t.addFunction(a+"_finalExponentiationOld");_.addParam("x","i32"),_.addParam("r","i32");let R=t.alloc(Vt.bigInt2BytesLE(322277361516934140462891564586510139908379969514828494218366688025288661041104682794998680497580008899973249814104447692778988208376779573819485263026159588510513834876303014016798809919343532899164848730280942609956670917565618115867287399623286813270357901731510188149934363360381614501334086825442271920079363289954510565375378443704372994881406797882676971082200626541916413184642520269678897559532260949334760604962086348898118982248842634379637598665468817769075878555493752214492790122785850202957575200176084204422751485957336465472324810982833638490904279282696134323072515220044451592646885410572234451732790590013479358343841220074174848221722017083597872017638514103174122784843925578370430843522959600095676285723737049438346544753168912974976791528535276317256904336520179281145394686565050419250614107803233314658825463117900250701199181529205942363159325765991819433914303908860460720581408201373164047773794825411011922305820065611121544561808414055302212057471395719432072209245600258134364584636810093520285711072578721435517884103526483832733289802426157301542744476740008494780363354305116978805620671467071400711358839553375340724899735460480144599782014906586543813292157922220645089192130209334926661588737007768565838519456601560804957985667880395221049249803753582637708560n,544)),G=_.getCodeBuilder();_.addCode(G.call(V+"_exp",G.getLocal("x"),G.i32_const(R),G.i32_const(544),G.getLocal("r")))}let Pt=t.alloc(r),qt=t.alloc(z);function Rt(_){let f=t.addFunction(a+"_pairingEq"+_);for(let Z=0;Z<_;Z++)f.addParam("p_"+Z,"i32"),f.addParam("q_"+Z,"i32");f.addParam("c","i32"),f.setReturnType("i32");let R=f.getCodeBuilder(),G=R.i32_const(t.alloc(s)),P=R.i32_const(t.alloc(s));f.addCode(R.call(V+"_one",G));for(let Z=0;Z<_;Z++)f.addCode(R.call(a+"_prepareG1",R.getLocal("p_"+Z),R.i32_const(Pt))),f.addCode(R.call(a+"_prepareG2",R.getLocal("q_"+Z),R.i32_const(qt))),f.addCode(R.if(R.i32_eqz(R.call(S+"_inGroupAffine",R.i32_const(Pt))),R.ret(R.i32_const(0))),R.if(R.i32_eqz(R.call(O+"_inGroupAffine",R.i32_const(qt))),R.ret(R.i32_const(0)))),f.addCode(R.call(a+"_millerLoop",R.i32_const(Pt),R.i32_const(qt),P)),f.addCode(R.call(V+"_mul",G,P,G));f.addCode(R.call(a+"_finalExponentiation",G,G)),f.addCode(R.call(V+"_eq",G,R.getLocal("c")))}function Kt(){let _=t.addFunction(a+"_pairing");_.addParam("p","i32"),_.addParam("q","i32"),_.addParam("r","i32");let f=_.getCodeBuilder(),R=f.i32_const(t.alloc(s));_.addCode(f.call(a+"_prepareG1",f.getLocal("p"),f.i32_const(Pt))),_.addCode(f.call(a+"_prepareG2",f.getLocal("q"),f.i32_const(qt))),_.addCode(f.call(a+"_millerLoop",f.i32_const(Pt),f.i32_const(qt),R)),_.addCode(f.call(a+"_finalExponentiation",R,f.getLocal("r")))}function Ut(){let _=t.addFunction(O+"_inGroupAffine");_.addParam("p","i32"),_.setReturnType("i32");let f=_.getCodeBuilder(),R=[2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279894n,2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279893n],G=4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,P=[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],Z=f.i32_const(t.alloc([...Vt.bigInt2BytesLE(F(R[0]),d),...Vt.bigInt2BytesLE(F(R[1]),d)])),T=f.i32_const(t.alloc(Vt.bigInt2BytesLE(F(G),d))),D=f.i32_const(t.alloc([...Vt.bigInt2BytesLE(F(P[0]),d),...Vt.bigInt2BytesLE(F(P[1]),d)])),Y=f.i32_const(t.alloc(Vt.bigInt2BytesLE(g,8))),tt=f.getLocal("p"),K=f.i32_add(f.getLocal("p"),f.i32_const(l)),it=f.i32_const(t.alloc(b)),mt=f.i32_const(t.alloc(l)),pt=f.i32_const(t.alloc(l)),dt=t.alloc(l*2),Ct=f.i32_const(dt),xt=f.i32_const(dt),St=f.i32_const(dt),Bt=f.i32_const(dt+b),At=f.i32_const(dt+l),wt=f.i32_const(dt+l),Ot=f.i32_const(dt+l+b),Jt=t.alloc(l*3),cn=f.i32_const(Jt),oo=f.i32_const(Jt),Nn=f.i32_const(Jt),$n=f.i32_const(Jt+b),io=f.i32_const(Jt+l),Zn=f.i32_const(Jt+l),jn=f.i32_const(Jt+l+b),eo=f.i32_const(Jt+l*2);_.addCode(f.if(f.call(O+"_isZeroAffine",f.getLocal("p")),f.ret(f.i32_const(1))),f.if(f.i32_eqz(f.call(O+"_inCurveAffine",f.getLocal("p"))),f.ret(f.i32_const(0))),f.call(w+"_mul",tt,Z,mt),f.call(w+"_mul",K,Z,pt),f.call(w+"_mul1",mt,T,xt),f.call(w+"_neg",pt,At),f.call(w+"_neg",mt,oo),f.call(w+"_mul",pt,D,io),f.call(M+"_sub",St,Bt,it),f.call(M+"_add",St,Bt,Bt),f.call(M+"_copy",it,St),f.call(M+"_sub",wt,Ot,it),f.call(M+"_add",wt,Ot,Ot),f.call(M+"_copy",it,wt),f.call(M+"_add",Nn,$n,it),f.call(M+"_sub",Nn,$n,$n),f.call(M+"_copy",it,Nn),f.call(M+"_sub",jn,Zn,it),f.call(M+"_add",Zn,jn,jn),f.call(M+"_copy",it,Zn),f.call(w+"_one",eo),f.call(O+"_timesScalar",cn,Y,f.i32_const(8),cn),f.call(O+"_addMixed",cn,Ct,cn),f.ret(f.call(O+"_eqMixed",cn,f.getLocal("p"))));let An=t.addFunction(O+"_inGroup");An.addParam("pIn","i32"),An.setReturnType("i32");let fn=An.getCodeBuilder(),da=fn.i32_const(t.alloc(l*2));An.addCode(fn.call(O+"_toAffine",fn.getLocal("pIn"),da),fn.ret(fn.call(O+"_inGroupAffine",da)))}function X(){let _=t.addFunction(S+"_inGroupAffine");_.addParam("p","i32"),_.setReturnType("i32");let f=_.getCodeBuilder(),R=4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,G=793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,P=(g*g-1n)/3n,Z=f.i32_const(t.alloc(Vt.bigInt2BytesLE(F(R),d))),T=f.i32_const(t.alloc(Vt.bigInt2BytesLE(F(G),d))),D=f.i32_const(t.alloc(Vt.bigInt2BytesLE(P,16))),Y=f.getLocal("p"),tt=f.i32_add(f.getLocal("p"),f.i32_const(b)),K=t.alloc(b*3),it=f.i32_const(K),mt=f.i32_const(K),pt=f.i32_const(K+b),dt=t.alloc(b*2),Ct=f.i32_const(dt),xt=f.i32_const(dt),St=f.i32_const(dt+b);_.addCode(f.if(f.call(S+"_isZeroAffine",f.getLocal("p")),f.ret(f.i32_const(1))),f.if(f.i32_eqz(f.call(S+"_inCurveAffine",f.getLocal("p"))),f.ret(f.i32_const(0))),f.call(M+"_mul",Y,Z,mt),f.call(M+"_copy",tt,pt),f.call(M+"_mul",Y,T,xt),f.call(M+"_copy",tt,St),f.call(S+"_doubleAffine",it,it),f.call(S+"_subMixed",it,f.getLocal("p"),it),f.call(S+"_subMixed",it,Ct,it),f.call(S+"_timesScalar",it,D,f.i32_const(16),it),f.ret(f.call(S+"_eqMixed",it,Ct)));let Bt=t.addFunction(S+"_inGroup");Bt.addParam("pIn","i32"),Bt.setReturnType("i32");let At=Bt.getCodeBuilder(),wt=At.i32_const(t.alloc(b*2));Bt.addCode(At.call(S+"_toAffine",At.getLocal("pIn"),wt),At.ret(At.call(S+"_inGroupAffine",wt)))}for(let _=0;_<10;_++)Et(_),t.exportFunction(V+"_frobeniusMap"+_);X(),Ut(),ft(),ct(),et(),_t(),bt(),kt(),Mt();for(let _=1;_<=5;_++)Rt(_),t.exportFunction(a+"_pairingEq"+_);Kt(),t.exportFunction(a+"_pairing"),t.exportFunction(a+"_prepareG1"),t.exportFunction(a+"_prepareG2"),t.exportFunction(a+"_millerLoop"),t.exportFunction(a+"_finalExponentiation"),t.exportFunction(a+"_finalExponentiationOld"),t.exportFunction(a+"__cyclotomicSquare"),t.exportFunction(a+"__cyclotomicExp_w0"),t.exportFunction(j+"_mul1"),t.exportFunction(j+"_mul01"),t.exportFunction(V+"_mul014"),t.exportFunction(S+"_inGroupAffine"),t.exportFunction(S+"_inGroup"),t.exportFunction(O+"_inGroupAffine"),t.exportFunction(O+"_inGroup")},XL=UL,HL=QL;vi=[];for(let c=0;c<256;c++)vi[c]=YL(c,8);tp=Object.freeze({__proto__:null,array2buffer:Kl,beBuff2int:DL,beInt2Buff:KL,bitReverse:p_,buffReverseBits:b_,buffer2array:cc,leBuff2int:JL,leInt2Buff:L_,log2:Yn,stringifyBigInts:Ol,stringifyFElements:Ml,unstringifyBigInts:Pl,unstringifyFElements:Rl}),Pn=1<<30,Ln=class c{constructor(t){this.buffers=[],this.byteLength=t;for(let n=0;n<t;n+=Pn){let a=Math.min(t-n,Pn);this.buffers.push(new Uint8Array(a))}}slice(t,n){n===void 0&&(n=this.byteLength),t===void 0&&(t=0);let a=n-t,o=Math.floor(t/Pn),e=Math.floor((t+a-1)/Pn);if(o==e||a==0)return this.buffers[o].slice(t%Pn,t%Pn+a);let h,d=o,b=t%Pn,l=a;for(;l>0;){let s=b+l>Pn?Pn-b:l,m=new Uint8Array(this.buffers[d].buffer,this.buffers[d].byteOffset+b,s);if(s==a)return m.slice();h||(a<=Pn?h=new Uint8Array(a):h=new c(a)),h.set(m,a-l),l=l-s,d++,b=0}return h}set(t,n){n===void 0&&(n=0);let a=t.byteLength;if(a==0)return;let o=Math.floor(n/Pn),e=Math.floor((n+a-1)/Pn);if(o==e)return t instanceof c&&t.buffers.length==1?this.buffers[o].set(t.buffers[0],n%Pn):this.buffers[o].set(t,n%Pn);let h=o,d=n%Pn,b=a;for(;b>0;){let l=d+b>Pn?Pn-d:b,s=t.slice(a-b,a-b+l);new Uint8Array(this.buffers[h].buffer,this.buffers[h].byteOffset+d,l).set(s),b=b-l,h++,d=0}}};sc=class{constructor(t,n,a,o){if(this.tm=t,this.prefix=n,this.p=o,this.n8=a,this.type="F1",this.m=1,this.half=vo(o,uo),this.bitLength=Ii(o),this.mask=Ia(tc(uo,this.bitLength),uo),this.pOp1=t.alloc(a),this.pOp2=t.alloc(a),this.pOp3=t.alloc(a),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(a/8),this.n32=Math.floor(a/4),this.n64*8!=this.n8)throw new Error("n8 must be a multiple of 8");this.half=vo(this.p,uo),this.nqr=this.two;let e=this.exp(this.nqr,this.half);for(;!this.eq(e,this.negone);)this.nqr=this.add(this.nqr,this.one),e=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let h=Ia(this.p,uo);for(;!$l(h);)this.s=this.s+1,h=vo(h,uo);this.w=[],this.w[this.s]=this.exp(this.nqr,h);for(let d=this.s-1;d>=0;d--)this.w[d]=this.square(this.w[d+1]);if(!this.eq(this.w[0],this.one))throw new Error("Error calculating roots of unity");this.batchToMontgomery=Za(t,n+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=Za(t,n+"_batchFromMontgomery",this.n8,this.n8)}op2(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){return this.op2("_add",t,n)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=qo(yn(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,n){if(t instanceof Uint8Array)return t;let a=yn(t,n);ju(a)?(a=Xu(a),nc(a,this.p)&&(a=ya(a,this.p)),a=Ia(this.p,a)):nc(a,this.p)&&(a=ya(a,this.p));let o=L_(a,this.n8);return this.toMontgomery(o)}toString(t,n){let a=this.fromMontgomery(t),o=qi(a,0);return fc(o,n)}fromRng(t){let n,a=new Uint8Array(this.n8);do{n=Yu;for(let o=0;o<this.n64;o++)n=Zl(n,tc(t.nextU64(),64*o));n=jl(n,this.mask)}while(Du(n,this.p));return Si(a,0,n,this.n8),a}random(){return this.fromRng(Vl())}toObject(t){let n=this.fromMontgomery(t);return qi(n,0)}fromObject(t){let n=new Uint8Array(this.n8);return Si(n,0,t,this.n8),this.toMontgomery(n)}toRprLE(t,n,a){t.set(this.fromMontgomery(a),n)}toRprBE(t,n,a){let o=this.fromMontgomery(a);for(let e=0;e<this.n8/2;e++){let h=o[e];o[e]=o[this.n8-1-e],o[this.n8-1-e]=h}t.set(o,n)}fromRprLE(t,n){n=n||0;let a=t.slice(n,n+this.n8);return this.toMontgomery(a)}async batchInverse(t){let n=!1,a=this.n8,o=this.n8;Array.isArray(t)?(t=Kl(t,a),n=!0):t=t.slice(0,t.byteLength);let e=Math.floor(t.byteLength/a);if(e*a!==t.byteLength)throw new Error("Invalid buffer size");let h=Math.floor(e/this.tm.concurrency),d=[];for(let m=0;m<this.tm.concurrency;m++){let B;if(m<this.tm.concurrency-1?B=h:B=e-m*h,B==0)continue;let v=[{cmd:"ALLOCSET",var:0,buff:t.slice(m*h*a,m*h*a+B*a)},{cmd:"ALLOC",var:1,len:o*B},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:a},{val:B},{var:1},{val:o}]},{cmd:"GET",out:0,var:1,len:o*B}];d.push(this.tm.queueAction(v))}let b=await Promise.all(d),l;t instanceof Ln?l=new Ln(e*o):l=new Uint8Array(e*o);let s=0;for(let m=0;m<b.length;m++)l.set(b[m][0],s),s+=b[m][0].byteLength;return n?cc(l,o):l}},lc=class{constructor(t,n,a){this.tm=t,this.prefix=n,this.F=a,this.type="F2",this.m=a.m*2,this.n8=this.F.n8*2,this.n32=this.F.n32*2,this.n64=this.F.n64*2,this.pOp1=t.alloc(a.n8*2),this.pOp2=t.alloc(a.n8*2),this.pOp3=t.alloc(a.n8*2),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){return this.op2("_add",t,n)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}mul1(t,n){return this.op2("_mul1",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=qo(yn(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,n){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&t.length==2){let a=this.F.e(t[0],n),o=this.F.e(t[1],n),e=new Uint8Array(this.F.n8*2);return e.set(a),e.set(o,this.F.n8*2),e}else throw new Error("invalid F2")}toString(t,n){let a=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8),n);return`[${a}, ${o}]`}fromRng(t){let n=this.F.fromRng(t),a=this.F.fromRng(t),o=new Uint8Array(this.F.n8*2);return o.set(n),o.set(a,this.F.n8),o}random(){return this.fromRng(Vl())}toObject(t){let n=this.F.toObject(t.slice(0,this.F.n8)),a=this.F.toObject(t.slice(this.F.n8,this.F.n8*2));return[n,a]}fromObject(t){let n=new Uint8Array(this.F.n8*2),a=this.F.fromObject(t[0]),o=this.F.fromObject(t[1]);return n.set(a),n.set(o,this.F.n8),n}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}},zl=class{constructor(t,n,a){this.tm=t,this.prefix=n,this.F=a,this.type="F3",this.m=a.m*3,this.n8=this.F.n8*3,this.n32=this.F.n32*3,this.n64=this.F.n64*3,this.pOp1=t.alloc(a.n8*3),this.pOp2=t.alloc(a.n8*3),this.pOp3=t.alloc(a.n8*3),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}add(t,n){return this.op2("_add",t,n)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=qo(yn(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,n){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&t.length==3){let a=this.F.e(t[0],n),o=this.F.e(t[1],n),e=this.F.e(t[2],n),h=new Uint8Array(this.F.n8*3);return h.set(a),h.set(o,this.F.n8),h.set(e,this.F.n8*2),h}else throw new Error("invalid F3")}toString(t,n){let a=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8,this.F.n8*2),n),e=this.F.toString(t.slice(this.F.n8*2),n);return`[${a}, ${o}, ${e}]`}fromRng(t){let n=this.F.fromRng(t),a=this.F.fromRng(t),o=this.F.fromRng(t),e=new Uint8Array(this.F.n8*3);return e.set(n),e.set(a,this.F.n8),e.set(o,this.F.n8*2),e}random(){return this.fromRng(Vl())}toObject(t){let n=this.F.toObject(t.slice(0,this.F.n8)),a=this.F.toObject(t.slice(this.F.n8,this.F.n8*2)),o=this.F.toObject(t.slice(this.F.n8*2,this.F.n8*3));return[n,a,o]}fromObject(t){let n=new Uint8Array(this.F.n8*3),a=this.F.fromObject(t[0]),o=this.F.fromObject(t[1]),e=this.F.fromObject(t[2]);return n.set(a),n.set(o,this.F.n8),n.set(e,this.F.n8*2),n}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,this.F.n8*2)}c3(t){return t.slice(this.F.n8*2)}},rc=class{constructor(t,n,a,o,e,h){this.tm=t,this.prefix=n,this.F=a,this.pOp1=t.alloc(a.n8*3),this.pOp2=t.alloc(a.n8*3),this.pOp3=t.alloc(a.n8*3),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,a.n8*3),this.tm.instance.exports[n+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,a.n8*2),this.one=this.tm.getBuff(o,a.n8*3),this.g=this.one,this.oneAffine=this.tm.getBuff(o,a.n8*2),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(e,a.n8),h&&(this.cofactor=qo(h)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=Za(t,n+"_batchLEMtoC",a.n8*2,a.n8),this.batchLEMtoU=Za(t,n+"_batchLEMtoU",a.n8*2,a.n8*2),this.batchCtoLEM=Za(t,n+"_batchCtoLEM",a.n8,a.n8*2),this.batchUtoLEM=Za(t,n+"_batchUtoLEM",a.n8*2,a.n8*2),this.batchToJacobian=Za(t,n+"_batchToJacobian",a.n8*2,a.n8*3),this.batchToAffine=Za(t,n+"_batchToAffine",a.n8*3,a.n8*2)}op2(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}op2bool(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}op1Affine(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*2)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2("_add",t,n);if(n.byteLength==this.F.n8*2)return this.op2("_addMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2("_addMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2("_addAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}sub(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2("_sub",t,n);if(n.byteLength==this.F.n8*2)return this.op2("_subMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2("_subMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2("_subAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}neg(t){if(t.byteLength==this.F.n8*3)return this.op1("_neg",t);if(t.byteLength==this.F.n8*2)return this.op1Affine("_negAffine",t);throw new Error("invalid point size")}double(t){if(t.byteLength==this.F.n8*3)return this.op1("_double",t);if(t.byteLength==this.F.n8*2)return this.op1("_doubleAffine",t);throw new Error("invalid point size")}isZero(t){if(t.byteLength==this.F.n8*3)return this.op1Bool("_isZero",t);if(t.byteLength==this.F.n8*2)return this.op1Bool("_isZeroAffine",t);throw new Error("invalid point size")}timesScalar(t,n){n instanceof Uint8Array||(n=qo(yn(n)));let a;if(t.byteLength==this.F.n8*3)a=this.prefix+"_timesScalar";else if(t.byteLength==this.F.n8*2)a=this.prefix+"_timesScalarAffine";else throw new Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[a](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}timesFr(t,n){let a;if(t.byteLength==this.F.n8*3)a=this.prefix+"_timesFr";else if(t.byteLength==this.F.n8*2)a=this.prefix+"_timesFrAffine";else throw new Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[a](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}eq(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2bool("_eq",t,n);if(n.byteLength==this.F.n8*2)return this.op2bool("_eqMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2bool("_eqMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2bool("_eqAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}toAffine(t){if(t.byteLength==this.F.n8*3)return this.op1Affine("_toAffine",t);if(t.byteLength==this.F.n8*2)return t;throw new Error("invalid point size")}toJacobian(t){if(t.byteLength==this.F.n8*3)return t;if(t.byteLength==this.F.n8*2)return this.op1("_toJacobian",t);throw new Error("invalid point size")}toRprUncompressed(t,n,a){if(this.tm.setBuff(this.pOp1,a),a.byteLength==this.F.n8*3)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(a.byteLength!=this.F.n8*2)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);let o=this.tm.getBuff(this.pOp1,this.F.n8*2);t.set(o,n)}fromRprUncompressed(t,n){let a=t.slice(n,n+this.F.n8*2);return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,this.F.n8*2)}toRprCompressed(t,n,a){if(this.tm.setBuff(this.pOp1,a),a.byteLength==this.F.n8*3)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(a.byteLength!=this.F.n8*2)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);let o=this.tm.getBuff(this.pOp1,this.F.n8);t.set(o,n)}fromRprCompressed(t,n){let a=t.slice(n,n+this.F.n8);return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,this.F.n8*2)}toUncompressed(t){let n=new Uint8Array(this.F.n8*2);return this.toRprUncompressed(n,0,t),n}toRprLEM(t,n,a){if(a.byteLength==this.F.n8*2){t.set(a,n);return}else if(a.byteLength==this.F.n8*3){this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);let o=this.tm.getBuff(this.pOp1,this.F.n8*2);t.set(o,n)}else throw new Error("invalid point size")}fromRprLEM(t,n){return n=n||0,t.slice(n,n+this.F.n8*2)}toString(t,n){if(t.byteLength==this.F.n8*3){let a=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8,this.F.n8*2),n),e=this.F.toString(t.slice(this.F.n8*2),n);return`[ ${a}, ${o}, ${e} ]`}else if(t.byteLength==this.F.n8*2){let a=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8),n);return`[ ${a}, ${o} ]`}else throw new Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;let n=this.F,a=this.toAffine(t),o=a.slice(0,this.F.n8),e=a.slice(this.F.n8,this.F.n8*2),h=n.add(n.mul(n.square(o),o),this.b),d=n.square(e);return n.eq(h,d)}fromRng(t){let n=this.F,a=[],o,e;do a[0]=n.fromRng(t),o=t.nextBool(),e=n.add(n.mul(n.square(a[0]),a[0]),this.b);while(!n.isSquare(e));a[1]=n.sqrt(e);let h=n.isNegative(a[1]);o^h&&(a[1]=n.neg(a[1]));let d=new Uint8Array(this.F.n8*2);return d.set(a[0]),d.set(a[1],this.F.n8),this.cofactor&&(d=this.timesScalar(d,this.cofactor)),d}toObject(t){if(this.isZero(t))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];let n=this.F.toObject(t.slice(0,this.F.n8)),a=this.F.toObject(t.slice(this.F.n8,this.F.n8*2)),o;return t.byteLength==this.F.n8*3?o=this.F.toObject(t.slice(this.F.n8*2,this.F.n8*3)):o=this.F.toObject(this.F.one),[n,a,o]}fromObject(t){let n=this.F.fromObject(t[0]),a=this.F.fromObject(t[1]),o;if(t.length==3?o=this.F.fromObject(t[2]):o=this.F.one,this.F.isZero(o,this.F.one))return this.zeroAffine;if(this.F.eq(o,this.F.one)){let e=new Uint8Array(this.F.n8*2);return e.set(n),e.set(a,this.F.n8),e}else{let e=new Uint8Array(this.F.n8*3);return e.set(n),e.set(a,this.F.n8),e.set(o,this.F.n8*2),e}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){return this.toAffine(t).slice(0,this.F.n8)}y(t){return this.toAffine(t).slice(this.F.n8)}};wl=25,dc=class{constructor(){this.promise=new Promise((t,n)=>{this.reject=n,this.resolve=t})}};Uu=`(function thread(self) {
    const MAXMEM = 32767;
    let instance;
    let memory;

    if (self) {
        self.onmessage = function(e) {
            let data;
            if (e.data) {
                data = e.data;
            } else {
                data = e;
            }

            if (data[0].cmd == "INIT") {
                init(data[0]).then(function() {
                    self.postMessage(data.result);
                });
            } else if (data[0].cmd == "TERMINATE") {
                self.close();
            } else {
                const res = runTask(data);
                self.postMessage(res);
            }
        };
    }

    async function init(data) {
        const code = new Uint8Array(data.code);
        const wasmModule = await WebAssembly.compile(code);
        memory = new WebAssembly.Memory({initial:data.init, maximum: MAXMEM});

        instance = await WebAssembly.instantiate(wasmModule, {
            env: {
                "memory": memory
            }
        });
    }



    function alloc(length) {
        const u32 = new Uint32Array(memory.buffer, 0, 1);
        while (u32[0] & 3) u32[0]++;  // Return always aligned pointers
        const res = u32[0];
        u32[0] += length;
        if (u32[0] + length > memory.buffer.byteLength) {
            const currentPages = memory.buffer.byteLength / 0x10000;
            let requiredPages = Math.floor((u32[0] + length) / 0x10000)+1;
            if (requiredPages>MAXMEM) requiredPages=MAXMEM;
            memory.grow(requiredPages-currentPages);
        }
        return res;
    }

    function allocBuffer(buffer) {
        const p = alloc(buffer.byteLength);
        setBuffer(p, buffer);
        return p;
    }

    function getBuffer(pointer, length) {
        const u8 = new Uint8Array(memory.buffer);
        return new Uint8Array(u8.buffer, u8.byteOffset + pointer, length);
    }

    function setBuffer(pointer, buffer) {
        const u8 = new Uint8Array(memory.buffer);
        u8.set(new Uint8Array(buffer), pointer);
    }

    function runTask(task) {
        if (task[0].cmd == "INIT") {
            return init(task[0]);
        }
        const ctx = {
            vars: [],
            out: []
        };
        const u32a = new Uint32Array(memory.buffer, 0, 1);
        const oldAlloc = u32a[0];
        for (let i=0; i<task.length; i++) {
            switch (task[i].cmd) {
            case "ALLOCSET":
                ctx.vars[task[i].var] = allocBuffer(task[i].buff);
                break;
            case "ALLOC":
                ctx.vars[task[i].var] = alloc(task[i].len);
                break;
            case "SET":
                setBuffer(ctx.vars[task[i].var], task[i].buff);
                break;
            case "CALL": {
                const params = [];
                for (let j=0; j<task[i].params.length; j++) {
                    const p = task[i].params[j];
                    if (typeof p.var !== "undefined") {
                        params.push(ctx.vars[p.var] + (p.offset || 0));
                    } else if (typeof p.val != "undefined") {
                        params.push(p.val);
                    }
                }
                instance.exports[task[i].fnName](...params);
                break;
            }
            case "GET":
                ctx.out[task[i].out] = getBuffer(ctx.vars[task[i].var], task[i].len).slice();
                break;
            default:
                throw new Error("Invalid cmd");
            }
        }
        const u32b = new Uint32Array(memory.buffer, 0, 1);
        u32b[0] = oldAlloc;
        return ctx.out;
    }


    return runTask;
})(self)`;if(globalThis?.Blob){let c=new TextEncoder().encode(Uu),t=new Blob([c],{type:"application/javascript"});Tl=URL.createObjectURL(t)}else Tl="data:application/javascript;base64,"+globalThis.btoa(Uu);Gl=class{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(this.oldPFree!=0)throw new Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(this.oldPFree==0)throw new Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,n,a,o){if(this.working[t])throw new Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=o||new dc,this.workers[t].postMessage(n,a),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(this.working[t]==!1){let n=this.actionQueue.shift();this.postAction(t,n.data,n.transfers,n.deferred)}}queueAction(t,n){let a=new dc;if(this.singleThread){let o=this.taskManager(t);a.resolve(o)}else this.actionQueue.push({data:t,transfers:n,deferred:a}),this.processWorks();return a.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){let n=this.alloc(t.byteLength);return this.setBuff(n,t),n}getBuff(t,n){return this.u8.slice(t,t+n)}setBuff(t,n){this.u8.set(new Uint8Array(n),t)}alloc(t){for(;this.u32[0]&3;)this.u32[0]++;let n=this.u32[0];return this.u32[0]+=t,n}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);await ap(200)}};Nu=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];Ul=class{constructor(t){this.func=t,this.functionName=t.functionName,this.module=t.module}setLocal(t,n){let a=this.func.localIdxByName[t];if(a===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...n,33,...Wt(a)]}teeLocal(t,n){let a=this.func.localIdxByName[t];if(a===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...n,34,...Wt(a)]}getLocal(t){let n=this.func.localIdxByName[t];if(n===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[32,...Wt(n)]}i64_load8_s(t,n,a){let o=n||0,e=a===void 0?0:a;return[...t,48,e,...Wt(o)]}i64_load8_u(t,n,a){let o=n||0,e=a===void 0?0:a;return[...t,49,e,...Wt(o)]}i64_load16_s(t,n,a){let o=n||0,e=a===void 0?1:a;return[...t,50,e,...Wt(o)]}i64_load16_u(t,n,a){let o=n||0,e=a===void 0?1:a;return[...t,51,e,...Wt(o)]}i64_load32_s(t,n,a){let o=n||0,e=a===void 0?2:a;return[...t,52,e,...Wt(o)]}i64_load32_u(t,n,a){let o=n||0,e=a===void 0?2:a;return[...t,53,e,...Wt(o)]}i64_load(t,n,a){let o=n||0,e=a===void 0?3:a;return[...t,41,e,...Wt(o)]}i64_store(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=3,d=n):Array.isArray(a)?(e=n,h=3,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,55,h,...Wt(e)]}i64_store32(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=2,d=n):Array.isArray(a)?(e=n,h=2,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,62,h,...Wt(e)]}i64_store16(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=1,d=n):Array.isArray(a)?(e=n,h=1,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,61,h,...Wt(e)]}i64_store8(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=0,d=n):Array.isArray(a)?(e=n,h=0,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,60,h,...Wt(e)]}i32_load8_s(t,n,a){let o=n||0,e=a===void 0?0:a;return[...t,44,e,...Wt(o)]}i32_load8_u(t,n,a){let o=n||0,e=a===void 0?0:a;return[...t,45,e,...Wt(o)]}i32_load16_s(t,n,a){let o=n||0,e=a===void 0?1:a;return[...t,46,e,...Wt(o)]}i32_load16_u(t,n,a){let o=n||0,e=a===void 0?1:a;return[...t,47,e,...Wt(o)]}i32_load(t,n,a){let o=n||0,e=a===void 0?2:a;return[...t,40,e,...Wt(o)]}i32_store(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=2,d=n):Array.isArray(a)?(e=n,h=2,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,54,h,...Wt(e)]}i32_store16(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=1,d=n):Array.isArray(a)?(e=n,h=1,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,59,h,...Wt(e)]}i32_store8(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=0,d=n):Array.isArray(a)?(e=n,h=0,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,58,h,...Wt(e)]}call(t,...n){let a=this.module.functionIdxByName[t];if(a===void 0)throw new Error(`Function not defined: Function: ${t}`);return[...[].concat(...n),16,...Wt(a)]}call_indirect(t,...n){return[...[].concat(...n),...t,17,0,0]}if(t,n,a){return a?[...t,4,64,...n,5,...a,11]:[...t,4,64,...n,11]}block(t){return[2,64,...t,11]}loop(...t){return[3,64,...[].concat(...t),11]}br_if(t,n){return[...n,13,...Wt(t)]}br(t){return[12,...Wt(t)]}ret(t){return[...t,15]}drop(t){return[...t,26]}i64_const(t){return[66,...lp(t)]}i32_const(t){return[65,...kl(t)]}i64_eqz(t){return[...t,80]}i64_eq(t,n){return[...t,...n,81]}i64_ne(t,n){return[...t,...n,82]}i64_lt_s(t,n){return[...t,...n,83]}i64_lt_u(t,n){return[...t,...n,84]}i64_gt_s(t,n){return[...t,...n,85]}i64_gt_u(t,n){return[...t,...n,86]}i64_le_s(t,n){return[...t,...n,87]}i64_le_u(t,n){return[...t,...n,88]}i64_ge_s(t,n){return[...t,...n,89]}i64_ge_u(t,n){return[...t,...n,90]}i64_add(t,n){return[...t,...n,124]}i64_sub(t,n){return[...t,...n,125]}i64_mul(t,n){return[...t,...n,126]}i64_div_s(t,n){return[...t,...n,127]}i64_div_u(t,n){return[...t,...n,128]}i64_rem_s(t,n){return[...t,...n,129]}i64_rem_u(t,n){return[...t,...n,130]}i64_and(t,n){return[...t,...n,131]}i64_or(t,n){return[...t,...n,132]}i64_xor(t,n){return[...t,...n,133]}i64_shl(t,n){return[...t,...n,134]}i64_shr_s(t,n){return[...t,...n,135]}i64_shr_u(t,n){return[...t,...n,136]}i64_extend_i32_s(t){return[...t,172]}i64_extend_i32_u(t){return[...t,173]}i64_clz(t){return[...t,121]}i64_ctz(t){return[...t,122]}i32_eqz(t){return[...t,69]}i32_eq(t,n){return[...t,...n,70]}i32_ne(t,n){return[...t,...n,71]}i32_lt_s(t,n){return[...t,...n,72]}i32_lt_u(t,n){return[...t,...n,73]}i32_gt_s(t,n){return[...t,...n,74]}i32_gt_u(t,n){return[...t,...n,75]}i32_le_s(t,n){return[...t,...n,76]}i32_le_u(t,n){return[...t,...n,77]}i32_ge_s(t,n){return[...t,...n,78]}i32_ge_u(t,n){return[...t,...n,79]}i32_add(t,n){return[...t,...n,106]}i32_sub(t,n){return[...t,...n,107]}i32_mul(t,n){return[...t,...n,108]}i32_div_s(t,n){return[...t,...n,109]}i32_div_u(t,n){return[...t,...n,110]}i32_rem_s(t,n){return[...t,...n,111]}i32_rem_u(t,n){return[...t,...n,112]}i32_and(t,n){return[...t,...n,113]}i32_or(t,n){return[...t,...n,114]}i32_xor(t,n){return[...t,...n,115]}i32_shl(t,n){return[...t,...n,116]}i32_shr_s(t,n){return[...t,...n,117]}i32_shr_u(t,n){return[...t,...n,118]}i32_rotl(t,n){return[...t,...n,119]}i32_rotr(t,n){return[...t,...n,120]}i32_wrap_i64(t){return[...t,167]}i32_clz(t){return[...t,103]}i32_ctz(t){return[...t,104]}unreachable(){return[0]}current_memory(){return[63,0]}comment(){return[]}},xl={i32:127,i64:126,f32:125,f64:124,anyfunc:112,func:96,emptyblock:64},uc=class{constructor(t,n,a,o,e){if(a=="import")this.fnType="import",this.moduleName=o,this.fieldName=e;else if(a=="internal")this.fnType="internal";else throw new Error("Invalid function fnType: "+a);this.module=t,this.fnName=n,this.params=[],this.locals=[],this.localIdxByName={},this.code=[],this.returnType=null,this.nextLocal=0}addParam(t,n){if(this.localIdxByName[t])throw new Error(`param already exists. Function: ${this.fnName}, Param: ${t} `);let a=this.nextLocal++;this.localIdxByName[t]=a,this.params.push({type:n})}addLocal(t,n,a){let o=a||1;if(this.localIdxByName[t])throw new Error(`local already exists. Function: ${this.fnName}, Param: ${t} `);let e=this.nextLocal++;this.localIdxByName[t]=e,this.locals.push({type:n,length:o})}setReturnType(t){if(this.returnType)throw new Error(`returnType already defined. Function: ${this.fnName}`);this.returnType=t}getSignature(){let t=[...Wt(this.params.length),...this.params.map(a=>xl[a.type])],n=this.returnType?[1,xl[this.returnType]]:[0];return[96,...t,...n]}getBody(){let t=this.locals.map(a=>[...Wt(a.length),xl[a.type]]),n=[...Wt(this.locals.length),...[].concat(...t),...this.code,11];return[...Wt(n.length),...n]}addCode(...t){this.code.push(...[].concat(...t))}getCodeBuilder(){return new Ul(this)}},_c=class{constructor(){this.functions=[],this.functionIdxByName={},this.nImportFunctions=0,this.nInternalFunctions=0,this.memory={pagesSize:1,moduleName:"env",fieldName:"memory"},this.free=8,this.datas=[],this.modules={},this.exports=[],this.functionsTable=[]}build(){return this._setSignatures(),new Uint8Array([...Bl(1836278016),...Bl(1),...this._buildType(),...this._buildImport(),...this._buildFunctionDeclarations(),...this._buildFunctionsTable(),...this._buildExports(),...this._buildElements(),...this._buildCode(),...this._buildData()])}addFunction(t){if(typeof this.functionIdxByName[t]<"u")throw new Error(`Function already defined: ${t}`);let n=this.functions.length;return this.functionIdxByName[t]=n,this.functions.push(new uc(this,t,"internal")),this.nInternalFunctions++,this.functions[n]}addIimportFunction(t,n,a){if(typeof this.functionIdxByName[t]<"u")throw new Error(`Function already defined: ${t}`);if(this.functions.length>0&&this.functions[this.functions.length-1].type=="internal")throw new Error(`Import functions must be declared before internal: ${t}`);let o=a||t,e=this.functions.length;return this.functionIdxByName[t]=e,this.functions.push(new uc(this,t,"import",n,o)),this.nImportFunctions++,this.functions[e]}setMemory(t,n,a){this.memory={pagesSize:t,moduleName:n||"env",fieldName:a||"memory"}}exportFunction(t,n){let a=n||t;if(typeof this.functionIdxByName[t]>"u")throw new Error(`Function not defined: ${t}`);let o=this.functionIdxByName[t];a!=t&&(this.functionIdxByName[a]=o),this.exports.push({exportName:a,idx:o})}addFunctionToTable(t){let n=this.functionIdxByName[t];this.functionsTable.push(n)}addData(t,n){this.datas.push({offset:t,bytes:n})}alloc(t,n){let a,o;(Array.isArray(t)||ArrayBuffer.isView(t))&&typeof n>"u"?(a=t.length,o=t):(a=t,o=n),a=(a-1>>3)+1<<3;let e=this.free;return this.free+=a,o&&this.addData(e,o),e}allocString(t){let a=new globalThis.TextEncoder().encode(t);return this.alloc([...a,0])}_setSignatures(){this.signatures=[];let t={};if(this.functionsTable.length>0){let n=this.functions[this.functionsTable[0]].getSignature(),a="s_"+Zu(n);t[a]=0,this.signatures.push(n)}for(let n=0;n<this.functions.length;n++){let a=this.functions[n].getSignature(),o="s_"+Zu(a);typeof t[o]>"u"&&(t[o]=this.signatures.length,this.signatures.push(a)),this.functions[n].signatureIdx=t[o]}}_buildSection(t,n){return[t,...Wt(n.length),...n]}_buildType(){return this._buildSection(1,[...Wt(this.signatures.length),...[].concat(...this.signatures)])}_buildImport(){let t=[];t.push([...Ai(this.memory.moduleName),...Ai(this.memory.fieldName),2,0,...Wt(this.memory.pagesSize)]);for(let n=0;n<this.nImportFunctions;n++)t.push([...Ai(this.functions[n].moduleName),...Ai(this.functions[n].fieldName),0,...Wt(this.functions[n].signatureIdx)]);return this._buildSection(2,Wt(t.length).concat(...t))}_buildFunctionDeclarations(){let t=[];for(let n=this.nImportFunctions;n<this.nImportFunctions+this.nInternalFunctions;n++)t.push(...Wt(this.functions[n].signatureIdx));return this._buildSection(3,[...Wt(t.length),...t])}_buildFunctionsTable(){return this.functionsTable.length==0?[]:this._buildSection(4,[...Wt(1),112,0,...Wt(this.functionsTable.length)])}_buildElements(){if(this.functionsTable.length==0)return[];let t=[];for(let n=0;n<this.functionsTable.length;n++)t.push(...Wt(this.functionsTable[n]));return this._buildSection(9,[...Wt(1),...Wt(0),65,...kl(0),11,...Wt(this.functionsTable.length),...t])}_buildExports(){let t=[];for(let n=0;n<this.exports.length;n++)t.push([...Ai(this.exports[n].exportName),0,...Wt(this.exports[n].idx)]);return this._buildSection(7,Wt(t.length).concat(...t))}_buildCode(){let t=[];for(let n=this.nImportFunctions;n<this.nImportFunctions+this.nInternalFunctions;n++)t.push(this.functions[n].getBody());return this._buildSection(10,Wt(t.length).concat(...t))}_buildData(){let t=[];t.push([0,65,0,11,4,...Bl(this.free)]);for(let n=0;n<this.datas.length;n++)t.push([0,65,...kl(this.datas[n].offset),11,...Wt(this.datas[n].bytes.length),...this.datas[n].bytes]);return this._buildSection(11,Wt(t.length).concat(...t))}};globalThis.curve_bn128=null;globalThis.curve_bls12381=null;rp=yn("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),dp=yn("21888242871839275222246405745257275088548364400416034343698204186575808495617"),up=yn("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),_p=yn("21888242871839275222246405745257275088696311157297823662689037894645226208583");Lp=Hg,pp=tp});var x_=Sn(bc=>{"use strict";Object.defineProperty(bc,"__esModule",{value:!0});bc.crypto=void 0;bc.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var zo=Sn($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.wrapXOFConstructorWithOpts=$t.wrapConstructorWithOpts=$t.wrapConstructor=$t.Hash=$t.nextTick=$t.swap32IfBE=$t.byteSwapIfBE=$t.swap8IfBE=$t.isLE=void 0;$t.isBytes=E_;$t.anumber=Jl;$t.abytes=Ro;$t.ahash=bp;$t.aexists=mp;$t.aoutput=yp;$t.u8=wp;$t.u32=Fp;$t.clean=Cp;$t.createView=Bp;$t.rotr=xp;$t.rotl=Ap;$t.byteSwap=tr;$t.byteSwap32=v_;$t.bytesToHex=vp;$t.hexToBytes=Sp;$t.asyncLoop=Ip;$t.utf8ToBytes=nr;$t.bytesToUtf8=Op;$t.toBytes=mc;$t.kdfInputToBytes=Pp;$t.concatBytes=Mp;$t.checkOpts=Rp;$t.createHasher=q_;$t.createOptHasher=I_;$t.createXOFer=O_;$t.randomBytes=zp;var Mo=x_();function E_(c){return c instanceof Uint8Array||ArrayBuffer.isView(c)&&c.constructor.name==="Uint8Array"}function Jl(c){if(!Number.isSafeInteger(c)||c<0)throw new Error("positive integer expected, got "+c)}function Ro(c,...t){if(!E_(c))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(c.length))throw new Error("Uint8Array expected of length "+t+", got length="+c.length)}function bp(c){if(typeof c!="function"||typeof c.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Jl(c.outputLen),Jl(c.blockLen)}function mp(c,t=!0){if(c.destroyed)throw new Error("Hash instance has been destroyed");if(t&&c.finished)throw new Error("Hash#digest() has already been called")}function yp(c,t){Ro(c);let n=t.outputLen;if(c.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function wp(c){return new Uint8Array(c.buffer,c.byteOffset,c.byteLength)}function Fp(c){return new Uint32Array(c.buffer,c.byteOffset,Math.floor(c.byteLength/4))}function Cp(...c){for(let t=0;t<c.length;t++)c[t].fill(0)}function Bp(c){return new DataView(c.buffer,c.byteOffset,c.byteLength)}function xp(c,t){return c<<32-t|c>>>t}function Ap(c,t){return c<<t|c>>>32-t>>>0}$t.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function tr(c){return c<<24&4278190080|c<<8&16711680|c>>>8&65280|c>>>24&255}$t.swap8IfBE=$t.isLE?c=>c:c=>tr(c);$t.byteSwapIfBE=$t.swap8IfBE;function v_(c){for(let t=0;t<c.length;t++)c[t]=tr(c[t]);return c}$t.swap32IfBE=$t.isLE?c=>c:v_;var S_=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Ep=Array.from({length:256},(c,t)=>t.toString(16).padStart(2,"0"));function vp(c){if(Ro(c),S_)return c.toHex();let t="";for(let n=0;n<c.length;n++)t+=Ep[c[n]];return t}var Oa={_0:48,_9:57,A:65,F:70,a:97,f:102};function A_(c){if(c>=Oa._0&&c<=Oa._9)return c-Oa._0;if(c>=Oa.A&&c<=Oa.F)return c-(Oa.A-10);if(c>=Oa.a&&c<=Oa.f)return c-(Oa.a-10)}function Sp(c){if(typeof c!="string")throw new Error("hex string expected, got "+typeof c);if(S_)return Uint8Array.fromHex(c);let t=c.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let a=new Uint8Array(n);for(let o=0,e=0;o<n;o++,e+=2){let h=A_(c.charCodeAt(e)),d=A_(c.charCodeAt(e+1));if(h===void 0||d===void 0){let b=c[e]+c[e+1];throw new Error('hex string expected, got non-hex character "'+b+'" at index '+e)}a[o]=h*16+d}return a}var qp=async()=>{};$t.nextTick=qp;async function Ip(c,t,n){let a=Date.now();for(let o=0;o<c;o++){n(o);let e=Date.now()-a;e>=0&&e<t||(await(0,$t.nextTick)(),a+=e)}}function nr(c){if(typeof c!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(c))}function Op(c){return new TextDecoder().decode(c)}function mc(c){return typeof c=="string"&&(c=nr(c)),Ro(c),c}function Pp(c){return typeof c=="string"&&(c=nr(c)),Ro(c),c}function Mp(...c){let t=0;for(let a=0;a<c.length;a++){let o=c[a];Ro(o),t+=o.length}let n=new Uint8Array(t);for(let a=0,o=0;a<c.length;a++){let e=c[a];n.set(e,o),o+=e.length}return n}function Rp(c,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("options should be object or undefined");return Object.assign(c,t)}var Yl=class{};$t.Hash=Yl;function q_(c){let t=a=>c().update(mc(a)).digest(),n=c();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>c(),t}function I_(c){let t=(a,o)=>c(o).update(mc(a)).digest(),n=c({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=a=>c(a),t}function O_(c){let t=(a,o)=>c(o).update(mc(a)).digest(),n=c({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=a=>c(a),t}$t.wrapConstructor=q_;$t.wrapConstructorWithOpts=I_;$t.wrapXOFConstructorWithOpts=O_;function zp(c=32){if(Mo.crypto&&typeof Mo.crypto.getRandomValues=="function")return Mo.crypto.getRandomValues(new Uint8Array(c));if(Mo.crypto&&typeof Mo.crypto.randomBytes=="function")return Uint8Array.from(Mo.crypto.randomBytes(c));throw new Error("crypto.getRandomValues must be defined")}});var P_=Sn(To=>{"use strict";Object.defineProperty(To,"__esModule",{value:!0});To.BSIGMA=void 0;To.G1s=Tp;To.G2s=Gp;var yc=zo();To.BSIGMA=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]);function Tp(c,t,n,a,o){return c=c+t+o|0,a=(0,yc.rotr)(a^c,16),n=n+a|0,t=(0,yc.rotr)(t^n,12),{a:c,b:t,c:n,d:a}}function Gp(c,t,n,a,o){return c=c+t+o|0,a=(0,yc.rotr)(a^c,8),n=n+a|0,t=(0,yc.rotr)(t^n,7),{a:c,b:t,c:n,d:a}}});var R_=Sn(Qn=>{"use strict";Object.defineProperty(Qn,"__esModule",{value:!0});Qn.SHA512_IV=Qn.SHA384_IV=Qn.SHA224_IV=Qn.SHA256_IV=Qn.HashMD=void 0;Qn.setBigUint64=M_;Qn.Chi=kp;Qn.Maj=Up;var wa=zo();function M_(c,t,n,a){if(typeof c.setBigUint64=="function")return c.setBigUint64(t,n,a);let o=BigInt(32),e=BigInt(4294967295),h=Number(n>>o&e),d=Number(n&e),b=a?4:0,l=a?0:4;c.setUint32(t+b,h,a),c.setUint32(t+l,d,a)}function kp(c,t,n){return c&t^~c&n}function Up(c,t,n){return c&t^c&n^t&n}var ar=class extends wa.Hash{constructor(t,n,a,o){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=n,this.padOffset=a,this.isLE=o,this.buffer=new Uint8Array(t),this.view=(0,wa.createView)(this.buffer)}update(t){(0,wa.aexists)(this),t=(0,wa.toBytes)(t),(0,wa.abytes)(t);let{view:n,buffer:a,blockLen:o}=this,e=t.length;for(let h=0;h<e;){let d=Math.min(o-this.pos,e-h);if(d===o){let b=(0,wa.createView)(t);for(;o<=e-h;h+=o)this.process(b,h);continue}a.set(t.subarray(h,h+d),this.pos),this.pos+=d,h+=d,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,wa.aexists)(this),(0,wa.aoutput)(t,this),this.finished=!0;let{buffer:n,view:a,blockLen:o,isLE:e}=this,{pos:h}=this;n[h++]=128,(0,wa.clean)(this.buffer.subarray(h)),this.padOffset>o-h&&(this.process(a,0),h=0);for(let m=h;m<o;m++)n[m]=0;M_(a,o-8,BigInt(this.length*8),e),this.process(a,0);let d=(0,wa.createView)(t),b=this.outputLen;if(b%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let l=b/4,s=this.get();if(l>s.length)throw new Error("_sha2: outputLen bigger than state");for(let m=0;m<l;m++)d.setUint32(4*m,s[m],e)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let a=t.slice(0,n);return this.destroy(),a}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:a,length:o,finished:e,destroyed:h,pos:d}=this;return t.destroyed=h,t.finished=e,t.length=o,t.pos=d,o%n&&t.buffer.set(a),t}clone(){return this._cloneInto()}};Qn.HashMD=ar;Qn.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);Qn.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]);Qn.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]);Qn.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209])});var er=Sn(en=>{"use strict";Object.defineProperty(en,"__esModule",{value:!0});en.toBig=en.shrSL=en.shrSH=en.rotrSL=en.rotrSH=en.rotrBL=en.rotrBH=en.rotr32L=en.rotr32H=en.rotlSL=en.rotlSH=en.rotlBL=en.rotlBH=en.add5L=en.add5H=en.add4L=en.add4H=en.add3L=en.add3H=void 0;en.add=D_;en.fromBig=ir;en.split=z_;var wc=BigInt(2**32-1),or=BigInt(32);function ir(c,t=!1){return t?{h:Number(c&wc),l:Number(c>>or&wc)}:{h:Number(c>>or&wc)|0,l:Number(c&wc)|0}}function z_(c,t=!1){let n=c.length,a=new Uint32Array(n),o=new Uint32Array(n);for(let e=0;e<n;e++){let{h,l:d}=ir(c[e],t);[a[e],o[e]]=[h,d]}return[a,o]}var T_=(c,t)=>BigInt(c>>>0)<<or|BigInt(t>>>0);en.toBig=T_;var G_=(c,t,n)=>c>>>n;en.shrSH=G_;var k_=(c,t,n)=>c<<32-n|t>>>n;en.shrSL=k_;var U_=(c,t,n)=>c>>>n|t<<32-n;en.rotrSH=U_;var N_=(c,t,n)=>c<<32-n|t>>>n;en.rotrSL=N_;var $_=(c,t,n)=>c<<64-n|t>>>n-32;en.rotrBH=$_;var Z_=(c,t,n)=>c>>>n-32|t<<64-n;en.rotrBL=Z_;var j_=(c,t)=>t;en.rotr32H=j_;var V_=(c,t)=>c;en.rotr32L=V_;var W_=(c,t,n)=>c<<n|t>>>32-n;en.rotlSH=W_;var Q_=(c,t,n)=>t<<n|c>>>32-n;en.rotlSL=Q_;var X_=(c,t,n)=>t<<n-32|c>>>64-n;en.rotlBH=X_;var H_=(c,t,n)=>c<<n-32|t>>>64-n;en.rotlBL=H_;function D_(c,t,n,a){let o=(t>>>0)+(a>>>0);return{h:c+n+(o/2**32|0)|0,l:o|0}}var K_=(c,t,n)=>(c>>>0)+(t>>>0)+(n>>>0);en.add3L=K_;var J_=(c,t,n,a)=>t+n+a+(c/2**32|0)|0;en.add3H=J_;var Y_=(c,t,n,a)=>(c>>>0)+(t>>>0)+(n>>>0)+(a>>>0);en.add4L=Y_;var t3=(c,t,n,a,o)=>t+n+a+o+(c/2**32|0)|0;en.add4H=t3;var n3=(c,t,n,a,o)=>(c>>>0)+(t>>>0)+(n>>>0)+(a>>>0)+(o>>>0);en.add5L=n3;var a3=(c,t,n,a,o,e)=>t+n+a+o+e+(c/2**32|0)|0;en.add5H=a3;var Np={fromBig:ir,split:z_,toBig:T_,shrSH:G_,shrSL:k_,rotrSH:U_,rotrSL:N_,rotrBH:$_,rotrBL:Z_,rotr32H:j_,rotr32L:V_,rotlSH:W_,rotlSL:Q_,rotlBH:X_,rotlBL:H_,add:D_,add3L:K_,add3H:J_,add4L:Y_,add4H:t3,add5H:a3,add5L:n3};en.default=Np});var e3=Sn(ia=>{"use strict";Object.defineProperty(ia,"__esModule",{value:!0});ia.blake2s=ia.BLAKE2s=ia.blake2b=ia.BLAKE2b=ia.BLAKE2=void 0;ia.compress=i3;var qn=P_(),$p=R_(),Gn=er(),nn=zo(),En=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Tt=new Uint32Array(32);function Va(c,t,n,a,o,e){let h=o[e],d=o[e+1],b=Tt[2*c],l=Tt[2*c+1],s=Tt[2*t],m=Tt[2*t+1],B=Tt[2*n],p=Tt[2*n+1],v=Tt[2*a],M=Tt[2*a+1],x=Gn.add3L(b,s,h);l=Gn.add3H(x,l,m,d),b=x|0,{Dh:M,Dl:v}={Dh:M^l,Dl:v^b},{Dh:M,Dl:v}={Dh:Gn.rotr32H(M,v),Dl:Gn.rotr32L(M,v)},{h:p,l:B}=Gn.add(p,B,M,v),{Bh:m,Bl:s}={Bh:m^p,Bl:s^B},{Bh:m,Bl:s}={Bh:Gn.rotrSH(m,s,24),Bl:Gn.rotrSL(m,s,24)},Tt[2*c]=b,Tt[2*c+1]=l,Tt[2*t]=s,Tt[2*t+1]=m,Tt[2*n]=B,Tt[2*n+1]=p,Tt[2*a]=v,Tt[2*a+1]=M}function Wa(c,t,n,a,o,e){let h=o[e],d=o[e+1],b=Tt[2*c],l=Tt[2*c+1],s=Tt[2*t],m=Tt[2*t+1],B=Tt[2*n],p=Tt[2*n+1],v=Tt[2*a],M=Tt[2*a+1],x=Gn.add3L(b,s,h);l=Gn.add3H(x,l,m,d),b=x|0,{Dh:M,Dl:v}={Dh:M^l,Dl:v^b},{Dh:M,Dl:v}={Dh:Gn.rotrSH(M,v,16),Dl:Gn.rotrSL(M,v,16)},{h:p,l:B}=Gn.add(p,B,M,v),{Bh:m,Bl:s}={Bh:m^p,Bl:s^B},{Bh:m,Bl:s}={Bh:Gn.rotrBH(m,s,63),Bl:Gn.rotrBL(m,s,63)},Tt[2*c]=b,Tt[2*c+1]=l,Tt[2*t]=s,Tt[2*t+1]=m,Tt[2*n]=B,Tt[2*n+1]=p,Tt[2*a]=v,Tt[2*a+1]=M}function o3(c,t={},n,a,o){if((0,nn.anumber)(n),c<0||c>n)throw new Error("outputLen bigger than keyLen");let{key:e,salt:h,personalization:d}=t;if(e!==void 0&&(e.length<1||e.length>n))throw new Error("key length must be undefined or 1.."+n);if(h!==void 0&&h.length!==a)throw new Error("salt must be undefined or "+a);if(d!==void 0&&d.length!==o)throw new Error("personalization must be undefined or "+o)}var Mi=class extends nn.Hash{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,(0,nn.anumber)(t),(0,nn.anumber)(n),this.blockLen=t,this.outputLen=n,this.buffer=new Uint8Array(t),this.buffer32=(0,nn.u32)(this.buffer)}update(t){(0,nn.aexists)(this),t=(0,nn.toBytes)(t),(0,nn.abytes)(t);let{blockLen:n,buffer:a,buffer32:o}=this,e=t.length,h=t.byteOffset,d=t.buffer;for(let b=0;b<e;){this.pos===n&&((0,nn.swap32IfBE)(o),this.compress(o,0,!1),(0,nn.swap32IfBE)(o),this.pos=0);let l=Math.min(n-this.pos,e-b),s=h+b;if(l===n&&!(s%4)&&b+l<e){let m=new Uint32Array(d,s,Math.floor((e-b)/4));(0,nn.swap32IfBE)(m);for(let B=0;b+n<e;B+=o.length,b+=n)this.length+=n,this.compress(m,B,!1);(0,nn.swap32IfBE)(m);continue}a.set(t.subarray(b,b+l),this.pos),this.pos+=l,this.length+=l,b+=l}return this}digestInto(t){(0,nn.aexists)(this),(0,nn.aoutput)(t,this);let{pos:n,buffer32:a}=this;this.finished=!0,(0,nn.clean)(this.buffer.subarray(n)),(0,nn.swap32IfBE)(a),this.compress(a,0,!0),(0,nn.swap32IfBE)(a);let o=(0,nn.u32)(t);this.get().forEach((e,h)=>o[h]=(0,nn.swap8IfBE)(e))}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let a=t.slice(0,n);return this.destroy(),a}_cloneInto(t){let{buffer:n,length:a,finished:o,destroyed:e,outputLen:h,pos:d}=this;return t||(t=new this.constructor({dkLen:h})),t.set(...this.get()),t.buffer.set(n),t.destroyed=e,t.finished=o,t.length=a,t.pos=d,t.outputLen=h,t}clone(){return this._cloneInto()}};ia.BLAKE2=Mi;var Fc=class extends Mi{constructor(t={}){let n=t.dkLen===void 0?64:t.dkLen;super(128,n),this.v0l=En[0]|0,this.v0h=En[1]|0,this.v1l=En[2]|0,this.v1h=En[3]|0,this.v2l=En[4]|0,this.v2h=En[5]|0,this.v3l=En[6]|0,this.v3h=En[7]|0,this.v4l=En[8]|0,this.v4h=En[9]|0,this.v5l=En[10]|0,this.v5h=En[11]|0,this.v6l=En[12]|0,this.v6h=En[13]|0,this.v7l=En[14]|0,this.v7h=En[15]|0,o3(n,t,64,16,16);let{key:a,personalization:o,salt:e}=t,h=0;if(a!==void 0&&(a=(0,nn.toBytes)(a),h=a.length),this.v0l^=this.outputLen|h<<8|65536|1<<24,e!==void 0){e=(0,nn.toBytes)(e);let d=(0,nn.u32)(e);this.v4l^=(0,nn.swap8IfBE)(d[0]),this.v4h^=(0,nn.swap8IfBE)(d[1]),this.v5l^=(0,nn.swap8IfBE)(d[2]),this.v5h^=(0,nn.swap8IfBE)(d[3])}if(o!==void 0){o=(0,nn.toBytes)(o);let d=(0,nn.u32)(o);this.v6l^=(0,nn.swap8IfBE)(d[0]),this.v6h^=(0,nn.swap8IfBE)(d[1]),this.v7l^=(0,nn.swap8IfBE)(d[2]),this.v7h^=(0,nn.swap8IfBE)(d[3])}if(a!==void 0){let d=new Uint8Array(this.blockLen);d.set(a),this.update(d)}}get(){let{v0l:t,v0h:n,v1l:a,v1h:o,v2l:e,v2h:h,v3l:d,v3h:b,v4l:l,v4h:s,v5l:m,v5h:B,v6l:p,v6h:v,v7l:M,v7h:x}=this;return[t,n,a,o,e,h,d,b,l,s,m,B,p,v,M,x]}set(t,n,a,o,e,h,d,b,l,s,m,B,p,v,M,x){this.v0l=t|0,this.v0h=n|0,this.v1l=a|0,this.v1h=o|0,this.v2l=e|0,this.v2h=h|0,this.v3l=d|0,this.v3h=b|0,this.v4l=l|0,this.v4h=s|0,this.v5l=m|0,this.v5h=B|0,this.v6l=p|0,this.v6h=v|0,this.v7l=M|0,this.v7h=x|0}compress(t,n,a){this.get().forEach((b,l)=>Tt[l]=b),Tt.set(En,16);let{h:o,l:e}=Gn.fromBig(BigInt(this.length));Tt[24]=En[8]^e,Tt[25]=En[9]^o,a&&(Tt[28]=~Tt[28],Tt[29]=~Tt[29]);let h=0,d=qn.BSIGMA;for(let b=0;b<12;b++)Va(0,4,8,12,t,n+2*d[h++]),Wa(0,4,8,12,t,n+2*d[h++]),Va(1,5,9,13,t,n+2*d[h++]),Wa(1,5,9,13,t,n+2*d[h++]),Va(2,6,10,14,t,n+2*d[h++]),Wa(2,6,10,14,t,n+2*d[h++]),Va(3,7,11,15,t,n+2*d[h++]),Wa(3,7,11,15,t,n+2*d[h++]),Va(0,5,10,15,t,n+2*d[h++]),Wa(0,5,10,15,t,n+2*d[h++]),Va(1,6,11,12,t,n+2*d[h++]),Wa(1,6,11,12,t,n+2*d[h++]),Va(2,7,8,13,t,n+2*d[h++]),Wa(2,7,8,13,t,n+2*d[h++]),Va(3,4,9,14,t,n+2*d[h++]),Wa(3,4,9,14,t,n+2*d[h++]);this.v0l^=Tt[0]^Tt[16],this.v0h^=Tt[1]^Tt[17],this.v1l^=Tt[2]^Tt[18],this.v1h^=Tt[3]^Tt[19],this.v2l^=Tt[4]^Tt[20],this.v2h^=Tt[5]^Tt[21],this.v3l^=Tt[6]^Tt[22],this.v3h^=Tt[7]^Tt[23],this.v4l^=Tt[8]^Tt[24],this.v4h^=Tt[9]^Tt[25],this.v5l^=Tt[10]^Tt[26],this.v5h^=Tt[11]^Tt[27],this.v6l^=Tt[12]^Tt[28],this.v6h^=Tt[13]^Tt[29],this.v7l^=Tt[14]^Tt[30],this.v7h^=Tt[15]^Tt[31],(0,nn.clean)(Tt)}destroy(){this.destroyed=!0,(0,nn.clean)(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};ia.BLAKE2b=Fc;ia.blake2b=(0,nn.createOptHasher)(c=>new Fc(c));function i3(c,t,n,a,o,e,h,d,b,l,s,m,B,p,v,M,x,S,w,k){let O=0;for(let W=0;W<a;W++)({a:o,b,c:B,d:x}=(0,qn.G1s)(o,b,B,x,n[t+c[O++]])),{a:o,b,c:B,d:x}=(0,qn.G2s)(o,b,B,x,n[t+c[O++]]),{a:e,b:l,c:p,d:S}=(0,qn.G1s)(e,l,p,S,n[t+c[O++]]),{a:e,b:l,c:p,d:S}=(0,qn.G2s)(e,l,p,S,n[t+c[O++]]),{a:h,b:s,c:v,d:w}=(0,qn.G1s)(h,s,v,w,n[t+c[O++]]),{a:h,b:s,c:v,d:w}=(0,qn.G2s)(h,s,v,w,n[t+c[O++]]),{a:d,b:m,c:M,d:k}=(0,qn.G1s)(d,m,M,k,n[t+c[O++]]),{a:d,b:m,c:M,d:k}=(0,qn.G2s)(d,m,M,k,n[t+c[O++]]),{a:o,b:l,c:v,d:k}=(0,qn.G1s)(o,l,v,k,n[t+c[O++]]),{a:o,b:l,c:v,d:k}=(0,qn.G2s)(o,l,v,k,n[t+c[O++]]),{a:e,b:s,c:M,d:x}=(0,qn.G1s)(e,s,M,x,n[t+c[O++]]),{a:e,b:s,c:M,d:x}=(0,qn.G2s)(e,s,M,x,n[t+c[O++]]),{a:h,b:m,c:B,d:S}=(0,qn.G1s)(h,m,B,S,n[t+c[O++]]),{a:h,b:m,c:B,d:S}=(0,qn.G2s)(h,m,B,S,n[t+c[O++]]),{a:d,b,c:p,d:w}=(0,qn.G1s)(d,b,p,w,n[t+c[O++]]),{a:d,b,c:p,d:w}=(0,qn.G2s)(d,b,p,w,n[t+c[O++]]);return{v0:o,v1:e,v2:h,v3:d,v4:b,v5:l,v6:s,v7:m,v8:B,v9:p,v10:v,v11:M,v12:x,v13:S,v14:w,v15:k}}var Mn=$p.SHA256_IV,Cc=class extends Mi{constructor(t={}){let n=t.dkLen===void 0?32:t.dkLen;super(64,n),this.v0=Mn[0]|0,this.v1=Mn[1]|0,this.v2=Mn[2]|0,this.v3=Mn[3]|0,this.v4=Mn[4]|0,this.v5=Mn[5]|0,this.v6=Mn[6]|0,this.v7=Mn[7]|0,o3(n,t,32,8,8);let{key:a,personalization:o,salt:e}=t,h=0;if(a!==void 0&&(a=(0,nn.toBytes)(a),h=a.length),this.v0^=this.outputLen|h<<8|65536|1<<24,e!==void 0){e=(0,nn.toBytes)(e);let d=(0,nn.u32)(e);this.v4^=(0,nn.swap8IfBE)(d[0]),this.v5^=(0,nn.swap8IfBE)(d[1])}if(o!==void 0){o=(0,nn.toBytes)(o);let d=(0,nn.u32)(o);this.v6^=(0,nn.swap8IfBE)(d[0]),this.v7^=(0,nn.swap8IfBE)(d[1])}if(a!==void 0){(0,nn.abytes)(a);let d=new Uint8Array(this.blockLen);d.set(a),this.update(d)}}get(){let{v0:t,v1:n,v2:a,v3:o,v4:e,v5:h,v6:d,v7:b}=this;return[t,n,a,o,e,h,d,b]}set(t,n,a,o,e,h,d,b){this.v0=t|0,this.v1=n|0,this.v2=a|0,this.v3=o|0,this.v4=e|0,this.v5=h|0,this.v6=d|0,this.v7=b|0}compress(t,n,a){let{h:o,l:e}=Gn.fromBig(BigInt(this.length)),{v0:h,v1:d,v2:b,v3:l,v4:s,v5:m,v6:B,v7:p,v8:v,v9:M,v10:x,v11:S,v12:w,v13:k,v14:O,v15:W}=i3(qn.BSIGMA,n,t,10,this.v0,this.v1,this.v2,this.v3,this.v4,this.v5,this.v6,this.v7,Mn[0],Mn[1],Mn[2],Mn[3],e^Mn[4],o^Mn[5],a?~Mn[6]:Mn[6],Mn[7]);this.v0^=h^v,this.v1^=d^M,this.v2^=b^x,this.v3^=l^S,this.v4^=s^w,this.v5^=m^k,this.v6^=B^O,this.v7^=p^W}destroy(){this.destroyed=!0,(0,nn.clean)(this.buffer32),this.set(0,0,0,0,0,0,0,0)}};ia.BLAKE2s=Cc;ia.blake2s=(0,nn.createOptHasher)(c=>new Cc(c))});var s3=Sn(Go=>{"use strict";Object.defineProperty(Go,"__esModule",{value:!0});Go.blake2b=Go.BLAKE2b=void 0;var c3=e3();Go.BLAKE2b=c3.BLAKE2b;Go.blake2b=c3.blake2b});var sh={};Ae(sh,{BigBuffer:()=>pn,ChaCha:()=>Ic,EC:()=>Fr,F1Field:()=>mr,F2Field:()=>yr,F3Field:()=>wr,PolField:()=>pr,Scalar:()=>Am,ZqField:()=>mr,buildBls12381:()=>jc,buildBn128:()=>Zc,getCurveFromName:()=>xm,getCurveFromQ:()=>Bm,getCurveFromR:()=>Cm,utils:()=>Em});function Uc(c,t){if(!t||t==10)return BigInt(c);if(t==16)return c.slice(0,2)=="0x"?BigInt(c):BigInt("0x"+c)}function jp(c,t){let n=BigInt(0);t=BigInt(t);for(let a=0;a<c.length;a++)n=n*t+BigInt(c[a]);return n}function ji(c){let t=c.toString(16);return(t.length-1)*4+Zp[parseInt(t[0],16)]}function v3(c){return BigInt(c)<BigInt(0)}function Or(c){return!c}function Ec(c,t){return BigInt(c)<<BigInt(t)}function ko(c,t){return BigInt(c)>>BigInt(t)}function Pr(c){return(BigInt(c)&BigInt(1))==BigInt(1)}function S3(c){let t=BigInt(c),n=[];for(;t;){if(t&BigInt(1)){let a=2-Number(t%BigInt(4));n.push(a),t=t-BigInt(a)}else n.push(0);t=t>>BigInt(1)}return n}function q3(c){let t=BigInt(c),n=[];for(;t;)t&BigInt(1)?n.push(1):n.push(0),t=t>>BigInt(1);return n}function I3(c){if(c>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(c)}function Qp(c,t){let n=[],a=BigInt(c);for(t=BigInt(t);a;)n.unshift(Number(a%t)),a=a/t;return n}function Mr(c,t){return BigInt(c)+BigInt(t)}function Ma(c,t){return BigInt(c)-BigInt(t)}function O3(c){return-BigInt(c)}function P3(c,t){return BigInt(c)*BigInt(t)}function Xp(c){return BigInt(c)*BigInt(c)}function Vi(c,t){return BigInt(c)**BigInt(t)}function Hp(c,t){return BigInt(c)**BigInt(t)}function Dp(c){return BigInt(c)>=0?BigInt(c):-BigInt(c)}function Uo(c,t){return BigInt(c)/BigInt(t)}function Ca(c,t){return BigInt(c)%BigInt(t)}function ha(c,t){return BigInt(c)==BigInt(t)}function Kp(c,t){return BigInt(c)!=BigInt(t)}function Jp(c,t){return BigInt(c)<BigInt(t)}function vc(c,t){return BigInt(c)>BigInt(t)}function Yp(c,t){return BigInt(c)<=BigInt(t)}function M3(c,t){return BigInt(c)>=BigInt(t)}function Rr(c,t){return BigInt(c)&BigInt(t)}function tb(c,t){return BigInt(c)|BigInt(t)}function nb(c,t){return BigInt(c)^BigInt(t)}function ab(c,t){return BigInt(c)&&BigInt(t)}function ob(c,t){return BigInt(c)||BigInt(t)}function ib(c){return!BigInt(c)}function $i(c,t,n,a){let o="0000000"+n.toString(16),e=new Uint32Array(c.buffer,c.byteOffset+t,a/4),h=((o.length-7)*4-1>>5)+1;for(let d=0;d<h;d++)e[d]=parseInt(o.substring(o.length-8*d-8,o.length-8*d),16);for(let d=h;d<e.length;d++)e[d]=0;for(let d=e.length*4;d<a;d++)c[d]=I3(Rr(ko(n,d*8),255))}function R3(c,t,n,a){let o="0000000"+n.toString(16),e=new DataView(c.buffer,c.byteOffset+t,a),h=((o.length-7)*4-1>>5)+1;for(let d=0;d<h;d++)e.setUint32(a-d*4-4,parseInt(o.substring(o.length-8*d-8,o.length-8*d),16),!1);for(let d=0;d<a/4-h;d++)e[d]=0}function Zi(c,t,n){n=n||c.byteLength,t=t||0;let a=new Uint32Array(c.buffer,c.byteOffset+t,n/4),o=new Array(n/4);return a.forEach((e,h)=>o[o.length-h-1]=e.toString(16).padStart(8,"0")),Uc(o.join(""),16)}function z3(c,t,n){n=n||c.byteLength,t=t||0;let a=new DataView(c.buffer,c.byteOffset+t,n),o=new Array(n/4);for(let e=0;e<n/4;e++)o[e]=a.getUint32(e*4,!1).toString(16).padStart(8,"0");return Uc(o.join(""),16)}function Nc(c,t){return c.toString(t)}function No(c){let t=new Uint8Array(Math.floor((ji(c)-1)/8)+1);return $i(t,0,c,t.byteLength),t}function Fa(c){return((c&4294901760)!==0?(c&=4294901760,16):0)|((c&4278255360)!==0?(c&=4278255360,8):0)|((c&4042322160)!==0?(c&=4042322160,4):0)|((c&3435973836)!==0?(c&=3435973836,2):0)|(c&2863311530)!==0}function fo(c,t,n,a,o){let e=1<<n;if(e==1)return[t[a]];if(e==2)return[c.F.add(t[a],t[a+o]),c.F.sub(t[a],t[a+o])];let h=e>>1,d=fo(c,t,n-1,a,o*2),b=fo(c,t,n-1,a+o,o*2),l=new Array(e);for(let s=0;s<h;s++)l[s]=c.F.add(d[s],c.F.mul(c.roots[n][s],b[s])),l[s+h]=c.F.sub(d[s],c.F.mul(c.roots[n][s],b[s]));return l}function Sc(c,t,n){let a=1<<n;if(a==1)return[t[0]];let o=a>>1,e=Sc(c,t.slice(0,o),n-1),h=Sc(c,t.slice(o),n-1),d=new Array(a);for(let b=0;b<o;b++)d[b]=c.F.add(e[b],c.F.mul(c.roots[n][b],h[b])),d[b+o]=c.F.sub(e[b],c.F.mul(c.roots[n][b],h[b]));return d}function cb(c,t){let n=0,a=c;for(let o=0;o<t;o++)n<<=1,n=n|a&1,a>>=1;return n}function sb(c,t){return(Ui[c>>>24]|Ui[c>>>16&255]<<8|Ui[c>>>8&255]<<16|Ui[c&255]<<24)>>>32-t}function l3(c,t){for(let n=0;n<c.length;n++){let a=sb(n,t);if(a>n){let o=c[n];c[n]=c[a],c[a]=o}}}function qc(c,t,n){let a;if(Or(n))return c.zero;let o=S3(n);if(o[o.length-1]==1)a=t;else if(o[o.length-1]==-1)a=c.neg(t);else throw new Error("invlaud NAF");for(let e=o.length-2;e>=0;e--)a=c.double(a),o[e]==1?a=c.add(a,t):o[e]==-1&&(a=c.sub(a,t));return a}function $o(c,t,n){if(Or(n))return c.one;let a=q3(n);if(a.length==0)return c.one;let o=t;for(let e=a.length-2;e>=0;e--)o=c.square(o),a[e]&&(o=c.mul(o,t));return o}function G3(c){if(c.m%2==1)if(ha(Ca(c.p,4),1))if(ha(Ca(c.p,8),1))if(ha(Ca(c.p,16),1))lb(c);else if(ha(Ca(c.p,16),9))rb(c);else throw new Error("Field withot sqrt");else if(ha(Ca(c.p,8),5))db(c);else throw new Error("Field withot sqrt");else ha(Ca(c.p,4),3)&&ub(c);else{let t=Ca(Vi(c.p,c.m/2),4);t==1?_b(c):t==3?hb(c):fb(c)}}function lb(c){for(c.sqrt_q=Vi(c.p,c.m),c.sqrt_s=0,c.sqrt_t=Ma(c.sqrt_q,1);!Pr(c.sqrt_t);)c.sqrt_s=c.sqrt_s+1,c.sqrt_t=Uo(c.sqrt_t,2);let t=c.one;for(;c.eq(t,c.one);){let n=c.random();c.sqrt_z=c.pow(n,c.sqrt_t),t=c.pow(c.sqrt_z,2**(c.sqrt_s-1))}c.sqrt_tm1d2=Uo(Ma(c.sqrt_t,1),2),c.sqrt=function(n){let a=this;if(a.isZero(n))return a.zero;let o=a.pow(n,a.sqrt_tm1d2),e=a.pow(a.mul(a.square(o),n),2**(a.sqrt_s-1));if(a.eq(e,a.negone))return null;let h=a.sqrt_s,d=a.mul(n,o),b=a.mul(d,o),l=a.sqrt_z;for(;!a.eq(b,a.one);){let s=a.square(b),m=1;for(;!a.eq(s,a.one);)s=a.square(s),m++;o=l;for(let B=0;B<h-m-1;B++)o=a.square(o);l=a.square(o),b=a.mul(b,l),d=a.mul(d,o),h=m}return a.geq(d,a.zero)?d:a.neg(d)}}function rb(c){c.sqrt=function(){throw new Error("Sqrt alg 4 not implemented")}}function db(c){c.sqrt=function(){throw new Error("Sqrt alg 3 not implemented")}}function ub(c){c.sqrt_q=Vi(c.p,c.m),c.sqrt_e1=Uo(Ma(c.sqrt_q,3),4),c.sqrt=function(t){if(this.isZero(t))return this.zero;let n=this.pow(t,this.sqrt_e1),a=this.mul(this.square(n),t);if(this.eq(a,this.negone))return null;let o=this.mul(n,t);return c.geq(o,c.zero)?o:c.neg(o)}}function _b(c){c.sqrt=function(){throw new Error("Sqrt alg 10 not implemented")}}function hb(c){c.sqrt_q=Vi(c.p,c.m/2),c.sqrt_e34=Uo(Ma(c.sqrt_q,3),4),c.sqrt_e12=Uo(Ma(c.sqrt_q,1),2),c.frobenius=function(t,n){return t%2==1?c.conjugate(n):n},c.sqrt=function(t){let n=this,a=n.pow(t,n.sqrt_e34),o=n.mul(n.square(a),t),e=n.mul(n.frobenius(1,o),o);if(n.eq(e,n.negone))return null;let h=n.mul(a,t),d;if(n.eq(o,n.negone))d=n.mul(h,[n.F.zero,n.F.one]);else{let b=n.pow(n.add(n.one,o),n.sqrt_e12);d=n.mul(b,h)}return n.geq(d,n.zero)?d:n.neg(d)}}function fb(c){c.sqrt=function(){throw new Error("Sqrt alg 8 not implemented")}}function Qa(c,t,n,a,o){c[t]=c[t]+c[n]>>>0,c[o]=(c[o]^c[t])>>>0,c[o]=(c[o]<<16|c[o]>>>16&65535)>>>0,c[a]=c[a]+c[o]>>>0,c[n]=(c[n]^c[a])>>>0,c[n]=(c[n]<<12|c[n]>>>20&4095)>>>0,c[t]=c[t]+c[n]>>>0,c[o]=(c[o]^c[t])>>>0,c[o]=(c[o]<<8|c[o]>>>24&255)>>>0,c[a]=c[a]+c[o]>>>0,c[n]=(c[n]^c[a])>>>0,c[n]=(c[n]<<7|c[n]>>>25&127)>>>0}function gb(c){Qa(c,0,4,8,12),Qa(c,1,5,9,13),Qa(c,2,6,10,14),Qa(c,3,7,11,15),Qa(c,0,5,10,15),Qa(c,1,6,11,12),Qa(c,2,7,8,13),Qa(c,3,4,9,14)}function k3(c){let t=new Uint8Array(c);if(typeof globalThis.crypto<"u")globalThis.crypto.getRandomValues(t);else for(let n=0;n<c;n++)t[n]=Math.random()*4294967296>>>0;return t}function Lb(){let c=k3(32),t=new Uint32Array(c.buffer),n=[];for(let a=0;a<8;a++)n.push(t[a]);return n}function zr(){return Bc||(Bc=new Ic(Lb()),Bc)}function r3(c){return((c&4294901760)!==0?(c&=4294901760,16):0)|((c&4278255360)!==0?(c&=4278255360,8):0)|((c&4042322160)!==0?(c&=4042322160,4):0)|((c&3435973836)!==0?(c&=3435973836,2):0)|(c&2863311530)!==0}function Oc(c,t,n,a,o){let e=1<<n;if(e==1)return[t[a]];if(e==2)return[c.G.add(t[a],t[a+o]),c.G.sub(t[a],t[a+o])];let h=e>>1,d=Oc(c,t,n-1,a,o*2),b=Oc(c,t,n-1,a+o,o*2),l=new Array(e);for(let s=0;s<h;s++)l[s]=c.G.add(d[s],c.opMulGF(b[s],c.roots[n][s])),l[s+h]=c.G.sub(d[s],c.opMulGF(b[s],c.roots[n][s]));return l}function Ac(c,t){if(Array.isArray(t)){for(let n=t.length-1;n>=0;n--)if(!c.F.isZero(t[n]))return Ac(c.F,t[n]);return 0}else{let n=c.neg(t);return vc(t,n)}}function bb(c,t){let n=c.modules[t].n64*8,a=c.addFunction(t+"_batchInverse");a.addParam("pIn","i32"),a.addParam("inStep","i32"),a.addParam("n","i32"),a.addParam("pOut","i32"),a.addParam("outStep","i32"),a.addLocal("itAux","i32"),a.addLocal("itIn","i32"),a.addLocal("itOut","i32"),a.addLocal("i","i32");let o=a.getCodeBuilder(),e=o.i32_const(c.alloc(n));a.addCode(o.setLocal("itAux",o.i32_load(o.i32_const(0))),o.i32_store(o.i32_const(0),o.i32_add(o.getLocal("itAux"),o.i32_mul(o.i32_add(o.getLocal("n"),o.i32_const(1)),o.i32_const(n))))),a.addCode(o.call(t+"_one",o.getLocal("itAux")),o.setLocal("itIn",o.getLocal("pIn")),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.if(o.call(t+"_isZero",o.getLocal("itIn")),o.call(t+"_copy",o.i32_sub(o.getLocal("itAux"),o.i32_const(n)),o.getLocal("itAux")),o.call(t+"_mul",o.getLocal("itIn"),o.i32_sub(o.getLocal("itAux"),o.i32_const(n)),o.getLocal("itAux"))),o.setLocal("itIn",o.i32_add(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))),o.setLocal("itIn",o.i32_sub(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itAux",o.i32_sub(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("itOut",o.i32_add(o.getLocal("pOut"),o.i32_mul(o.i32_sub(o.getLocal("n"),o.i32_const(1)),o.getLocal("outStep")))),o.call(t+"_inverse",o.getLocal("itAux"),o.getLocal("itAux")),o.block(o.loop(o.br_if(1,o.i32_eqz(o.getLocal("i"))),o.if(o.call(t+"_isZero",o.getLocal("itIn")),[...o.call(t+"_copy",o.getLocal("itAux"),o.i32_sub(o.getLocal("itAux"),o.i32_const(n))),...o.call(t+"_zero",o.getLocal("itOut"))],[...o.call(t+"_copy",o.i32_sub(o.getLocal("itAux"),o.i32_const(n)),e),...o.call(t+"_mul",o.getLocal("itAux"),o.getLocal("itIn"),o.i32_sub(o.getLocal("itAux"),o.i32_const(n))),...o.call(t+"_mul",o.getLocal("itAux"),e,o.getLocal("itOut"))]),o.setLocal("itIn",o.i32_sub(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itOut",o.i32_sub(o.getLocal("itOut"),o.getLocal("outStep"))),o.setLocal("itAux",o.i32_sub(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("i",o.i32_sub(o.getLocal("i"),o.i32_const(1))),o.br(0)))),a.addCode(o.i32_store(o.i32_const(0),o.getLocal("itAux")))}function mb(c,t,n,a,o,e){typeof e>"u"&&(a<o?e=!0:e=!1);let h=c.addFunction(t);h.addParam("pIn","i32"),h.addParam("n","i32"),h.addParam("pOut","i32"),h.addLocal("i","i32"),h.addLocal("itIn","i32"),h.addLocal("itOut","i32");let d=h.getCodeBuilder();e?h.addCode(d.setLocal("itIn",d.i32_add(d.getLocal("pIn"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(a)))),d.setLocal("itOut",d.i32_add(d.getLocal("pOut"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(o)))),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn"),d.getLocal("itOut")),d.setLocal("itIn",d.i32_sub(d.getLocal("itIn"),d.i32_const(a))),d.setLocal("itOut",d.i32_sub(d.getLocal("itOut"),d.i32_const(o))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0)))):h.addCode(d.setLocal("itIn",d.getLocal("pIn")),d.setLocal("itOut",d.getLocal("pOut")),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn"),d.getLocal("itOut")),d.setLocal("itIn",d.i32_add(d.getLocal("itIn"),d.i32_const(a))),d.setLocal("itOut",d.i32_add(d.getLocal("itOut"),d.i32_const(o))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0))))}function wb(c,t,n,a,o,e){typeof e>"u"&&(a<o?e=!0:e=!1);let h=c.addFunction(t);h.addParam("pIn1","i32"),h.addParam("pIn2","i32"),h.addParam("n","i32"),h.addParam("pOut","i32"),h.addLocal("i","i32"),h.addLocal("itIn1","i32"),h.addLocal("itIn2","i32"),h.addLocal("itOut","i32");let d=h.getCodeBuilder();e?h.addCode(d.setLocal("itIn1",d.i32_add(d.getLocal("pIn1"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(a)))),d.setLocal("itIn2",d.i32_add(d.getLocal("pIn2"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(a)))),d.setLocal("itOut",d.i32_add(d.getLocal("pOut"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(o)))),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn1"),d.getLocal("itIn2"),d.getLocal("itOut")),d.setLocal("itIn1",d.i32_sub(d.getLocal("itIn1"),d.i32_const(a))),d.setLocal("itIn2",d.i32_sub(d.getLocal("itIn2"),d.i32_const(a))),d.setLocal("itOut",d.i32_sub(d.getLocal("itOut"),d.i32_const(o))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0)))):h.addCode(d.setLocal("itIn1",d.getLocal("pIn1")),d.setLocal("itIn2",d.getLocal("pIn2")),d.setLocal("itOut",d.getLocal("pOut")),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn1"),d.getLocal("itIn2"),d.getLocal("itOut")),d.setLocal("itIn1",d.i32_add(d.getLocal("itIn1"),d.i32_const(a))),d.setLocal("itIn2",d.i32_add(d.getLocal("itIn2"),d.i32_const(a))),d.setLocal("itOut",d.i32_add(d.getLocal("itOut"),d.i32_const(o))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0))))}function N3(c,t){return c===t?0:c>t?1:-1}function kr(c){return c*c}function $3(c){return c%2n!==0n}function Ur(c){return c%2n===0n}function $c(c){return c<0n}function Fb(c){return c>0n}function Z3(c){return $c(c)?c.toString(2).length-1:c.toString(2).length}function Wi(c){return c<0n?-c:c}function Zo(c){return Wi(c)===1n}function j3(c,t){for(var n=0n,a=1n,o=t,e=Wi(c),h,d,b;e!==0n;)h=o/e,d=n,b=o,n=a,o=e,a=d-h*a,e=b-h*e;if(!Zo(o))throw new Error(c.toString()+" and "+t.toString()+" are not co-prime");return N3(n,0n)===-1&&(n=n+t),$c(c)?-n:n}function V3(c,t,n){if(n===0n)throw new Error("Cannot take modPow with modulus 0");var a=1n,o=c%n;for($c(t)&&(t=t*-1n,o=j3(o,n));Fb(t);){if(o===0n)return 0n;$3(t)&&(a=a*o%n),t=t/2n,o=kr(o)%n}return a}function Cb(c,t){return c=c>=0n?c:-c,t=t>=0n?t:-t,c===t?0:c>t?1:-1}function d3(c,t){return t===0n?!1:Zo(t)?!0:Cb(t,2n)===0?Ur(c):c%t===0n}function Bb(c){var t=Wi(c);if(Zo(t))return!1;if(t===2n||t===3n||t===5n)return!0;if(Ur(t)||d3(t,3n)||d3(t,5n))return!1;if(t<49n)return!0}function xb(c){return c-1n}function u3(c,t){for(var n=xb(c),a=n,o=0,e,h,d;Ur(a);)a=a/2n,o++;t:for(h=0;h<t.length;h++)if(!(c<t[h])&&(d=V3(BigInt(t[h]),a,c),!(Zo(d)||d===n))){for(e=o-1;e!=0;e--){if(d=kr(d)%c,Zo(d))return!1;if(d===n)continue t}return!1}return!0}function Ab(c){var t=Bb(c);if(t!==void 0)return t;var n=Wi(c),a=Z3(n);if(a<=64)return u3(n,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var o=Math.log(2)*Number(a),e=Math.ceil(o),h=[],d=0;d<e;d++)h.push(BigInt(d+2));return u3(n,h)}function Cr(c){if(typeof c=="bigint"||c.eq!==void 0)return c.toString(10);if(c instanceof Uint8Array)return Zi(c,0);if(Array.isArray(c))return c.map(Cr);if(typeof c=="object"){let t={};return Object.keys(c).forEach(a=>{t[a]=Cr(c[a])}),t}else return c}function Br(c){if(typeof c=="string"&&/^[0-9]+$/.test(c))return BigInt(c);if(typeof c=="string"&&/^0x[0-9a-fA-F]+$/.test(c))return BigInt(c);if(Array.isArray(c))return c.map(Br);if(typeof c=="object"){if(c===null)return null;let t={};return Object.keys(c).forEach(a=>{t[a]=Br(c[a])}),t}else return c}function cm(c){let t=BigInt(0),n=c.length,a=0,o=new DataView(c.buffer,c.byteOffset,c.byteLength);for(;n>0;)n>=4?(n-=4,t+=BigInt(o.getUint32(n))<<BigInt(a*8),a+=4):n>=2?(n-=2,t+=BigInt(o.getUint16(n))<<BigInt(a*8),a+=2):(n-=1,t+=BigInt(o.getUint8(n))<<BigInt(a*8),a+=1);return t}function sm(c,t){let n=c,a=new Uint8Array(t),o=new DataView(a.buffer),e=t;for(;e>0;)e-4>=0?(e-=4,o.setUint32(e,Number(n&BigInt(4294967295))),n=n>>BigInt(32)):e-2>=0?(e-=2,o.setUint16(e,Number(n&BigInt(65535))),n=n>>BigInt(16)):(e-=1,o.setUint8(e,Number(n&BigInt(255))),n=n>>BigInt(8));if(n)throw new Error("Number does not fit in this length");return a}function lm(c){let t=BigInt(0),n=0,a=new DataView(c.buffer,c.byteOffset,c.byteLength);for(;n<c.length;)n+4<=c.length?(t+=BigInt(a.getUint32(n,!0))<<BigInt(n*8),n+=4):n+2<=c.length?(t+=BigInt(a.getUint16(n,!0))<<BigInt(n*8),n+=2):(t+=BigInt(a.getUint8(n,!0))<<BigInt(n*8),n+=1);return t}function th(c,t){let n=c;typeof t>"u"&&(t=Math.floor((ji(c)-1)/8)+1,t==0&&(t=1));let a=new Uint8Array(t),o=new DataView(a.buffer),e=0;for(;e<t;)e+4<=t?(o.setUint32(e,Number(n&BigInt(4294967295)),!0),e+=4,n=n>>BigInt(32)):e+2<=t?(o.setUint16(e,Number(n&BigInt(65535)),!0),e+=2,n=n>>BigInt(16)):(o.setUint8(e,Number(n&BigInt(255)),!0),e+=1,n=n>>BigInt(8));if(n)throw new Error("Number does not fit in this length");return a}function xr(c,t){if(typeof t=="bigint"||t.eq!==void 0)return t.toString(10);if(t instanceof Uint8Array)return c.toString(c.e(t));if(Array.isArray(t))return t.map(xr.bind(this,c));if(typeof t=="object"){let n={};return Object.keys(t).forEach(o=>{n[o]=xr(c,t[o])}),n}else return t}function Ar(c,t){if(typeof t=="string"&&/^[0-9]+$/.test(t))return c.e(t);if(typeof t=="string"&&/^0x[0-9a-fA-F]+$/.test(t))return c.e(t);if(Array.isArray(t))return t.map(Ar.bind(this,c));if(typeof t=="object"){if(t===null)return null;let n={};return Object.keys(t).forEach(o=>{n[o]=Ar(c,t[o])}),n}else return t}function rm(c,t){let n=0,a=c;for(let o=0;o<t;o++)n<<=1,n=n|a&1,a>>=1;return n}function nh(c,t){return(Ni[c>>>24]|Ni[c>>>16&255]<<8|Ni[c>>>8&255]<<16|Ni[c&255]<<24)>>>32-t}function ta(c){return((c&4294901760)!==0?(c&=4294901760,16):0)|((c&4278255360)!==0?(c&=4278255360,8):0)|((c&4042322160)!==0?(c&=4042322160,4):0)|((c&3435973836)!==0?(c&=3435973836,2):0)|(c&2863311530)!==0}function ah(c,t){let n=c.byteLength/t,a=ta(n);if(n!=1<<a)throw new Error("Invalid number of pointers");for(let o=0;o<n;o++){let e=nh(o,a);if(o>e){let h=c.slice(o*t,(o+1)*t);c.set(c.slice(e*t,(e+1)*t),o*t),c.set(h,e*t)}}}function $r(c,t){let n=new Uint8Array(t*c.length);for(let a=0;a<c.length;a++)n.set(c[a],a*t);return n}function Pc(c,t){let n=c.byteLength/t,a=new Array(n);for(let o=0;o<n;o++)a[o]=c.slice(o*t,o*t+t);return a}function Xa(c,t,n,a){return async function(e){let h=Math.floor(e.byteLength/n);if(h*n!==e.byteLength)throw new Error("Invalid buffer size");let d=Math.floor(h/c.concurrency),b=[];for(let B=0;B<c.concurrency;B++){let p;if(B<c.concurrency-1?p=d:p=h-B*d,p==0)continue;let M=[{cmd:"ALLOCSET",var:0,buff:e.slice(B*d*n,B*d*n+p*n)},{cmd:"ALLOC",var:1,len:a*p},{cmd:"CALL",fnName:t,params:[{var:0},{val:p},{var:1}]},{cmd:"GET",out:0,var:1,len:a*p}];b.push(c.queueAction(M))}let l=await Promise.all(b),s;e instanceof pn?s=new pn(h*a):s=new Uint8Array(h*a);let m=0;for(let B=0;B<l.length;B++)s.set(l[B][0],m),m+=l[B][0].byteLength;return s}}function um(c){let n,a;c&&(c.onmessage=function(s){let m;if(s.data?m=s.data:m=s,m[0].cmd=="INIT")o(m[0]).then(function(){c.postMessage(m.result)});else if(m[0].cmd=="TERMINATE")c.close();else{let B=l(m);c.postMessage(B)}});async function o(s){let m=new Uint8Array(s.code),B=await WebAssembly.compile(m);a=new WebAssembly.Memory({initial:s.init,maximum:32767}),n=await WebAssembly.instantiate(B,{env:{memory:a}})}function e(s){let m=new Uint32Array(a.buffer,0,1);for(;m[0]&3;)m[0]++;let B=m[0];if(m[0]+=s,m[0]+s>a.buffer.byteLength){let p=a.buffer.byteLength/65536,v=Math.floor((m[0]+s)/65536)+1;v>32767&&(v=32767),a.grow(v-p)}return B}function h(s){let m=e(s.byteLength);return b(m,s),m}function d(s,m){let B=new Uint8Array(a.buffer);return new Uint8Array(B.buffer,B.byteOffset+s,m)}function b(s,m){new Uint8Array(a.buffer).set(new Uint8Array(m),s)}function l(s){if(s[0].cmd=="INIT")return o(s[0]);let m={vars:[],out:[]},p=new Uint32Array(a.buffer,0,1)[0];for(let M=0;M<s.length;M++)switch(s[M].cmd){case"ALLOCSET":m.vars[s[M].var]=h(s[M].buff);break;case"ALLOC":m.vars[s[M].var]=e(s[M].len);break;case"SET":b(m.vars[s[M].var],s[M].buff);break;case"CALL":{let x=[];for(let S=0;S<s[M].params.length;S++){let w=s[M].params[S];typeof w.var<"u"?x.push(m.vars[w.var]+(w.offset||0)):typeof w.val<"u"&&x.push(w.val)}n.exports[s[M].fnName](...x);break}case"GET":m.out[s[M].out]=d(m.vars[s[M].var],s[M].len).slice();break;default:throw new Error("Invalid cmd")}let v=new Uint32Array(a.buffer,0,1);return v[0]=p,m.out}return l}function _m(c){return new Promise(t=>setTimeout(t,c))}async function hm(c,t){let n=new Sr;n.memory=new WebAssembly.Memory({initial:_r}),n.u8=new Uint8Array(n.memory.buffer),n.u32=new Uint32Array(n.memory.buffer);let a=await WebAssembly.compile(c.code);if(n.instance=await WebAssembly.instantiate(a,{env:{memory:n.memory}}),globalThis?.Worker||(t=!0),n.singleThread=t,n.initalPFree=n.u32[0],n.pq=c.pq,n.pr=c.pr,n.pG1gen=c.pG1gen,n.pG1zero=c.pG1zero,n.pG2gen=c.pG2gen,n.pG2zero=c.pG2zero,n.pOneT=c.pOneT,t)n.code=c.code,n.taskManager=um(),await n.taskManager([{cmd:"INIT",init:_r,code:n.code.slice()}]),n.concurrency=1;else{n.workers=[],n.pendingDeferreds=[],n.working=[];let e=2;typeof navigator=="object"&&navigator.hardwareConcurrency&&(e=navigator.hardwareConcurrency),e==0&&(e=2),e>64&&(e=64),n.concurrency=e;for(let d=0;d<e;d++)n.workers[d]=new Worker(vr),n.workers[d].addEventListener("message",o(d)),n.working[d]=!1;let h=[];for(let d=0;d<n.workers.length;d++){let b=c.code.slice();h.push(n.postAction(d,[{cmd:"INIT",init:_r,code:b}],[b.buffer]))}await Promise.all(h)}return n;function o(e){return function(h){let d;h&&h.data?d=h.data:d=h,n.working[e]=!1,n.pendingDeferreds[e].resolve(d),n.processWorks()}}}function hr(c,t){let n=c[t],a=c.Fr,o=c.tm;c[t].batchApplyKey=async function(e,h,d,b,l){b=b||"affine",l=l||"affine";let s,m,B,p,v;if(t=="G1")b=="jacobian"?(B=n.F.n8*3,s="g1m_batchApplyKey"):(B=n.F.n8*2,s="g1m_batchApplyKeyMixed"),p=n.F.n8*3,l=="jacobian"?v=n.F.n8*3:(m="g1m_batchToAffine",v=n.F.n8*2);else if(t=="G2")b=="jacobian"?(B=n.F.n8*3,s="g2m_batchApplyKey"):(B=n.F.n8*2,s="g2m_batchApplyKeyMixed"),p=n.F.n8*3,l=="jacobian"?v=n.F.n8*3:(m="g2m_batchToAffine",v=n.F.n8*2);else if(t=="Fr")s="frm_batchApplyKey",B=n.n8,p=n.n8,v=n.n8;else throw new Error("Invalid group: "+t);let M=Math.floor(e.byteLength/B),x=Math.floor(M/o.concurrency),S=[];d=a.e(d);let w=a.e(h);for(let F=0;F<o.concurrency;F++){let u;if(F<o.concurrency-1?u=x:u=M-F*x,u==0)continue;let L=[];L.push({cmd:"ALLOCSET",var:0,buff:e.slice(F*x*B,F*x*B+u*B)}),L.push({cmd:"ALLOCSET",var:1,buff:w}),L.push({cmd:"ALLOCSET",var:2,buff:d}),L.push({cmd:"ALLOC",var:3,len:u*Math.max(p,v)}),L.push({cmd:"CALL",fnName:s,params:[{var:0},{val:u},{var:1},{var:2},{var:3}]}),m&&L.push({cmd:"CALL",fnName:m,params:[{var:3},{val:u},{var:3}]}),L.push({cmd:"GET",out:0,var:3,len:u*v}),S.push(o.queueAction(L)),w=a.mul(w,a.exp(d,u))}let k=await Promise.all(S),O;e instanceof pn?O=new pn(M*v):O=new Uint8Array(M*v);let W=0;for(let F=0;F<k.length;F++)O.set(k[F][0],W),W+=k[F][0].byteLength;return O}}function fm(c){let t=c.tm;c.pairing=function(a,o){t.startSyncOp();let e=t.allocBuff(c.G1.toJacobian(a)),h=t.allocBuff(c.G2.toJacobian(o)),d=t.alloc(c.Gt.n8);t.instance.exports[c.name+"_pairing"](e,h,d);let b=t.getBuff(d,c.Gt.n8);return t.endSyncOp(),b},c.pairingEq=async function(){let a,o;arguments.length%2==1?(a=arguments[arguments.length-1],o=(arguments.length-1)/2):(a=c.Gt.one,o=arguments.length/2);let e=[];for(let s=0;s<o;s++){let m=[],B=c.G1.toJacobian(arguments[s*2]);m.push({cmd:"ALLOCSET",var:0,buff:B}),m.push({cmd:"ALLOC",var:1,len:c.prePSize});let p=c.G2.toJacobian(arguments[s*2+1]);m.push({cmd:"ALLOCSET",var:2,buff:p}),m.push({cmd:"ALLOC",var:3,len:c.preQSize}),m.push({cmd:"ALLOC",var:4,len:c.Gt.n8}),m.push({cmd:"CALL",fnName:c.name+"_prepareG1",params:[{var:0},{var:1}]}),m.push({cmd:"CALL",fnName:c.name+"_prepareG2",params:[{var:2},{var:3}]}),m.push({cmd:"CALL",fnName:c.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),m.push({cmd:"GET",out:0,var:4,len:c.Gt.n8}),e.push(t.queueAction(m))}let h=await Promise.all(e);t.startSyncOp();let d=t.alloc(c.Gt.n8);t.instance.exports.ftm_one(d);for(let s=0;s<h.length;s++){let m=t.allocBuff(h[s][0]);t.instance.exports.ftm_mul(d,m,d)}t.instance.exports[c.name+"_finalExponentiation"](d,d);let b=t.allocBuff(a),l=!!t.instance.exports.ftm_eq(d,b);return t.endSyncOp(),l},c.prepareG1=function(n){this.tm.startSyncOp();let a=this.tm.allocBuff(n),o=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](a,o);let e=this.tm.getBuff(o,this.prePSize);return this.tm.endSyncOp(),e},c.prepareG2=function(n){this.tm.startSyncOp();let a=this.tm.allocBuff(n),o=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](a,o);let e=this.tm.getBuff(o,this.preQSize);return this.tm.endSyncOp(),e},c.millerLoop=function(n,a){this.tm.startSyncOp();let o=this.tm.allocBuff(n),e=this.tm.allocBuff(a),h=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](o,e,h);let d=this.tm.getBuff(h,this.Gt.n8);return this.tm.endSyncOp(),d},c.finalExponentiation=function(n){this.tm.startSyncOp();let a=this.tm.allocBuff(n),o=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](a,o);let e=this.tm.getBuff(o,this.Gt.n8);return this.tm.endSyncOp(),e}}function A3(c,t){let n=c[t],a=n.tm;async function o(h,d,b,l,s){if(!(h instanceof Uint8Array))throw l&&l.error(`${s} _multiExpChunk buffBases is not Uint8Array`),new Error(`${s} _multiExpChunk buffBases is not Uint8Array`);if(!(d instanceof Uint8Array))throw l&&l.error(`${s} _multiExpChunk buffScalars is not Uint8Array`),new Error(`${s} _multiExpChunk buffScalars is not Uint8Array`);b=b||"affine";let m,B;if(t=="G1")b=="affine"?(B="g1m_multiexpAffine_chunk",m=n.F.n8*2):(B="g1m_multiexp_chunk",m=n.F.n8*3);else if(t=="G2")b=="affine"?(B="g2m_multiexpAffine_chunk",m=n.F.n8*2):(B="g2m_multiexp_chunk",m=n.F.n8*3);else throw new Error("Invalid group");let p=Math.floor(h.byteLength/m);if(p==0)return n.zero;let v=Math.floor(d.byteLength/p);if(v*p!=d.byteLength)throw new Error("Scalar size does not match");let M=x3[ta(p)],x=Math.floor((v*8-1)/M)+1,S=[];for(let O=0;O<x;O++){let W=[{cmd:"ALLOCSET",var:0,buff:h},{cmd:"ALLOCSET",var:1,buff:d},{cmd:"ALLOC",var:2,len:n.F.n8*3},{cmd:"CALL",fnName:B,params:[{var:0},{var:1},{val:v},{val:p},{val:O*M},{val:Math.min(v*8-O*M,M)},{var:2}]},{cmd:"GET",out:0,var:2,len:n.F.n8*3}];S.push(n.tm.queueAction(W))}let w=await Promise.all(S),k=n.zero;for(let O=w.length-1;O>=0;O--){if(!n.isZero(k))for(let W=0;W<M;W++)k=n.double(k);k=n.add(k,w[O][0])}return k}async function e(h,d,b,l,s){let p;if(t=="G1")b=="affine"?p=n.F.n8*2:p=n.F.n8*3;else if(t=="G2")b=="affine"?p=n.F.n8*2:p=n.F.n8*3;else throw new Error("Invalid group");let v=Math.floor(h.byteLength/p);if(v==0)return n.zero;let M=Math.floor(d.byteLength/v);if(M*v!=d.byteLength)throw new Error("Scalar size does not match");let x=x3[ta(v)],S=Math.floor((M*8-1)/x)+1,w;w=Math.floor(v/(a.concurrency/S)),w>4194304&&(w=4194304),w<1024&&(w=1024);let k=[];for(let F=0;F<v;F+=w){l&&l.debug(`Multiexp start: ${s}: ${F}/${v}`);let u=Math.min(v-F,w),L=h.slice(F*p,(F+u)*p),$=d.slice(F*M,(F+u)*M);k.push(o(L,$,b,l,s).then(Q=>(l&&l.debug(`Multiexp end: ${s}: ${F}/${v}`),Q)))}let O=await Promise.all(k),W=n.zero;for(let F=O.length-1;F>=0;F--)W=n.add(W,O[F]);return W}n.multiExp=async function(d,b,l,s){return await e(d,b,"jacobian",l,s)},n.multiExpAffine=async function(d,b,l,s){return await e(d,b,"affine",l,s)}}function fr(c,t){let n=c[t],a=c.Fr,o=n.tm;async function e(l,s,m,B,p,v){m=m||"affine",B=B||"affine";let M=14,x,S,w,k,O,W,F,u;t=="G1"?(m=="affine"?(x=n.F.n8*2,k="g1m_batchToJacobian"):x=n.F.n8*3,S=n.F.n8*3,s&&(u="g1m_fftFinal"),F="g1m_fftJoin",W="g1m_fftMix",B=="affine"?(w=n.F.n8*2,O="g1m_batchToAffine"):w=n.F.n8*3):t=="G2"?(m=="affine"?(x=n.F.n8*2,k="g2m_batchToJacobian"):x=n.F.n8*3,S=n.F.n8*3,s&&(u="g2m_fftFinal"),F="g2m_fftJoin",W="g2m_fftMix",B=="affine"?(w=n.F.n8*2,O="g2m_batchToAffine"):w=n.F.n8*3):t=="Fr"&&(x=n.n8,S=n.n8,w=n.n8,s&&(u="frm_fftFinal"),W="frm_fftMix",F="frm_fftJoin");let L=!1;Array.isArray(l)?(l=$r(l,x),L=!0):l=l.slice(0,l.byteLength);let $=l.byteLength/x,Q=ta($);if(1<<Q!=$)throw new Error("fft must be multiple of 2");if(Q==a.s+1){let j;return s?j=await d(l,m,B,p,v):j=await h(l,m,B,p,v),L?Pc(j,w):j}let H;s&&(H=a.inv(a.e($)));let q;ah(l,x);let y,I=Math.min(1<<M,$),N=$/I;for(;N<o.concurrency&&I>=16;)N*=2,I/=2;let nt=ta(I),J=[];for(let j=0;j<N;j++){p&&p.debug(`${v}: fft ${Q} mix start: ${j}/${N}`);let ot=[];ot.push({cmd:"ALLOC",var:0,len:S*I});let V=l.slice(I*j*x,I*(j+1)*x);ot.push({cmd:"SET",var:0,buff:V}),k&&ot.push({cmd:"CALL",fnName:k,params:[{var:0},{val:I},{var:0}]});for(let at=1;at<=nt;at++)ot.push({cmd:"CALL",fnName:W,params:[{var:0},{val:I},{val:at}]});nt==Q?(u&&(ot.push({cmd:"ALLOCSET",var:1,buff:H}),ot.push({cmd:"CALL",fnName:u,params:[{var:0},{val:I},{var:1}]})),O&&ot.push({cmd:"CALL",fnName:O,params:[{var:0},{val:I},{var:0}]}),ot.push({cmd:"GET",out:0,var:0,len:I*w})):ot.push({cmd:"GET",out:0,var:0,len:S*I}),J.push(o.queueAction(ot).then(at=>(p&&p.debug(`${v}: fft ${Q} mix end: ${j}/${N}`),at)))}y=await Promise.all(J);for(let j=0;j<N;j++)y[j]=y[j][0];for(let j=nt+1;j<=Q;j++){p&&p.debug(`${v}: fft  ${Q}  join: ${j}/${Q}`);let ot=1<<Q-j,V=N/ot,at=[];for(let rt=0;rt<ot;rt++)for(let ht=0;ht<V/2;ht++){let A=a.exp(a.w[j],ht*I),i=a.w[j],C=rt*V+ht,r=rt*V+ht+V/2,z=[];z.push({cmd:"ALLOCSET",var:0,buff:y[C]}),z.push({cmd:"ALLOCSET",var:1,buff:y[r]}),z.push({cmd:"ALLOCSET",var:2,buff:A}),z.push({cmd:"ALLOCSET",var:3,buff:i}),z.push({cmd:"CALL",fnName:F,params:[{var:0},{var:1},{val:I},{var:2},{var:3}]}),j==Q?(u&&(z.push({cmd:"ALLOCSET",var:4,buff:H}),z.push({cmd:"CALL",fnName:u,params:[{var:0},{val:I},{var:4}]}),z.push({cmd:"CALL",fnName:u,params:[{var:1},{val:I},{var:4}]})),O&&(z.push({cmd:"CALL",fnName:O,params:[{var:0},{val:I},{var:0}]}),z.push({cmd:"CALL",fnName:O,params:[{var:1},{val:I},{var:1}]})),z.push({cmd:"GET",out:0,var:0,len:I*w}),z.push({cmd:"GET",out:1,var:1,len:I*w})):(z.push({cmd:"GET",out:0,var:0,len:I*S}),z.push({cmd:"GET",out:1,var:1,len:I*S})),at.push(o.queueAction(z).then(E=>(p&&p.debug(`${v}: fft ${Q} join  ${j}/${Q}  ${rt+1}/${ot} ${ht}/${V/2}`),E)))}let Lt=await Promise.all(at);for(let rt=0;rt<ot;rt++)for(let ht=0;ht<V/2;ht++){let A=rt*V+ht,i=rt*V+ht+V/2,C=Lt.shift();y[A]=C[0],y[i]=C[1]}}if(l instanceof pn?q=new pn($*w):q=new Uint8Array($*w),s){q.set(y[0].slice((I-1)*w));let j=w;for(let ot=N-1;ot>0;ot--)q.set(y[ot],j),j+=I*w,delete y[ot];q.set(y[0].slice(0,(I-1)*w),j),delete y[0]}else for(let j=0;j<N;j++)q.set(y[j],I*w*j),delete y[j];return L?Pc(q,w):q}async function h(l,s,m,B,p){let v,M;v=l.slice(0,l.byteLength/2),M=l.slice(l.byteLength/2,l.byteLength);let x=[];[v,M]=await b(v,M,"fftJoinExt",a.one,a.shift,s,"jacobian",B,p),x.push(e(v,!1,"jacobian",m,B,p)),x.push(e(M,!1,"jacobian",m,B,p));let S=await Promise.all(x),w;return S[0].byteLength>1<<28?w=new pn(S[0].byteLength*2):w=new Uint8Array(S[0].byteLength*2),w.set(S[0]),w.set(S[1],S[0].byteLength),w}async function d(l,s,m,B,p){let v,M;v=l.slice(0,l.byteLength/2),M=l.slice(l.byteLength/2,l.byteLength);let x=[];x.push(e(v,!0,s,"jacobian",B,p)),x.push(e(M,!0,s,"jacobian",B,p)),[v,M]=await Promise.all(x);let S=await b(v,M,"fftJoinExtInv",a.one,a.shiftInv,"jacobian",m,B,p),w;return S[0].byteLength>1<<28?w=new pn(S[0].byteLength*2):w=new Uint8Array(S[0].byteLength*2),w.set(S[0]),w.set(S[1],S[0].byteLength),w}async function b(l,s,m,B,p,v,M,x,S){let O,W,F,u,L,$;if(t=="G1")v=="affine"?(L=n.F.n8*2,W="g1m_batchToJacobian"):L=n.F.n8*3,$=n.F.n8*3,O="g1m_"+m,M=="affine"?(F="g1m_batchToAffine",u=n.F.n8*2):u=n.F.n8*3;else if(t=="G2")v=="affine"?(L=n.F.n8*2,W="g2m_batchToJacobian"):L=n.F.n8*3,O="g2m_"+m,$=n.F.n8*3,M=="affine"?(F="g2m_batchToAffine",u=n.F.n8*2):u=n.F.n8*3;else if(t=="Fr")L=a.n8,u=a.n8,$=a.n8,O="frm_"+m;else throw new Error("Invalid group");if(l.byteLength!=s.byteLength)throw new Error("Invalid buffer size");let Q=Math.floor(l.byteLength/L);if(Q!=1<<ta(Q))throw new Error("Invalid number of points");let H=Math.floor(Q/o.concurrency);H<16&&(H=16),H>65536&&(H=65536);let q=[];for(let J=0;J<Q;J+=H){x&&x.debug(`${S}: fftJoinExt Start: ${J}/${Q}`);let j=Math.min(Q-J,H),ot=a.mul(B,a.exp(p,J)),V=[],at=l.slice(J*L,(J+j)*L),Lt=s.slice(J*L,(J+j)*L);V.push({cmd:"ALLOC",var:0,len:$*j}),V.push({cmd:"SET",var:0,buff:at}),V.push({cmd:"ALLOC",var:1,len:$*j}),V.push({cmd:"SET",var:1,buff:Lt}),V.push({cmd:"ALLOCSET",var:2,buff:ot}),V.push({cmd:"ALLOCSET",var:3,buff:p}),W&&(V.push({cmd:"CALL",fnName:W,params:[{var:0},{val:j},{var:0}]}),V.push({cmd:"CALL",fnName:W,params:[{var:1},{val:j},{var:1}]})),V.push({cmd:"CALL",fnName:O,params:[{var:0},{var:1},{val:j},{var:2},{var:3},{val:a.s}]}),F&&(V.push({cmd:"CALL",fnName:F,params:[{var:0},{val:j},{var:0}]}),V.push({cmd:"CALL",fnName:F,params:[{var:1},{val:j},{var:1}]})),V.push({cmd:"GET",out:0,var:0,len:j*u}),V.push({cmd:"GET",out:1,var:1,len:j*u}),q.push(o.queueAction(V).then(rt=>(x&&x.debug(`${S}: fftJoinExt End: ${J}/${Q}`),rt)))}let y=await Promise.all(q),I,N;Q*u>1<<28?(I=new pn(Q*u),N=new pn(Q*u)):(I=new Uint8Array(Q*u),N=new Uint8Array(Q*u));let nt=0;for(let J=0;J<y.length;J++)I.set(y[J][0],nt),N.set(y[J][1],nt),nt+=y[J][0].byteLength;return[I,N]}n.fft=async function(l,s,m,B,p){return await e(l,!1,s,m,B,p)},n.ifft=async function(l,s,m,B,p){return await e(l,!0,s,m,B,p)},n.lagrangeEvaluations=async function(l,s,m,B,p){s=s||"affine",m=m||"affine";let v;if(t=="G1")s=="affine"?v=n.F.n8*2:v=n.F.n8*3;else if(t=="G2")s=="affine"?v=n.F.n8*2:v=n.F.n8*3;else if(t=="Fr")v=a.n8;else throw new Error("Invalid group");let M=l.byteLength/v,x=ta(M);if(2**x*v!=l.byteLength)throw B&&B.error("lagrangeEvaluations iinvalid input size"),new Error("lagrangeEvaluations invalid Input size");if(x<=a.s)return await n.ifft(l,s,m,B,p);if(x>a.s+1)throw B&&B.error("lagrangeEvaluations input too big"),new Error("lagrangeEvaluations input too big");let S=l.slice(0,l.byteLength/2),w=l.slice(l.byteLength/2,l.byteLength),k=a.exp(a.shift,M/2),O=a.inv(a.sub(a.one,k));[S,w]=await b(S,w,"prepareLagrangeEvaluation",O,a.shiftInv,s,"jacobian",B,p+" prep");let W=[];W.push(e(S,!0,"jacobian",m,B,p+" t0")),W.push(e(w,!0,"jacobian",m,B,p+" t1")),[S,w]=await Promise.all(W);let F;return S.byteLength>1<<28?F=new pn(S.byteLength*2):F=new Uint8Array(S.byteLength*2),F.set(S),F.set(w,S.byteLength),F},n.fftMix=async function(s){let m=n.F.n8*3,B,p;if(t=="G1")B="g1m_fftMix",p="g1m_fftJoin";else if(t=="G2")B="g2m_fftMix",p="g2m_fftJoin";else if(t=="Fr")B="frm_fftMix",p="frm_fftJoin";else throw new Error("Invalid group");let v=Math.floor(s.byteLength/m),M=ta(v),x=1<<ta(o.concurrency);v<=x*2&&(x=1);let S=v/x,w=ta(S),k=[];for(let L=0;L<x;L++){let $=[],Q=s.slice(L*S*m,(L+1)*S*m);$.push({cmd:"ALLOCSET",var:0,buff:Q});for(let H=1;H<=w;H++)$.push({cmd:"CALL",fnName:B,params:[{var:0},{val:S},{val:H}]});$.push({cmd:"GET",out:0,var:0,len:S*m}),k.push(o.queueAction($))}let O=await Promise.all(k),W=[];for(let L=0;L<O.length;L++)W[L]=O[L][0];for(let L=w+1;L<=M;L++){let $=1<<M-L,Q=x/$,H=[];for(let y=0;y<$;y++)for(let I=0;I<Q/2;I++){let N=a.exp(a.w[L],I*S),nt=a.w[L],J=y*Q+I,j=y*Q+I+Q/2,ot=[];ot.push({cmd:"ALLOCSET",var:0,buff:W[J]}),ot.push({cmd:"ALLOCSET",var:1,buff:W[j]}),ot.push({cmd:"ALLOCSET",var:2,buff:N}),ot.push({cmd:"ALLOCSET",var:3,buff:nt}),ot.push({cmd:"CALL",fnName:p,params:[{var:0},{var:1},{val:S},{var:2},{var:3}]}),ot.push({cmd:"GET",out:0,var:0,len:S*m}),ot.push({cmd:"GET",out:1,var:1,len:S*m}),H.push(o.queueAction(ot))}let q=await Promise.all(H);for(let y=0;y<$;y++)for(let I=0;I<Q/2;I++){let N=y*Q+I,nt=y*Q+I+Q/2,J=q.shift();W[N]=J[0],W[nt]=J[1]}}let F;s instanceof pn?F=new pn(v*m):F=new Uint8Array(v*m);let u=0;for(let L=0;L<x;L++)F.set(W[L],u),u+=W[L].byteLength;return F},n.fftJoin=async function(s,m,B,p){let v=n.F.n8*3,M;if(t=="G1")M="g1m_fftJoin";else if(t=="G2")M="g2m_fftJoin";else if(t=="Fr")M="frm_fftJoin";else throw new Error("Invalid group");if(s.byteLength!=m.byteLength)throw new Error("Invalid buffer size");let x=Math.floor(s.byteLength/v);if(x!=1<<ta(x))throw new Error("Invalid number of points");let S=1<<ta(o.concurrency);x<=S*2&&(S=1);let w=x/S,k=[];for(let L=0;L<S;L++){let $=[],Q=a.mul(B,a.exp(p,L*w)),H=s.slice(L*w*v,(L+1)*w*v),q=m.slice(L*w*v,(L+1)*w*v);$.push({cmd:"ALLOCSET",var:0,buff:H}),$.push({cmd:"ALLOCSET",var:1,buff:q}),$.push({cmd:"ALLOCSET",var:2,buff:Q}),$.push({cmd:"ALLOCSET",var:3,buff:p}),$.push({cmd:"CALL",fnName:M,params:[{var:0},{var:1},{val:w},{var:2},{var:3}]}),$.push({cmd:"GET",out:0,var:0,len:w*v}),$.push({cmd:"GET",out:1,var:1,len:w*v}),k.push(o.queueAction($))}let O=await Promise.all(k),W,F;s instanceof pn?(W=new pn(x*v),F=new pn(x*v)):(W=new Uint8Array(x*v),F=new Uint8Array(x*v));let u=0;for(let L=0;L<O.length;L++)W.set(O[L][0],u),F.set(O[L][1],u),u+=O[L][0].byteLength;return[W,F]},n.fftFinal=async function(s,m){let B=n.F.n8*3,p=n.F.n8*2,v,M;if(t=="G1")v="g1m_fftFinal",M="g1m_batchToAffine";else if(t=="G2")v="g2m_fftFinal",M="g2m_batchToAffine";else throw new Error("Invalid group");let x=Math.floor(s.byteLength/B);if(x!=1<<ta(x))throw new Error("Invalid number of points");let S=Math.floor(x/o.concurrency),w=[];for(let F=0;F<o.concurrency;F++){let u;if(F<o.concurrency-1?u=S:u=x-F*S,u==0)continue;let L=[],$=s.slice(F*S*B,(F*S+u)*B);L.push({cmd:"ALLOCSET",var:0,buff:$}),L.push({cmd:"ALLOCSET",var:1,buff:m}),L.push({cmd:"CALL",fnName:v,params:[{var:0},{val:u},{var:1}]}),L.push({cmd:"CALL",fnName:M,params:[{var:0},{val:u},{var:0}]}),L.push({cmd:"GET",out:0,var:0,len:u*p}),w.push(o.queueAction(L))}let k=await Promise.all(w),O;s instanceof pn?O=new pn(x*p):O=new Uint8Array(x*p);let W=0;for(let F=k.length-1;F>=0;F--)O.set(k[F][0],W),W+=k[F][0].byteLength;return O}}async function oh(c){let t=await hm(c.wasm,c.singleThread),n={};return n.q=wn(c.wasm.q.toString()),n.r=wn(c.wasm.r.toString()),n.name=c.name,n.tm=t,n.prePSize=c.wasm.prePSize,n.preQSize=c.wasm.preQSize,n.Fr=new Mc(t,"frm",c.n8r,c.r),n.F1=new Mc(t,"f1m",c.n8q,c.q),n.F2=new Rc(t,"f2m",n.F1),n.G1=new zc(t,"g1m",n.F1,c.wasm.pG1gen,c.wasm.pG1b,c.cofactorG1),n.G2=new zc(t,"g2m",n.F2,c.wasm.pG2gen,c.wasm.pG2b,c.cofactorG2),n.F6=new Er(t,"f6m",n.F2),n.F12=new Rc(t,"ftm",n.F6),n.Gt=n.F12,hr(n,"G1"),hr(n,"G2"),hr(n,"Fr"),A3(n,"G1"),A3(n,"G2"),fr(n,"G1"),fr(n,"G2"),fr(n,"Fr"),fm(n),n.array2buffer=function(a,o){let e=new Uint8Array(o*a.length);for(let h=0;h<a.length;h++)e.set(a[h],h*o);return e},n.buffer2array=function(a,o){let e=a.byteLength/o,h=new Array(e);for(let d=0;d<e;d++)h[d]=a.slice(d*o,d*o+o);return h},n}function jo(c){return BigInt(c)}function ih(c){return c<0n}function gm(c){return c===0n}function Lm(c){return ih(c)?c.toString(2).length-1:c.toString(2).length}function gr(c){let t=[],n=jo(c);return t.push(Number(n&0xFFn)),t.push(Number(n>>8n&0xFFn)),t.push(Number(n>>16n&0xFFn)),t.push(Number(n>>24n&0xFFn)),t}function pm(c){for(var t=[],n=0;n<c.length;n++){var a=c.charCodeAt(n);a<128?t.push(a):a<2048?t.push(192|a>>6,128|a&63):a<55296||a>=57344?t.push(224|a>>12,128|a>>6&63,128|a&63):(n++,a=65536+((a&1023)<<10|c.charCodeAt(n)&1023),t.push(240|a>>18,128|a>>12&63,128|a>>6&63,128|a&63))}return t}function ki(c){let t=pm(c);return[...Xt(t.length),...t]}function eh(c){let t=[],n=jo(c);if(ih(n))throw new Error("Number cannot be negative");for(;!gm(n);)t.push(Number(n&0x7Fn)),n=n>>7n;t.length==0&&t.push(0);for(let a=0;a<t.length-1;a++)t[a]=t[a]|128;return t}function ch(c){let t,n,a=Lm(c);c<0?(n=!0,t=(1n<<BigInt(a))+c):(n=!1,t=jo(c));let o=7-a%7,e=(1n<<BigInt(o))-1n<<BigInt(a),h=(1<<7-o)-1|128,d=eh(t+e);return n||(d[d.length-1]=d[d.length-1]&h),d}function qr(c){let t=jo(c);if(t>0xFFFFFFFFn)throw new Error("Number too big");if(t>0x7FFFFFFFn&&(t=t-0x100000000n),t<-2147483648n)throw new Error("Number too small");return ch(t)}function bm(c){let t=jo(c);if(t>0xFFFFFFFFFFFFFFFFn)throw new Error("Number too big");if(t>0x7FFFFFFFFFFFFFFFn&&(t=t-0x10000000000000000n),t<-9223372036854775808n)throw new Error("Number too small");return ch(t)}function Xt(c){let t=jo(c);if(t>0xFFFFFFFFn)throw new Error("Number too big");return eh(t)}function E3(c){return Array.from(c,function(t){return("0"+(t&255).toString(16)).slice(-2)}).join("")}async function Zc(c,t){if(!c&&globalThis.curve_bn128)return globalThis.curve_bn128;let n=new kc;n.setMemory(25),im(n),t&&t(n);let a={};a.code=n.build(),a.pq=n.modules.f1m.pq,a.pr=n.modules.frm.pq,a.pG1gen=n.modules.bn128.pG1gen,a.pG1zero=n.modules.bn128.pG1zero,a.pG1b=n.modules.bn128.pG1b,a.pG2gen=n.modules.bn128.pG2gen,a.pG2zero=n.modules.bn128.pG2zero,a.pG2b=n.modules.bn128.pG2b,a.pOneT=n.modules.bn128.pOneT,a.prePSize=n.modules.bn128.prePSize,a.preQSize=n.modules.bn128.preQSize,a.n8q=32,a.n8r=32,a.q=n.modules.bn128.q,a.r=n.modules.bn128.r;let o={name:"bn128",wasm:a,q:wn("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:wn("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:wn("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!c},e=await oh(o);return e.terminate=async function(){o.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},c||(globalThis.curve_bn128=e),e}async function jc(c,t){if(!c&&globalThis.curve_bls12381)return globalThis.curve_bls12381;let n=new kc;n.setMemory(25),em(n),t&&t(n);let a={};a.code=n.build(),a.pq=n.modules.f1m.pq,a.pr=n.modules.frm.pq,a.pG1gen=n.modules.bls12381.pG1gen,a.pG1zero=n.modules.bls12381.pG1zero,a.pG1b=n.modules.bls12381.pG1b,a.pG2gen=n.modules.bls12381.pG2gen,a.pG2zero=n.modules.bls12381.pG2zero,a.pG2b=n.modules.bls12381.pG2b,a.pOneT=n.modules.bls12381.pOneT,a.prePSize=n.modules.bls12381.prePSize,a.preQSize=n.modules.bls12381.preQSize,a.n8q=48,a.n8r=32,a.q=n.modules.bls12381.q,a.r=n.modules.bls12381.r;let o={name:"bls12381",wasm:a,q:wn("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:wn("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:wn("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:wn("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!c},e=await oh(o);return e.terminate=async function(){o.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},c||(globalThis.curve_bls12381=e),e}async function Cm(c,t,n){let a;if(ha(c,ym))a=await Zc(t,n);else if(ha(c,mm))a=await jc(t,n);else throw new Error(`Curve not supported: ${Nc(c)}`);return a}async function Bm(c,t,n){let a;if(ha(c,Fm))a=await Zc(t,n);else if(ha(c,wm))a=await jc(t,n);else throw new Error(`Curve not supported: ${Nc(c,16)}`);return a}async function xm(c,t,n){let a,o=e(c);if(["BN128","BN254","ALTBN128"].indexOf(o)>=0)a=await Zc(t,n);else if(["BLS12381"].indexOf(o)>=0)a=await jc(t,n);else throw new Error(`Curve not supported: ${c}`);return a;function e(h){return h.toUpperCase().match(/[A-Za-z0-9]+/g).join("")}}var Zp,wn,Vp,Wp,T3,ho,eb,pr,Ui,Ic,Bc,br,mr,yr,wr,Fr,Ha,pb,Tr,Gr,U3,yb,Xn,Eb,Pa,vb,Sb,cr,sr,qb,lr,_3,h3,Ib,Ob,Nr,Pb,Mb,W3,Rb,zb,rr,Q3,Tb,Gb,X3,kb,Ub,f3,Ri,g3,H3,Nb,L3,zi,xc,D3,K3,J3,Y3,an,$b,Zb,p3,jb,b3,dr,Vb,Wb,Ti,Qb,Xb,m3,Hb,Db,Qt,Kb,Jb,y3,Yb,w3,ur,tm,nm,Gi,F3,C3,am,om,im,em,Ni,dm,Rn,pn,Mc,Rc,Er,zc,_r,Tc,vr,B3,Sr,x3,Ir,Lr,Gc,kc,mm,ym,wm,Fm,Am,Em,lh=xe(()=>{Zp=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];wn=Uc;Vp=Ec,Wp=ko;T3=wn(0),ho=wn(1),eb=Object.freeze({__proto__:null,abs:Dp,add:Mr,band:Rr,bitLength:ji,bits:q3,bor:tb,bxor:nb,div:Uo,e:wn,eq:ha,exp:Hp,fromArray:jp,fromRprBE:z3,fromRprLE:Zi,fromString:Uc,geq:M3,gt:vc,isNegative:v3,isOdd:Pr,isZero:Or,land:ab,leq:Yp,lnot:ib,lor:ob,lt:Jp,mod:Ca,mul:P3,naf:S3,neg:O3,neq:Kp,one:ho,pow:Vi,shiftLeft:Ec,shiftRight:ko,shl:Vp,shr:Wp,square:Xp,sub:Ma,toArray:Qp,toLEBuff:No,toNumber:I3,toRprBE:R3,toRprLE:$i,toString:Nc,zero:T3}),pr=class{constructor(t){this.F=t;let n=t.sqrt_t,a=t.sqrt_s,o=this.F.add(this.F.add(this.F.two,this.F.two),this.F.one);this.w=new Array(a+1),this.wi=new Array(a+1),this.w[a]=this.F.pow(o,n),this.wi[a]=this.F.inv(this.w[a]);let e=a-1;for(;e>=0;)this.w[e]=this.F.square(this.w[e+1]),this.wi[e]=this.F.square(this.wi[e+1]),e--;this.roots=[],this._setRoots(15)}_setRoots(t){t>this.F.sqrt_s&&(t=this.s);for(let n=t;n>=0&&!this.roots[n];n--){let a=this.F.one,o=1<<n,e=new Array(o);for(let h=0;h<o;h++)e[h]=a,a=this.F.mul(a,this.w[n]);this.roots[n]=e}}add(t,n){let a=Math.max(t.length,n.length),o=new Array(a);for(let e=0;e<a;e++)o[e]=this.F.add(t[e]||this.F.zero,n[e]||this.F.zero);return this.reduce(o)}double(t){return this.add(t,t)}sub(t,n){let a=Math.max(t.length,n.length),o=new Array(a);for(let e=0;e<a;e++)o[e]=this.F.sub(t[e]||this.F.zero,n[e]||this.F.zero);return this.reduce(o)}mulScalar(t,n){if(this.F.eq(n,this.F.zero))return[];if(this.F.eq(n,this.F.one))return t;let a=new Array(t.length);for(let o=0;o<t.length;o++)a[o]=this.F.mul(t[o],n);return a}mul(t,n){return t.length==0?[]:n.length==0?[]:t.length==1?this.mulScalar(n,t[0]):n.length==1?this.mulScalar(t,n[0]):(n.length>t.length&&([n,t]=[t,n]),n.length<=2||n.length<Fa(t.length)?this.mulNormal(t,n):this.mulFFT(t,n))}mulNormal(t,n){let a=[];for(let o=0;o<n.length;o++)a=this.add(a,this.scaleX(this.mulScalar(t,n[o]),o));return a}mulFFT(t,n){let a=Math.max(t.length,n.length),o=Fa(a-1)+2;this._setRoots(o);let e=1<<o,h=this.extend(t,e),d=this.extend(n,e),b=fo(this,h,o,0,1),l=fo(this,d,o,0,1),s=new Array(e);for(let v=0;v<e;v++)s[v]=this.F.mul(b[v],l[v]);let m=fo(this,s,o,0,1),B=this.F.inv(this.F.mulScalar(this.F.one,e)),p=new Array(e);for(let v=0;v<e;v++)p[v]=this.F.mul(m[(e-v)%e],B);return this.reduce(p)}square(t){return this.mul(t,t)}scaleX(t,n){return n==0?t:n>0?new Array(n).fill(this.F.zero).concat(t):-n>=t.length?[]:t.slice(-n)}eval2(t,n){let a=this.F.zero,o=this.F.one;for(let e=0;e<t.length;e++)a=this.F.add(a,this.F.mul(t[e],o)),o=this.F.mul(o,n);return a}evaluate(t,n){let a=this.F;if(t.length==0)return a.zero;let o=this._next2Power(t.length),e=this.extend(t,o);return h(e,n,0,1,o);function h(d,b,l,s,m){if(m==1)return d[l];let B=a.square(b);return a.add(h(d,B,l,s<<1,m>>1),a.mul(b,h(d,B,l+s,s<<1,m>>1)))}}lagrange(t){let n=[this.F.one];for(let o=0;o<t.length;o++)n=this.mul(n,[this.F.neg(t[o][0]),this.F.one]);let a=[];for(let o=0;o<t.length;o++){let e=this.ruffini(n,t[o][0]),h=this.F.mul(this.F.inv(this.evaluate(e,t[o][0])),t[o][1]);e=this.mulScalar(e,h),a=this.add(a,e)}return a}fft(t){if(t.length<=1)return t;let n=Fa(t.length-1)+1;this._setRoots(n);let a=1<<n,o=this.extend(t,a);return fo(this,o,n,0,1)}fft2(t){if(t.length<=1)return t;let n=Fa(t.length-1)+1;this._setRoots(n);let a=1<<n,o=this.extend(t,a);return l3(o,n),Sc(this,o,n)}ifft(t){if(t.length<=1)return t;let n=Fa(t.length-1)+1;this._setRoots(n);let a=1<<n,o=this.extend(t,a),e=fo(this,o,n,0,1),h=this.F.inv(this.F.mulScalar(this.F.one,a)),d=new Array(a);for(let b=0;b<a;b++)d[b]=this.F.mul(e[(a-b)%a],h);return d}ifft2(t){if(t.length<=1)return t;let n=Fa(t.length-1)+1;this._setRoots(n);let a=1<<n,o=this.extend(t,a);l3(o,n);let e=Sc(this,o,n),h=this.F.inv(this.F.mulScalar(this.F.one,a)),d=new Array(a);for(let b=0;b<a;b++)d[b]=this.F.mul(e[(a-b)%a],h);return d}_fft(t,n,a,o){let e=1<<n;if(e==1)return[t[a]];let h=e>>1,d=this._fft(t,n-1,a,o*2),b=this._fft(t,n-1,a+o,o*2),l=new Array(e),s=this.F.one;for(let m=0;m<h;m++)l[m]=this.F.add(d[m],this.F.mul(s,b[m])),l[m+h]=this.F.sub(d[m],this.F.mul(s,b[m])),s=this.F.mul(s,this.w[n]);return l}extend(t,n){if(n==t.length)return t;let a=new Array(n-t.length).fill(this.F.zero);return t.concat(a)}reduce(t){if(t.length==0||!this.F.eq(t[t.length-1],this.F.zero))return t;let n=t.length-1;for(;n>0&&this.F.eq(t[n],this.F.zero);)n--;return t.slice(0,n+1)}eq(t,n){let a=this.reduce(t),o=this.reduce(n);if(a.length!=o.length)return!1;for(let e=0;e<o.length;e++)if(!this.F.eq(a[e],o[e]))return!1;return!0}ruffini(t,n){let a=new Array(t.length-1);a[a.length-1]=t[t.length-1];for(let o=a.length-2;o>=0;o--)a[o]=this.F.add(this.F.mul(a[o+1],n),t[o+1]);return a}_next2Power(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t++,t}toString(t){let n=this.normalize(t),a="";for(let o=n.length-1;o>=0;o--)this.F.eq(t[o],this.F.zero)||(a!=""&&(a+=" + "),a=a+t[o].toString(10),o>0&&(a=a+"x",o>1&&(a=a+"^"+o)));return a}normalize(t){let n=new Array(t.length);for(let a=0;a<t.length;a++)n[a]=this.F.normalize(t[a]);return n}_reciprocal(t,n){let a=1<<n;if(a==1)return[this.F.inv(t[0])];let o=this.scaleX(t,-a/2),e=this._reciprocal(o,n-1),h=this.scaleX(this.double(e),3*a/2-2),d=this.mul(this.square(e),t);return this.scaleX(this.sub(h,d),-(a-2))}_div2(t,n){let a=Fa(n.length-1)+1,o=1<<a,e=o-n.length,h=this._reciprocal(this.scaleX(n,e),a);return this.scaleX(h,t-2*o+2+e)}div(t,n){if(t.length<n.length)return[];let a=Fa(n.length-1)+1,o=1<<a,e=this.scaleX(t,o-n.length),h=this.scaleX(n,o-n.length),d=h.length-1,b=e.length-1,l=this._reciprocal(h,a),s;b>2*d&&(s=this.sub(this.scaleX([this.F.one],2*d),this.mul(l,h)));let m=[],B=e,p,v,M=!1;for(;!M;)p=this.mul(B,l),m=this.add(m,this.scaleX(p,-2*d)),b>2*d?(v=this.mul(B,s),B=this.scaleX(v,-2*d),b=B.length-1):M=!0;return m}oneRoot(t,n){let a=Fa(t-1)+1,o=this.F.one,e=n;if(n>=t)throw new Error("Given 'i' should be lower than 'n'");if(1<<a!==t)throw new Error(`Internal errlr: ${t} should equal ${1<<a}`);for(;e>0;)e&!0&&(o=this.F.mul(o,this.w[a])),e=e>>1,a--;return o}computeVanishingPolinomial(t,n){let a=1<<t;return this.F.sub(this.F.pow(n,a),this.F.one)}evaluateLagrangePolynomials(t,n){let a=1<<t,o=this.F.pow(n,a),e=new Array(a).fill(this.F.zero);this._setRoots(t);let h=this.w[t];if(this.F.eq(o,this.F.one)){for(let l=0;l<a;l++)if(this.F.eq(this.roots[t][0],n))return e[l]=this.F.one,e}let d=this.F.sub(o,this.F.one),b=this.F.mul(d,this.F.inv(this.F.e(a)));for(let l=0;l<a;l++)e[l]=this.F.mul(b,this.F.inv(this.F.sub(n,this.roots[t][l]))),b=this.F.mul(b,h);return e}log2(t){return Fa(t)}};Ui=[];for(let c=0;c<256;c++)Ui[c]=cb(c,8);Ic=class{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=new Array(16)}nextU32(){return this.idx==16&&this.update(),this.buff[this.idx++]}nextU64(){return Mr(P3(this.nextU32(),4294967296),this.nextU32())}nextBool(){return(this.nextU32()&1)==1}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let t=0;t<10;t++)gb(this.buff);for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,this.state[12]==0&&(this.state[13]=this.state[13]+1>>>0,this.state[13]==0&&(this.state[14]=this.state[14]+1>>>0,this.state[14]==0&&(this.state[15]=this.state[15]+1>>>0)))}};Bc=null;br=class{constructor(t,n,a){this.F=n,this.G=t,this.opMulGF=a;let o=n.sqrt_t||n.t,e=n.sqrt_s||n.s,h=n.one;for(;n.eq(n.pow(h,n.half),n.one);)h=n.add(h,n.one);this.w=new Array(e+1),this.wi=new Array(e+1),this.w[e]=this.F.pow(h,o),this.wi[e]=this.F.inv(this.w[e]);let d=e-1;for(;d>=0;)this.w[d]=this.F.square(this.w[d+1]),this.wi[d]=this.F.square(this.wi[d+1]),d--;this.roots=[],this._setRoots(Math.min(e,15))}_setRoots(t){for(let n=t;n>=0&&!this.roots[n];n--){let a=this.F.one,o=1<<n,e=new Array(o);for(let h=0;h<o;h++)e[h]=a,a=this.F.mul(a,this.w[n]);this.roots[n]=e}}fft(t){if(t.length<=1)return t;let n=r3(t.length-1)+1;this._setRoots(n);let a=1<<n;if(t.length!=a)throw new Error("Size must be multiple of 2");return Oc(this,t,n,0,1)}ifft(t){if(t.length<=1)return t;let n=r3(t.length-1)+1;this._setRoots(n);let a=1<<n;if(t.length!=a)throw new Error("Size must be multiple of 2");let o=Oc(this,t,n,0,1),e=this.F.inv(this.F.mulScalar(this.F.one,a)),h=new Array(a);for(let d=0;d<a;d++)h[d]=this.opMulGF(o[(a-d)%a],e);return h}};mr=class{constructor(t){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(t),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=ji(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=this.n64*2,this.n8=this.n64*8,this.R=this.e(this.one<<BigInt(this.n64*64)),this.Ri=this.inv(this.R);let n=this.negone>>this.one;this.nqr=this.two;let a=this.pow(this.nqr,n);for(;!this.eq(a,this.negone);)this.nqr=this.nqr+this.one,a=this.pow(this.nqr,n);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),G3(this),this.FFT=new br(this,this,this.mul.bind(this)),this.fft=this.FFT.fft.bind(this.FFT),this.ifft=this.FFT.ifft.bind(this.FFT),this.w=this.FFT.w,this.wi=this.FFT.wi,this.shift=this.square(this.nqr),this.k=this.exp(this.nqr,2**this.s)}e(t,n){let a;if(n?n==16&&(a=BigInt("0x"+t)):a=BigInt(t),a<0){let o=-a;return o>=this.p&&(o=o%this.p),this.p-o}else return a>=this.p?a%this.p:a}add(t,n){let a=t+n;return a>=this.p?a-this.p:a}sub(t,n){return t>=n?t-n:this.p-n+t}neg(t){return t&&this.p-t}mul(t,n){return t*n%this.p}mulScalar(t,n){return t*this.e(n)%this.p}square(t){return t*t%this.p}eq(t,n){return t==n}neq(t,n){return t!=n}lt(t,n){let a=t>this.half?t-this.p:t,o=n>this.half?n-this.p:n;return a<o}gt(t,n){let a=t>this.half?t-this.p:t,o=n>this.half?n-this.p:n;return a>o}leq(t,n){let a=t>this.half?t-this.p:t,o=n>this.half?n-this.p:n;return a<=o}geq(t,n){let a=t>this.half?t-this.p:t,o=n>this.half?n-this.p:n;return a>=o}div(t,n){return this.mul(t,this.inv(n))}idiv(t,n){if(!n)throw new Error("Division by zero");return t/n}inv(t){if(!t)throw new Error("Division by zero");let n=this.zero,a=this.p,o=this.one,e=t%this.p;for(;e;){let h=a/e;[n,o]=[o,n-h*o],[a,e]=[e,a-h*e]}return n<this.zero&&(n+=this.p),n}mod(t,n){return t%n}pow(t,n){return $o(this,t,n)}exp(t,n){return $o(this,t,n)}band(t,n){let a=t&n&this.mask;return a>=this.p?a-this.p:a}bor(t,n){let a=(t|n)&this.mask;return a>=this.p?a-this.p:a}bxor(t,n){let a=(t^n)&this.mask;return a>=this.p?a-this.p:a}bnot(t){let n=t^this.mask;return n>=this.p?n-this.p:n}shl(t,n){if(Number(n)<this.bitLength){let a=t<<n&this.mask;return a>=this.p?a-this.p:a}else{let a=this.p-n;return Number(a)<this.bitLength?t>>a:this.zero}}shr(t,n){if(Number(n)<this.bitLength)return t>>n;{let a=this.p-n;if(Number(a)<this.bitLength){let o=t<<a&this.mask;return o>=this.p?o-this.p:o}else return 0}}land(t,n){return t&&n?this.one:this.zero}lor(t,n){return t||n?this.one:this.zero}lnot(t){return t?this.zero:this.one}sqrt_old(t){if(t==this.zero)return this.zero;if(this.pow(t,this.negone>>this.one)!=this.one)return null;let a=this.s,o=this.nqr_to_t,e=this.pow(t,this.t),h=this.pow(t,this.add(this.t,this.one)>>this.one);for(;e!=this.one;){let d=this.square(e),b=1;for(;d!=this.one;)b++,d=this.square(d);let l=o;for(let s=0;s<a-b-1;s++)l=this.square(l);a=b,o=this.square(l),e=this.mul(e,o),h=this.mul(h,l)}return h>this.p>>this.one&&(h=this.neg(h)),h}normalize(t,n){if(t=BigInt(t,n),t<0){let a=-t;return a>=this.p&&(a=a%this.p),this.p-a}else return t>=this.p?t%this.p:t}random(){let t=this.bitLength*2/8,n=this.zero;for(let a=0;a<t;a++)n=(n<<BigInt(8))+BigInt(k3(1)[0]);return n%this.p}toString(t,n){n=n||10;let a;return t>this.half&&n==10?a="-"+(this.p-t).toString(n):a=t.toString(n),a}isZero(t){return t==this.zero}fromRng(t){let n;do{n=this.zero;for(let a=0;a<this.n64;a++)n+=t.nextU64()<<BigInt(64*a);n&=this.mask}while(n>=this.p);return n=n*this.Ri%this.p,n}fft(t){return this.FFT.fft(t)}ifft(t){return this.FFT.ifft(t)}toRprLE(t,n,a){$i(t,n,a,this.n64*8)}toRprBE(t,n,a){R3(t,n,a,this.n64*8)}toRprBEM(t,n,a){return this.toRprBE(t,n,this.mul(this.R,a))}toRprLEM(t,n,a){return this.toRprLE(t,n,this.mul(this.R,a))}fromRprLE(t,n){return Zi(t,n,this.n8)}fromRprBE(t,n){return z3(t,n,this.n8)}fromRprLEM(t,n){return this.mul(this.fromRprLE(t,n),this.Ri)}fromRprBEM(t,n){return this.mul(this.fromRprBE(t,n),this.Ri)}toObject(t){return t}},yr=class{constructor(t,n){this.type="F2",this.F=t,this.zero=[this.F.zero,this.F.zero],this.one=[this.F.one,this.F.zero],this.negone=this.neg(this.one),this.nonResidue=n,this.m=t.m*2,this.p=t.p,this.n64=t.n64*2,this.n32=this.n64*2,this.n8=this.n64*8,G3(this)}_mulByNonResidue(t){return this.F.mul(this.nonResidue,t)}copy(t){return[this.F.copy(t[0]),this.F.copy(t[1])]}add(t,n){return[this.F.add(t[0],n[0]),this.F.add(t[1],n[1])]}double(t){return this.add(t,t)}sub(t,n){return[this.F.sub(t[0],n[0]),this.F.sub(t[1],n[1])]}neg(t){return this.sub(this.zero,t)}conjugate(t){return[t[0],this.F.neg(t[1])]}mul(t,n){let a=this.F.mul(t[0],n[0]),o=this.F.mul(t[1],n[1]);return[this.F.add(a,this._mulByNonResidue(o)),this.F.sub(this.F.mul(this.F.add(t[0],t[1]),this.F.add(n[0],n[1])),this.F.add(a,o))]}inv(t){let n=this.F.square(t[0]),a=this.F.square(t[1]),o=this.F.sub(n,this._mulByNonResidue(a)),e=this.F.inv(o);return[this.F.mul(t[0],e),this.F.neg(this.F.mul(t[1],e))]}div(t,n){return this.mul(t,this.inv(n))}square(t){let n=this.F.mul(t[0],t[1]);return[this.F.sub(this.F.mul(this.F.add(t[0],t[1]),this.F.add(t[0],this._mulByNonResidue(t[1]))),this.F.add(n,this._mulByNonResidue(n))),this.F.add(n,n)]}isZero(t){return this.F.isZero(t[0])&&this.F.isZero(t[1])}eq(t,n){return this.F.eq(t[0],n[0])&&this.F.eq(t[1],n[1])}mulScalar(t,n){return qc(this,t,n)}pow(t,n){return $o(this,t,n)}exp(t,n){return $o(this,t,n)}toString(t){return`[ ${this.F.toString(t[0])} , ${this.F.toString(t[1])} ]`}fromRng(t){let n=this.F.fromRng(t),a=this.F.fromRng(t);return[n,a]}gt(t,n){return this.F.gt(t[0],n[0])?!0:this.F.gt(n[0],t[0])?!1:!!this.F.gt(t[1],n[1])}geq(t,n){return this.gt(t,n)||this.eq(t,n)}lt(t,n){return!this.geq(t,n)}leq(t,n){return!this.gt(t,n)}neq(t,n){return!this.eq(t,n)}random(){return[this.F.random(),this.F.random()]}toRprLE(t,n,a){this.F.toRprLE(t,n,a[0]),this.F.toRprLE(t,n+this.F.n8,a[1])}toRprBE(t,n,a){this.F.toRprBE(t,n,a[1]),this.F.toRprBE(t,n+this.F.n8,a[0])}toRprLEM(t,n,a){this.F.toRprLEM(t,n,a[0]),this.F.toRprLEM(t,n+this.F.n8,a[1])}toRprBEM(t,n,a){this.F.toRprBEM(t,n,a[1]),this.F.toRprBEM(t,n+this.F.n8,a[0])}fromRprLE(t,n){n=n||0;let a=this.F.fromRprLE(t,n),o=this.F.fromRprLE(t,n+this.F.n8);return[a,o]}fromRprBE(t,n){n=n||0;let a=this.F.fromRprBE(t,n);return[this.F.fromRprBE(t,n+this.F.n8),a]}fromRprLEM(t,n){n=n||0;let a=this.F.fromRprLEM(t,n),o=this.F.fromRprLEM(t,n+this.F.n8);return[a,o]}fromRprBEM(t,n){n=n||0;let a=this.F.fromRprBEM(t,n);return[this.F.fromRprBEM(t,n+this.F.n8),a]}toObject(t){return t}},wr=class{constructor(t,n){this.type="F3",this.F=t,this.zero=[this.F.zero,this.F.zero,this.F.zero],this.one=[this.F.one,this.F.zero,this.F.zero],this.negone=this.neg(this.one),this.nonResidue=n,this.m=t.m*3,this.p=t.p,this.n64=t.n64*3,this.n32=this.n64*2,this.n8=this.n64*8}_mulByNonResidue(t){return this.F.mul(this.nonResidue,t)}copy(t){return[this.F.copy(t[0]),this.F.copy(t[1]),this.F.copy(t[2])]}add(t,n){return[this.F.add(t[0],n[0]),this.F.add(t[1],n[1]),this.F.add(t[2],n[2])]}double(t){return this.add(t,t)}sub(t,n){return[this.F.sub(t[0],n[0]),this.F.sub(t[1],n[1]),this.F.sub(t[2],n[2])]}neg(t){return this.sub(this.zero,t)}mul(t,n){let a=this.F.mul(t[0],n[0]),o=this.F.mul(t[1],n[1]),e=this.F.mul(t[2],n[2]);return[this.F.add(a,this._mulByNonResidue(this.F.sub(this.F.mul(this.F.add(t[1],t[2]),this.F.add(n[1],n[2])),this.F.add(o,e)))),this.F.add(this.F.sub(this.F.mul(this.F.add(t[0],t[1]),this.F.add(n[0],n[1])),this.F.add(a,o)),this._mulByNonResidue(e)),this.F.add(this.F.sub(this.F.mul(this.F.add(t[0],t[2]),this.F.add(n[0],n[2])),this.F.add(a,e)),o)]}inv(t){let n=this.F.square(t[0]),a=this.F.square(t[1]),o=this.F.square(t[2]),e=this.F.mul(t[0],t[1]),h=this.F.mul(t[0],t[2]),d=this.F.mul(t[1],t[2]),b=this.F.sub(n,this._mulByNonResidue(d)),l=this.F.sub(this._mulByNonResidue(o),e),s=this.F.sub(a,h),m=this.F.inv(this.F.add(this.F.mul(t[0],b),this._mulByNonResidue(this.F.add(this.F.mul(t[2],l),this.F.mul(t[1],s)))));return[this.F.mul(m,b),this.F.mul(m,l),this.F.mul(m,s)]}div(t,n){return this.mul(t,this.inv(n))}square(t){let n=this.F.square(t[0]),a=this.F.mul(t[0],t[1]),o=this.F.add(a,a),e=this.F.square(this.F.add(this.F.sub(t[0],t[1]),t[2])),h=this.F.mul(t[1],t[2]),d=this.F.add(h,h),b=this.F.square(t[2]);return[this.F.add(n,this._mulByNonResidue(d)),this.F.add(o,this._mulByNonResidue(b)),this.F.sub(this.F.add(this.F.add(o,e),d),this.F.add(n,b))]}isZero(t){return this.F.isZero(t[0])&&this.F.isZero(t[1])&&this.F.isZero(t[2])}eq(t,n){return this.F.eq(t[0],n[0])&&this.F.eq(t[1],n[1])&&this.F.eq(t[2],n[2])}affine(t){return[this.F.affine(t[0]),this.F.affine(t[1]),this.F.affine(t[2])]}mulScalar(t,n){return qc(this,t,n)}pow(t,n){return $o(this,t,n)}exp(t,n){return $o(this,t,n)}toString(t){return`[ ${this.F.toString(t[0])} , ${this.F.toString(t[1])}, ${this.F.toString(t[2])} ]`}fromRng(t){let n=this.F.fromRng(t),a=this.F.fromRng(t),o=this.F.fromRng(t);return[n,a,o]}gt(t,n){return this.F.gt(t[0],n[0])?!0:this.F.gt(n[0],t[0])?!1:this.F.gt(t[1],n[1])?!0:this.F.gt(n[1],t[1])?!1:!!this.F.gt(t[2],n[2])}geq(t,n){return this.gt(t,n)||this.eq(t,n)}lt(t,n){return!this.geq(t,n)}leq(t,n){return!this.gt(t,n)}neq(t,n){return!this.eq(t,n)}random(){return[this.F.random(),this.F.random(),this.F.random()]}toRprLE(t,n,a){this.F.toRprLE(t,n,a[0]),this.F.toRprLE(t,n+this.F.n8,a[1]),this.F.toRprLE(t,n+this.F.n8*2,a[2])}toRprBE(t,n,a){this.F.toRprBE(t,n,a[2]),this.F.toRprBE(t,n+this.F.n8,a[1]),this.F.toRprBE(t,n+this.F.n8*2,a[0])}toRprLEM(t,n,a){this.F.toRprLEM(t,n,a[0]),this.F.toRprLEM(t,n+this.F.n8,a[1]),this.F.toRprLEM(t,n+this.F.n8*2,a[2])}toRprBEM(t,n,a){this.F.toRprBEM(t,n,a[2]),this.F.toRprBEM(t,n+this.F.n8,a[1]),this.F.toRprBEM(t,n+this.F.n8*2,a[0])}fromRprLE(t,n){n=n||0;let a=this.F.fromRprLE(t,n),o=this.F.fromRprLE(t,n+this.n8),e=this.F.fromRprLE(t,n+this.n8*2);return[a,o,e]}fromRprBE(t,n){n=n||0;let a=this.F.fromRprBE(t,n),o=this.F.fromRprBE(t,n+this.n8);return[this.F.fromRprBE(t,n+this.n8*2),o,a]}fromRprLEM(t,n){n=n||0;let a=this.F.fromRprLEM(t,n),o=this.F.fromRprLEM(t,n+this.n8),e=this.F.fromRprLEM(t,n+this.n8*2);return[a,o,e]}fromRprBEM(t,n){n=n||0;let a=this.F.fromRprBEM(t,n),o=this.F.fromRprBEM(t,n+this.n8);return[this.F.fromRprBEM(t,n+this.n8*2),o,a]}toObject(t){return t}};Fr=class{constructor(t,n){this.F=t,this.g=n,this.g.length==2&&(this.g[2]=this.F.one),this.zero=[this.F.zero,this.F.one,this.F.zero]}add(t,n){let a=this.F;if(this.eq(t,this.zero))return n;if(this.eq(n,this.zero))return t;let o=new Array(3),e=a.square(t[2]),h=a.square(n[2]),d=a.mul(t[0],h),b=a.mul(n[0],e),l=a.mul(t[2],e),s=a.mul(n[2],h),m=a.mul(t[1],s),B=a.mul(n[1],l);if(a.eq(d,b)&&a.eq(m,B))return this.double(t);let p=a.sub(b,d),v=a.sub(B,m),M=a.square(a.add(p,p)),x=a.mul(p,M),S=a.add(v,v),w=a.mul(d,M);o[0]=a.sub(a.sub(a.square(S),x),a.add(w,w));let k=a.mul(m,x);return o[1]=a.sub(a.mul(S,a.sub(w,o[0])),a.add(k,k)),o[2]=a.mul(p,a.sub(a.square(a.add(t[2],n[2])),a.add(e,h))),o}neg(t){return[t[0],this.F.neg(t[1]),t[2]]}sub(t,n){return this.add(t,this.neg(n))}double(t){let n=this.F,a=new Array(3);if(this.eq(t,this.zero))return t;let o=n.square(t[0]),e=n.square(t[1]),h=n.square(e),d=n.sub(n.square(n.add(t[0],e)),n.add(o,h));d=n.add(d,d);let b=n.add(n.add(o,o),o),l=n.square(b);a[0]=n.sub(l,n.add(d,d));let s=n.add(h,h);s=n.add(s,s),s=n.add(s,s),a[1]=n.sub(n.mul(b,n.sub(d,a[0])),s);let m=n.mul(t[1],t[2]);return a[2]=n.add(m,m),a}timesScalar(t,n){return qc(this,t,n)}mulScalar(t,n){return qc(this,t,n)}affine(t){let n=this.F;if(this.isZero(t))return this.zero;if(n.eq(t[2],n.one))return t;{let a=n.inv(t[2]),o=n.square(a),e=n.mul(o,a),h=new Array(3);return h[0]=n.mul(t[0],o),h[1]=n.mul(t[1],e),h[2]=n.one,h}}multiAffine(t){let n=Object.keys(t),a=this.F,o=new Array(n.length+1);o[0]=a.one;for(let e=0;e<n.length;e++)a.eq(t[n[e]][2],a.zero)?o[e+1]=o[e]:o[e+1]=a.mul(o[e],t[n[e]][2]);o[n.length]=a.inv(o[n.length]);for(let e=n.length-1;e>=0;e--)if(a.eq(t[n[e]][2],a.zero))o[e]=o[e+1],t[n[e]]=this.zero;else{let h=a.mul(o[e],o[e+1]);o[e]=a.mul(t[n[e]][2],o[e+1]);let d=a.square(h),b=a.mul(d,h);t[n[e]][0]=a.mul(t[n[e]][0],d),t[n[e]][1]=a.mul(t[n[e]][1],b),t[n[e]][2]=a.one}}eq(t,n){let a=this.F;if(this.F.eq(t[2],this.F.zero))return this.F.eq(n[2],this.F.zero);if(this.F.eq(n[2],this.F.zero))return!1;let o=a.square(t[2]),e=a.square(n[2]),h=a.mul(t[0],e),d=a.mul(n[0],o),b=a.mul(t[2],o),l=a.mul(n[2],e),s=a.mul(t[1],l),m=a.mul(n[1],b);return a.eq(h,d)&&a.eq(s,m)}isZero(t){return this.F.isZero(t[2])}toString(t){let n=this.affine(t);return`[ ${this.F.toString(n[0])} , ${this.F.toString(n[1])} ]`}fromRng(t){let n=this.F,a=[],o;do{a[0]=n.fromRng(t),o=t.nextBool();let h=n.add(n.mul(n.square(a[0]),a[0]),this.b);a[1]=n.sqrt(h)}while(a[1]==null||n.isZero[a]);let e=Ac(n,a[1]);return o^e&&(a[1]=n.neg(a[1])),a[2]=n.one,this.cofactor&&(a=this.mulScalar(a,this.cofactor)),a=this.affine(a),a}toRprLE(t,n,a){if(a=this.affine(a),this.isZero(a)){new Uint8Array(t,n,this.F.n8*2).fill(0);return}this.F.toRprLE(t,n,a[0]),this.F.toRprLE(t,n+this.F.n8,a[1])}toRprBE(t,n,a){if(a=this.affine(a),this.isZero(a)){new Uint8Array(t,n,this.F.n8*2).fill(0);return}this.F.toRprBE(t,n,a[0]),this.F.toRprBE(t,n+this.F.n8,a[1])}toRprLEM(t,n,a){if(a=this.affine(a),this.isZero(a)){new Uint8Array(t,n,this.F.n8*2).fill(0);return}this.F.toRprLEM(t,n,a[0]),this.F.toRprLEM(t,n+this.F.n8,a[1])}toRprLEJM(t,n,a){if(a=this.affine(a),this.isZero(a)){new Uint8Array(t,n,this.F.n8*2).fill(0);return}this.F.toRprLEM(t,n,a[0]),this.F.toRprLEM(t,n+this.F.n8,a[1]),this.F.toRprLEM(t,n+2*this.F.n8,a[2])}toRprBEM(t,n,a){if(a=this.affine(a),this.isZero(a)){new Uint8Array(t,n,this.F.n8*2).fill(0);return}this.F.toRprBEM(t,n,a[0]),this.F.toRprBEM(t,n+this.F.n8,a[1])}fromRprLE(t,n){n=n||0;let a=this.F.fromRprLE(t,n),o=this.F.fromRprLE(t,n+this.F.n8);return this.F.isZero(a)&&this.F.isZero(o)?this.zero:[a,o,this.F.one]}fromRprBE(t,n){n=n||0;let a=this.F.fromRprBE(t,n),o=this.F.fromRprBE(t,n+this.F.n8);return this.F.isZero(a)&&this.F.isZero(o)?this.zero:[a,o,this.F.one]}fromRprLEM(t,n){n=n||0;let a=this.F.fromRprLEM(t,n),o=this.F.fromRprLEM(t,n+this.F.n8);return this.F.isZero(a)&&this.F.isZero(o)?this.zero:[a,o,this.F.one]}fromRprLEJM(t,n){n=n||0;let a=this.F.fromRprLEM(t,n),o=this.F.fromRprLEM(t,n+this.F.n8),e=this.F.fromRprLEM(t,n+this.F.n8*2);return this.F.isZero(a)&&this.F.isZero(o)?this.zero:[a,o,e]}fromRprBEM(t,n){n=n||0;let a=this.F.fromRprBEM(t,n),o=this.F.fromRprBEM(t,n+this.F.n8);return this.F.isZero(a)&&this.F.isZero(o)?this.zero:[a,o,this.F.one]}fromRprCompressed(t,n){let a=this.F,o=new Uint8Array(t.buffer,n,a.n8);if(o[0]&64)return this.zero;let e=new Array(3),h=(o[0]&128)!=0;o[0]=o[0]&127,e[0]=a.fromRprBE(t,n),h&&(o[0]=o[0]|128);let d=a.add(a.mul(a.square(e[0]),e[0]),this.b);if(e[1]=a.sqrt(d),e[1]===null)throw new Error("Invalid Point!");let b=Ac(a,e[1]);return h^b&&(e[1]=a.neg(e[1])),e[2]=a.one,e}toRprCompressed(t,n,a){a=this.affine(a);let o=new Uint8Array(t.buffer,n,this.F.n8);if(this.isZero(a)){o.fill(0),o[0]=64;return}this.F.toRprBE(t,n,a[0]),Ac(this.F,a[1])&&(o[0]=o[0]|128)}fromRprUncompressed(t,n){return t[0]&64?this.zero:this.fromRprBE(t,n)}toRprUncompressed(t,n,a){this.toRprBE(t,n,a),this.isZero(a)&&(t[n]=t[n]|64)}},Ha={};Ha.bigInt2BytesLE=function(t,n){let a=Array(n),o=BigInt(t);for(let e=0;e<n;e++)a[e]=Number(o&0xFFn),o=o>>8n;return a};Ha.bigInt2U32LE=function(t,n){let a=Array(n),o=BigInt(t);for(let e=0;e<n;e++)a[e]=Number(o&0xFFFFFFFFn),o=o>>32n;return a};Ha.isOcamNum=function(c){return!(!Array.isArray(c)||c.length!=3||typeof c[0]!="number"||typeof c[1]!="number"||!Array.isArray(c[2]))};pb=function(t,n,a){let o=a||"int";if(t.modules[o])return o;t.modules[o]={};let e=n*2,h=n*8;function d(){let F=t.addFunction(o+"_copy");F.addParam("px","i32"),F.addParam("pr","i32");let u=F.getCodeBuilder();for(let L=0;L<n;L++)F.addCode(u.i64_store(u.getLocal("pr"),L*8,u.i64_load(u.getLocal("px"),L*8)))}function b(){let F=t.addFunction(o+"_zero");F.addParam("pr","i32");let u=F.getCodeBuilder();for(let L=0;L<n;L++)F.addCode(u.i64_store(u.getLocal("pr"),L*8,u.i64_const(0)))}function l(){let F=t.addFunction(o+"_one");F.addParam("pr","i32");let u=F.getCodeBuilder();F.addCode(u.i64_store(u.getLocal("pr"),0,u.i64_const(1)));for(let L=1;L<n;L++)F.addCode(u.i64_store(u.getLocal("pr"),L*8,u.i64_const(0)))}function s(){let F=t.addFunction(o+"_isZero");F.addParam("px","i32"),F.setReturnType("i32");let u=F.getCodeBuilder();function L($){return $==0?u.ret(u.i64_eqz(u.i64_load(u.getLocal("px")))):u.if(u.i64_eqz(u.i64_load(u.getLocal("px"),$*8)),L($-1),u.ret(u.i32_const(0)))}F.addCode(L(n-1)),F.addCode(u.ret(u.i32_const(0)))}function m(){let F=t.addFunction(o+"_eq");F.addParam("px","i32"),F.addParam("py","i32"),F.setReturnType("i32");let u=F.getCodeBuilder();function L($){return $==0?u.ret(u.i64_eq(u.i64_load(u.getLocal("px")),u.i64_load(u.getLocal("py")))):u.if(u.i64_eq(u.i64_load(u.getLocal("px"),$*8),u.i64_load(u.getLocal("py"),$*8)),L($-1),u.ret(u.i32_const(0)))}F.addCode(L(n-1)),F.addCode(u.ret(u.i32_const(0)))}function B(){let F=t.addFunction(o+"_gte");F.addParam("px","i32"),F.addParam("py","i32"),F.setReturnType("i32");let u=F.getCodeBuilder();function L($){return $==0?u.ret(u.i64_ge_u(u.i64_load(u.getLocal("px")),u.i64_load(u.getLocal("py")))):u.if(u.i64_lt_u(u.i64_load(u.getLocal("px"),$*8),u.i64_load(u.getLocal("py"),$*8)),u.ret(u.i32_const(0)),u.if(u.i64_gt_u(u.i64_load(u.getLocal("px"),$*8),u.i64_load(u.getLocal("py"),$*8)),u.ret(u.i32_const(1)),L($-1)))}F.addCode(L(n-1)),F.addCode(u.ret(u.i32_const(0)))}function p(){let F=t.addFunction(o+"_add");F.addParam("x","i32"),F.addParam("y","i32"),F.addParam("r","i32"),F.setReturnType("i32"),F.addLocal("c","i64");let u=F.getCodeBuilder();F.addCode(u.setLocal("c",u.i64_add(u.i64_load32_u(u.getLocal("x")),u.i64_load32_u(u.getLocal("y"))))),F.addCode(u.i64_store32(u.getLocal("r"),u.getLocal("c")));for(let L=1;L<e;L++)F.addCode(u.setLocal("c",u.i64_add(u.i64_add(u.i64_load32_u(u.getLocal("x"),4*L),u.i64_load32_u(u.getLocal("y"),4*L)),u.i64_shr_u(u.getLocal("c"),u.i64_const(32))))),F.addCode(u.i64_store32(u.getLocal("r"),L*4,u.getLocal("c")));F.addCode(u.i32_wrap_i64(u.i64_shr_u(u.getLocal("c"),u.i64_const(32))))}function v(){let F=t.addFunction(o+"_sub");F.addParam("x","i32"),F.addParam("y","i32"),F.addParam("r","i32"),F.setReturnType("i32"),F.addLocal("c","i64");let u=F.getCodeBuilder();F.addCode(u.setLocal("c",u.i64_sub(u.i64_load32_u(u.getLocal("x")),u.i64_load32_u(u.getLocal("y"))))),F.addCode(u.i64_store32(u.getLocal("r"),u.i64_and(u.getLocal("c"),u.i64_const("0xFFFFFFFF"))));for(let L=1;L<e;L++)F.addCode(u.setLocal("c",u.i64_add(u.i64_sub(u.i64_load32_u(u.getLocal("x"),4*L),u.i64_load32_u(u.getLocal("y"),4*L)),u.i64_shr_s(u.getLocal("c"),u.i64_const(32))))),F.addCode(u.i64_store32(u.getLocal("r"),L*4,u.i64_and(u.getLocal("c"),u.i64_const("0xFFFFFFFF"))));F.addCode(u.i32_wrap_i64(u.i64_shr_s(u.getLocal("c"),u.i64_const(32))))}function M(){let F=t.addFunction(o+"_mul");F.addParam("x","i32"),F.addParam("y","i32"),F.addParam("r","i32"),F.addLocal("c0","i64"),F.addLocal("c1","i64");for(let y=0;y<e;y++)F.addLocal("x"+y,"i64"),F.addLocal("y"+y,"i64");let u=F.getCodeBuilder(),L=[],$=[];function Q(y,I){let N,nt;return L[y]?N=u.getLocal("x"+y):(N=u.teeLocal("x"+y,u.i64_load32_u(u.getLocal("x"),y*4)),L[y]=!0),$[I]?nt=u.getLocal("y"+I):(nt=u.teeLocal("y"+I,u.i64_load32_u(u.getLocal("y"),I*4)),$[I]=!0),u.i64_mul(N,nt)}let H="c0",q="c1";for(let y=0;y<e*2-1;y++){for(let I=Math.max(0,y-e+1);I<=y&&I<e;I++){let N=y-I;F.addCode(u.setLocal(H,u.i64_add(u.i64_and(u.getLocal(H),u.i64_const(4294967295)),Q(I,N)))),F.addCode(u.setLocal(q,u.i64_add(u.getLocal(q),u.i64_shr_u(u.getLocal(H),u.i64_const(32)))))}F.addCode(u.i64_store32(u.getLocal("r"),y*4,u.getLocal(H))),[H,q]=[q,H],F.addCode(u.setLocal(q,u.i64_shr_u(u.getLocal(H),u.i64_const(32))))}F.addCode(u.i64_store32(u.getLocal("r"),e*4*2-4,u.getLocal(H)))}function x(){let F=t.addFunction(o+"_square");F.addParam("x","i32"),F.addParam("r","i32"),F.addLocal("c0","i64"),F.addLocal("c1","i64"),F.addLocal("c0_old","i64"),F.addLocal("c1_old","i64");for(let I=0;I<e;I++)F.addLocal("x"+I,"i64");let u=F.getCodeBuilder(),L=[];function $(I,N){let nt,J;return L[I]?nt=u.getLocal("x"+I):(nt=u.teeLocal("x"+I,u.i64_load32_u(u.getLocal("x"),I*4)),L[I]=!0),L[N]?J=u.getLocal("x"+N):(J=u.teeLocal("x"+N,u.i64_load32_u(u.getLocal("x"),N*4)),L[N]=!0),u.i64_mul(nt,J)}let Q="c0",H="c1",q="c0_old",y="c1_old";for(let I=0;I<e*2-1;I++){F.addCode(u.setLocal(Q,u.i64_const(0)),u.setLocal(H,u.i64_const(0)));for(let N=Math.max(0,I-e+1);N<I+1>>1&&N<e;N++){let nt=I-N;F.addCode(u.setLocal(Q,u.i64_add(u.i64_and(u.getLocal(Q),u.i64_const(4294967295)),$(N,nt)))),F.addCode(u.setLocal(H,u.i64_add(u.getLocal(H),u.i64_shr_u(u.getLocal(Q),u.i64_const(32)))))}F.addCode(u.setLocal(Q,u.i64_shl(u.i64_and(u.getLocal(Q),u.i64_const(4294967295)),u.i64_const(1)))),F.addCode(u.setLocal(H,u.i64_add(u.i64_shl(u.getLocal(H),u.i64_const(1)),u.i64_shr_u(u.getLocal(Q),u.i64_const(32))))),I%2==0&&(F.addCode(u.setLocal(Q,u.i64_add(u.i64_and(u.getLocal(Q),u.i64_const(4294967295)),$(I>>1,I>>1)))),F.addCode(u.setLocal(H,u.i64_add(u.getLocal(H),u.i64_shr_u(u.getLocal(Q),u.i64_const(32)))))),I>0&&(F.addCode(u.setLocal(Q,u.i64_add(u.i64_and(u.getLocal(Q),u.i64_const(4294967295)),u.i64_and(u.getLocal(q),u.i64_const(4294967295))))),F.addCode(u.setLocal(H,u.i64_add(u.i64_add(u.getLocal(H),u.i64_shr_u(u.getLocal(Q),u.i64_const(32))),u.getLocal(y))))),F.addCode(u.i64_store32(u.getLocal("r"),I*4,u.getLocal(Q))),F.addCode(u.setLocal(q,u.getLocal(H)),u.setLocal(y,u.i64_shr_u(u.getLocal(q),u.i64_const(32))))}F.addCode(u.i64_store32(u.getLocal("r"),e*4*2-4,u.getLocal(q)))}function S(){let F=t.addFunction(o+"_squareOld");F.addParam("x","i32"),F.addParam("r","i32");let u=F.getCodeBuilder();F.addCode(u.call(o+"_mul",u.getLocal("x"),u.getLocal("x"),u.getLocal("r")))}function w(){let F=t.addFunction(o+"__mul1");F.addParam("px","i32"),F.addParam("y","i64"),F.addParam("pr","i32"),F.addLocal("c","i64");let u=F.getCodeBuilder();F.addCode(u.setLocal("c",u.i64_mul(u.i64_load32_u(u.getLocal("px"),0,0),u.getLocal("y")))),F.addCode(u.i64_store32(u.getLocal("pr"),0,0,u.getLocal("c")));for(let L=1;L<e;L++)F.addCode(u.setLocal("c",u.i64_add(u.i64_mul(u.i64_load32_u(u.getLocal("px"),4*L,0),u.getLocal("y")),u.i64_shr_u(u.getLocal("c"),u.i64_const(32))))),F.addCode(u.i64_store32(u.getLocal("pr"),L*4,0,u.getLocal("c")))}function k(){let F=t.addFunction(o+"__add1");F.addParam("x","i32"),F.addParam("y","i64"),F.addLocal("c","i64"),F.addLocal("px","i32");let u=F.getCodeBuilder();F.addCode(u.setLocal("px",u.getLocal("x"))),F.addCode(u.setLocal("c",u.i64_add(u.i64_load32_u(u.getLocal("px"),0,0),u.getLocal("y")))),F.addCode(u.i64_store32(u.getLocal("px"),0,0,u.getLocal("c"))),F.addCode(u.setLocal("c",u.i64_shr_u(u.getLocal("c"),u.i64_const(32)))),F.addCode(u.block(u.loop(u.br_if(1,u.i64_eqz(u.getLocal("c"))),u.setLocal("px",u.i32_add(u.getLocal("px"),u.i32_const(4))),u.setLocal("c",u.i64_add(u.i64_load32_u(u.getLocal("px"),0,0),u.getLocal("c"))),u.i64_store32(u.getLocal("px"),0,0,u.getLocal("c")),u.setLocal("c",u.i64_shr_u(u.getLocal("c"),u.i64_const(32))),u.br(0))))}function O(){w(),k();let F=t.addFunction(o+"_div");F.addParam("x","i32"),F.addParam("y","i32"),F.addParam("c","i32"),F.addParam("r","i32"),F.addLocal("rr","i32"),F.addLocal("cc","i32"),F.addLocal("eX","i32"),F.addLocal("eY","i32"),F.addLocal("sy","i64"),F.addLocal("sx","i64"),F.addLocal("ec","i32");let u=F.getCodeBuilder(),L=u.i32_const(t.alloc(h)),$=u.i32_const(t.alloc(h)),Q=u.i32_const(t.alloc(h)),H=u.getLocal("cc"),q=u.getLocal("rr"),y=t.alloc(h*2),I=u.i32_const(y),N=u.i32_const(y+h);F.addCode(u.if(u.getLocal("c"),u.setLocal("cc",u.getLocal("c")),u.setLocal("cc",$))),F.addCode(u.if(u.getLocal("r"),u.setLocal("rr",u.getLocal("r")),u.setLocal("rr",Q))),F.addCode(u.call(o+"_copy",u.getLocal("x"),q)),F.addCode(u.call(o+"_copy",u.getLocal("y"),L)),F.addCode(u.call(o+"_zero",H)),F.addCode(u.call(o+"_zero",I)),F.addCode(u.setLocal("eX",u.i32_const(h-1))),F.addCode(u.setLocal("eY",u.i32_const(h-1))),F.addCode(u.block(u.loop(u.br_if(1,u.i32_or(u.i32_load8_u(u.i32_add(L,u.getLocal("eY")),0,0),u.i32_eq(u.getLocal("eY"),u.i32_const(3)))),u.setLocal("eY",u.i32_sub(u.getLocal("eY"),u.i32_const(1))),u.br(0)))),F.addCode(u.setLocal("sy",u.i64_add(u.i64_load32_u(u.i32_sub(u.i32_add(L,u.getLocal("eY")),u.i32_const(3)),0,0),u.i64_const(1)))),F.addCode(u.if(u.i64_eq(u.getLocal("sy"),u.i64_const(1)),u.drop(u.i64_div_u(u.i64_const(0),u.i64_const(0))))),F.addCode(u.block(u.loop(u.block(u.loop(u.br_if(1,u.i32_or(u.i32_load8_u(u.i32_add(q,u.getLocal("eX")),0,0),u.i32_eq(u.getLocal("eX"),u.i32_const(7)))),u.setLocal("eX",u.i32_sub(u.getLocal("eX"),u.i32_const(1))),u.br(0))),u.setLocal("sx",u.i64_load(u.i32_sub(u.i32_add(q,u.getLocal("eX")),u.i32_const(7)),0,0)),u.setLocal("sx",u.i64_div_u(u.getLocal("sx"),u.getLocal("sy"))),u.setLocal("ec",u.i32_sub(u.i32_sub(u.getLocal("eX"),u.getLocal("eY")),u.i32_const(4))),u.block(u.loop(u.br_if(1,u.i32_and(u.i64_eqz(u.i64_and(u.getLocal("sx"),u.i64_const("0xFFFFFFFF00000000"))),u.i32_ge_s(u.getLocal("ec"),u.i32_const(0)))),u.setLocal("sx",u.i64_shr_u(u.getLocal("sx"),u.i64_const(8))),u.setLocal("ec",u.i32_add(u.getLocal("ec"),u.i32_const(1))),u.br(0))),u.if(u.i64_eqz(u.getLocal("sx")),[...u.br_if(2,u.i32_eqz(u.call(o+"_gte",q,L))),...u.setLocal("sx",u.i64_const(1)),...u.setLocal("ec",u.i32_const(0))]),u.call(o+"__mul1",L,u.getLocal("sx"),N),u.drop(u.call(o+"_sub",q,u.i32_sub(N,u.getLocal("ec")),q)),u.call(o+"__add1",u.i32_add(H,u.getLocal("ec")),u.getLocal("sx")),u.br(0))))}function W(){let F=t.addFunction(o+"_inverseMod");F.addParam("px","i32"),F.addParam("pm","i32"),F.addParam("pr","i32"),F.addLocal("t","i32"),F.addLocal("newt","i32"),F.addLocal("r","i32"),F.addLocal("qq","i32"),F.addLocal("qr","i32"),F.addLocal("newr","i32"),F.addLocal("swp","i32"),F.addLocal("x","i32"),F.addLocal("signt","i32"),F.addLocal("signnewt","i32"),F.addLocal("signx","i32");let u=F.getCodeBuilder(),L=u.i32_const(t.alloc(h)),$=u.i32_const(t.alloc(h)),Q=u.i32_const(t.alloc(h)),H=u.i32_const(t.alloc(h)),q=u.i32_const(t.alloc(h)),y=u.i32_const(t.alloc(h)),I=u.i32_const(t.alloc(h*2)),N=u.i32_const(t.alloc(h));F.addCode(u.setLocal("t",L),u.call(o+"_zero",L),u.setLocal("signt",u.i32_const(0))),F.addCode(u.setLocal("r",$),u.call(o+"_copy",u.getLocal("pm"),$)),F.addCode(u.setLocal("newt",Q),u.call(o+"_one",Q),u.setLocal("signnewt",u.i32_const(0))),F.addCode(u.setLocal("newr",H),u.call(o+"_copy",u.getLocal("px"),H)),F.addCode(u.setLocal("qq",q)),F.addCode(u.setLocal("qr",y)),F.addCode(u.setLocal("x",N)),F.addCode(u.block(u.loop(u.br_if(1,u.call(o+"_isZero",u.getLocal("newr"))),u.call(o+"_div",u.getLocal("r"),u.getLocal("newr"),u.getLocal("qq"),u.getLocal("qr")),u.call(o+"_mul",u.getLocal("qq"),u.getLocal("newt"),I),u.if(u.getLocal("signt"),u.if(u.getLocal("signnewt"),u.if(u.call(o+"_gte",I,u.getLocal("t")),[...u.drop(u.call(o+"_sub",I,u.getLocal("t"),u.getLocal("x"))),...u.setLocal("signx",u.i32_const(0))],[...u.drop(u.call(o+"_sub",u.getLocal("t"),I,u.getLocal("x"))),...u.setLocal("signx",u.i32_const(1))]),[...u.drop(u.call(o+"_add",I,u.getLocal("t"),u.getLocal("x"))),...u.setLocal("signx",u.i32_const(1))]),u.if(u.getLocal("signnewt"),[...u.drop(u.call(o+"_add",I,u.getLocal("t"),u.getLocal("x"))),...u.setLocal("signx",u.i32_const(0))],u.if(u.call(o+"_gte",u.getLocal("t"),I),[...u.drop(u.call(o+"_sub",u.getLocal("t"),I,u.getLocal("x"))),...u.setLocal("signx",u.i32_const(0))],[...u.drop(u.call(o+"_sub",I,u.getLocal("t"),u.getLocal("x"))),...u.setLocal("signx",u.i32_const(1))]))),u.setLocal("swp",u.getLocal("t")),u.setLocal("t",u.getLocal("newt")),u.setLocal("newt",u.getLocal("x")),u.setLocal("x",u.getLocal("swp")),u.setLocal("signt",u.getLocal("signnewt")),u.setLocal("signnewt",u.getLocal("signx")),u.setLocal("swp",u.getLocal("r")),u.setLocal("r",u.getLocal("newr")),u.setLocal("newr",u.getLocal("qr")),u.setLocal("qr",u.getLocal("swp")),u.br(0)))),F.addCode(u.if(u.getLocal("signt"),u.drop(u.call(o+"_sub",u.getLocal("pm"),u.getLocal("t"),u.getLocal("pr"))),u.call(o+"_copy",u.getLocal("t"),u.getLocal("pr"))))}return d(),b(),s(),l(),m(),B(),p(),v(),M(),x(),S(),O(),W(),t.exportFunction(o+"_copy"),t.exportFunction(o+"_zero"),t.exportFunction(o+"_one"),t.exportFunction(o+"_isZero"),t.exportFunction(o+"_eq"),t.exportFunction(o+"_gte"),t.exportFunction(o+"_add"),t.exportFunction(o+"_sub"),t.exportFunction(o+"_mul"),t.exportFunction(o+"_square"),t.exportFunction(o+"_squareOld"),t.exportFunction(o+"_div"),t.exportFunction(o+"_inverseMod"),o},Tr=function(t,n,a,o,e,h,d){let b=t.addFunction(n);b.addParam("base","i32"),b.addParam("scalar","i32"),b.addParam("scalarLength","i32"),b.addParam("r","i32"),b.addLocal("i","i32"),b.addLocal("b","i32");let l=b.getCodeBuilder(),s=l.i32_const(t.alloc(a));b.addCode(l.if(l.i32_eqz(l.getLocal("scalarLength")),[...l.call(d,l.getLocal("r")),...l.ret([])])),b.addCode(l.call(h,l.getLocal("base"),s)),b.addCode(l.call(d,l.getLocal("r"))),b.addCode(l.setLocal("i",l.getLocal("scalarLength"))),b.addCode(l.block(l.loop(l.setLocal("i",l.i32_sub(l.getLocal("i"),l.i32_const(1))),l.setLocal("b",l.i32_load8_u(l.i32_add(l.getLocal("scalar"),l.getLocal("i")))),...m(),l.br_if(1,l.i32_eqz(l.getLocal("i"))),l.br(0))));function m(){let B=[];for(let p=0;p<8;p++)B.push(...l.call(e,l.getLocal("r"),l.getLocal("r")),...l.if(l.i32_ge_u(l.getLocal("b"),l.i32_const(128>>p)),[...l.setLocal("b",l.i32_sub(l.getLocal("b"),l.i32_const(128>>p))),...l.call(o,l.getLocal("r"),s,l.getLocal("r"))]));return B}},Gr=bb;U3=mb;yb=wb;Xn={};Xn.bitLength=Z3;Xn.isOdd=$3;Xn.isNegative=$c;Xn.abs=Wi;Xn.isUnit=Zo;Xn.compare=N3;Xn.modInv=j3;Xn.modPow=V3;Xn.isPrime=Ab;Xn.square=kr;Eb=pb,Pa=Ha,vb=Tr,Sb=Gr,cr=U3,sr=yb,{bitLength:qb,modInv:lr,modPow:_3,isPrime:h3,isOdd:Ib,square:Ob}=Xn,Nr=function(t,n,a,o){let e=BigInt(n),h=Math.floor((qb(e-1n)-1)/64)+1,d=h*2,b=h*8,l=a||"f1m";if(t.modules[l])return l;let s=Eb(t,h,o),m=t.alloc(b,Pa.bigInt2BytesLE(e,b)),B=t.alloc(Pa.bigInt2BytesLE(Ob(1n<<BigInt(h*64))%e,b)),p=t.alloc(Pa.bigInt2BytesLE((1n<<BigInt(h*64))%e,b)),v=t.alloc(Pa.bigInt2BytesLE(0n,b)),M=e-1n,x=M>>1n,S=t.alloc(b,Pa.bigInt2BytesLE(x,b)),w=x+1n,k=t.alloc(b,Pa.bigInt2BytesLE(w,b));t.modules[l]={pq:m,pR2:B,n64:h,q:e,pOne:p,pZero:v,pePlusOne:k};function O(){let E=t.addFunction(l+"_one");E.addParam("pr","i32");let g=E.getCodeBuilder();E.addCode(g.call(s+"_copy",g.i32_const(p),g.getLocal("pr")))}function W(){let E=t.addFunction(l+"_add");E.addParam("x","i32"),E.addParam("y","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.if(g.call(s+"_add",g.getLocal("x"),g.getLocal("y"),g.getLocal("r")),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))),g.if(g.call(s+"_gte",g.getLocal("r"),g.i32_const(m)),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))))))}function F(){let E=t.addFunction(l+"_sub");E.addParam("x","i32"),E.addParam("y","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.if(g.call(s+"_sub",g.getLocal("x"),g.getLocal("y"),g.getLocal("r")),g.drop(g.call(s+"_add",g.getLocal("r"),g.i32_const(m),g.getLocal("r")))))}function u(){let E=t.addFunction(l+"_neg");E.addParam("x","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.call(l+"_sub",g.i32_const(v),g.getLocal("x"),g.getLocal("r")))}function L(){let E=t.addFunction(l+"_isNegative");E.addParam("x","i32"),E.setReturnType("i32");let g=E.getCodeBuilder(),U=g.i32_const(t.alloc(b));E.addCode(g.call(l+"_fromMontgomery",g.getLocal("x"),U),g.call(s+"_gte",U,g.i32_const(k)))}function $(){let E=t.addFunction(l+"_sign");E.addParam("x","i32"),E.setReturnType("i32");let g=E.getCodeBuilder(),U=g.i32_const(t.alloc(b));E.addCode(g.if(g.call(s+"_isZero",g.getLocal("x")),g.ret(g.i32_const(0))),g.call(l+"_fromMontgomery",g.getLocal("x"),U),g.if(g.call(s+"_gte",U,g.i32_const(k)),g.ret(g.i32_const(-1))),g.ret(g.i32_const(1)))}function Q(){let E=t.alloc(d*d*8),g=t.addFunction(l+"_mReduct");g.addParam("t","i32"),g.addParam("r","i32"),g.addLocal("np32","i64"),g.addLocal("c","i64"),g.addLocal("m","i64");let U=g.getCodeBuilder(),st=Number(0x100000000n-lr(e,0x100000000n));g.addCode(U.setLocal("np32",U.i64_const(st)));for(let et=0;et<d;et++){g.addCode(U.setLocal("c",U.i64_const(0))),g.addCode(U.setLocal("m",U.i64_and(U.i64_mul(U.i64_load32_u(U.getLocal("t"),et*4),U.getLocal("np32")),U.i64_const("0xFFFFFFFF"))));for(let ct=0;ct<d;ct++)g.addCode(U.setLocal("c",U.i64_add(U.i64_add(U.i64_load32_u(U.getLocal("t"),(et+ct)*4),U.i64_shr_u(U.getLocal("c"),U.i64_const(32))),U.i64_mul(U.i64_load32_u(U.i32_const(m),ct*4),U.getLocal("m"))))),g.addCode(U.i64_store32(U.getLocal("t"),(et+ct)*4,U.getLocal("c")));g.addCode(U.i64_store32(U.i32_const(E),et*4,U.i64_shr_u(U.getLocal("c"),U.i64_const(32))))}g.addCode(U.call(l+"_add",U.i32_const(E),U.i32_add(U.getLocal("t"),U.i32_const(d*4)),U.getLocal("r")))}function H(){let E=t.addFunction(l+"_mul");E.addParam("x","i32"),E.addParam("y","i32"),E.addParam("r","i32"),E.addLocal("c0","i64"),E.addLocal("c1","i64"),E.addLocal("np32","i64");for(let ut=0;ut<d;ut++)E.addLocal("x"+ut,"i64"),E.addLocal("y"+ut,"i64"),E.addLocal("m"+ut,"i64"),E.addLocal("q"+ut,"i64");let g=E.getCodeBuilder(),U=Number(0x100000000n-lr(e,0x100000000n));E.addCode(g.setLocal("np32",g.i64_const(U)));let st=[],et=[],ct=[];function ft(ut,lt){let bt,Et;return st[ut]?bt=g.getLocal("x"+ut):(bt=g.teeLocal("x"+ut,g.i64_load32_u(g.getLocal("x"),ut*4)),st[ut]=!0),et[lt]?Et=g.getLocal("y"+lt):(Et=g.teeLocal("y"+lt,g.i64_load32_u(g.getLocal("y"),lt*4)),et[lt]=!0),g.i64_mul(bt,Et)}function _t(ut,lt){let bt,Et;return ct[ut]?bt=g.getLocal("q"+ut):(bt=g.teeLocal("q"+ut,g.i64_load32_u(g.i32_const(0),m+ut*4)),ct[ut]=!0),Et=g.getLocal("m"+lt),g.i64_mul(bt,Et)}let gt="c0",yt="c1";for(let ut=0;ut<d*2-1;ut++){for(let lt=Math.max(0,ut-d+1);lt<=ut&&lt<d;lt++){let bt=ut-lt;E.addCode(g.setLocal(gt,g.i64_add(g.i64_and(g.getLocal(gt),g.i64_const(4294967295)),ft(lt,bt)))),E.addCode(g.setLocal(yt,g.i64_add(g.getLocal(yt),g.i64_shr_u(g.getLocal(gt),g.i64_const(32)))))}for(let lt=Math.max(1,ut-d+1);lt<=ut&&lt<d;lt++){let bt=ut-lt;E.addCode(g.setLocal(gt,g.i64_add(g.i64_and(g.getLocal(gt),g.i64_const(4294967295)),_t(lt,bt)))),E.addCode(g.setLocal(yt,g.i64_add(g.getLocal(yt),g.i64_shr_u(g.getLocal(gt),g.i64_const(32)))))}ut<d&&(E.addCode(g.setLocal("m"+ut,g.i64_and(g.i64_mul(g.i64_and(g.getLocal(gt),g.i64_const(4294967295)),g.getLocal("np32")),g.i64_const("0xFFFFFFFF")))),E.addCode(g.setLocal(gt,g.i64_add(g.i64_and(g.getLocal(gt),g.i64_const(4294967295)),_t(0,ut)))),E.addCode(g.setLocal(yt,g.i64_add(g.getLocal(yt),g.i64_shr_u(g.getLocal(gt),g.i64_const(32)))))),ut>=d&&E.addCode(g.i64_store32(g.getLocal("r"),(ut-d)*4,g.getLocal(gt))),[gt,yt]=[yt,gt],E.addCode(g.setLocal(yt,g.i64_shr_u(g.getLocal(gt),g.i64_const(32))))}E.addCode(g.i64_store32(g.getLocal("r"),d*4-4,g.getLocal(gt))),E.addCode(g.if(g.i32_wrap_i64(g.getLocal(yt)),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))),g.if(g.call(s+"_gte",g.getLocal("r"),g.i32_const(m)),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))))))}function q(){let E=t.addFunction(l+"_square");E.addParam("x","i32"),E.addParam("r","i32"),E.addLocal("c0","i64"),E.addLocal("c1","i64"),E.addLocal("c0_old","i64"),E.addLocal("c1_old","i64"),E.addLocal("np32","i64");for(let lt=0;lt<d;lt++)E.addLocal("x"+lt,"i64"),E.addLocal("m"+lt,"i64"),E.addLocal("q"+lt,"i64");let g=E.getCodeBuilder(),U=Number(0x100000000n-lr(e,0x100000000n));E.addCode(g.setLocal("np32",g.i64_const(U)));let st=[],et=[];function ct(lt,bt){let Et,It;return st[lt]?Et=g.getLocal("x"+lt):(Et=g.teeLocal("x"+lt,g.i64_load32_u(g.getLocal("x"),lt*4)),st[lt]=!0),st[bt]?It=g.getLocal("x"+bt):(It=g.teeLocal("x"+bt,g.i64_load32_u(g.getLocal("x"),bt*4)),st[bt]=!0),g.i64_mul(Et,It)}function ft(lt,bt){let Et,It;return et[lt]?Et=g.getLocal("q"+lt):(Et=g.teeLocal("q"+lt,g.i64_load32_u(g.i32_const(0),m+lt*4)),et[lt]=!0),It=g.getLocal("m"+bt),g.i64_mul(Et,It)}let _t="c0",gt="c1",yt="c0_old",ut="c1_old";for(let lt=0;lt<d*2-1;lt++){E.addCode(g.setLocal(_t,g.i64_const(0)),g.setLocal(gt,g.i64_const(0)));for(let bt=Math.max(0,lt-d+1);bt<lt+1>>1&&bt<d;bt++){let Et=lt-bt;E.addCode(g.setLocal(_t,g.i64_add(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),ct(bt,Et)))),E.addCode(g.setLocal(gt,g.i64_add(g.getLocal(gt),g.i64_shr_u(g.getLocal(_t),g.i64_const(32)))))}E.addCode(g.setLocal(_t,g.i64_shl(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),g.i64_const(1)))),E.addCode(g.setLocal(gt,g.i64_add(g.i64_shl(g.getLocal(gt),g.i64_const(1)),g.i64_shr_u(g.getLocal(_t),g.i64_const(32))))),lt%2==0&&(E.addCode(g.setLocal(_t,g.i64_add(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),ct(lt>>1,lt>>1)))),E.addCode(g.setLocal(gt,g.i64_add(g.getLocal(gt),g.i64_shr_u(g.getLocal(_t),g.i64_const(32)))))),lt>0&&(E.addCode(g.setLocal(_t,g.i64_add(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),g.i64_and(g.getLocal(yt),g.i64_const(4294967295))))),E.addCode(g.setLocal(gt,g.i64_add(g.i64_add(g.getLocal(gt),g.i64_shr_u(g.getLocal(_t),g.i64_const(32))),g.getLocal(ut)))));for(let bt=Math.max(1,lt-d+1);bt<=lt&&bt<d;bt++){let Et=lt-bt;E.addCode(g.setLocal(_t,g.i64_add(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),ft(bt,Et)))),E.addCode(g.setLocal(gt,g.i64_add(g.getLocal(gt),g.i64_shr_u(g.getLocal(_t),g.i64_const(32)))))}lt<d&&(E.addCode(g.setLocal("m"+lt,g.i64_and(g.i64_mul(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),g.getLocal("np32")),g.i64_const("0xFFFFFFFF")))),E.addCode(g.setLocal(_t,g.i64_add(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),ft(0,lt)))),E.addCode(g.setLocal(gt,g.i64_add(g.getLocal(gt),g.i64_shr_u(g.getLocal(_t),g.i64_const(32)))))),lt>=d&&E.addCode(g.i64_store32(g.getLocal("r"),(lt-d)*4,g.getLocal(_t))),E.addCode(g.setLocal(yt,g.getLocal(gt)),g.setLocal(ut,g.i64_shr_u(g.getLocal(yt),g.i64_const(32))))}E.addCode(g.i64_store32(g.getLocal("r"),d*4-4,g.getLocal(yt))),E.addCode(g.if(g.i32_wrap_i64(g.getLocal(ut)),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))),g.if(g.call(s+"_gte",g.getLocal("r"),g.i32_const(m)),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))))))}function y(){let E=t.addFunction(l+"_squareOld");E.addParam("x","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.call(l+"_mul",g.getLocal("x"),g.getLocal("x"),g.getLocal("r")))}function I(){let E=t.addFunction(l+"_toMontgomery");E.addParam("x","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.call(l+"_mul",g.getLocal("x"),g.i32_const(B),g.getLocal("r")))}function N(){let E=t.alloc(b*2),g=t.addFunction(l+"_fromMontgomery");g.addParam("x","i32"),g.addParam("r","i32");let U=g.getCodeBuilder();g.addCode(U.call(s+"_copy",U.getLocal("x"),U.i32_const(E))),g.addCode(U.call(s+"_zero",U.i32_const(E+b))),g.addCode(U.call(l+"_mReduct",U.i32_const(E),U.getLocal("r")))}function nt(){let E=t.addFunction(l+"_inverse");E.addParam("x","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.call(l+"_fromMontgomery",g.getLocal("x"),g.getLocal("r"))),E.addCode(g.call(s+"_inverseMod",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))),E.addCode(g.call(l+"_toMontgomery",g.getLocal("r"),g.getLocal("r")))}let J=2n;if(h3(e))for(;_3(J,x,e)!==M;)J=J+1n;let j=0,ot=M;for(;!Ib(ot)&&ot!==0n;)j++,ot=ot>>1n;let V=t.alloc(b,Pa.bigInt2BytesLE(ot,b)),at=_3(J,ot,e),Lt=t.alloc(Pa.bigInt2BytesLE((at<<BigInt(h*64))%e,b)),rt=ot+1n>>1n,ht=t.alloc(b,Pa.bigInt2BytesLE(rt,b));function A(){let E=t.addFunction(l+"_sqrt");E.addParam("n","i32"),E.addParam("r","i32"),E.addLocal("m","i32"),E.addLocal("i","i32"),E.addLocal("j","i32");let g=E.getCodeBuilder(),U=g.i32_const(p),st=g.i32_const(t.alloc(b)),et=g.i32_const(t.alloc(b)),ct=g.i32_const(t.alloc(b)),ft=g.i32_const(t.alloc(b)),_t=g.i32_const(t.alloc(b));E.addCode(g.if(g.call(l+"_isZero",g.getLocal("n")),g.ret(g.call(l+"_zero",g.getLocal("r")))),g.setLocal("m",g.i32_const(j)),g.call(l+"_copy",g.i32_const(Lt),st),g.call(l+"_exp",g.getLocal("n"),g.i32_const(V),g.i32_const(b),et),g.call(l+"_exp",g.getLocal("n"),g.i32_const(ht),g.i32_const(b),ct),g.block(g.loop(g.br_if(1,g.call(l+"_eq",et,U)),g.call(l+"_square",et,ft),g.setLocal("i",g.i32_const(1)),g.block(g.loop(g.br_if(1,g.call(l+"_eq",ft,U)),g.call(l+"_square",ft,ft),g.setLocal("i",g.i32_add(g.getLocal("i"),g.i32_const(1))),g.br(0))),g.call(l+"_copy",st,_t),g.setLocal("j",g.i32_sub(g.i32_sub(g.getLocal("m"),g.getLocal("i")),g.i32_const(1))),g.block(g.loop(g.br_if(1,g.i32_eqz(g.getLocal("j"))),g.call(l+"_square",_t,_t),g.setLocal("j",g.i32_sub(g.getLocal("j"),g.i32_const(1))),g.br(0))),g.setLocal("m",g.getLocal("i")),g.call(l+"_square",_t,st),g.call(l+"_mul",et,st,et),g.call(l+"_mul",ct,_t,ct),g.br(0))),g.if(g.call(l+"_isNegative",ct),g.call(l+"_neg",ct,g.getLocal("r")),g.call(l+"_copy",ct,g.getLocal("r"))))}function i(){let E=t.addFunction(l+"_isSquare");E.addParam("n","i32"),E.setReturnType("i32");let g=E.getCodeBuilder(),U=g.i32_const(p),st=g.i32_const(t.alloc(b));E.addCode(g.if(g.call(l+"_isZero",g.getLocal("n")),g.ret(g.i32_const(1))),g.call(l+"_exp",g.getLocal("n"),g.i32_const(S),g.i32_const(b),st),g.call(l+"_eq",st,U))}function C(){let E=t.addFunction(l+"_load");E.addParam("scalar","i32"),E.addParam("scalarLen","i32"),E.addParam("r","i32"),E.addLocal("p","i32"),E.addLocal("l","i32"),E.addLocal("i","i32"),E.addLocal("j","i32");let g=E.getCodeBuilder(),U=g.i32_const(t.alloc(b)),st=t.alloc(b),et=g.i32_const(st);E.addCode(g.call(s+"_zero",g.getLocal("r")),g.setLocal("i",g.i32_const(b)),g.setLocal("p",g.getLocal("scalar")),g.block(g.loop(g.br_if(1,g.i32_gt_u(g.getLocal("i"),g.getLocal("scalarLen"))),g.if(g.i32_eq(g.getLocal("i"),g.i32_const(b)),g.call(l+"_one",U),g.call(l+"_mul",U,g.i32_const(B),U)),g.call(l+"_mul",g.getLocal("p"),U,et),g.call(l+"_add",g.getLocal("r"),et,g.getLocal("r")),g.setLocal("p",g.i32_add(g.getLocal("p"),g.i32_const(b))),g.setLocal("i",g.i32_add(g.getLocal("i"),g.i32_const(b))),g.br(0))),g.setLocal("l",g.i32_rem_u(g.getLocal("scalarLen"),g.i32_const(b))),g.if(g.i32_eqz(g.getLocal("l")),g.ret([])),g.call(s+"_zero",et),g.setLocal("j",g.i32_const(0)),g.block(g.loop(g.br_if(1,g.i32_eq(g.getLocal("j"),g.getLocal("l"))),g.i32_store8(g.getLocal("j"),st,g.i32_load8_u(g.getLocal("p"))),g.setLocal("p",g.i32_add(g.getLocal("p"),g.i32_const(1))),g.setLocal("j",g.i32_add(g.getLocal("j"),g.i32_const(1))),g.br(0))),g.if(g.i32_eq(g.getLocal("i"),g.i32_const(b)),g.call(l+"_one",U),g.call(l+"_mul",U,g.i32_const(B),U)),g.call(l+"_mul",et,U,et),g.call(l+"_add",g.getLocal("r"),et,g.getLocal("r")))}function r(){let E=t.addFunction(l+"_timesScalar");E.addParam("x","i32"),E.addParam("scalar","i32"),E.addParam("scalarLen","i32"),E.addParam("r","i32");let g=E.getCodeBuilder(),U=g.i32_const(t.alloc(b));E.addCode(g.call(l+"_load",g.getLocal("scalar"),g.getLocal("scalarLen"),U),g.call(l+"_toMontgomery",U,U),g.call(l+"_mul",g.getLocal("x"),U,g.getLocal("r")))}function z(){let E=t.addFunction(l+"_isOne");E.addParam("x","i32"),E.setReturnType("i32");let g=E.getCodeBuilder();E.addCode(g.ret(g.call(s+"_eq",g.getLocal("x"),g.i32_const(p))))}return t.exportFunction(s+"_copy",l+"_copy"),t.exportFunction(s+"_zero",l+"_zero"),t.exportFunction(s+"_isZero",l+"_isZero"),t.exportFunction(s+"_eq",l+"_eq"),z(),W(),F(),u(),Q(),H(),q(),y(),I(),N(),L(),$(),nt(),O(),C(),r(),Sb(t,l),cr(t,l+"_batchToMontgomery",l+"_toMontgomery",b,b),cr(t,l+"_batchFromMontgomery",l+"_fromMontgomery",b,b),cr(t,l+"_batchNeg",l+"_neg",b,b),sr(t,l+"_batchAdd",l+"_add",b,b),sr(t,l+"_batchSub",l+"_sub",b,b),sr(t,l+"_batchMul",l+"_mul",b,b),t.exportFunction(l+"_add"),t.exportFunction(l+"_sub"),t.exportFunction(l+"_neg"),t.exportFunction(l+"_isNegative"),t.exportFunction(l+"_isOne"),t.exportFunction(l+"_sign"),t.exportFunction(l+"_mReduct"),t.exportFunction(l+"_mul"),t.exportFunction(l+"_square"),t.exportFunction(l+"_squareOld"),t.exportFunction(l+"_fromMontgomery"),t.exportFunction(l+"_toMontgomery"),t.exportFunction(l+"_inverse"),t.exportFunction(l+"_one"),t.exportFunction(l+"_load"),t.exportFunction(l+"_timesScalar"),vb(t,l+"_exp",b,l+"_mul",l+"_square",s+"_copy",l+"_one"),t.exportFunction(l+"_exp"),t.exportFunction(l+"_batchInverse"),h3(e)&&(A(),i(),t.exportFunction(l+"_sqrt"),t.exportFunction(l+"_isSquare")),t.exportFunction(l+"_batchToMontgomery"),t.exportFunction(l+"_batchFromMontgomery"),l},Pb=Nr,{bitLength:Mb}=Xn,W3=function(t,n,a,o,e){let h=BigInt(n),d=Math.floor((Mb(h-1n)-1)/64)+1,b=d*8,l=a||"f1";if(t.modules[l])return l;t.modules[l]={n64:d};let s=e||"int",m=Pb(t,h,o,s),B=t.modules[m].pR2,p=t.modules[m].pq,v=t.modules[m].pePlusOne;function M(){let k=t.alloc(b),O=t.addFunction(l+"_mul");O.addParam("x","i32"),O.addParam("y","i32"),O.addParam("r","i32");let W=O.getCodeBuilder();O.addCode(W.call(m+"_mul",W.getLocal("x"),W.getLocal("y"),W.i32_const(k))),O.addCode(W.call(m+"_mul",W.i32_const(k),W.i32_const(B),W.getLocal("r")))}function x(){let k=t.addFunction(l+"_square");k.addParam("x","i32"),k.addParam("r","i32");let O=k.getCodeBuilder();k.addCode(O.call(l+"_mul",O.getLocal("x"),O.getLocal("x"),O.getLocal("r")))}function S(){let k=t.addFunction(l+"_inverse");k.addParam("x","i32"),k.addParam("r","i32");let O=k.getCodeBuilder();k.addCode(O.call(s+"_inverseMod",O.getLocal("x"),O.i32_const(p),O.getLocal("r")))}function w(){let k=t.addFunction(l+"_isNegative");k.addParam("x","i32"),k.setReturnType("i32");let O=k.getCodeBuilder();k.addCode(O.call(s+"_gte",O.getLocal("x"),O.i32_const(v)))}return M(),x(),S(),w(),t.exportFunction(m+"_add",l+"_add"),t.exportFunction(m+"_sub",l+"_sub"),t.exportFunction(m+"_neg",l+"_neg"),t.exportFunction(l+"_mul"),t.exportFunction(l+"_square"),t.exportFunction(l+"_inverse"),t.exportFunction(l+"_isNegative"),t.exportFunction(m+"_copy",l+"_copy"),t.exportFunction(m+"_zero",l+"_zero"),t.exportFunction(m+"_one",l+"_one"),t.exportFunction(m+"_isZero",l+"_isZero"),t.exportFunction(m+"_eq",l+"_eq"),l},Rb=Tr,zb=Gr,rr=Ha,Q3=function(t,n,a,o){if(t.modules[a])return a;let e=t.modules[o].n64*8,h=t.modules[o].q;t.modules[a]={n64:t.modules[o].n64*2};function d(){let q=t.addFunction(a+"_add");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("y"),J=y.i32_add(y.getLocal("y"),y.i32_const(e)),j=y.getLocal("r"),ot=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_add",I,nt,j),y.call(o+"_add",N,J,ot))}function b(){let q=t.addFunction(a+"_timesScalar");q.addParam("x","i32"),q.addParam("scalar","i32"),q.addParam("scalarLen","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_timesScalar",I,y.getLocal("scalar"),y.getLocal("scalarLen"),nt),y.call(o+"_timesScalar",N,y.getLocal("scalar"),y.getLocal("scalarLen"),J))}function l(){let q=t.addFunction(a+"_sub");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("y"),J=y.i32_add(y.getLocal("y"),y.i32_const(e)),j=y.getLocal("r"),ot=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_sub",I,nt,j),y.call(o+"_sub",N,J,ot))}function s(){let q=t.addFunction(a+"_neg");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_neg",I,nt),y.call(o+"_neg",N,J))}function m(){let q=t.addFunction(a+"_conjugate");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_copy",I,nt),y.call(o+"_neg",N,J))}function B(){let q=t.addFunction(a+"_isNegative");q.addParam("x","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.if(y.call(o+"_isZero",N),y.ret(y.call(o+"_isNegative",I))),y.ret(y.call(o+"_isNegative",N)))}function p(){let q=t.addFunction(a+"_mul");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("y"),J=y.i32_add(y.getLocal("y"),y.i32_const(e)),j=y.getLocal("r"),ot=y.i32_add(y.getLocal("r"),y.i32_const(e)),V=y.i32_const(t.alloc(e)),at=y.i32_const(t.alloc(e)),Lt=y.i32_const(t.alloc(e)),rt=y.i32_const(t.alloc(e));q.addCode(y.call(o+"_mul",I,nt,V),y.call(o+"_mul",N,J,at),y.call(o+"_add",I,N,Lt),y.call(o+"_add",nt,J,rt),y.call(o+"_mul",Lt,rt,Lt),y.call(n,at,j),y.call(o+"_add",V,j,j),y.call(o+"_add",V,at,ot),y.call(o+"_sub",Lt,ot,ot))}function v(){let q=t.addFunction(a+"_mul1");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("y"),J=y.getLocal("r"),j=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_mul",I,nt,J),y.call(o+"_mul",N,nt,j))}function M(){let q=t.addFunction(a+"_square");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e)),j=y.i32_const(t.alloc(e)),ot=y.i32_const(t.alloc(e)),V=y.i32_const(t.alloc(e)),at=y.i32_const(t.alloc(e));q.addCode(y.call(o+"_mul",I,N,j),y.call(o+"_add",I,N,ot),y.call(n,N,V),y.call(o+"_add",I,V,V),y.call(n,j,at),y.call(o+"_add",at,j,at),y.call(o+"_mul",ot,V,nt),y.call(o+"_sub",nt,at,nt),y.call(o+"_add",j,j,J))}function x(){let q=t.addFunction(a+"_toMontgomery");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_toMontgomery",I,nt),y.call(o+"_toMontgomery",N,J))}function S(){let q=t.addFunction(a+"_fromMontgomery");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_fromMontgomery",I,nt),y.call(o+"_fromMontgomery",N,J))}function w(){let q=t.addFunction(a+"_copy");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_copy",I,nt),y.call(o+"_copy",N,J))}function k(){let q=t.addFunction(a+"_zero");q.addParam("x","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.call(o+"_zero",I),y.call(o+"_zero",N))}function O(){let q=t.addFunction(a+"_one");q.addParam("x","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.call(o+"_one",I),y.call(o+"_zero",N))}function W(){let q=t.addFunction(a+"_eq");q.addParam("x","i32"),q.addParam("y","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("y"),J=y.i32_add(y.getLocal("y"),y.i32_const(e));q.addCode(y.i32_and(y.call(o+"_eq",I,nt),y.call(o+"_eq",N,J)))}function F(){let q=t.addFunction(a+"_isZero");q.addParam("x","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.i32_and(y.call(o+"_isZero",I),y.call(o+"_isZero",N)))}function u(){let q=t.addFunction(a+"_inverse");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e)),j=y.i32_const(t.alloc(e)),ot=y.i32_const(t.alloc(e)),V=y.i32_const(t.alloc(e)),at=y.i32_const(t.alloc(e));q.addCode(y.call(o+"_square",I,j),y.call(o+"_square",N,ot),y.call(n,ot,V),y.call(o+"_sub",j,V,V),y.call(o+"_inverse",V,at),y.call(o+"_mul",I,at,nt),y.call(o+"_mul",N,at,J),y.call(o+"_neg",J,J))}function L(){let q=t.addFunction(a+"_sign");q.addParam("x","i32"),q.addLocal("s","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.setLocal("s",y.call(o+"_sign",N)),y.if(y.getLocal("s"),y.ret(y.getLocal("s"))),y.ret(y.call(o+"_sign",I)))}function $(){let q=t.addFunction(a+"_isOne");q.addParam("x","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.ret(y.i32_and(y.call(o+"_isOne",I),y.call(o+"_isZero",N))))}function Q(){let q=t.addFunction(a+"_sqrt");q.addParam("a","i32"),q.addParam("pr","i32");let y=q.getCodeBuilder(),I=y.i32_const(t.alloc(rr.bigInt2BytesLE((BigInt(h||0)-3n)/4n,e))),N=y.i32_const(t.alloc(rr.bigInt2BytesLE((BigInt(h||0)-1n)/2n,e))),nt=y.getLocal("a"),J=y.i32_const(t.alloc(e*2)),j=y.i32_const(t.alloc(e*2)),ot=y.i32_const(t.alloc(e*2)),V=t.alloc(e*2),at=y.i32_const(V),Lt=y.i32_const(V),rt=y.i32_const(V+e),ht=y.i32_const(t.alloc(e*2)),A=y.i32_const(t.alloc(e*2));q.addCode(y.call(a+"_one",at),y.call(a+"_neg",at,at),y.call(a+"_exp",nt,I,y.i32_const(e),J),y.call(a+"_square",J,j),y.call(a+"_mul",nt,j,j),y.call(a+"_conjugate",j,ot),y.call(a+"_mul",ot,j,ot),y.if(y.call(a+"_eq",ot,at),y.unreachable()),y.call(a+"_mul",J,nt,ht),y.if(y.call(a+"_eq",j,at),[...y.call(o+"_zero",Lt),...y.call(o+"_one",rt),...y.call(a+"_mul",at,ht,y.getLocal("pr"))],[...y.call(a+"_one",A),...y.call(a+"_add",A,j,A),...y.call(a+"_exp",A,N,y.i32_const(e),A),...y.call(a+"_mul",A,ht,y.getLocal("pr"))]))}function H(){let q=t.addFunction(a+"_isSquare");q.addParam("a","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.i32_const(t.alloc(rr.bigInt2BytesLE((BigInt(h||0)-3n)/4n,e))),N=y.getLocal("a"),nt=y.i32_const(t.alloc(e*2)),J=y.i32_const(t.alloc(e*2)),j=y.i32_const(t.alloc(e*2)),ot=t.alloc(e*2),V=y.i32_const(ot);q.addCode(y.call(a+"_one",V),y.call(a+"_neg",V,V),y.call(a+"_exp",N,I,y.i32_const(e),nt),y.call(a+"_square",nt,J),y.call(a+"_mul",N,J,J),y.call(a+"_conjugate",J,j),y.call(a+"_mul",j,J,j),y.if(y.call(a+"_eq",j,V),y.ret(y.i32_const(0))),y.ret(y.i32_const(1)))}return F(),$(),k(),O(),w(),p(),v(),M(),d(),l(),s(),m(),x(),S(),W(),u(),b(),L(),B(),t.exportFunction(a+"_isZero"),t.exportFunction(a+"_isOne"),t.exportFunction(a+"_zero"),t.exportFunction(a+"_one"),t.exportFunction(a+"_copy"),t.exportFunction(a+"_mul"),t.exportFunction(a+"_mul1"),t.exportFunction(a+"_square"),t.exportFunction(a+"_add"),t.exportFunction(a+"_sub"),t.exportFunction(a+"_neg"),t.exportFunction(a+"_sign"),t.exportFunction(a+"_conjugate"),t.exportFunction(a+"_fromMontgomery"),t.exportFunction(a+"_toMontgomery"),t.exportFunction(a+"_eq"),t.exportFunction(a+"_inverse"),zb(t,a),Rb(t,a+"_exp",e*2,a+"_mul",a+"_square",a+"_copy",a+"_one"),Q(),H(),t.exportFunction(a+"_exp"),t.exportFunction(a+"_timesScalar"),t.exportFunction(a+"_batchInverse"),t.exportFunction(a+"_sqrt"),t.exportFunction(a+"_isSquare"),t.exportFunction(a+"_isNegative"),a},Tb=Tr,Gb=Gr,X3=function(t,n,a,o){if(t.modules[a])return a;let e=t.modules[o].n64*8;t.modules[a]={n64:t.modules[o].n64*3};function h(){let u=t.addFunction(a+"_add");u.addParam("x","i32"),u.addParam("y","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("y"),y=L.i32_add(L.getLocal("y"),L.i32_const(e)),I=L.i32_add(L.getLocal("y"),L.i32_const(2*e)),N=L.getLocal("r"),nt=L.i32_add(L.getLocal("r"),L.i32_const(e)),J=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_add",$,q,N),L.call(o+"_add",Q,y,nt),L.call(o+"_add",H,I,J))}function d(){let u=t.addFunction(a+"_timesScalar");u.addParam("x","i32"),u.addParam("scalar","i32"),u.addParam("scalarLen","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_timesScalar",$,L.getLocal("scalar"),L.getLocal("scalarLen"),q),L.call(o+"_timesScalar",Q,L.getLocal("scalar"),L.getLocal("scalarLen"),y),L.call(o+"_timesScalar",H,L.getLocal("scalar"),L.getLocal("scalarLen"),I))}function b(){let u=t.addFunction(a+"_sub");u.addParam("x","i32"),u.addParam("y","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("y"),y=L.i32_add(L.getLocal("y"),L.i32_const(e)),I=L.i32_add(L.getLocal("y"),L.i32_const(2*e)),N=L.getLocal("r"),nt=L.i32_add(L.getLocal("r"),L.i32_const(e)),J=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_sub",$,q,N),L.call(o+"_sub",Q,y,nt),L.call(o+"_sub",H,I,J))}function l(){let u=t.addFunction(a+"_neg");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_neg",$,q),L.call(o+"_neg",Q,y),L.call(o+"_neg",H,I))}function s(){let u=t.addFunction(a+"_isNegative");u.addParam("x","i32"),u.setReturnType("i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e));u.addCode(L.if(L.call(o+"_isZero",H),L.if(L.call(o+"_isZero",Q),L.ret(L.call(o+"_isNegative",$)),L.ret(L.call(o+"_isNegative",Q)))),L.ret(L.call(o+"_isNegative",H)))}function m(){let u=t.addFunction(a+"_mul");u.addParam("x","i32"),u.addParam("y","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("y"),y=L.i32_add(L.getLocal("y"),L.i32_const(e)),I=L.i32_add(L.getLocal("y"),L.i32_const(2*e)),N=L.getLocal("r"),nt=L.i32_add(L.getLocal("r"),L.i32_const(e)),J=L.i32_add(L.getLocal("r"),L.i32_const(2*e)),j=L.i32_const(t.alloc(e)),ot=L.i32_const(t.alloc(e)),V=L.i32_const(t.alloc(e)),at=L.i32_const(t.alloc(e)),Lt=L.i32_const(t.alloc(e)),rt=L.i32_const(t.alloc(e)),ht=L.i32_const(t.alloc(e)),A=L.i32_const(t.alloc(e)),i=L.i32_const(t.alloc(e)),C=L.i32_const(t.alloc(e)),r=L.i32_const(t.alloc(e)),z=L.i32_const(t.alloc(e)),E=L.i32_const(t.alloc(e));u.addCode(L.call(o+"_mul",$,q,j),L.call(o+"_mul",Q,y,ot),L.call(o+"_mul",H,I,V),L.call(o+"_add",$,Q,at),L.call(o+"_add",q,y,Lt),L.call(o+"_add",$,H,rt),L.call(o+"_add",q,I,ht),L.call(o+"_add",Q,H,A),L.call(o+"_add",y,I,i),L.call(o+"_add",j,ot,C),L.call(o+"_add",j,V,r),L.call(o+"_add",ot,V,z),L.call(o+"_mul",A,i,N),L.call(o+"_sub",N,z,N),L.call(n,N,N),L.call(o+"_add",j,N,N),L.call(o+"_mul",at,Lt,nt),L.call(o+"_sub",nt,C,nt),L.call(n,V,E),L.call(o+"_add",nt,E,nt),L.call(o+"_mul",rt,ht,J),L.call(o+"_sub",J,r,J),L.call(o+"_add",J,ot,J))}function B(){let u=t.addFunction(a+"_square");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e)),N=L.i32_const(t.alloc(e)),nt=L.i32_const(t.alloc(e)),J=L.i32_const(t.alloc(e)),j=L.i32_const(t.alloc(e)),ot=L.i32_const(t.alloc(e)),V=L.i32_const(t.alloc(e)),at=L.i32_const(t.alloc(e));u.addCode(L.call(o+"_square",$,N),L.call(o+"_mul",$,Q,nt),L.call(o+"_add",nt,nt,J),L.call(o+"_sub",$,Q,j),L.call(o+"_add",j,H,j),L.call(o+"_square",j,j),L.call(o+"_mul",Q,H,ot),L.call(o+"_add",ot,ot,V),L.call(o+"_square",H,at),L.call(n,V,q),L.call(o+"_add",N,q,q),L.call(n,at,y),L.call(o+"_add",J,y,y),L.call(o+"_add",N,at,I),L.call(o+"_sub",V,I,I),L.call(o+"_add",j,I,I),L.call(o+"_add",J,I,I))}function p(){let u=t.addFunction(a+"_toMontgomery");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_toMontgomery",$,q),L.call(o+"_toMontgomery",Q,y),L.call(o+"_toMontgomery",H,I))}function v(){let u=t.addFunction(a+"_fromMontgomery");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_fromMontgomery",$,q),L.call(o+"_fromMontgomery",Q,y),L.call(o+"_fromMontgomery",H,I))}function M(){let u=t.addFunction(a+"_copy");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_copy",$,q),L.call(o+"_copy",Q,y),L.call(o+"_copy",H,I))}function x(){let u=t.addFunction(a+"_zero");u.addParam("x","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e));u.addCode(L.call(o+"_zero",$),L.call(o+"_zero",Q),L.call(o+"_zero",H))}function S(){let u=t.addFunction(a+"_one");u.addParam("x","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e));u.addCode(L.call(o+"_one",$),L.call(o+"_zero",Q),L.call(o+"_zero",H))}function w(){let u=t.addFunction(a+"_eq");u.addParam("x","i32"),u.addParam("y","i32"),u.setReturnType("i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("y"),y=L.i32_add(L.getLocal("y"),L.i32_const(e)),I=L.i32_add(L.getLocal("y"),L.i32_const(2*e));u.addCode(L.i32_and(L.i32_and(L.call(o+"_eq",$,q),L.call(o+"_eq",Q,y)),L.call(o+"_eq",H,I)))}function k(){let u=t.addFunction(a+"_isZero");u.addParam("x","i32"),u.setReturnType("i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e));u.addCode(L.i32_and(L.i32_and(L.call(o+"_isZero",$),L.call(o+"_isZero",Q)),L.call(o+"_isZero",H)))}function O(){let u=t.addFunction(a+"_inverse");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e)),N=L.i32_const(t.alloc(e)),nt=L.i32_const(t.alloc(e)),J=L.i32_const(t.alloc(e)),j=L.i32_const(t.alloc(e)),ot=L.i32_const(t.alloc(e)),V=L.i32_const(t.alloc(e)),at=L.i32_const(t.alloc(e)),Lt=L.i32_const(t.alloc(e)),rt=L.i32_const(t.alloc(e)),ht=L.i32_const(t.alloc(e)),A=L.i32_const(t.alloc(e));u.addCode(L.call(o+"_square",$,N),L.call(o+"_square",Q,nt),L.call(o+"_square",H,J),L.call(o+"_mul",$,Q,j),L.call(o+"_mul",$,H,ot),L.call(o+"_mul",Q,H,V),L.call(n,V,at),L.call(o+"_sub",N,at,at),L.call(n,J,Lt),L.call(o+"_sub",Lt,j,Lt),L.call(o+"_sub",nt,ot,rt),L.call(o+"_mul",H,Lt,ht),L.call(o+"_mul",Q,rt,A),L.call(o+"_add",ht,A,ht),L.call(n,ht,ht),L.call(o+"_mul",$,at,A),L.call(o+"_add",A,ht,ht),L.call(o+"_inverse",ht,ht),L.call(o+"_mul",ht,at,q),L.call(o+"_mul",ht,Lt,y),L.call(o+"_mul",ht,rt,I))}function W(){let u=t.addFunction(a+"_sign");u.addParam("x","i32"),u.addLocal("s","i32"),u.setReturnType("i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e));u.addCode(L.setLocal("s",L.call(o+"_sign",H)),L.if(L.getLocal("s"),L.ret(L.getLocal("s"))),L.setLocal("s",L.call(o+"_sign",Q)),L.if(L.getLocal("s"),L.ret(L.getLocal("s"))),L.ret(L.call(o+"_sign",$)))}function F(){let u=t.addFunction(a+"_isOne");u.addParam("x","i32"),u.setReturnType("i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(e*2));u.addCode(L.ret(L.i32_and(L.i32_and(L.call(o+"_isOne",$),L.call(o+"_isZero",Q)),L.call(o+"_isZero",H))))}return k(),F(),x(),S(),M(),m(),B(),h(),b(),l(),W(),p(),v(),w(),O(),d(),s(),t.exportFunction(a+"_isZero"),t.exportFunction(a+"_isOne"),t.exportFunction(a+"_zero"),t.exportFunction(a+"_one"),t.exportFunction(a+"_copy"),t.exportFunction(a+"_mul"),t.exportFunction(a+"_square"),t.exportFunction(a+"_add"),t.exportFunction(a+"_sub"),t.exportFunction(a+"_neg"),t.exportFunction(a+"_sign"),t.exportFunction(a+"_fromMontgomery"),t.exportFunction(a+"_toMontgomery"),t.exportFunction(a+"_eq"),t.exportFunction(a+"_inverse"),Gb(t,a),Tb(t,a+"_exp",e*3,a+"_mul",a+"_square",a+"_copy",a+"_one"),t.exportFunction(a+"_exp"),t.exportFunction(a+"_timesScalar"),t.exportFunction(a+"_batchInverse"),t.exportFunction(a+"_isNegative"),a},kb=function(t,n,a,o,e,h,d,b){let l=t.addFunction(n);l.addParam("base","i32"),l.addParam("scalar","i32"),l.addParam("scalarLength","i32"),l.addParam("r","i32"),l.addLocal("old0","i32"),l.addLocal("nbits","i32"),l.addLocal("i","i32"),l.addLocal("last","i32"),l.addLocal("cur","i32"),l.addLocal("carry","i32"),l.addLocal("p","i32");let s=l.getCodeBuilder(),m=s.i32_const(t.alloc(a));function B(v){return s.i32_and(s.i32_shr_u(s.i32_load(s.i32_add(s.getLocal("scalar"),s.i32_and(s.i32_shr_u(v,s.i32_const(3)),s.i32_const(4294967292)))),s.i32_and(v,s.i32_const(31))),s.i32_const(1))}function p(v){return[...s.i32_store8(s.getLocal("p"),s.i32_const(v)),...s.setLocal("p",s.i32_add(s.getLocal("p"),s.i32_const(1)))]}l.addCode(s.if(s.i32_eqz(s.getLocal("scalarLength")),[...s.call(b,s.getLocal("r")),...s.ret([])]),s.setLocal("nbits",s.i32_shl(s.getLocal("scalarLength"),s.i32_const(3))),s.setLocal("old0",s.i32_load(s.i32_const(0))),s.setLocal("p",s.getLocal("old0")),s.i32_store(s.i32_const(0),s.i32_and(s.i32_add(s.i32_add(s.getLocal("old0"),s.i32_const(32)),s.getLocal("nbits")),s.i32_const(4294967288))),s.setLocal("i",s.i32_const(1)),s.setLocal("last",B(s.i32_const(0))),s.setLocal("carry",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("nbits"))),s.setLocal("cur",B(s.getLocal("i"))),s.if(s.getLocal("last"),s.if(s.getLocal("cur"),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...p(1)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...p(255)]),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...p(255)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(0)),...p(1)])),s.if(s.getLocal("cur"),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...p(0)],[...s.setLocal("last",s.i32_const(1)),...s.setLocal("carry",s.i32_const(0)),...p(0)]),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(1)),...s.setLocal("carry",s.i32_const(0)),...p(0)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(0)),...p(0)]))),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0))),s.if(s.getLocal("last"),s.if(s.getLocal("carry"),[...p(255),...p(0),...p(1)],[...p(1)]),s.if(s.getLocal("carry"),[...p(0),...p(1)])),s.setLocal("p",s.i32_sub(s.getLocal("p"),s.i32_const(1))),s.call(d,s.getLocal("base"),m),s.call(b,s.getLocal("r")),s.block(s.loop(s.call(e,s.getLocal("r"),s.getLocal("r")),s.setLocal("cur",s.i32_load8_u(s.getLocal("p"))),s.if(s.getLocal("cur"),s.if(s.i32_eq(s.getLocal("cur"),s.i32_const(1)),s.call(o,s.getLocal("r"),m,s.getLocal("r")),s.call(h,s.getLocal("r"),m,s.getLocal("r")))),s.br_if(1,s.i32_eq(s.getLocal("old0"),s.getLocal("p"))),s.setLocal("p",s.i32_sub(s.getLocal("p"),s.i32_const(1))),s.br(0))),s.i32_store(s.i32_const(0),s.getLocal("old0")))},Ub=function(t,n,a,o,e){let d=t.modules[n].n64*8;function b(){let B=t.addFunction(a+"_getChunk");B.addParam("pScalar","i32"),B.addParam("scalarSize","i32"),B.addParam("startBit","i32"),B.addParam("chunkSize","i32"),B.addLocal("bitsToEnd","i32"),B.addLocal("mask","i32"),B.setReturnType("i32");let p=B.getCodeBuilder();B.addCode(p.setLocal("bitsToEnd",p.i32_sub(p.i32_mul(p.getLocal("scalarSize"),p.i32_const(8)),p.getLocal("startBit"))),p.if(p.i32_gt_s(p.getLocal("chunkSize"),p.getLocal("bitsToEnd")),p.setLocal("mask",p.i32_sub(p.i32_shl(p.i32_const(1),p.getLocal("bitsToEnd")),p.i32_const(1))),p.setLocal("mask",p.i32_sub(p.i32_shl(p.i32_const(1),p.getLocal("chunkSize")),p.i32_const(1)))),p.i32_and(p.i32_shr_u(p.i32_load(p.i32_add(p.getLocal("pScalar"),p.i32_shr_u(p.getLocal("startBit"),p.i32_const(3))),0,0),p.i32_and(p.getLocal("startBit"),p.i32_const(7))),p.getLocal("mask")))}function l(){let B=t.addFunction(a+"_chunk");B.addParam("pBases","i32"),B.addParam("pScalars","i32"),B.addParam("scalarSize","i32"),B.addParam("n","i32"),B.addParam("startBit","i32"),B.addParam("chunkSize","i32"),B.addParam("pr","i32"),B.addLocal("nChunks","i32"),B.addLocal("itScalar","i32"),B.addLocal("endScalar","i32"),B.addLocal("itBase","i32"),B.addLocal("i","i32"),B.addLocal("j","i32"),B.addLocal("nTable","i32"),B.addLocal("pTable","i32"),B.addLocal("idx","i32"),B.addLocal("pIdxTable","i32");let p=B.getCodeBuilder();B.addCode(p.if(p.i32_eqz(p.getLocal("n")),[...p.call(n+"_zero",p.getLocal("pr")),...p.ret([])]),p.setLocal("nTable",p.i32_shl(p.i32_const(1),p.getLocal("chunkSize"))),p.setLocal("pTable",p.i32_load(p.i32_const(0))),p.i32_store(p.i32_const(0),p.i32_add(p.getLocal("pTable"),p.i32_mul(p.getLocal("nTable"),p.i32_const(d)))),p.setLocal("j",p.i32_const(0)),p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("j"),p.getLocal("nTable"))),p.call(n+"_zero",p.i32_add(p.getLocal("pTable"),p.i32_mul(p.getLocal("j"),p.i32_const(d)))),p.setLocal("j",p.i32_add(p.getLocal("j"),p.i32_const(1))),p.br(0))),p.setLocal("itBase",p.getLocal("pBases")),p.setLocal("itScalar",p.getLocal("pScalars")),p.setLocal("endScalar",p.i32_add(p.getLocal("pScalars"),p.i32_mul(p.getLocal("n"),p.getLocal("scalarSize")))),p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("itScalar"),p.getLocal("endScalar"))),p.setLocal("idx",p.call(a+"_getChunk",p.getLocal("itScalar"),p.getLocal("scalarSize"),p.getLocal("startBit"),p.getLocal("chunkSize"))),p.if(p.getLocal("idx"),[...p.setLocal("pIdxTable",p.i32_add(p.getLocal("pTable"),p.i32_mul(p.i32_sub(p.getLocal("idx"),p.i32_const(1)),p.i32_const(d)))),...p.call(o,p.getLocal("pIdxTable"),p.getLocal("itBase"),p.getLocal("pIdxTable"))]),p.setLocal("itScalar",p.i32_add(p.getLocal("itScalar"),p.getLocal("scalarSize"))),p.setLocal("itBase",p.i32_add(p.getLocal("itBase"),p.i32_const(e))),p.br(0))),p.call(a+"_reduceTable",p.getLocal("pTable"),p.getLocal("chunkSize")),p.call(n+"_copy",p.getLocal("pTable"),p.getLocal("pr")),p.i32_store(p.i32_const(0),p.getLocal("pTable")))}function s(){let B=t.addFunction(a);B.addParam("pBases","i32"),B.addParam("pScalars","i32"),B.addParam("scalarSize","i32"),B.addParam("n","i32"),B.addParam("pr","i32"),B.addLocal("chunkSize","i32"),B.addLocal("nChunks","i32"),B.addLocal("itScalar","i32"),B.addLocal("endScalar","i32"),B.addLocal("itBase","i32"),B.addLocal("itBit","i32"),B.addLocal("i","i32"),B.addLocal("j","i32"),B.addLocal("nTable","i32"),B.addLocal("pTable","i32"),B.addLocal("idx","i32"),B.addLocal("pIdxTable","i32");let p=B.getCodeBuilder(),v=p.i32_const(t.alloc(d)),M=t.alloc([17,17,17,17,17,17,17,17,17,17,16,16,15,14,13,13,12,11,10,9,8,7,7,6,5,4,3,2,1,1,1,1]);B.addCode(p.call(n+"_zero",p.getLocal("pr")),p.if(p.i32_eqz(p.getLocal("n")),p.ret([])),p.setLocal("chunkSize",p.i32_load8_u(p.i32_clz(p.getLocal("n")),M)),p.setLocal("nChunks",p.i32_add(p.i32_div_u(p.i32_sub(p.i32_shl(p.getLocal("scalarSize"),p.i32_const(3)),p.i32_const(1)),p.getLocal("chunkSize")),p.i32_const(1))),p.setLocal("itBit",p.i32_mul(p.i32_sub(p.getLocal("nChunks"),p.i32_const(1)),p.getLocal("chunkSize"))),p.block(p.loop(p.br_if(1,p.i32_lt_s(p.getLocal("itBit"),p.i32_const(0))),p.if(p.i32_eqz(p.call(n+"_isZero",p.getLocal("pr"))),[...p.setLocal("j",p.i32_const(0)),...p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("j"),p.getLocal("chunkSize"))),p.call(n+"_double",p.getLocal("pr"),p.getLocal("pr")),p.setLocal("j",p.i32_add(p.getLocal("j"),p.i32_const(1))),p.br(0)))]),p.call(a+"_chunk",p.getLocal("pBases"),p.getLocal("pScalars"),p.getLocal("scalarSize"),p.getLocal("n"),p.getLocal("itBit"),p.getLocal("chunkSize"),v),p.call(n+"_add",p.getLocal("pr"),v,p.getLocal("pr")),p.setLocal("itBit",p.i32_sub(p.getLocal("itBit"),p.getLocal("chunkSize"))),p.br(0))))}function m(){let B=t.addFunction(a+"_reduceTable");B.addParam("pTable","i32"),B.addParam("p","i32"),B.addLocal("half","i32"),B.addLocal("it1","i32"),B.addLocal("it2","i32"),B.addLocal("pAcc","i32");let p=B.getCodeBuilder();B.addCode(p.if(p.i32_eq(p.getLocal("p"),p.i32_const(1)),p.ret([])),p.setLocal("half",p.i32_shl(p.i32_const(1),p.i32_sub(p.getLocal("p"),p.i32_const(1)))),p.setLocal("it1",p.getLocal("pTable")),p.setLocal("it2",p.i32_add(p.getLocal("pTable"),p.i32_mul(p.getLocal("half"),p.i32_const(d)))),p.setLocal("pAcc",p.i32_sub(p.getLocal("it2"),p.i32_const(d))),p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("it1"),p.getLocal("pAcc"))),p.call(n+"_add",p.getLocal("it1"),p.getLocal("it2"),p.getLocal("it1")),p.call(n+"_add",p.getLocal("pAcc"),p.getLocal("it2"),p.getLocal("pAcc")),p.setLocal("it1",p.i32_add(p.getLocal("it1"),p.i32_const(d))),p.setLocal("it2",p.i32_add(p.getLocal("it2"),p.i32_const(d))),p.br(0))),p.call(a+"_reduceTable",p.getLocal("pTable"),p.i32_sub(p.getLocal("p"),p.i32_const(1))),p.setLocal("p",p.i32_sub(p.getLocal("p"),p.i32_const(1))),p.block(p.loop(p.br_if(1,p.i32_eqz(p.getLocal("p"))),p.call(n+"_double",p.getLocal("pAcc"),p.getLocal("pAcc")),p.setLocal("p",p.i32_sub(p.getLocal("p"),p.i32_const(1))),p.br(0))),p.call(n+"_add",p.getLocal("pTable"),p.getLocal("pAcc"),p.getLocal("pTable")))}b(),m(),l(),s(),t.exportFunction(a),t.exportFunction(a+"_chunk")},f3=kb,Ri=U3,g3=Ub,H3=function(t,n,a,o){let e=t.modules[a].n64,h=e*8;if(t.modules[n])return n;t.modules[n]={n64:e*3};function d(){let A=t.addFunction(n+"_isZero");A.addParam("p1","i32"),A.setReturnType("i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_isZero",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))))}function b(){let A=t.addFunction(n+"_isZeroAffine");A.addParam("p1","i32"),A.setReturnType("i32");let i=A.getCodeBuilder();A.addCode(i.i32_and(i.call(a+"_isZero",i.getLocal("p1")),i.call(a+"_isZero",i.i32_add(i.getLocal("p1"),i.i32_const(h)))))}function l(){let A=t.addFunction(n+"_copy");A.addParam("ps","i32"),A.addParam("pd","i32");let i=A.getCodeBuilder();for(let C=0;C<e*3;C++)A.addCode(i.i64_store(i.getLocal("pd"),C*8,i.i64_load(i.getLocal("ps"),C*8)))}function s(){let A=t.addFunction(n+"_copyAffine");A.addParam("ps","i32"),A.addParam("pd","i32");let i=A.getCodeBuilder();for(let C=0;C<e*2;C++)A.addCode(i.i64_store(i.getLocal("pd"),C*8,i.i64_load(i.getLocal("ps"),C*8)))}function m(){let A=t.addFunction(n+"_zero");A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_zero",i.getLocal("pr"))),A.addCode(i.call(a+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(h)))),A.addCode(i.call(a+"_zero",i.i32_add(i.getLocal("pr"),i.i32_const(h*2))))}function B(){let A=t.addFunction(n+"_zeroAffine");A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_zero",i.getLocal("pr"))),A.addCode(i.call(a+"_zero",i.i32_add(i.getLocal("pr"),i.i32_const(h))))}function p(){let A=t.addFunction(n+"_eq");A.addParam("p1","i32"),A.addParam("p2","i32"),A.setReturnType("i32"),A.addLocal("z1","i32"),A.addLocal("z2","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h));A.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));let z=i.getLocal("z1"),E=i.getLocal("p2"),g=i.i32_add(i.getLocal("p2"),i.i32_const(h));A.addCode(i.setLocal("z2",i.i32_add(i.getLocal("p2"),i.i32_const(h*2))));let U=i.getLocal("z2"),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),yt=i.i32_const(t.alloc(h)),ut=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),i.ret(i.call(n+"_isZero",i.getLocal("p2")))),i.if(i.call(n+"_isZero",i.getLocal("p2")),i.ret(i.i32_const(0))),i.if(i.call(a+"_isOne",z),i.ret(i.call(n+"_eqMixed",i.getLocal("p2"),i.getLocal("p1")))),i.if(i.call(a+"_isOne",U),i.ret(i.call(n+"_eqMixed",i.getLocal("p1"),i.getLocal("p2")))),i.call(a+"_square",z,st),i.call(a+"_square",U,et),i.call(a+"_mul",C,et,ct),i.call(a+"_mul",E,st,ft),i.call(a+"_mul",z,st,_t),i.call(a+"_mul",U,et,gt),i.call(a+"_mul",r,gt,yt),i.call(a+"_mul",g,_t,ut),i.if(i.call(a+"_eq",ct,ft),i.if(i.call(a+"_eq",yt,ut),i.ret(i.i32_const(1)))),i.ret(i.i32_const(0)))}function v(){let A=t.addFunction(n+"_eqMixed");A.addParam("p1","i32"),A.addParam("p2","i32"),A.setReturnType("i32"),A.addLocal("z1","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h));A.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));let z=i.getLocal("z1"),E=i.getLocal("p2"),g=i.i32_add(i.getLocal("p2"),i.i32_const(h)),U=i.i32_const(t.alloc(h)),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),i.ret(i.call(n+"_isZeroAffine",i.getLocal("p2")))),i.if(i.call(n+"_isZeroAffine",i.getLocal("p2")),i.ret(i.i32_const(0))),i.if(i.call(a+"_isOne",z),i.ret(i.call(n+"_eqAffine",i.getLocal("p1"),i.getLocal("p2")))),i.call(a+"_square",z,U),i.call(a+"_mul",E,U,st),i.call(a+"_mul",z,U,et),i.call(a+"_mul",g,et,ct),i.if(i.call(a+"_eq",C,st),i.if(i.call(a+"_eq",r,ct),i.ret(i.i32_const(1)))),i.ret(i.i32_const(0)))}function M(){let A=t.addFunction(n+"_double");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.i32_add(i.getLocal("p1"),i.i32_const(h*2)),E=i.getLocal("pr"),g=i.i32_add(i.getLocal("pr"),i.i32_const(h)),U=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),yt=i.i32_const(t.alloc(h)),ut=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(n+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(a+"_isOne",z),[...i.ret(i.call(n+"_doubleAffine",i.getLocal("p1"),i.getLocal("pr"))),...i.ret([])]),i.call(a+"_square",C,st),i.call(a+"_square",r,et),i.call(a+"_square",et,ct),i.call(a+"_add",C,et,ft),i.call(a+"_square",ft,ft),i.call(a+"_sub",ft,st,ft),i.call(a+"_sub",ft,ct,ft),i.call(a+"_add",ft,ft,ft),i.call(a+"_add",st,st,_t),i.call(a+"_add",_t,st,_t),i.call(a+"_square",_t,gt),i.call(a+"_mul",r,z,yt),i.call(a+"_add",ft,ft,E),i.call(a+"_sub",gt,E,E),i.call(a+"_add",ct,ct,ut),i.call(a+"_add",ut,ut,ut),i.call(a+"_add",ut,ut,ut),i.call(a+"_sub",ft,E,g),i.call(a+"_mul",g,_t,g),i.call(a+"_sub",g,ut,g),i.call(a+"_add",yt,yt,U))}function x(){let A=t.addFunction(n+"_doubleAffine");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.getLocal("pr"),E=i.i32_add(i.getLocal("pr"),i.i32_const(h)),g=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),U=i.i32_const(t.alloc(h)),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("p1")),[...i.call(n+"_toJacobian",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.call(a+"_square",C,U),i.call(a+"_square",r,st),i.call(a+"_square",st,et),i.call(a+"_add",C,st,ct),i.call(a+"_square",ct,ct),i.call(a+"_sub",ct,U,ct),i.call(a+"_sub",ct,et,ct),i.call(a+"_add",ct,ct,ct),i.call(a+"_add",U,U,ft),i.call(a+"_add",ft,U,ft),i.call(a+"_add",r,r,g),i.call(a+"_square",ft,z),i.call(a+"_sub",z,ct,z),i.call(a+"_sub",z,ct,z),i.call(a+"_add",et,et,_t),i.call(a+"_add",_t,_t,_t),i.call(a+"_add",_t,_t,_t),i.call(a+"_sub",ct,z,E),i.call(a+"_mul",E,ft,E),i.call(a+"_sub",E,_t,E))}function S(){let A=t.addFunction(n+"_eqAffine");A.addParam("p1","i32"),A.addParam("p2","i32"),A.setReturnType("i32"),A.addLocal("z1","i32");let i=A.getCodeBuilder();A.addCode(i.ret(i.i32_and(i.call(a+"_eq",i.getLocal("p1"),i.getLocal("p2")),i.call(a+"_eq",i.i32_add(i.getLocal("p1"),i.i32_const(h)),i.i32_add(i.getLocal("p2"),i.i32_const(h))))))}function w(){let A=t.addFunction(n+"_toMontgomery");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_toMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<3;C++)A.addCode(i.call(a+"_toMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*h)),i.i32_add(i.getLocal("pr"),i.i32_const(C*h))))}function k(){let A=t.addFunction(n+"_toMontgomeryAffine");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_toMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<2;C++)A.addCode(i.call(a+"_toMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*h)),i.i32_add(i.getLocal("pr"),i.i32_const(C*h))))}function O(){let A=t.addFunction(n+"_fromMontgomery");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_fromMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<3;C++)A.addCode(i.call(a+"_fromMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*h)),i.i32_add(i.getLocal("pr"),i.i32_const(C*h))))}function W(){let A=t.addFunction(n+"_fromMontgomeryAffine");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_fromMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<2;C++)A.addCode(i.call(a+"_fromMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*h)),i.i32_add(i.getLocal("pr"),i.i32_const(C*h))))}function F(){let A=t.addFunction(n+"_add");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32"),A.addLocal("z1","i32"),A.addLocal("z2","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h));A.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));let z=i.getLocal("z1"),E=i.getLocal("p2"),g=i.i32_add(i.getLocal("p2"),i.i32_const(h));A.addCode(i.setLocal("z2",i.i32_add(i.getLocal("p2"),i.i32_const(h*2))));let U=i.getLocal("z2"),st=i.getLocal("pr"),et=i.i32_add(i.getLocal("pr"),i.i32_const(h)),ct=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),yt=i.i32_const(t.alloc(h)),ut=i.i32_const(t.alloc(h)),lt=i.i32_const(t.alloc(h)),bt=i.i32_const(t.alloc(h)),Et=i.i32_const(t.alloc(h)),It=i.i32_const(t.alloc(h)),zt=i.i32_const(t.alloc(h)),Mt=i.i32_const(t.alloc(h)),kt=i.i32_const(t.alloc(h)),Pt=i.i32_const(t.alloc(h)),qt=i.i32_const(t.alloc(h)),Rt=i.i32_const(t.alloc(h)),Kt=i.i32_const(t.alloc(h)),Ut=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(n+"_copy",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(n+"_isZero",i.getLocal("p2")),[...i.call(n+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(a+"_isOne",z),[...i.call(n+"_addMixed",E,C,st),...i.ret([])]),i.if(i.call(a+"_isOne",U),[...i.call(n+"_addMixed",C,E,st),...i.ret([])]),i.call(a+"_square",z,ft),i.call(a+"_square",U,_t),i.call(a+"_mul",C,_t,gt),i.call(a+"_mul",E,ft,yt),i.call(a+"_mul",z,ft,ut),i.call(a+"_mul",U,_t,lt),i.call(a+"_mul",r,lt,bt),i.call(a+"_mul",g,ut,Et),i.if(i.call(a+"_eq",gt,yt),i.if(i.call(a+"_eq",bt,Et),[...i.call(n+"_double",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])])),i.call(a+"_sub",yt,gt,It),i.call(a+"_sub",Et,bt,zt),i.call(a+"_add",It,It,Mt),i.call(a+"_square",Mt,Mt),i.call(a+"_mul",It,Mt,kt),i.call(a+"_add",zt,zt,Pt),i.call(a+"_mul",gt,Mt,Rt),i.call(a+"_square",Pt,qt),i.call(a+"_add",Rt,Rt,Kt),i.call(a+"_sub",qt,kt,st),i.call(a+"_sub",st,Kt,st),i.call(a+"_mul",bt,kt,Ut),i.call(a+"_add",Ut,Ut,Ut),i.call(a+"_sub",Rt,st,et),i.call(a+"_mul",et,Pt,et),i.call(a+"_sub",et,Ut,et),i.call(a+"_add",z,U,ct),i.call(a+"_square",ct,ct),i.call(a+"_sub",ct,ft,ct),i.call(a+"_sub",ct,_t,ct),i.call(a+"_mul",ct,It,ct))}function u(){let A=t.addFunction(n+"_addMixed");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32"),A.addLocal("z1","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h));A.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));let z=i.getLocal("z1"),E=i.getLocal("p2"),g=i.i32_add(i.getLocal("p2"),i.i32_const(h)),U=i.getLocal("pr"),st=i.i32_add(i.getLocal("pr"),i.i32_const(h)),et=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),ct=i.i32_const(t.alloc(h)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),yt=i.i32_const(t.alloc(h)),ut=i.i32_const(t.alloc(h)),lt=i.i32_const(t.alloc(h)),bt=i.i32_const(t.alloc(h)),Et=i.i32_const(t.alloc(h)),It=i.i32_const(t.alloc(h)),zt=i.i32_const(t.alloc(h)),Mt=i.i32_const(t.alloc(h)),kt=i.i32_const(t.alloc(h)),Pt=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(n+"_copyAffine",i.getLocal("p2"),i.getLocal("pr")),...i.call(a+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(h*2))),...i.ret([])]),i.if(i.call(n+"_isZeroAffine",i.getLocal("p2")),[...i.call(n+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(a+"_isOne",z),[...i.call(n+"_addAffine",C,E,U),...i.ret([])]),i.call(a+"_square",z,ct),i.call(a+"_mul",E,ct,ft),i.call(a+"_mul",z,ct,_t),i.call(a+"_mul",g,_t,gt),i.if(i.call(a+"_eq",C,ft),i.if(i.call(a+"_eq",r,gt),[...i.call(n+"_doubleAffine",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])])),i.call(a+"_sub",ft,C,yt),i.call(a+"_sub",gt,r,lt),i.call(a+"_square",yt,ut),i.call(a+"_add",ut,ut,bt),i.call(a+"_add",bt,bt,bt),i.call(a+"_mul",yt,bt,Et),i.call(a+"_add",lt,lt,It),i.call(a+"_mul",C,bt,Mt),i.call(a+"_square",It,zt),i.call(a+"_add",Mt,Mt,kt),i.call(a+"_sub",zt,Et,U),i.call(a+"_sub",U,kt,U),i.call(a+"_mul",r,Et,Pt),i.call(a+"_add",Pt,Pt,Pt),i.call(a+"_sub",Mt,U,st),i.call(a+"_mul",st,It,st),i.call(a+"_sub",st,Pt,st),i.call(a+"_add",z,yt,et),i.call(a+"_square",et,et),i.call(a+"_sub",et,ct,et),i.call(a+"_sub",et,ut,et))}function L(){let A=t.addFunction(n+"_addAffine");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32"),A.addLocal("z1","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h));A.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));let z=i.getLocal("p2"),E=i.i32_add(i.getLocal("p2"),i.i32_const(h)),g=i.getLocal("pr"),U=i.i32_add(i.getLocal("pr"),i.i32_const(h)),st=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),yt=i.i32_const(t.alloc(h)),ut=i.i32_const(t.alloc(h)),lt=i.i32_const(t.alloc(h)),bt=i.i32_const(t.alloc(h)),Et=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("p1")),[...i.call(n+"_copyAffine",i.getLocal("p2"),i.getLocal("pr")),...i.call(a+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(h*2))),...i.ret([])]),i.if(i.call(n+"_isZeroAffine",i.getLocal("p2")),[...i.call(n+"_copyAffine",i.getLocal("p1"),i.getLocal("pr")),...i.call(a+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(h*2))),...i.ret([])]),i.if(i.call(a+"_eq",C,z),i.if(i.call(a+"_eq",r,E),[...i.call(n+"_doubleAffine",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])])),i.call(a+"_sub",z,C,et),i.call(a+"_sub",E,r,ft),i.call(a+"_square",et,ct),i.call(a+"_add",ct,ct,_t),i.call(a+"_add",_t,_t,_t),i.call(a+"_mul",et,_t,gt),i.call(a+"_add",ft,ft,yt),i.call(a+"_mul",C,_t,lt),i.call(a+"_square",yt,ut),i.call(a+"_add",lt,lt,bt),i.call(a+"_sub",ut,gt,g),i.call(a+"_sub",g,bt,g),i.call(a+"_mul",r,gt,Et),i.call(a+"_add",Et,Et,Et),i.call(a+"_sub",lt,g,U),i.call(a+"_mul",U,yt,U),i.call(a+"_sub",U,Et,U),i.call(a+"_add",et,et,st))}function $(){let A=t.addFunction(n+"_neg");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.i32_add(i.getLocal("p1"),i.i32_const(h*2)),E=i.getLocal("pr"),g=i.i32_add(i.getLocal("pr"),i.i32_const(h)),U=i.i32_add(i.getLocal("pr"),i.i32_const(h*2));A.addCode(i.call(a+"_copy",C,E),i.call(a+"_neg",r,g),i.call(a+"_copy",z,U))}function Q(){let A=t.addFunction(n+"_negAffine");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.getLocal("pr"),E=i.i32_add(i.getLocal("pr"),i.i32_const(h));A.addCode(i.call(a+"_copy",C,z),i.call(a+"_neg",r,E))}function H(){let A=t.addFunction(n+"_sub");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h*3));A.addCode(i.call(n+"_neg",i.getLocal("p2"),C),i.call(n+"_add",i.getLocal("p1"),C,i.getLocal("pr")))}function q(){let A=t.addFunction(n+"_subMixed");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h*3));A.addCode(i.call(n+"_negAffine",i.getLocal("p2"),C),i.call(n+"_addMixed",i.getLocal("p1"),C,i.getLocal("pr")))}function y(){let A=t.addFunction(n+"_subAffine");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h*3));A.addCode(i.call(n+"_negAffine",i.getLocal("p2"),C),i.call(n+"_addAffine",i.getLocal("p1"),C,i.getLocal("pr")))}function I(){let A=t.addFunction(n+"_normalize");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.i32_add(i.getLocal("p1"),i.i32_const(h*2)),E=i.getLocal("pr"),g=i.i32_add(i.getLocal("pr"),i.i32_const(h)),U=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),i.call(n+"_zero",i.getLocal("pr")),[...i.call(a+"_inverse",z,st),...i.call(a+"_square",st,et),...i.call(a+"_mul",st,et,ct),...i.call(a+"_mul",C,et,E),...i.call(a+"_mul",r,ct,g),...i.call(a+"_one",U)]))}function N(){let A=t.addFunction(n+"_toAffine");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.i32_add(i.getLocal("p1"),i.i32_const(h*2)),E=i.getLocal("pr"),g=i.i32_add(i.getLocal("pr"),i.i32_const(h)),U=i.i32_const(t.alloc(h)),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(a+"_zero",E),...i.call(a+"_zero",g)],[...i.call(a+"_inverse",z,U),...i.call(a+"_square",U,st),...i.call(a+"_mul",U,st,et),...i.call(a+"_mul",C,st,E),...i.call(a+"_mul",r,et,g)]))}function nt(){let A=t.addFunction(n+"_toJacobian");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.getLocal("pr"),E=i.i32_add(i.getLocal("pr"),i.i32_const(h)),g=i.i32_add(i.getLocal("pr"),i.i32_const(h*2));A.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("p1")),i.call(n+"_zero",i.getLocal("pr")),[...i.call(a+"_one",g),...i.call(a+"_copy",r,E),...i.call(a+"_copy",C,z)]))}function J(){let A=t.addFunction(n+"_batchToAffine");A.addParam("pIn","i32"),A.addParam("n","i32"),A.addParam("pOut","i32"),A.addLocal("pAux","i32"),A.addLocal("itIn","i32"),A.addLocal("itAux","i32"),A.addLocal("itOut","i32"),A.addLocal("i","i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h));A.addCode(i.setLocal("pAux",i.i32_load(i.i32_const(0))),i.i32_store(i.i32_const(0),i.i32_add(i.getLocal("pAux"),i.i32_mul(i.getLocal("n"),i.i32_const(h)))),i.call(a+"_batchInverse",i.i32_add(i.getLocal("pIn"),i.i32_const(h*2)),i.i32_const(h*3),i.getLocal("n"),i.getLocal("pAux"),i.i32_const(h)),i.setLocal("itIn",i.getLocal("pIn")),i.setLocal("itAux",i.getLocal("pAux")),i.setLocal("itOut",i.getLocal("pOut")),i.setLocal("i",i.i32_const(0)),i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("i"),i.getLocal("n"))),i.if(i.call(a+"_isZero",i.getLocal("itAux")),[...i.call(a+"_zero",i.getLocal("itOut")),...i.call(a+"_zero",i.i32_add(i.getLocal("itOut"),i.i32_const(h)))],[...i.call(a+"_mul",i.getLocal("itAux"),i.i32_add(i.getLocal("itIn"),i.i32_const(h)),C),...i.call(a+"_square",i.getLocal("itAux"),i.getLocal("itAux")),...i.call(a+"_mul",i.getLocal("itAux"),i.getLocal("itIn"),i.getLocal("itOut")),...i.call(a+"_mul",i.getLocal("itAux"),C,i.i32_add(i.getLocal("itOut"),i.i32_const(h)))]),i.setLocal("itIn",i.i32_add(i.getLocal("itIn"),i.i32_const(h*3))),i.setLocal("itOut",i.i32_add(i.getLocal("itOut"),i.i32_const(h*2))),i.setLocal("itAux",i.i32_add(i.getLocal("itAux"),i.i32_const(h))),i.setLocal("i",i.i32_add(i.getLocal("i"),i.i32_const(1))),i.br(0))),i.i32_store(i.i32_const(0),i.getLocal("pAux")))}function j(){let A=t.addFunction(n+"__reverseBytes");A.addParam("pIn","i32"),A.addParam("n","i32"),A.addParam("pOut","i32"),A.addLocal("itOut","i32"),A.addLocal("itIn","i32");let i=A.getCodeBuilder();A.addCode(i.setLocal("itOut",i.i32_sub(i.i32_add(i.getLocal("pOut"),i.getLocal("n")),i.i32_const(1))),i.setLocal("itIn",i.getLocal("pIn")),i.block(i.loop(i.br_if(1,i.i32_lt_s(i.getLocal("itOut"),i.getLocal("pOut"))),i.i32_store8(i.getLocal("itOut"),i.i32_load8_u(i.getLocal("itIn"))),i.setLocal("itOut",i.i32_sub(i.getLocal("itOut"),i.i32_const(1))),i.setLocal("itIn",i.i32_add(i.getLocal("itIn"),i.i32_const(1))),i.br(0))))}function ot(){let A=t.addFunction(n+"_LEMtoC");A.addParam("pIn","i32"),A.addParam("pOut","i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("pIn")),[...i.call(a+"_zero",i.getLocal("pOut")),...i.i32_store8(i.getLocal("pOut"),i.i32_const(64)),...i.ret([])]),i.call(a+"_fromMontgomery",i.getLocal("pIn"),C),i.call(n+"__reverseBytes",C,i.i32_const(h),i.getLocal("pOut")),i.if(i.i32_eq(i.call(a+"_sign",i.i32_add(i.getLocal("pIn"),i.i32_const(h))),i.i32_const(-1)),i.i32_store8(i.getLocal("pOut"),i.i32_or(i.i32_load8_u(i.getLocal("pOut")),i.i32_const(128)))))}function V(){let A=t.addFunction(n+"_LEMtoU");A.addParam("pIn","i32"),A.addParam("pOut","i32");let i=A.getCodeBuilder(),C=t.alloc(h*2),r=i.i32_const(C),z=i.i32_const(C),E=i.i32_const(C+h);A.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("pIn")),[...i.call(n+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.call(n+"_fromMontgomeryAffine",i.getLocal("pIn"),r),i.call(n+"__reverseBytes",z,i.i32_const(h),i.getLocal("pOut")),i.call(n+"__reverseBytes",E,i.i32_const(h),i.i32_add(i.getLocal("pOut"),i.i32_const(h))))}function at(){let A=t.addFunction(n+"_UtoLEM");A.addParam("pIn","i32"),A.addParam("pOut","i32");let i=A.getCodeBuilder(),C=t.alloc(h*2),r=i.i32_const(C),z=i.i32_const(C),E=i.i32_const(C+h);A.addCode(i.if(i.i32_and(i.i32_load8_u(i.getLocal("pIn")),i.i32_const(64)),[...i.call(n+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.call(n+"__reverseBytes",i.getLocal("pIn"),i.i32_const(h),z),i.call(n+"__reverseBytes",i.i32_add(i.getLocal("pIn"),i.i32_const(h)),i.i32_const(h),E),i.call(n+"_toMontgomeryAffine",r,i.getLocal("pOut")))}function Lt(){let A=t.addFunction(n+"_CtoLEM");A.addParam("pIn","i32"),A.addParam("pOut","i32"),A.addLocal("firstByte","i32"),A.addLocal("greatest","i32");let i=A.getCodeBuilder(),C=t.alloc(h*2),r=i.i32_const(C),z=i.i32_const(C+h);A.addCode(i.setLocal("firstByte",i.i32_load8_u(i.getLocal("pIn"))),i.if(i.i32_and(i.getLocal("firstByte"),i.i32_const(64)),[...i.call(n+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.setLocal("greatest",i.i32_and(i.getLocal("firstByte"),i.i32_const(128))),i.call(a+"_copy",i.getLocal("pIn"),z),i.i32_store8(z,i.i32_and(i.getLocal("firstByte"),i.i32_const(63))),i.call(n+"__reverseBytes",z,i.i32_const(h),r),i.call(a+"_toMontgomery",r,i.getLocal("pOut")),i.call(a+"_square",i.getLocal("pOut"),z),i.call(a+"_mul",i.getLocal("pOut"),z,z),i.call(a+"_add",z,i.i32_const(o),z),i.call(a+"_sqrt",z,z),i.call(a+"_neg",z,r),i.if(i.i32_eq(i.call(a+"_sign",z),i.i32_const(-1)),i.if(i.getLocal("greatest"),i.call(a+"_copy",z,i.i32_add(i.getLocal("pOut"),i.i32_const(h))),i.call(a+"_neg",z,i.i32_add(i.getLocal("pOut"),i.i32_const(h)))),i.if(i.getLocal("greatest"),i.call(a+"_neg",z,i.i32_add(i.getLocal("pOut"),i.i32_const(h))),i.call(a+"_copy",z,i.i32_add(i.getLocal("pOut"),i.i32_const(h))))))}function rt(){let A=t.addFunction(n+"_inCurveAffine");A.addParam("pIn","i32"),A.setReturnType("i32");let i=A.getCodeBuilder(),C=i.getLocal("pIn"),r=i.i32_add(i.getLocal("pIn"),i.i32_const(h)),z=i.i32_const(t.alloc(h)),E=i.i32_const(t.alloc(h));A.addCode(i.call(a+"_square",r,z),i.call(a+"_square",C,E),i.call(a+"_mul",C,E,E),i.call(a+"_add",E,i.i32_const(o),E),i.ret(i.call(a+"_eq",z,E)))}function ht(){let A=t.addFunction(n+"_inCurve");A.addParam("pIn","i32"),A.setReturnType("i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h*2));A.addCode(i.call(n+"_toAffine",i.getLocal("pIn"),C),i.ret(i.call(n+"_inCurveAffine",C)))}return b(),d(),B(),m(),s(),l(),nt(),S(),v(),p(),x(),M(),L(),u(),F(),Q(),$(),y(),q(),H(),W(),O(),k(),w(),N(),rt(),ht(),J(),I(),j(),V(),ot(),at(),Lt(),Ri(t,n+"_batchLEMtoU",n+"_LEMtoU",h*2,h*2),Ri(t,n+"_batchLEMtoC",n+"_LEMtoC",h*2,h),Ri(t,n+"_batchUtoLEM",n+"_UtoLEM",h*2,h*2),Ri(t,n+"_batchCtoLEM",n+"_CtoLEM",h,h*2,!0),Ri(t,n+"_batchToJacobian",n+"_toJacobian",h*2,h*3,!0),g3(t,n,n+"_multiexp",n+"_add",h*3),g3(t,n,n+"_multiexpAffine",n+"_addMixed",h*2),f3(t,n+"_timesScalar",h*3,n+"_add",n+"_double",n+"_sub",n+"_copy",n+"_zero"),f3(t,n+"_timesScalarAffine",h*2,n+"_addMixed",n+"_double",n+"_subMixed",n+"_copyAffine",n+"_zero"),t.exportFunction(n+"_isZero"),t.exportFunction(n+"_isZeroAffine"),t.exportFunction(n+"_eq"),t.exportFunction(n+"_eqMixed"),t.exportFunction(n+"_eqAffine"),t.exportFunction(n+"_copy"),t.exportFunction(n+"_copyAffine"),t.exportFunction(n+"_zero"),t.exportFunction(n+"_zeroAffine"),t.exportFunction(n+"_double"),t.exportFunction(n+"_doubleAffine"),t.exportFunction(n+"_add"),t.exportFunction(n+"_addMixed"),t.exportFunction(n+"_addAffine"),t.exportFunction(n+"_neg"),t.exportFunction(n+"_negAffine"),t.exportFunction(n+"_sub"),t.exportFunction(n+"_subMixed"),t.exportFunction(n+"_subAffine"),t.exportFunction(n+"_fromMontgomery"),t.exportFunction(n+"_fromMontgomeryAffine"),t.exportFunction(n+"_toMontgomery"),t.exportFunction(n+"_toMontgomeryAffine"),t.exportFunction(n+"_timesScalar"),t.exportFunction(n+"_timesScalarAffine"),t.exportFunction(n+"_normalize"),t.exportFunction(n+"_LEMtoU"),t.exportFunction(n+"_LEMtoC"),t.exportFunction(n+"_UtoLEM"),t.exportFunction(n+"_CtoLEM"),t.exportFunction(n+"_batchLEMtoU"),t.exportFunction(n+"_batchLEMtoC"),t.exportFunction(n+"_batchUtoLEM"),t.exportFunction(n+"_batchCtoLEM"),t.exportFunction(n+"_toAffine"),t.exportFunction(n+"_toJacobian"),t.exportFunction(n+"_batchToAffine"),t.exportFunction(n+"_batchToJacobian"),t.exportFunction(n+"_inCurve"),t.exportFunction(n+"_inCurveAffine"),n},{isOdd:Nb,modInv:L3,modPow:zi}=Xn,xc=Ha,D3=function(t,n,a,o,e){let d=t.modules[o].n64*8,l=t.modules[a].n64*8,s=t.modules[o].q,m=s-1n,B=0;for(;!Nb(m);)B++,m=m>>1n;let p=2n;for(;zi(p,s>>1n,s)===1n;)p=p+1n;let v=new Array(B+1);v[B]=zi(p,m,s);let M=B-1;for(;M>=0;)v[M]=zi(v[M+1],2n,s),M--;let x=[],S=(1n<<BigInt(d*8))%s;for(let C=0;C<v.length;C++){let r=v[C]*S%s;x.push(...xc.bigInt2BytesLE(r,d))}let w=t.alloc(x),k=new Array(B+1);k[0]=1n;for(let C=1;C<=B;C++)k[C]=k[C-1]*2n;let O=[];for(let C=0;C<=B;C++){let r=L3(k[C],s)*S%s;O.push(...xc.bigInt2BytesLE(r,d))}let W=t.alloc(O),F=zi(p,2n,s),u=[],L=[];for(let C=0;C<=B;C++){let r=zi(F,2n**BigInt(C),s),z=L3(s+1n-r,s);u.push(...xc.bigInt2BytesLE(r*S%s,d)),L.push(...xc.bigInt2BytesLE(z*S%s,d))}let $=t.alloc(u),Q=t.alloc(L);function H(C){let r=0;for(let z=0;z<8;z++)C&1<<z&&(r=r|128>>z);return r}let q=Array(256);for(let C=0;C<256;C++)q[C]=H(C);let y=t.alloc(q);function I(){let C=t.addFunction(n+"__log2");C.addParam("n","i32"),C.setReturnType("i32"),C.addLocal("bits","i32"),C.addLocal("aux","i32");let r=C.getCodeBuilder();C.addCode(r.setLocal("aux",r.i32_shr_u(r.getLocal("n"),r.i32_const(1)))),C.addCode(r.setLocal("bits",r.i32_const(0))),C.addCode(r.block(r.loop(r.br_if(1,r.i32_eqz(r.getLocal("aux"))),r.setLocal("aux",r.i32_shr_u(r.getLocal("aux"),r.i32_const(1))),r.setLocal("bits",r.i32_add(r.getLocal("bits"),r.i32_const(1))),r.br(0)))),C.addCode(r.if(r.i32_ne(r.getLocal("n"),r.i32_shl(r.i32_const(1),r.getLocal("bits"))),r.unreachable())),C.addCode(r.if(r.i32_gt_u(r.getLocal("bits"),r.i32_const(B)),r.unreachable())),C.addCode(r.getLocal("bits"))}function N(){let C=t.addFunction(n+"_fft");C.addParam("px","i32"),C.addParam("n","i32"),C.addLocal("bits","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d));C.addCode(r.setLocal("bits",r.call(n+"__log2",r.getLocal("n"))),r.call(o+"_one",z),r.call(n+"_rawfft",r.getLocal("px"),r.getLocal("bits"),r.i32_const(0),z))}function nt(){let C=t.addFunction(n+"_ifft");C.addParam("px","i32"),C.addParam("n","i32"),C.addLocal("bits","i32"),C.addLocal("pInv2","i32");let r=C.getCodeBuilder();C.addCode(r.setLocal("bits",r.call(n+"__log2",r.getLocal("n"))),r.setLocal("pInv2",r.i32_add(r.i32_const(W),r.i32_mul(r.getLocal("bits"),r.i32_const(d)))),r.call(n+"_rawfft",r.getLocal("px"),r.getLocal("bits"),r.i32_const(1),r.getLocal("pInv2")))}function J(){let C=t.addFunction(n+"_rawfft");C.addParam("px","i32"),C.addParam("bits","i32"),C.addParam("reverse","i32"),C.addParam("mulFactor","i32"),C.addLocal("s","i32"),C.addLocal("k","i32"),C.addLocal("j","i32"),C.addLocal("m","i32"),C.addLocal("mdiv2","i32"),C.addLocal("n","i32"),C.addLocal("pwm","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l)),g=r.i32_const(t.alloc(l));C.addCode(r.call(n+"__reversePermutation",r.getLocal("px"),r.getLocal("bits")),r.setLocal("n",r.i32_shl(r.i32_const(1),r.getLocal("bits"))),r.setLocal("s",r.i32_const(1)),r.block(r.loop(r.br_if(1,r.i32_gt_u(r.getLocal("s"),r.getLocal("bits"))),r.setLocal("m",r.i32_shl(r.i32_const(1),r.getLocal("s"))),r.setLocal("pwm",r.i32_add(r.i32_const(w),r.i32_mul(r.getLocal("s"),r.i32_const(d)))),r.setLocal("k",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_ge_u(r.getLocal("k"),r.getLocal("n"))),r.call(o+"_one",z),r.setLocal("mdiv2",r.i32_shr_u(r.getLocal("m"),r.i32_const(1))),r.setLocal("j",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_ge_u(r.getLocal("j"),r.getLocal("mdiv2"))),r.setLocal("idx1",r.i32_add(r.getLocal("px"),r.i32_mul(r.i32_add(r.getLocal("k"),r.getLocal("j")),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("idx1"),r.i32_mul(r.getLocal("mdiv2"),r.i32_const(l)))),r.call(e,r.getLocal("idx2"),z,E),r.call(a+"_copy",r.getLocal("idx1"),g),r.call(a+"_add",g,E,r.getLocal("idx1")),r.call(a+"_sub",g,E,r.getLocal("idx2")),r.call(o+"_mul",z,r.getLocal("pwm"),z),r.setLocal("j",r.i32_add(r.getLocal("j"),r.i32_const(1))),r.br(0))),r.setLocal("k",r.i32_add(r.getLocal("k"),r.getLocal("m"))),r.br(0))),r.setLocal("s",r.i32_add(r.getLocal("s"),r.i32_const(1))),r.br(0))),r.call(n+"__fftFinal",r.getLocal("px"),r.getLocal("bits"),r.getLocal("reverse"),r.getLocal("mulFactor")))}function j(){let C=t.addFunction(n+"__fftFinal");C.addParam("px","i32"),C.addParam("bits","i32"),C.addParam("reverse","i32"),C.addParam("mulFactor","i32"),C.addLocal("n","i32"),C.addLocal("ndiv2","i32"),C.addLocal("pInv2","i32"),C.addLocal("i","i32"),C.addLocal("mask","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(l));C.addCode(r.if(r.i32_and(r.i32_eqz(r.getLocal("reverse")),r.call(o+"_isOne",r.getLocal("mulFactor"))),r.ret([])),r.setLocal("n",r.i32_shl(r.i32_const(1),r.getLocal("bits"))),r.setLocal("mask",r.i32_sub(r.getLocal("n"),r.i32_const(1))),r.setLocal("i",r.i32_const(1)),r.setLocal("ndiv2",r.i32_shr_u(r.getLocal("n"),r.i32_const(1))),r.block(r.loop(r.br_if(1,r.i32_ge_u(r.getLocal("i"),r.getLocal("ndiv2"))),r.setLocal("idx1",r.i32_add(r.getLocal("px"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("px"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.getLocal("i")),r.i32_const(l)))),r.if(r.getLocal("reverse"),r.if(r.call(o+"_isOne",r.getLocal("mulFactor")),[...r.call(a+"_copy",r.getLocal("idx1"),z),...r.call(a+"_copy",r.getLocal("idx2"),r.getLocal("idx1")),...r.call(a+"_copy",z,r.getLocal("idx2"))],[...r.call(a+"_copy",r.getLocal("idx1"),z),...r.call(e,r.getLocal("idx2"),r.getLocal("mulFactor"),r.getLocal("idx1")),...r.call(e,z,r.getLocal("mulFactor"),r.getLocal("idx2"))]),r.if(r.call(o+"_isOne",r.getLocal("mulFactor")),[],[...r.call(e,r.getLocal("idx1"),r.getLocal("mulFactor"),r.getLocal("idx1")),...r.call(e,r.getLocal("idx2"),r.getLocal("mulFactor"),r.getLocal("idx2"))])),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))),r.if(r.call(o+"_isOne",r.getLocal("mulFactor")),[],[...r.call(e,r.getLocal("px"),r.getLocal("mulFactor"),r.getLocal("px")),...r.setLocal("idx2",r.i32_add(r.getLocal("px"),r.i32_mul(r.getLocal("ndiv2"),r.i32_const(l)))),...r.call(e,r.getLocal("idx2"),r.getLocal("mulFactor"),r.getLocal("idx2"))]))}function ot(){let C=t.addFunction(n+"__reversePermutation");C.addParam("px","i32"),C.addParam("bits","i32"),C.addLocal("n","i32"),C.addLocal("i","i32"),C.addLocal("ri","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(l));C.addCode(r.setLocal("n",r.i32_shl(r.i32_const(1),r.getLocal("bits"))),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.setLocal("idx1",r.i32_add(r.getLocal("px"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("ri",r.call(n+"__rev",r.getLocal("i"),r.getLocal("bits"))),r.setLocal("idx2",r.i32_add(r.getLocal("px"),r.i32_mul(r.getLocal("ri"),r.i32_const(l)))),r.if(r.i32_lt_u(r.getLocal("i"),r.getLocal("ri")),[...r.call(a+"_copy",r.getLocal("idx1"),z),...r.call(a+"_copy",r.getLocal("idx2"),r.getLocal("idx1")),...r.call(a+"_copy",z,r.getLocal("idx2"))]),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function V(){let C=t.addFunction(n+"__rev");C.addParam("x","i32"),C.addParam("bits","i32"),C.setReturnType("i32");let r=C.getCodeBuilder();C.addCode(r.i32_rotl(r.i32_add(r.i32_add(r.i32_shl(r.i32_load8_u(r.i32_and(r.getLocal("x"),r.i32_const(255)),y,0),r.i32_const(24)),r.i32_shl(r.i32_load8_u(r.i32_and(r.i32_shr_u(r.getLocal("x"),r.i32_const(8)),r.i32_const(255)),y,0),r.i32_const(16))),r.i32_add(r.i32_shl(r.i32_load8_u(r.i32_and(r.i32_shr_u(r.getLocal("x"),r.i32_const(16)),r.i32_const(255)),y,0),r.i32_const(8)),r.i32_load8_u(r.i32_and(r.i32_shr_u(r.getLocal("x"),r.i32_const(24)),r.i32_const(255)),y,0))),r.getLocal("bits")))}function at(){let C=t.addFunction(n+"_fftJoin");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l)),g=r.i32_const(t.alloc(l));C.addCode(r.call(o+"_copy",r.getLocal("first"),z),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff1"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("pBuff2"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.call(e,r.getLocal("idx2"),z,E),r.call(a+"_copy",r.getLocal("idx1"),g),r.call(a+"_add",g,E,r.getLocal("idx1")),r.call(a+"_sub",g,E,r.getLocal("idx2")),r.call(o+"_mul",z,r.getLocal("inc"),z),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function Lt(){let C=t.addFunction(n+"_fftJoinExt");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addParam("totalBits","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("pShiftToM","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l));C.addCode(r.setLocal("pShiftToM",r.i32_add(r.i32_const($),r.i32_mul(r.getLocal("totalBits"),r.i32_const(d)))),r.call(o+"_copy",r.getLocal("first"),z),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff1"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("pBuff2"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.call(a+"_add",r.getLocal("idx1"),r.getLocal("idx2"),E),r.call(e,r.getLocal("idx2"),r.getLocal("pShiftToM"),r.getLocal("idx2")),r.call(a+"_add",r.getLocal("idx1"),r.getLocal("idx2"),r.getLocal("idx2")),r.call(e,r.getLocal("idx2"),z,r.getLocal("idx2")),r.call(a+"_copy",E,r.getLocal("idx1")),r.call(o+"_mul",z,r.getLocal("inc"),z),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function rt(){let C=t.addFunction(n+"_fftJoinExtInv");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addParam("totalBits","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("pShiftToM","i32"),C.addLocal("pSConst","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l));C.addCode(r.setLocal("pShiftToM",r.i32_add(r.i32_const($),r.i32_mul(r.getLocal("totalBits"),r.i32_const(d)))),r.setLocal("pSConst",r.i32_add(r.i32_const(Q),r.i32_mul(r.getLocal("totalBits"),r.i32_const(d)))),r.call(o+"_copy",r.getLocal("first"),z),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff1"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("pBuff2"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.call(e,r.getLocal("idx2"),z,E),r.call(a+"_sub",r.getLocal("idx1"),E,r.getLocal("idx2")),r.call(e,r.getLocal("idx2"),r.getLocal("pSConst"),r.getLocal("idx2")),r.call(e,r.getLocal("idx1"),r.getLocal("pShiftToM"),r.getLocal("idx1")),r.call(a+"_sub",E,r.getLocal("idx1"),r.getLocal("idx1")),r.call(e,r.getLocal("idx1"),r.getLocal("pSConst"),r.getLocal("idx1")),r.call(o+"_mul",z,r.getLocal("inc"),z),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function ht(){let C=t.addFunction(n+"_prepareLagrangeEvaluation");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addParam("totalBits","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("pShiftToM","i32"),C.addLocal("pSConst","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l));C.addCode(r.setLocal("pShiftToM",r.i32_add(r.i32_const($),r.i32_mul(r.getLocal("totalBits"),r.i32_const(d)))),r.setLocal("pSConst",r.i32_add(r.i32_const(Q),r.i32_mul(r.getLocal("totalBits"),r.i32_const(d)))),r.call(o+"_copy",r.getLocal("first"),z),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff1"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("pBuff2"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.call(e,r.getLocal("idx1"),r.getLocal("pShiftToM"),E),r.call(a+"_sub",r.getLocal("idx2"),E,E),r.call(a+"_sub",r.getLocal("idx1"),r.getLocal("idx2"),r.getLocal("idx2")),r.call(e,E,r.getLocal("pSConst"),r.getLocal("idx1")),r.call(e,r.getLocal("idx2"),z,r.getLocal("idx2")),r.call(o+"_mul",z,r.getLocal("inc"),z),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function A(){let C=t.addFunction(n+"_fftMix");C.addParam("pBuff","i32"),C.addParam("n","i32"),C.addParam("exp","i32"),C.addLocal("nGroups","i32"),C.addLocal("nPerGroup","i32"),C.addLocal("nPerGroupDiv2","i32"),C.addLocal("pairOffset","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("j","i32"),C.addLocal("pwm","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l)),g=r.i32_const(t.alloc(l));C.addCode(r.setLocal("nPerGroup",r.i32_shl(r.i32_const(1),r.getLocal("exp"))),r.setLocal("nPerGroupDiv2",r.i32_shr_u(r.getLocal("nPerGroup"),r.i32_const(1))),r.setLocal("nGroups",r.i32_shr_u(r.getLocal("n"),r.getLocal("exp"))),r.setLocal("pairOffset",r.i32_mul(r.getLocal("nPerGroupDiv2"),r.i32_const(l))),r.setLocal("pwm",r.i32_add(r.i32_const(w),r.i32_mul(r.getLocal("exp"),r.i32_const(d)))),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("nGroups"))),r.call(o+"_one",z),r.setLocal("j",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("j"),r.getLocal("nPerGroupDiv2"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff"),r.i32_mul(r.i32_add(r.i32_mul(r.getLocal("i"),r.getLocal("nPerGroup")),r.getLocal("j")),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("idx1"),r.getLocal("pairOffset"))),r.call(e,r.getLocal("idx2"),z,E),r.call(a+"_copy",r.getLocal("idx1"),g),r.call(a+"_add",g,E,r.getLocal("idx1")),r.call(a+"_sub",g,E,r.getLocal("idx2")),r.call(o+"_mul",z,r.getLocal("pwm"),z),r.setLocal("j",r.i32_add(r.getLocal("j"),r.i32_const(1))),r.br(0))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function i(){let C=t.addFunction(n+"_fftFinal");C.addParam("pBuff","i32"),C.addParam("n","i32"),C.addParam("factor","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("ndiv2","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(l));C.addCode(r.setLocal("ndiv2",r.i32_shr_u(r.getLocal("n"),r.i32_const(1))),r.if(r.i32_and(r.getLocal("n"),r.i32_const(1)),r.call(e,r.i32_add(r.getLocal("pBuff"),r.i32_mul(r.getLocal("ndiv2"),r.i32_const(l))),r.getLocal("factor"),r.i32_add(r.getLocal("pBuff"),r.i32_mul(r.getLocal("ndiv2"),r.i32_const(l))))),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_ge_u(r.getLocal("i"),r.getLocal("ndiv2"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("pBuff"),r.i32_mul(r.i32_sub(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.getLocal("i")),r.i32_const(l)))),r.call(e,r.getLocal("idx2"),r.getLocal("factor"),z),r.call(e,r.getLocal("idx1"),r.getLocal("factor"),r.getLocal("idx2")),r.call(a+"_copy",z,r.getLocal("idx1")),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}V(),ot(),j(),J(),I(),N(),nt(),at(),Lt(),rt(),A(),i(),ht(),t.exportFunction(n+"_fft"),t.exportFunction(n+"_ifft"),t.exportFunction(n+"_rawfft"),t.exportFunction(n+"_fftJoin"),t.exportFunction(n+"_fftJoinExt"),t.exportFunction(n+"_fftJoinExtInv"),t.exportFunction(n+"_fftMix"),t.exportFunction(n+"_fftFinal"),t.exportFunction(n+"_prepareLagrangeEvaluation")},K3=function(t,n,a){let e=t.modules[a].n64*8;function h(){let b=t.addFunction(n+"_zero");b.addParam("px","i32"),b.addParam("n","i32"),b.addLocal("lastp","i32"),b.addLocal("p","i32");let l=b.getCodeBuilder();b.addCode(l.setLocal("p",l.getLocal("px")),l.setLocal("lastp",l.i32_add(l.getLocal("px"),l.i32_mul(l.getLocal("n"),l.i32_const(e)))),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("p"),l.getLocal("lastp"))),l.call(a+"_zero",l.getLocal("p")),l.setLocal("p",l.i32_add(l.getLocal("p"),l.i32_const(e))),l.br(0))))}function d(){let b=t.addFunction(n+"_constructLC");b.addParam("ppolynomials","i32"),b.addParam("psignals","i32"),b.addParam("nSignals","i32"),b.addParam("pres","i32"),b.addLocal("i","i32"),b.addLocal("j","i32"),b.addLocal("pp","i32"),b.addLocal("ps","i32"),b.addLocal("pd","i32"),b.addLocal("ncoefs","i32");let l=b.getCodeBuilder(),s=l.i32_const(t.alloc(e));b.addCode(l.setLocal("i",l.i32_const(0)),l.setLocal("pp",l.getLocal("ppolynomials")),l.setLocal("ps",l.getLocal("psignals")),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("nSignals"))),l.setLocal("ncoefs",l.i32_load(l.getLocal("pp"))),l.setLocal("pp",l.i32_add(l.getLocal("pp"),l.i32_const(4))),l.setLocal("j",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("j"),l.getLocal("ncoefs"))),l.setLocal("pd",l.i32_add(l.getLocal("pres"),l.i32_mul(l.i32_load(l.getLocal("pp")),l.i32_const(e)))),l.setLocal("pp",l.i32_add(l.getLocal("pp"),l.i32_const(4))),l.call(a+"_mul",l.getLocal("ps"),l.getLocal("pp"),s),l.call(a+"_add",s,l.getLocal("pd"),l.getLocal("pd")),l.setLocal("pp",l.i32_add(l.getLocal("pp"),l.i32_const(e))),l.setLocal("j",l.i32_add(l.getLocal("j"),l.i32_const(1))),l.br(0))),l.setLocal("ps",l.i32_add(l.getLocal("ps"),l.i32_const(e))),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))))}return h(),d(),t.exportFunction(n+"_zero"),t.exportFunction(n+"_constructLC"),n},J3=function(t,n,a){let e=t.modules[a].n64*8;function h(){let l=t.addFunction(n+"_buildABC");l.addParam("pCoefs","i32"),l.addParam("nCoefs","i32"),l.addParam("pWitness","i32"),l.addParam("pA","i32"),l.addParam("pB","i32"),l.addParam("pC","i32"),l.addParam("offsetOut","i32"),l.addParam("nOut","i32"),l.addParam("offsetWitness","i32"),l.addParam("nWitness","i32"),l.addLocal("it","i32"),l.addLocal("ita","i32"),l.addLocal("itb","i32"),l.addLocal("last","i32"),l.addLocal("m","i32"),l.addLocal("c","i32"),l.addLocal("s","i32"),l.addLocal("pOut","i32");let s=l.getCodeBuilder(),m=s.i32_const(t.alloc(e));l.addCode(s.setLocal("ita",s.getLocal("pA")),s.setLocal("itb",s.getLocal("pB")),s.setLocal("last",s.i32_add(s.getLocal("pA"),s.i32_mul(s.getLocal("nOut"),s.i32_const(e)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(a+"_zero",s.getLocal("ita")),s.call(a+"_zero",s.getLocal("itb")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(e))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(e))),s.br(0))),s.setLocal("it",s.getLocal("pCoefs")),s.setLocal("last",s.i32_add(s.getLocal("pCoefs"),s.i32_mul(s.getLocal("nCoefs"),s.i32_const(e+12)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("it"),s.getLocal("last"))),s.setLocal("s",s.i32_load(s.getLocal("it"),8)),s.if(s.i32_or(s.i32_lt_u(s.getLocal("s"),s.getLocal("offsetWitness")),s.i32_ge_u(s.getLocal("s"),s.i32_add(s.getLocal("offsetWitness"),s.getLocal("nWitness")))),[...s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(e+12))),...s.br(1)]),s.setLocal("m",s.i32_load(s.getLocal("it"))),s.if(s.i32_eq(s.getLocal("m"),s.i32_const(0)),s.setLocal("pOut",s.getLocal("pA")),s.if(s.i32_eq(s.getLocal("m"),s.i32_const(1)),s.setLocal("pOut",s.getLocal("pB")),[...s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(e+12))),...s.br(1)])),s.setLocal("c",s.i32_load(s.getLocal("it"),4)),s.if(s.i32_or(s.i32_lt_u(s.getLocal("c"),s.getLocal("offsetOut")),s.i32_ge_u(s.getLocal("c"),s.i32_add(s.getLocal("offsetOut"),s.getLocal("nOut")))),[...s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(e+12))),...s.br(1)]),s.setLocal("pOut",s.i32_add(s.getLocal("pOut"),s.i32_mul(s.i32_sub(s.getLocal("c"),s.getLocal("offsetOut")),s.i32_const(e)))),s.call(a+"_mul",s.i32_add(s.getLocal("pWitness"),s.i32_mul(s.i32_sub(s.getLocal("s"),s.getLocal("offsetWitness")),s.i32_const(e))),s.i32_add(s.getLocal("it"),s.i32_const(12)),m),s.call(a+"_add",s.getLocal("pOut"),m,s.getLocal("pOut")),s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(e+12))),s.br(0))),s.setLocal("ita",s.getLocal("pA")),s.setLocal("itb",s.getLocal("pB")),s.setLocal("it",s.getLocal("pC")),s.setLocal("last",s.i32_add(s.getLocal("pA"),s.i32_mul(s.getLocal("nOut"),s.i32_const(e)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(a+"_mul",s.getLocal("ita"),s.getLocal("itb"),s.getLocal("it")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(e))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(e))),s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(e))),s.br(0))))}function d(){let l=t.addFunction(n+"_joinABC");l.addParam("pA","i32"),l.addParam("pB","i32"),l.addParam("pC","i32"),l.addParam("n","i32"),l.addParam("pP","i32"),l.addLocal("ita","i32"),l.addLocal("itb","i32"),l.addLocal("itc","i32"),l.addLocal("itp","i32"),l.addLocal("last","i32");let s=l.getCodeBuilder(),m=s.i32_const(t.alloc(e));l.addCode(s.setLocal("ita",s.getLocal("pA")),s.setLocal("itb",s.getLocal("pB")),s.setLocal("itc",s.getLocal("pC")),s.setLocal("itp",s.getLocal("pP")),s.setLocal("last",s.i32_add(s.getLocal("pA"),s.i32_mul(s.getLocal("n"),s.i32_const(e)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(a+"_mul",s.getLocal("ita"),s.getLocal("itb"),m),s.call(a+"_sub",m,s.getLocal("itc"),s.getLocal("itp")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(e))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(e))),s.setLocal("itc",s.i32_add(s.getLocal("itc"),s.i32_const(e))),s.setLocal("itp",s.i32_add(s.getLocal("itp"),s.i32_const(e))),s.br(0))))}function b(){let l=t.addFunction(n+"_batchAdd");l.addParam("pa","i32"),l.addParam("pb","i32"),l.addParam("n","i32"),l.addParam("pr","i32"),l.addLocal("ita","i32"),l.addLocal("itb","i32"),l.addLocal("itr","i32"),l.addLocal("last","i32");let s=l.getCodeBuilder();l.addCode(s.setLocal("ita",s.getLocal("pa")),s.setLocal("itb",s.getLocal("pb")),s.setLocal("itr",s.getLocal("pr")),s.setLocal("last",s.i32_add(s.getLocal("pa"),s.i32_mul(s.getLocal("n"),s.i32_const(e)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(a+"_add",s.getLocal("ita"),s.getLocal("itb"),s.getLocal("itr")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(e))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(e))),s.setLocal("itr",s.i32_add(s.getLocal("itr"),s.i32_const(e))),s.br(0))))}return h(),d(),b(),t.exportFunction(n+"_buildABC"),t.exportFunction(n+"_joinABC"),t.exportFunction(n+"_batchAdd"),n},Y3=function(t,n,a,o,e,h,d,b){let l=t.addFunction(n);l.addParam("pIn","i32"),l.addParam("n","i32"),l.addParam("pFirst","i32"),l.addParam("pInc","i32"),l.addParam("pOut","i32"),l.addLocal("pOldFree","i32"),l.addLocal("i","i32"),l.addLocal("pFrom","i32"),l.addLocal("pTo","i32");let s=l.getCodeBuilder(),m=s.i32_const(t.alloc(d));l.addCode(s.setLocal("pFrom",s.getLocal("pIn")),s.setLocal("pTo",s.getLocal("pOut"))),l.addCode(s.call(o+"_copy",s.getLocal("pFirst"),m)),l.addCode(s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.call(b,s.getLocal("pFrom"),m,s.getLocal("pTo")),s.setLocal("pFrom",s.i32_add(s.getLocal("pFrom"),s.i32_const(e))),s.setLocal("pTo",s.i32_add(s.getLocal("pTo"),s.i32_const(h))),s.call(o+"_mul",m,s.getLocal("pInc"),m),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0)))),t.exportFunction(n)},an=Ha,$b=Nr,Zb=W3,p3=Q3,jb=X3,b3=H3,dr=D3,Vb=K3,Wb=J3,Ti=Y3,{bitLength:Qb,modInv:Xb,isOdd:m3,isNegative:Hb}=Xn,Db=function(t,n){let a=n||"bn128";if(t.modules[a])return a;let o=21888242871839275222246405745257275088696311157297823662689037894645226208583n,e=21888242871839275222246405745257275088548364400416034343698204186575808495617n,h=Math.floor((Qb(o-1n)-1)/64)+1,d=h*8,b=d,l=d,s=l*2,m=l*12,B=t.alloc(an.bigInt2BytesLE(e,b)),p=$b(t,o,"f1m");Zb(t,e,"fr","frm");let v=t.alloc(an.bigInt2BytesLE(O(3n),l)),M=b3(t,"g1m","f1m",v);dr(t,"frm","frm","frm","frm_mul"),Vb(t,"pol","frm"),Wb(t,"qap","frm");let x=p3(t,"f1m_neg","f2m","f1m"),S=t.alloc([...an.bigInt2BytesLE(O(19485874751759354771024239261021720505790618469301721065564631296452457478373n),l),...an.bigInt2BytesLE(O(266929791119991161246907387137283842545076965332900288569378510910307636690n),l)]),w=b3(t,"g2m","f2m",S);function k(X,_){let f=t.addFunction(X);f.addParam("pG","i32"),f.addParam("pFr","i32"),f.addParam("pr","i32");let R=f.getCodeBuilder(),G=R.i32_const(t.alloc(d));f.addCode(R.call("frm_fromMontgomery",R.getLocal("pFr"),G),R.call(_,R.getLocal("pG"),G,R.i32_const(d),R.getLocal("pr"))),t.exportFunction(X)}k("g1m_timesFr","g1m_timesScalar"),dr(t,"g1m","g1m","frm","g1m_timesFr"),k("g2m_timesFr","g2m_timesScalar"),dr(t,"g2m","g2m","frm","g2m_timesFr"),k("g1m_timesFrAffine","g1m_timesScalarAffine"),k("g2m_timesFrAffine","g2m_timesScalarAffine"),Ti(t,"frm_batchApplyKey","fmr","frm",d,d,d,"frm_mul"),Ti(t,"g1m_batchApplyKey","g1m","frm",d*3,d*3,d,"g1m_timesFr"),Ti(t,"g1m_batchApplyKeyMixed","g1m","frm",d*2,d*3,d,"g1m_timesFrAffine"),Ti(t,"g2m_batchApplyKey","g2m","frm",d*2*3,d*3*2,d,"g2m_timesFr"),Ti(t,"g2m_batchApplyKeyMixed","g2m","frm",d*2*2,d*3*2,d,"g2m_timesFrAffine");function O(X){return BigInt(X)*(1n<<BigInt(l*8))%o}let W=[1n,2n,1n],F=t.alloc([...an.bigInt2BytesLE(O(W[0]),l),...an.bigInt2BytesLE(O(W[1]),l),...an.bigInt2BytesLE(O(W[2]),l)]),u=[0n,1n,0n],L=t.alloc([...an.bigInt2BytesLE(O(u[0]),l),...an.bigInt2BytesLE(O(u[1]),l),...an.bigInt2BytesLE(O(u[2]),l)]),$=[[10857046999023057135944570762232829481370756359578518086990519993285655852781n,11559732032986387107991004021392285783925812861821192530917403151452391805634n],[8495653923123431417604973247489272438418190587263600148770280649306958101930n,4082367875863433681332203403145435568316851327593401208105741076214120093531n],[1n,0n]],Q=t.alloc([...an.bigInt2BytesLE(O($[0][0]),l),...an.bigInt2BytesLE(O($[0][1]),l),...an.bigInt2BytesLE(O($[1][0]),l),...an.bigInt2BytesLE(O($[1][1]),l),...an.bigInt2BytesLE(O($[2][0]),l),...an.bigInt2BytesLE(O($[2][1]),l)]),H=[[0n,0n],[1n,0n],[0n,0n]],q=t.alloc([...an.bigInt2BytesLE(O(H[0][0]),l),...an.bigInt2BytesLE(O(H[0][1]),l),...an.bigInt2BytesLE(O(H[1][0]),l),...an.bigInt2BytesLE(O(H[1][1]),l),...an.bigInt2BytesLE(O(H[2][0]),l),...an.bigInt2BytesLE(O(H[2][1]),l)]),y=t.alloc([...an.bigInt2BytesLE(O(1),l),...an.bigInt2BytesLE(O(0),l),...an.bigInt2BytesLE(O(0),l),...an.bigInt2BytesLE(O(0),l),...an.bigInt2BytesLE(O(0),l),...an.bigInt2BytesLE(O(0),l),...an.bigInt2BytesLE(O(0),l),...an.bigInt2BytesLE(O(0),l),...an.bigInt2BytesLE(O(0),l),...an.bigInt2BytesLE(O(0),l),...an.bigInt2BytesLE(O(0),l),...an.bigInt2BytesLE(O(0),l)]),I=t.alloc([...an.bigInt2BytesLE(O(9),l),...an.bigInt2BytesLE(O(1),l)]),N=t.alloc([...an.bigInt2BytesLE(O(Xb(2n,o)),l),...an.bigInt2BytesLE(0n,l)]),nt=I,J=t.alloc([...an.bigInt2BytesLE(O(19485874751759354771024239261021720505790618469301721065564631296452457478373n),l),...an.bigInt2BytesLE(O(266929791119991161246907387137283842545076965332900288569378510910307636690n),l)]);function j(){let X=t.addFunction(a+"_mulNR6");X.addParam("x","i32"),X.addParam("pr","i32");let _=X.getCodeBuilder();X.addCode(_.call(x+"_mul",_.i32_const(I),_.getLocal("x"),_.getLocal("pr")))}j();let ot=jb(t,a+"_mulNR6","f6m","f2m");function V(){let X=t.addFunction(a+"_mulNR12");X.addParam("x","i32"),X.addParam("pr","i32");let _=X.getCodeBuilder();X.addCode(_.call(x+"_mul",_.i32_const(I),_.i32_add(_.getLocal("x"),_.i32_const(d*4)),_.getLocal("pr")),_.call(x+"_copy",_.getLocal("x"),_.i32_add(_.getLocal("pr"),_.i32_const(d*2))),_.call(x+"_copy",_.i32_add(_.getLocal("x"),_.i32_const(d*2)),_.i32_add(_.getLocal("pr"),_.i32_const(d*4))))}V();let at=p3(t,a+"_mulNR12","ftm",ot),rt=st(29793968203157093288n),ht=t.alloc(rt),A=3*s,i=rt.length-1,r=rt.reduce((X,_)=>X+(_!=0?1:0),0)+i+1,z=6*d,E=3*d*2+r*A;t.modules[a]={n64:h,pG1gen:F,pG1zero:L,pG1b:v,pG2gen:Q,pG2zero:q,pG2b:S,pq:t.modules.f1m.pq,pr:B,pOneT:y,prePSize:z,preQSize:E,r:e.toString(),q:o.toString()};let g=4965661367192848881n;function U(X){let _=X,f=[];for(;_>0n;){if(m3(_)){let R=2-Number(_%4n);f.push(R),_=_-BigInt(R)}else f.push(0);_=_>>1n}return f}function st(X){let _=X,f=[];for(;_>0n;)m3(_)?f.push(1):f.push(0),_=_>>1n;return f}function et(){let X=t.addFunction(a+"_prepareG1");X.addParam("pP","i32"),X.addParam("ppreP","i32");let _=X.getCodeBuilder();X.addCode(_.call(M+"_normalize",_.getLocal("pP"),_.getLocal("ppreP")))}function ct(){let X=t.addFunction(a+"_prepAddStep");X.addParam("pQ","i32"),X.addParam("pR","i32"),X.addParam("pCoef","i32");let _=X.getCodeBuilder(),f=_.getLocal("pQ"),R=_.i32_add(_.getLocal("pQ"),_.i32_const(s)),G=_.getLocal("pR"),P=_.i32_add(_.getLocal("pR"),_.i32_const(s)),Z=_.i32_add(_.getLocal("pR"),_.i32_const(2*s)),T=_.getLocal("pCoef"),D=_.i32_add(_.getLocal("pCoef"),_.i32_const(s)),Y=_.i32_add(_.getLocal("pCoef"),_.i32_const(2*s)),tt=D,K=_.i32_const(t.alloc(s)),it=_.i32_const(t.alloc(s)),mt=_.i32_const(t.alloc(s)),pt=_.i32_const(t.alloc(s)),dt=_.i32_const(t.alloc(s)),Ct=_.i32_const(t.alloc(s)),xt=_.i32_const(t.alloc(s));X.addCode(_.call(x+"_mul",f,Z,tt),_.call(x+"_sub",G,tt,tt),_.call(x+"_mul",R,Z,K),_.call(x+"_sub",P,K,K),_.call(x+"_square",tt,it),_.call(x+"_square",K,mt),_.call(x+"_mul",tt,it,pt),_.call(x+"_mul",G,it,dt),_.call(x+"_add",dt,dt,xt),_.call(x+"_mul",Z,mt,Ct),_.call(x+"_add",pt,Ct,Ct),_.call(x+"_sub",Ct,xt,Ct),_.call(x+"_mul",tt,Ct,G),_.call(x+"_mul",pt,P,P),_.call(x+"_sub",dt,Ct,xt),_.call(x+"_mul",K,xt,xt),_.call(x+"_sub",xt,P,P),_.call(x+"_mul",Z,pt,Z),_.call(x+"_mul",tt,R,xt),_.call(x+"_mul",K,f,T),_.call(x+"_sub",T,xt,T),_.call(x+"_mul",T,_.i32_const(nt),T),_.call(x+"_neg",K,Y))}function ft(){let X=t.addFunction(a+"_prepDblStep");X.addParam("pR","i32"),X.addParam("pCoef","i32");let _=X.getCodeBuilder(),f=_.getLocal("pR"),R=_.i32_add(_.getLocal("pR"),_.i32_const(s)),G=_.i32_add(_.getLocal("pR"),_.i32_const(2*s)),P=_.getLocal("pCoef"),Z=_.i32_add(_.getLocal("pCoef"),_.i32_const(s)),T=_.i32_add(_.getLocal("pCoef"),_.i32_const(2*s)),D=_.i32_const(t.alloc(s)),Y=_.i32_const(t.alloc(s)),tt=_.i32_const(t.alloc(s)),K=_.i32_const(t.alloc(s)),it=_.i32_const(t.alloc(s)),mt=_.i32_const(t.alloc(s)),pt=_.i32_const(t.alloc(s)),dt=_.i32_const(t.alloc(s)),Ct=_.i32_const(t.alloc(s)),xt=_.i32_const(t.alloc(s)),St=_.i32_const(t.alloc(s)),Bt=_.i32_const(t.alloc(s));X.addCode(_.call(x+"_mul",R,_.i32_const(N),D),_.call(x+"_mul",f,D,D),_.call(x+"_square",R,Y),_.call(x+"_square",G,tt),_.call(x+"_add",tt,tt,K),_.call(x+"_add",K,tt,K),_.call(x+"_mul",_.i32_const(J),K,it),_.call(x+"_add",it,it,mt),_.call(x+"_add",it,mt,mt),_.call(x+"_add",Y,mt,pt),_.call(x+"_mul",pt,_.i32_const(N),pt),_.call(x+"_add",Y,tt,Bt),_.call(x+"_add",R,G,dt),_.call(x+"_square",dt,dt),_.call(x+"_sub",dt,Bt,dt),_.call(x+"_sub",it,Y,Ct),_.call(x+"_square",f,xt),_.call(x+"_square",it,St),_.call(x+"_sub",Y,mt,Bt),_.call(x+"_mul",D,Bt,f),_.call(x+"_add",St,St,Bt),_.call(x+"_add",St,Bt,Bt),_.call(x+"_square",pt,R),_.call(x+"_sub",R,Bt,R),_.call(x+"_mul",Y,dt,G),_.call(x+"_mul",_.i32_const(nt),Ct,P),_.call(x+"_neg",dt,Z),_.call(x+"_add",xt,xt,T),_.call(x+"_add",xt,T,T))}function _t(){let X=t.addFunction(a+"_mulByQ");X.addParam("p1","i32"),X.addParam("pr","i32");let _=X.getCodeBuilder(),f=_.getLocal("p1"),R=_.i32_add(_.getLocal("p1"),_.i32_const(s)),G=_.i32_add(_.getLocal("p1"),_.i32_const(s*2)),P=_.getLocal("pr"),Z=_.i32_add(_.getLocal("pr"),_.i32_const(s)),T=_.i32_add(_.getLocal("pr"),_.i32_const(s*2)),D=_.i32_const(t.alloc([...an.bigInt2BytesLE(O("21575463638280843010398324269430826099269044274347216827212613867836435027261"),l),...an.bigInt2BytesLE(O("10307601595873709700152284273816112264069230130616436755625194854815875713954"),l)])),Y=_.i32_const(t.alloc([...an.bigInt2BytesLE(O("2821565182194536844548159561693502659359617185244120367078079554186484126554"),l),...an.bigInt2BytesLE(O("3505843767911556378687030309984248845540243509899259641013678093033130930403"),l)]));X.addCode(_.call(x+"_conjugate",f,P),_.call(x+"_mul",D,P,P),_.call(x+"_conjugate",R,Z),_.call(x+"_mul",Y,Z,Z),_.call(x+"_conjugate",G,T))}function gt(){_t();let X=t.addFunction(a+"_prepareG2");X.addParam("pQ","i32"),X.addParam("ppreQ","i32"),X.addLocal("pCoef","i32"),X.addLocal("i","i32");let _=X.getCodeBuilder(),f=_.getLocal("pQ"),R=t.alloc(s*3),G=_.i32_const(R),P=_.i32_const(R),Z=_.i32_const(R+s),T=_.i32_const(R+2*s),D=_.i32_add(_.getLocal("ppreQ"),_.i32_const(0)),Y=_.i32_add(_.getLocal("ppreQ"),_.i32_const(s)),tt=t.alloc(s*3),K=_.i32_const(tt),it=t.alloc(s*3),mt=_.i32_const(it),pt=_.i32_const(it+s);X.addCode(_.call(w+"_normalize",f,D),_.call(x+"_copy",D,P),_.call(x+"_copy",Y,Z),_.call(x+"_one",T)),X.addCode(_.setLocal("pCoef",_.i32_add(_.getLocal("ppreQ"),_.i32_const(s*3))),_.setLocal("i",_.i32_const(rt.length-2)),_.block(_.loop(_.call(a+"_prepDblStep",G,_.getLocal("pCoef")),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))),_.if(_.i32_load8_s(_.getLocal("i"),ht),[..._.call(a+"_prepAddStep",D,G,_.getLocal("pCoef")),..._.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A)))]),_.br_if(1,_.i32_eqz(_.getLocal("i"))),_.setLocal("i",_.i32_sub(_.getLocal("i"),_.i32_const(1))),_.br(0)))),X.addCode(_.call(a+"_mulByQ",D,K),_.call(a+"_mulByQ",K,mt)),X.addCode(_.call(x+"_neg",pt,pt),_.call(a+"_prepAddStep",K,G,_.getLocal("pCoef")),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))),_.call(a+"_prepAddStep",mt,G,_.getLocal("pCoef")),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))))}function yt(){let X=t.addFunction(a+"__mulBy024Old");X.addParam("pEll0","i32"),X.addParam("pEllVW","i32"),X.addParam("pEllVV","i32"),X.addParam("pR","i32");let _=X.getCodeBuilder(),f=_.getLocal("pEll0"),R=_.getLocal("pEllVV"),G=_.getLocal("pEllVW"),P=_.getLocal("pR"),Z=t.alloc(m),T=_.i32_const(Z),D=_.i32_const(Z),Y=_.i32_const(Z+s),tt=_.i32_const(Z+s*2),K=_.i32_const(Z+s*3),it=_.i32_const(Z+s*4),mt=_.i32_const(Z+s*5);X.addCode(_.call(x+"_copy",f,D),_.call(x+"_zero",Y),_.call(x+"_copy",R,tt),_.call(x+"_zero",K),_.call(x+"_copy",G,it),_.call(x+"_zero",mt),_.call(at+"_mul",T,P,P))}function ut(){let X=t.addFunction(a+"__mulBy024");X.addParam("pEll0","i32"),X.addParam("pEllVW","i32"),X.addParam("pEllVV","i32"),X.addParam("pR","i32");let _=X.getCodeBuilder(),f=_.getLocal("pEll0"),R=_.getLocal("pEllVV"),G=_.getLocal("pEllVW"),P=_.getLocal("pR"),Z=_.i32_add(_.getLocal("pR"),_.i32_const(2*d)),T=_.i32_add(_.getLocal("pR"),_.i32_const(4*d)),D=_.i32_add(_.getLocal("pR"),_.i32_const(6*d)),Y=_.i32_add(_.getLocal("pR"),_.i32_const(8*d)),tt=_.i32_add(_.getLocal("pR"),_.i32_const(10*d)),K=_.i32_const(t.alloc(s)),it=_.i32_const(t.alloc(s)),mt=_.i32_const(t.alloc(s)),pt=_.i32_const(t.alloc(s)),dt=_.i32_const(t.alloc(s)),Ct=_.i32_const(t.alloc(s)),xt=_.i32_const(t.alloc(s)),St=_.i32_const(t.alloc(s)),Bt=_.i32_const(t.alloc(s)),At=_.i32_const(t.alloc(s)),wt=_.i32_const(t.alloc(s));X.addCode(_.call(x+"_mul",P,f,xt),_.call(x+"_mul",T,R,St),_.call(x+"_mul",Y,G,Bt),_.call(x+"_add",P,Y,mt),_.call(x+"_add",P,T,it),_.call(x+"_add",Z,D,pt),_.call(x+"_add",pt,tt,pt),_.call(x+"_mul",Z,R,At),_.call(x+"_add",At,Bt,dt),_.call(x+"_mul",_.i32_const(I),dt,Ct),_.call(x+"_add",Ct,xt,P),_.call(x+"_mul",tt,G,dt),_.call(x+"_add",At,dt,At),_.call(x+"_add",dt,St,dt),_.call(x+"_mul",_.i32_const(I),dt,Ct),_.call(x+"_mul",Z,f,dt),_.call(x+"_add",At,dt,At),_.call(x+"_add",Ct,dt,Z),_.call(x+"_add",f,R,K),_.call(x+"_mul",it,K,dt),_.call(x+"_add",xt,St,wt),_.call(x+"_sub",dt,wt,dt),_.call(x+"_mul",D,G,Ct),_.call(x+"_add",At,Ct,At),_.call(x+"_add",T,Y,K),_.call(x+"_add",dt,Ct,T),_.call(x+"_add",R,G,it),_.call(x+"_mul",it,K,dt),_.call(x+"_add",St,Bt,wt),_.call(x+"_sub",dt,wt,dt),_.call(x+"_mul",_.i32_const(I),dt,Ct),_.call(x+"_mul",D,f,dt),_.call(x+"_add",At,dt,At),_.call(x+"_add",Ct,dt,D),_.call(x+"_mul",tt,R,dt),_.call(x+"_add",At,dt,At),_.call(x+"_mul",_.i32_const(I),dt,Ct),_.call(x+"_add",f,G,K),_.call(x+"_mul",mt,K,dt),_.call(x+"_add",xt,Bt,wt),_.call(x+"_sub",dt,wt,dt),_.call(x+"_add",Ct,dt,Y),_.call(x+"_add",f,R,K),_.call(x+"_add",K,G,K),_.call(x+"_mul",pt,K,dt),_.call(x+"_sub",dt,At,tt))}function lt(){let X=t.addFunction(a+"_millerLoop");X.addParam("ppreP","i32"),X.addParam("ppreQ","i32"),X.addParam("r","i32"),X.addLocal("pCoef","i32"),X.addLocal("i","i32");let _=X.getCodeBuilder(),f=_.getLocal("ppreP"),R=_.i32_add(_.getLocal("ppreP"),_.i32_const(l)),G=_.getLocal("pCoef"),P=_.i32_add(_.getLocal("pCoef"),_.i32_const(s)),Z=_.i32_add(_.getLocal("pCoef"),_.i32_const(2*s)),T=t.alloc(s),D=_.i32_const(T),Y=t.alloc(s),tt=_.i32_const(Y),K=_.getLocal("r");X.addCode(_.call(at+"_one",K),_.setLocal("pCoef",_.i32_add(_.getLocal("ppreQ"),_.i32_const(s*3))),_.setLocal("i",_.i32_const(rt.length-2)),_.block(_.loop(_.call(at+"_square",K,K),_.call(x+"_mul1",P,R,D),_.call(x+"_mul1",Z,f,tt),_.call(a+"__mulBy024",G,D,tt,K),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))),_.if(_.i32_load8_s(_.getLocal("i"),ht),[..._.call(x+"_mul1",P,R,D),..._.call(x+"_mul1",Z,f,tt),..._.call(a+"__mulBy024",G,D,tt,K),..._.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A)))]),_.br_if(1,_.i32_eqz(_.getLocal("i"))),_.setLocal("i",_.i32_sub(_.getLocal("i"),_.i32_const(1))),_.br(0)))),X.addCode(_.call(x+"_mul1",P,R,D),_.call(x+"_mul1",Z,f,tt),_.call(a+"__mulBy024",G,D,tt,K),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))),_.call(x+"_mul1",P,R,D),_.call(x+"_mul1",Z,f,tt),_.call(a+"__mulBy024",G,D,tt,K),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))))}function bt(X){let _=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[8376118865763821496583973867626364092589906065868298776909617916018768340080n,16469823323077808223889137241176536799009286646108169935659301613961712198316n],[21888242871839275220042445260109153167277707414472061641714758635765020556617n,0n],[11697423496358154304825782922584725312912383441159505038794027105778954184319n,303847389135065887422783454877609941456349188919719272345083954437860409601n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3321304630594332808241809054958361220322477375291206261884409189760185844239n,5722266937896532885780051958958348231143373700109372999374820235121374419868n],[21888242871839275222246405745257275088696311157297823662689037894645226208582n,0n],[13512124006075453725662431877630910996106405091429524885779419978626457868503n,5418419548761466998357268504080738289687024511189653727029736280683514010267n],[2203960485148121921418603742825762020974279258880205651966n,0n],[10190819375481120917420622822672549775783927716138318623895010788866272024264n,21584395482704209334823622290379665147239961968378104390343953940207365798982n],[2203960485148121921418603742825762020974279258880205651967n,0n],[18566938241244942414004596690298913868373833782006617400804628704885040364344n,16165975933942742336466353786298926857552937457188450663314217659523851788715n]]],f=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[21575463638280843010398324269430826099269044274347216827212613867836435027261n,10307601595873709700152284273816112264069230130616436755625194854815875713954n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3772000881919853776433695186713858239009073593817195771773381919316419345261n,2236595495967245188281701248203181795121068902605861227855261137820944008926n],[2203960485148121921418603742825762020974279258880205651966n,0n],[18429021223477853657660792034369865839114504446431234726392080002137598044644n,9344045779998320333812420223237981029506012124075525679208581902008406485703n]],[[1n,0n],[2581911344467009335267311115468803099551665605076196740867805258568234346338n,19937756971775647987995932169929341994314640652964949448313374472400716661030n],[2203960485148121921418603742825762020974279258880205651966n,0n],[5324479202449903542726783395506214481928257762400643279780343368557297135718n,16208900380737693084919495127334387981393726419856888799917914180988844123039n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[13981852324922362344252311234282257507216387789820983642040889267519694726527n,7629828391165209371577384193250820201684255241773809077146787135900891633097n]]],R=t.addFunction(a+"__frobeniusMap"+X);R.addParam("x","i32"),R.addParam("r","i32");let G=R.getCodeBuilder();for(let Z=0;Z<6;Z++){let T=Z==0?G.getLocal("x"):G.i32_add(G.getLocal("x"),G.i32_const(Z*s)),D=T,Y=G.i32_add(G.getLocal("x"),G.i32_const(Z*s+l)),tt=Z==0?G.getLocal("r"):G.i32_add(G.getLocal("r"),G.i32_const(Z*s)),K=tt,it=G.i32_add(G.getLocal("r"),G.i32_const(Z*s+l)),mt=P(_[Math.floor(Z/3)][X%12],f[Z%3][X%6]),pt=t.alloc([...an.bigInt2BytesLE(O(mt[0]),32),...an.bigInt2BytesLE(O(mt[1]),32)]);X%2==1?R.addCode(G.call(p+"_copy",D,K),G.call(p+"_neg",Y,it),G.call(x+"_mul",tt,G.i32_const(pt),tt)):R.addCode(G.call(x+"_mul",T,G.i32_const(pt),tt))}function P(Z,T){let D=BigInt(Z[0]),Y=BigInt(Z[1]),tt=BigInt(T[0]),K=BigInt(T[1]),it=[(D*tt-Y*K)%o,(D*K+Y*tt)%o];return Hb(it[0])&&(it[0]=it[0]+o),it}}function Et(){let X=t.addFunction(a+"__finalExponentiationFirstChunk");X.addParam("x","i32"),X.addParam("r","i32");let _=X.getCodeBuilder(),f=_.getLocal("x"),R=f,G=_.i32_add(f,_.i32_const(d*6)),P=_.getLocal("r"),Z=t.alloc(m),T=_.i32_const(Z),D=T,Y=_.i32_const(Z+d*6),tt=_.i32_const(t.alloc(m)),K=_.i32_const(t.alloc(m)),it=_.i32_const(t.alloc(m));X.addCode(_.call(ot+"_copy",R,D),_.call(ot+"_neg",G,Y),_.call(at+"_inverse",f,tt),_.call(at+"_mul",T,tt,K),_.call(a+"__frobeniusMap2",K,it),_.call(at+"_mul",K,it,P))}function It(){let X=t.addFunction(a+"__cyclotomicSquare");X.addParam("x","i32"),X.addParam("r","i32");let _=X.getCodeBuilder(),f=_.getLocal("x"),R=_.i32_add(_.getLocal("x"),_.i32_const(s)),G=_.i32_add(_.getLocal("x"),_.i32_const(2*s)),P=_.i32_add(_.getLocal("x"),_.i32_const(3*s)),Z=_.i32_add(_.getLocal("x"),_.i32_const(4*s)),T=_.i32_add(_.getLocal("x"),_.i32_const(5*s)),D=_.getLocal("r"),Y=_.i32_add(_.getLocal("r"),_.i32_const(s)),tt=_.i32_add(_.getLocal("r"),_.i32_const(2*s)),K=_.i32_add(_.getLocal("r"),_.i32_const(3*s)),it=_.i32_add(_.getLocal("r"),_.i32_const(4*s)),mt=_.i32_add(_.getLocal("r"),_.i32_const(5*s)),pt=_.i32_const(t.alloc(s)),dt=_.i32_const(t.alloc(s)),Ct=_.i32_const(t.alloc(s)),xt=_.i32_const(t.alloc(s)),St=_.i32_const(t.alloc(s)),Bt=_.i32_const(t.alloc(s)),At=_.i32_const(t.alloc(s)),wt=_.i32_const(t.alloc(s));X.addCode(_.call(x+"_mul",f,Z,At),_.call(x+"_mul",Z,_.i32_const(I),pt),_.call(x+"_add",f,pt,pt),_.call(x+"_add",f,Z,wt),_.call(x+"_mul",wt,pt,pt),_.call(x+"_mul",_.i32_const(I),At,wt),_.call(x+"_add",At,wt,wt),_.call(x+"_sub",pt,wt,pt),_.call(x+"_add",At,At,dt),_.call(x+"_mul",P,G,At),_.call(x+"_mul",G,_.i32_const(I),Ct),_.call(x+"_add",P,Ct,Ct),_.call(x+"_add",P,G,wt),_.call(x+"_mul",wt,Ct,Ct),_.call(x+"_mul",_.i32_const(I),At,wt),_.call(x+"_add",At,wt,wt),_.call(x+"_sub",Ct,wt,Ct),_.call(x+"_add",At,At,xt),_.call(x+"_mul",R,T,At),_.call(x+"_mul",T,_.i32_const(I),St),_.call(x+"_add",R,St,St),_.call(x+"_add",R,T,wt),_.call(x+"_mul",wt,St,St),_.call(x+"_mul",_.i32_const(I),At,wt),_.call(x+"_add",At,wt,wt),_.call(x+"_sub",St,wt,St),_.call(x+"_add",At,At,Bt),_.call(x+"_sub",pt,f,D),_.call(x+"_add",D,D,D),_.call(x+"_add",pt,D,D),_.call(x+"_add",dt,Z,it),_.call(x+"_add",it,it,it),_.call(x+"_add",dt,it,it),_.call(x+"_mul",Bt,_.i32_const(nt),wt),_.call(x+"_add",wt,P,K),_.call(x+"_add",K,K,K),_.call(x+"_add",wt,K,K),_.call(x+"_sub",St,G,tt),_.call(x+"_add",tt,tt,tt),_.call(x+"_add",St,tt,tt),_.call(x+"_sub",Ct,R,Y),_.call(x+"_add",Y,Y,Y),_.call(x+"_add",Ct,Y,Y),_.call(x+"_add",xt,T,mt),_.call(x+"_add",mt,mt,mt),_.call(x+"_add",xt,mt,mt))}function zt(X,_){let f=U(X).map(Y=>Y==-1?255:Y),R=t.alloc(f),G=t.addFunction(a+"__cyclotomicExp_"+_);G.addParam("x","i32"),G.addParam("r","i32"),G.addLocal("bit","i32"),G.addLocal("i","i32");let P=G.getCodeBuilder(),Z=P.getLocal("x"),T=P.getLocal("r"),D=P.i32_const(t.alloc(m));G.addCode(P.call(at+"_conjugate",Z,D),P.call(at+"_one",T),P.if(P.teeLocal("bit",P.i32_load8_s(P.i32_const(f.length-1),R)),P.if(P.i32_eq(P.getLocal("bit"),P.i32_const(1)),P.call(at+"_mul",T,Z,T),P.call(at+"_mul",T,D,T))),P.setLocal("i",P.i32_const(f.length-2)),P.block(P.loop(P.call(a+"__cyclotomicSquare",T,T),P.if(P.teeLocal("bit",P.i32_load8_s(P.getLocal("i"),R)),P.if(P.i32_eq(P.getLocal("bit"),P.i32_const(1)),P.call(at+"_mul",T,Z,T),P.call(at+"_mul",T,D,T))),P.br_if(1,P.i32_eqz(P.getLocal("i"))),P.setLocal("i",P.i32_sub(P.getLocal("i"),P.i32_const(1))),P.br(0))))}function Mt(){It(),zt(g,"w0");let X=t.addFunction(a+"__finalExponentiationLastChunk");X.addParam("x","i32"),X.addParam("r","i32");let _=X.getCodeBuilder(),f=_.getLocal("x"),R=_.getLocal("r"),G=_.i32_const(t.alloc(m)),P=_.i32_const(t.alloc(m)),Z=_.i32_const(t.alloc(m)),T=_.i32_const(t.alloc(m)),D=_.i32_const(t.alloc(m)),Y=_.i32_const(t.alloc(m)),tt=_.i32_const(t.alloc(m)),K=_.i32_const(t.alloc(m)),it=_.i32_const(t.alloc(m)),mt=_.i32_const(t.alloc(m)),pt=_.i32_const(t.alloc(m)),dt=_.i32_const(t.alloc(m)),Ct=_.i32_const(t.alloc(m)),xt=_.i32_const(t.alloc(m)),St=_.i32_const(t.alloc(m)),Bt=_.i32_const(t.alloc(m)),At=_.i32_const(t.alloc(m)),wt=_.i32_const(t.alloc(m)),Ot=_.i32_const(t.alloc(m)),Jt=_.i32_const(t.alloc(m)),cn=_.i32_const(t.alloc(m));X.addCode(_.call(a+"__cyclotomicExp_w0",f,G),_.call(at+"_conjugate",G,G),_.call(a+"__cyclotomicSquare",G,P),_.call(a+"__cyclotomicSquare",P,Z),_.call(at+"_mul",Z,P,T),_.call(a+"__cyclotomicExp_w0",T,D),_.call(at+"_conjugate",D,D),_.call(a+"__cyclotomicSquare",D,Y),_.call(a+"__cyclotomicExp_w0",Y,tt),_.call(at+"_conjugate",tt,tt),_.call(at+"_conjugate",T,K),_.call(at+"_conjugate",tt,it),_.call(at+"_mul",it,D,mt),_.call(at+"_mul",mt,K,pt),_.call(at+"_mul",pt,P,dt),_.call(at+"_mul",pt,D,Ct),_.call(at+"_mul",Ct,f,xt),_.call(a+"__frobeniusMap1",dt,St),_.call(at+"_mul",St,xt,Bt),_.call(a+"__frobeniusMap2",pt,At),_.call(at+"_mul",At,Bt,wt),_.call(at+"_conjugate",f,Ot),_.call(at+"_mul",Ot,dt,Jt),_.call(a+"__frobeniusMap3",Jt,cn),_.call(at+"_mul",cn,wt,R))}function kt(){Et(),Mt();let X=t.addFunction(a+"_finalExponentiation");X.addParam("x","i32"),X.addParam("r","i32");let _=X.getCodeBuilder(),f=_.getLocal("x"),R=_.getLocal("r"),G=_.i32_const(t.alloc(m));X.addCode(_.call(a+"__finalExponentiationFirstChunk",f,G),_.call(a+"__finalExponentiationLastChunk",G,R))}function Pt(){let X=t.addFunction(a+"_finalExponentiationOld");X.addParam("x","i32"),X.addParam("r","i32");let f=t.alloc(an.bigInt2BytesLE(552484233613224096312617126783173147097382103762957654188882734314196910839907541213974502761540629817009608548654680343627701153829446747810907373256841551006201639677726139946029199968412598804882391702273019083653272047566316584365559776493027495458238373902875937659943504873220554161550525926302303331747463515644711876653177129578303191095900909191624817826566688241804408081892785725967931714097716709526092261278071952560171111444072049229123565057483750161460024353346284167282452756217662335528813519139808291170539072125381230815729071544861602750936964829313608137325426383735122175229541155376346436093930287402089517426973178917569713384748081827255472576937471496195752727188261435633271238710131736096299798168852925540549342330775279877006784354801422249722573783561685179618816480037695005515426162362431072245638324744480n,352)),R=X.getCodeBuilder();X.addCode(R.call(at+"_exp",R.getLocal("x"),R.i32_const(f),R.i32_const(352),R.getLocal("r")))}let qt=t.alloc(z),Rt=t.alloc(E);function Kt(X){let _=t.addFunction(a+"_pairingEq"+X);for(let P=0;P<X;P++)_.addParam("p_"+P,"i32"),_.addParam("q_"+P,"i32");_.addParam("c","i32"),_.setReturnType("i32");let f=_.getCodeBuilder(),R=f.i32_const(t.alloc(m)),G=f.i32_const(t.alloc(m));_.addCode(f.call(at+"_one",R));for(let P=0;P<X;P++)_.addCode(f.call(a+"_prepareG1",f.getLocal("p_"+P),f.i32_const(qt))),_.addCode(f.call(a+"_prepareG2",f.getLocal("q_"+P),f.i32_const(Rt))),_.addCode(f.call(a+"_millerLoop",f.i32_const(qt),f.i32_const(Rt),G)),_.addCode(f.call(at+"_mul",R,G,R));_.addCode(f.call(a+"_finalExponentiation",R,R)),_.addCode(f.call(at+"_eq",R,f.getLocal("c")))}function Ut(){let X=t.addFunction(a+"_pairing");X.addParam("p","i32"),X.addParam("q","i32"),X.addParam("r","i32");let _=X.getCodeBuilder(),f=_.i32_const(t.alloc(m));X.addCode(_.call(a+"_prepareG1",_.getLocal("p"),_.i32_const(qt))),X.addCode(_.call(a+"_prepareG2",_.getLocal("q"),_.i32_const(Rt))),X.addCode(_.call(a+"_millerLoop",_.i32_const(qt),_.i32_const(Rt),f)),X.addCode(_.call(a+"_finalExponentiation",f,_.getLocal("r")))}ct(),ft(),et(),gt(),ut(),yt(),lt();for(let X=0;X<10;X++)bt(X),t.exportFunction(a+"__frobeniusMap"+X);Pt(),kt();for(let X=1;X<=5;X++)Kt(X),t.exportFunction(a+"_pairingEq"+X);Ut(),t.exportFunction(a+"_pairing"),t.exportFunction(a+"_prepareG1"),t.exportFunction(a+"_prepareG2"),t.exportFunction(a+"_millerLoop"),t.exportFunction(a+"_finalExponentiation"),t.exportFunction(a+"_finalExponentiationOld"),t.exportFunction(a+"__mulBy024"),t.exportFunction(a+"__mulBy024Old"),t.exportFunction(a+"__cyclotomicSquare"),t.exportFunction(a+"__cyclotomicExp_w0")},Qt=Ha,Kb=Nr,Jb=W3,y3=Q3,Yb=X3,w3=H3,ur=D3,tm=K3,nm=J3,Gi=Y3,{bitLength:F3,isOdd:C3,isNegative:am}=Xn,om=function(t,n){let a=n||"bls12381";if(t.modules[a])return a;let o=0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,e=0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,h=Math.floor((F3(o-1n)-1)/64)+1,d=h*8,b=d,l=b*2,s=b*12,m=Math.floor((F3(e-1n)-1)/64)+1,B=m*8,p=B,v=t.alloc(Qt.bigInt2BytesLE(e,p)),M=Kb(t,o,"f1m","intq");Jb(t,e,"fr","frm","intr");let x=t.alloc(Qt.bigInt2BytesLE(F(4n),b)),S=w3(t,"g1m","f1m",x);ur(t,"frm","frm","frm","frm_mul"),tm(t,"pol","frm"),nm(t,"qap","frm");let w=y3(t,"f1m_neg","f2m","f1m"),k=t.alloc([...Qt.bigInt2BytesLE(F(4n),b),...Qt.bigInt2BytesLE(F(4n),b)]),O=w3(t,"g2m","f2m",k);function W(_,f){let R=t.addFunction(_);R.addParam("pG","i32"),R.addParam("pFr","i32"),R.addParam("pr","i32");let G=R.getCodeBuilder(),P=G.i32_const(t.alloc(B));R.addCode(G.call("frm_fromMontgomery",G.getLocal("pFr"),P),G.call(f,G.getLocal("pG"),P,G.i32_const(B),G.getLocal("pr"))),t.exportFunction(_)}W("g1m_timesFr","g1m_timesScalar"),ur(t,"g1m","g1m","frm","g1m_timesFr"),W("g2m_timesFr","g2m_timesScalar"),ur(t,"g2m","g2m","frm","g2m_timesFr"),W("g1m_timesFrAffine","g1m_timesScalarAffine"),W("g2m_timesFrAffine","g2m_timesScalarAffine"),Gi(t,"frm_batchApplyKey","fmr","frm",B,B,B,"frm_mul"),Gi(t,"g1m_batchApplyKey","g1m","frm",d*3,d*3,B,"g1m_timesFr"),Gi(t,"g1m_batchApplyKeyMixed","g1m","frm",d*2,d*3,B,"g1m_timesFrAffine"),Gi(t,"g2m_batchApplyKey","g2m","frm",d*2*3,d*3*2,B,"g2m_timesFr"),Gi(t,"g2m_batchApplyKeyMixed","g2m","frm",d*2*2,d*3*2,B,"g2m_timesFrAffine");function F(_){return BigInt(_)*(1n<<BigInt(b*8))%o}let u=[3685416753713387016781088315183077757961620795782546409894578378688607592378376318836054947676345821548104185464507n,1339506544944476473020471379941921221584933875938349620426543736416511423956333506472724655353366534992391756441569n,1n],L=t.alloc([...Qt.bigInt2BytesLE(F(u[0]),b),...Qt.bigInt2BytesLE(F(u[1]),b),...Qt.bigInt2BytesLE(F(u[2]),b)]),$=[0n,1n,0n],Q=t.alloc([...Qt.bigInt2BytesLE(F($[0]),b),...Qt.bigInt2BytesLE(F($[1]),b),...Qt.bigInt2BytesLE(F($[2]),b)]),H=[[352701069587466618187139116011060144890029952792775240219908644239793785735715026873347600343865175952761926303160n,3059144344244213709971259814753781636986470325476647558659373206291635324768958432433509563104347017837885763365758n],[1985150602287291935568054521177171638300868978215655730859378665066344726373823718423869104263333984641494340347905n,927553665492332455747201965776037880757740193453592970025027978793976877002675564980949289727957565575433344219582n],[1n,0n]],q=t.alloc([...Qt.bigInt2BytesLE(F(H[0][0]),b),...Qt.bigInt2BytesLE(F(H[0][1]),b),...Qt.bigInt2BytesLE(F(H[1][0]),b),...Qt.bigInt2BytesLE(F(H[1][1]),b),...Qt.bigInt2BytesLE(F(H[2][0]),b),...Qt.bigInt2BytesLE(F(H[2][1]),b)]),y=[[0n,0n],[1n,0n],[0n,0n]],I=t.alloc([...Qt.bigInt2BytesLE(F(y[0][0]),b),...Qt.bigInt2BytesLE(F(y[0][1]),b),...Qt.bigInt2BytesLE(F(y[1][0]),b),...Qt.bigInt2BytesLE(F(y[1][1]),b),...Qt.bigInt2BytesLE(F(y[2][0]),b),...Qt.bigInt2BytesLE(F(y[2][1]),b)]),N=t.alloc([...Qt.bigInt2BytesLE(F(1n),b),...Qt.bigInt2BytesLE(F(0n),b),...Qt.bigInt2BytesLE(F(0n),b),...Qt.bigInt2BytesLE(F(0n),b),...Qt.bigInt2BytesLE(F(0n),b),...Qt.bigInt2BytesLE(F(0n),b),...Qt.bigInt2BytesLE(F(0n),b),...Qt.bigInt2BytesLE(F(0n),b),...Qt.bigInt2BytesLE(F(0n),b),...Qt.bigInt2BytesLE(F(0n),b),...Qt.bigInt2BytesLE(F(0n),b),...Qt.bigInt2BytesLE(F(0n),b)]),nt=t.alloc([...Qt.bigInt2BytesLE(F(1n),b),...Qt.bigInt2BytesLE(F(1n),b)]);function J(){let _=t.addFunction(w+"_mulNR");_.addParam("x","i32"),_.addParam("pr","i32");let f=_.getCodeBuilder(),R=f.i32_const(t.alloc(b)),G=f.getLocal("x"),P=f.i32_add(f.getLocal("x"),f.i32_const(b)),Z=f.getLocal("pr"),T=f.i32_add(f.getLocal("pr"),f.i32_const(b));_.addCode(f.call(M+"_copy",G,R),f.call(M+"_sub",G,P,Z),f.call(M+"_add",R,P,T))}J();let j=Yb(t,w+"_mulNR","f6m","f2m");function ot(){let _=t.addFunction(j+"_mulNR");_.addParam("x","i32"),_.addParam("pr","i32");let f=_.getCodeBuilder(),R=f.i32_const(t.alloc(b*2));_.addCode(f.call(w+"_copy",f.getLocal("x"),R),f.call(w+"_mulNR",f.i32_add(f.getLocal("x"),f.i32_const(d*4)),f.getLocal("pr")),f.call(w+"_copy",f.i32_add(f.getLocal("x"),f.i32_const(d*2)),f.i32_add(f.getLocal("pr"),f.i32_const(d*4))),f.call(w+"_copy",R,f.i32_add(f.getLocal("pr"),f.i32_const(d*2))))}ot();let V=y3(t,j+"_mulNR","ftm",j),Lt=st(0xd201000000010000n),rt=t.alloc(Lt),ht=3*l,A=Lt.length-1,C=Lt.reduce((_,f)=>_+(f!=0?1:0),0)+A+1,r=6*d,z=3*d*2+C*ht,E=!0,g=15132376222941642752n;t.modules[a]={n64q:h,n64r:m,n8q:d,n8r:B,pG1gen:L,pG1zero:Q,pG1b:x,pG2gen:q,pG2zero:I,pG2b:k,pq:t.modules.f1m.pq,pr:v,pOneT:N,r:e,q:o,prePSize:r,preQSize:z};function U(_){let f=_,R=[];for(;f>0n;){if(C3(f)){let G=2-Number(f%4n);R.push(G),f=f-BigInt(G)}else R.push(0);f=f>>1n}return R}function st(_){let f=_,R=[];for(;f>0n;)C3(f)?R.push(1):R.push(0),f=f>>1n;return R}function et(){let _=t.addFunction(a+"_prepareG1");_.addParam("pP","i32"),_.addParam("ppreP","i32");let f=_.getCodeBuilder();_.addCode(f.call(S+"_normalize",f.getLocal("pP"),f.getLocal("ppreP")))}function ct(){let _=t.addFunction(a+"_prepDblStep");_.addParam("R","i32"),_.addParam("r","i32");let f=_.getCodeBuilder(),R=f.getLocal("R"),G=f.i32_add(f.getLocal("R"),f.i32_const(2*d)),P=f.i32_add(f.getLocal("R"),f.i32_const(4*d)),Z=f.getLocal("r"),T=f.i32_add(f.getLocal("r"),f.i32_const(2*d)),D=f.i32_add(f.getLocal("r"),f.i32_const(4*d)),Y=f.i32_const(t.alloc(l)),tt=f.i32_const(t.alloc(l)),K=f.i32_const(t.alloc(l)),it=f.i32_const(t.alloc(l)),mt=f.i32_const(t.alloc(l));_.addCode(f.call(w+"_square",R,Z),f.call(w+"_square",G,tt),f.call(w+"_square",tt,K),f.call(w+"_add",tt,R,T),f.call(w+"_square",T,T),f.call(w+"_sub",T,Z,T),f.call(w+"_sub",T,K,T),f.call(w+"_add",T,T,T),f.call(w+"_add",Z,Z,it),f.call(w+"_add",it,Z,it),f.call(w+"_add",R,it,D),f.call(w+"_square",it,mt),f.call(w+"_square",P,Y),f.call(w+"_sub",mt,T,R),f.call(w+"_sub",R,T,R),f.call(w+"_add",P,G,P),f.call(w+"_square",P,P),f.call(w+"_sub",P,tt,P),f.call(w+"_sub",P,Y,P),f.call(w+"_sub",T,R,G),f.call(w+"_mul",G,it,G),f.call(w+"_add",K,K,K),f.call(w+"_add",K,K,K),f.call(w+"_add",K,K,K),f.call(w+"_sub",G,K,G),f.call(w+"_mul",it,Y,T),f.call(w+"_add",T,T,T),f.call(w+"_neg",T,T),f.call(w+"_square",D,D),f.call(w+"_sub",D,Z,D),f.call(w+"_sub",D,mt,D),f.call(w+"_add",tt,tt,tt),f.call(w+"_add",tt,tt,tt),f.call(w+"_sub",D,tt,D),f.call(w+"_mul",P,Y,Z),f.call(w+"_add",Z,Z,Z))}function ft(){let _=t.addFunction(a+"_prepAddStep");_.addParam("R","i32"),_.addParam("Q","i32"),_.addParam("r","i32");let f=_.getCodeBuilder(),R=f.getLocal("R"),G=f.i32_add(f.getLocal("R"),f.i32_const(2*d)),P=f.i32_add(f.getLocal("R"),f.i32_const(4*d)),Z=f.getLocal("Q"),T=f.i32_add(f.getLocal("Q"),f.i32_const(2*d)),D=f.getLocal("r"),Y=f.i32_add(f.getLocal("r"),f.i32_const(2*d)),tt=f.i32_add(f.getLocal("r"),f.i32_const(4*d)),K=f.i32_const(t.alloc(l)),it=f.i32_const(t.alloc(l)),mt=f.i32_const(t.alloc(l)),pt=f.i32_const(t.alloc(l)),dt=f.i32_const(t.alloc(l)),Ct=f.i32_const(t.alloc(l)),xt=f.i32_const(t.alloc(l)),St=f.i32_const(t.alloc(l)),Bt=f.i32_const(t.alloc(l)),At=f.i32_const(t.alloc(l)),wt=f.i32_const(t.alloc(l));_.addCode(f.call(w+"_square",P,K),f.call(w+"_square",T,it),f.call(w+"_mul",K,Z,pt),f.call(w+"_add",T,P,Y),f.call(w+"_square",Y,Y),f.call(w+"_sub",Y,it,Y),f.call(w+"_sub",Y,K,Y),f.call(w+"_mul",Y,K,Y),f.call(w+"_sub",pt,R,dt),f.call(w+"_square",dt,Ct),f.call(w+"_add",Ct,Ct,xt),f.call(w+"_add",xt,xt,xt),f.call(w+"_mul",xt,dt,St),f.call(w+"_sub",Y,G,Bt),f.call(w+"_sub",Bt,G,Bt),f.call(w+"_mul",Bt,Z,tt),f.call(w+"_mul",xt,R,At),f.call(w+"_square",Bt,R),f.call(w+"_sub",R,St,R),f.call(w+"_sub",R,At,R),f.call(w+"_sub",R,At,R),f.call(w+"_add",P,dt,P),f.call(w+"_square",P,P),f.call(w+"_sub",P,K,P),f.call(w+"_sub",P,Ct,P),f.call(w+"_add",T,P,D),f.call(w+"_sub",At,R,wt),f.call(w+"_mul",wt,Bt,wt),f.call(w+"_mul",G,St,pt),f.call(w+"_add",pt,pt,pt),f.call(w+"_sub",wt,pt,G),f.call(w+"_square",D,D),f.call(w+"_sub",D,it,D),f.call(w+"_square",P,mt),f.call(w+"_sub",D,mt,D),f.call(w+"_add",tt,tt,tt),f.call(w+"_sub",tt,D,tt),f.call(w+"_add",P,P,D),f.call(w+"_neg",Bt,Bt),f.call(w+"_add",Bt,Bt,Y))}function _t(){let _=t.addFunction(a+"_prepareG2");_.addParam("pQ","i32"),_.addParam("ppreQ","i32"),_.addLocal("pCoef","i32"),_.addLocal("i","i32");let f=_.getCodeBuilder(),R=f.getLocal("pQ"),G=t.alloc(l*3),P=f.i32_const(G),Z=f.getLocal("ppreQ");_.addCode(f.call(O+"_normalize",R,Z),f.if(f.call(O+"_isZero",Z),f.ret([])),f.call(O+"_copy",Z,P),f.setLocal("pCoef",f.i32_add(f.getLocal("ppreQ"),f.i32_const(l*3)))),_.addCode(f.setLocal("i",f.i32_const(Lt.length-2)),f.block(f.loop(f.call(a+"_prepDblStep",P,f.getLocal("pCoef")),f.setLocal("pCoef",f.i32_add(f.getLocal("pCoef"),f.i32_const(ht))),f.if(f.i32_load8_s(f.getLocal("i"),rt),[...f.call(a+"_prepAddStep",P,Z,f.getLocal("pCoef")),...f.setLocal("pCoef",f.i32_add(f.getLocal("pCoef"),f.i32_const(ht)))]),f.br_if(1,f.i32_eqz(f.getLocal("i"))),f.setLocal("i",f.i32_sub(f.getLocal("i"),f.i32_const(1))),f.br(0))))}function gt(){let _=t.addFunction(j+"_mul1");_.addParam("pA","i32"),_.addParam("pC1","i32"),_.addParam("pR","i32");let f=_.getCodeBuilder(),R=f.getLocal("pA"),G=f.i32_add(f.getLocal("pA"),f.i32_const(b*2)),P=f.i32_add(f.getLocal("pA"),f.i32_const(b*4)),Z=f.getLocal("pC1"),T=f.getLocal("pR"),D=f.i32_add(f.getLocal("pR"),f.i32_const(b*2)),Y=f.i32_add(f.getLocal("pR"),f.i32_const(b*4)),tt=f.i32_const(t.alloc(b*2)),K=f.i32_const(t.alloc(b*2));_.addCode(f.call(w+"_add",R,G,tt),f.call(w+"_add",G,P,K),f.call(w+"_mul",G,Z,Y),f.call(w+"_mul",K,Z,T),f.call(w+"_sub",T,Y,T),f.call(w+"_mulNR",T,T),f.call(w+"_mul",tt,Z,D),f.call(w+"_sub",D,Y,D))}gt();function yt(){let _=t.addFunction(j+"_mul01");_.addParam("pA","i32"),_.addParam("pC0","i32"),_.addParam("pC1","i32"),_.addParam("pR","i32");let f=_.getCodeBuilder(),R=f.getLocal("pA"),G=f.i32_add(f.getLocal("pA"),f.i32_const(b*2)),P=f.i32_add(f.getLocal("pA"),f.i32_const(b*4)),Z=f.getLocal("pC0"),T=f.getLocal("pC1"),D=f.getLocal("pR"),Y=f.i32_add(f.getLocal("pR"),f.i32_const(b*2)),tt=f.i32_add(f.getLocal("pR"),f.i32_const(b*4)),K=f.i32_const(t.alloc(b*2)),it=f.i32_const(t.alloc(b*2)),mt=f.i32_const(t.alloc(b*2)),pt=f.i32_const(t.alloc(b*2));_.addCode(f.call(w+"_mul",R,Z,K),f.call(w+"_mul",G,T,it),f.call(w+"_add",R,G,mt),f.call(w+"_add",R,P,pt),f.call(w+"_add",G,P,D),f.call(w+"_mul",D,T,D),f.call(w+"_sub",D,it,D),f.call(w+"_mulNR",D,D),f.call(w+"_add",D,K,D),f.call(w+"_add",Z,T,Y),f.call(w+"_mul",Y,mt,Y),f.call(w+"_sub",Y,K,Y),f.call(w+"_sub",Y,it,Y),f.call(w+"_mul",pt,Z,tt),f.call(w+"_sub",tt,K,tt),f.call(w+"_add",tt,it,tt))}yt();function ut(){let _=t.addFunction(V+"_mul014");_.addParam("pA","i32"),_.addParam("pC0","i32"),_.addParam("pC1","i32"),_.addParam("pC4","i32"),_.addParam("pR","i32");let f=_.getCodeBuilder(),R=f.getLocal("pA"),G=f.i32_add(f.getLocal("pA"),f.i32_const(b*6)),P=f.getLocal("pC0"),Z=f.getLocal("pC1"),T=f.getLocal("pC4"),D=f.i32_const(t.alloc(b*6)),Y=f.i32_const(t.alloc(b*6)),tt=f.i32_const(t.alloc(b*2)),K=f.getLocal("pR"),it=f.i32_add(f.getLocal("pR"),f.i32_const(b*6));_.addCode(f.call(j+"_mul01",R,P,Z,D),f.call(j+"_mul1",G,T,Y),f.call(w+"_add",Z,T,tt),f.call(j+"_add",G,R,it),f.call(j+"_mul01",it,P,tt,it),f.call(j+"_sub",it,D,it),f.call(j+"_sub",it,Y,it),f.call(j+"_copy",Y,K),f.call(j+"_mulNR",K,K),f.call(j+"_add",K,D,K))}ut();function lt(){let _=t.addFunction(a+"_ell");_.addParam("pP","i32"),_.addParam("pCoefs","i32"),_.addParam("pF","i32");let f=_.getCodeBuilder(),R=f.getLocal("pP"),G=f.i32_add(f.getLocal("pP"),f.i32_const(d)),P=f.getLocal("pF"),Z=f.getLocal("pCoefs"),T=f.i32_add(f.getLocal("pCoefs"),f.i32_const(b)),D=f.i32_add(f.getLocal("pCoefs"),f.i32_const(b*2)),Y=f.i32_add(f.getLocal("pCoefs"),f.i32_const(b*3)),tt=f.i32_add(f.getLocal("pCoefs"),f.i32_const(b*4)),K=t.alloc(b*2),it=f.i32_const(K),mt=f.i32_const(K),pt=f.i32_const(K+b),dt=t.alloc(b*2),Ct=f.i32_const(dt),xt=f.i32_const(dt),St=f.i32_const(dt+b);_.addCode(f.call(M+"_mul",Z,G,mt),f.call(M+"_mul",T,G,pt),f.call(M+"_mul",D,R,xt),f.call(M+"_mul",Y,R,St),f.call(V+"_mul014",P,tt,Ct,it,P))}lt();function bt(){let _=t.addFunction(a+"_millerLoop");_.addParam("ppreP","i32"),_.addParam("ppreQ","i32"),_.addParam("r","i32"),_.addLocal("pCoef","i32"),_.addLocal("i","i32");let f=_.getCodeBuilder(),R=f.getLocal("ppreP"),G=f.getLocal("pCoef"),P=f.getLocal("r");_.addCode(f.call(V+"_one",P),f.if(f.call(S+"_isZero",R),f.ret([])),f.if(f.call(S+"_isZero",f.getLocal("ppreQ")),f.ret([])),f.setLocal("pCoef",f.i32_add(f.getLocal("ppreQ"),f.i32_const(l*3))),f.setLocal("i",f.i32_const(Lt.length-2)),f.block(f.loop(f.call(a+"_ell",R,G,P),f.setLocal("pCoef",f.i32_add(f.getLocal("pCoef"),f.i32_const(ht))),f.if(f.i32_load8_s(f.getLocal("i"),rt),[...f.call(a+"_ell",R,G,P),...f.setLocal("pCoef",f.i32_add(f.getLocal("pCoef"),f.i32_const(ht)))]),f.call(V+"_square",P,P),f.br_if(1,f.i32_eq(f.getLocal("i"),f.i32_const(1))),f.setLocal("i",f.i32_sub(f.getLocal("i"),f.i32_const(1))),f.br(0))),f.call(a+"_ell",R,G,P)),_.addCode(f.call(V+"_conjugate",P,P))}function Et(_){let f=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n,151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n],[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n,877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n,3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n,3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n]]],R=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0n,4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[0n,1n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[0n,793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n]],[[1n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n]]],G=t.addFunction(V+"_frobeniusMap"+_);G.addParam("x","i32"),G.addParam("r","i32");let P=G.getCodeBuilder();for(let T=0;T<6;T++){let D=T==0?P.getLocal("x"):P.i32_add(P.getLocal("x"),P.i32_const(T*l)),Y=D,tt=P.i32_add(P.getLocal("x"),P.i32_const(T*l+b)),K=T==0?P.getLocal("r"):P.i32_add(P.getLocal("r"),P.i32_const(T*l)),it=K,mt=P.i32_add(P.getLocal("r"),P.i32_const(T*l+b)),pt=Z(f[Math.floor(T/3)][_%12],R[T%3][_%6]),dt=t.alloc([...Qt.bigInt2BytesLE(F(pt[0]),d),...Qt.bigInt2BytesLE(F(pt[1]),d)]);_%2==1?G.addCode(P.call(M+"_copy",Y,it),P.call(M+"_neg",tt,mt),P.call(w+"_mul",K,P.i32_const(dt),K)):G.addCode(P.call(w+"_mul",D,P.i32_const(dt),K))}function Z(T,D){let Y=T[0],tt=T[1],K=D[0],it=D[1],mt=[(Y*K-tt*it)%o,(Y*it+tt*K)%o];return am(mt[0])&&(mt[0]=mt[0]+o),mt}}function It(){let _=t.addFunction(a+"__cyclotomicSquare");_.addParam("x","i32"),_.addParam("r","i32");let f=_.getCodeBuilder(),R=f.getLocal("x"),G=f.i32_add(f.getLocal("x"),f.i32_const(l)),P=f.i32_add(f.getLocal("x"),f.i32_const(2*l)),Z=f.i32_add(f.getLocal("x"),f.i32_const(3*l)),T=f.i32_add(f.getLocal("x"),f.i32_const(4*l)),D=f.i32_add(f.getLocal("x"),f.i32_const(5*l)),Y=f.getLocal("r"),tt=f.i32_add(f.getLocal("r"),f.i32_const(l)),K=f.i32_add(f.getLocal("r"),f.i32_const(2*l)),it=f.i32_add(f.getLocal("r"),f.i32_const(3*l)),mt=f.i32_add(f.getLocal("r"),f.i32_const(4*l)),pt=f.i32_add(f.getLocal("r"),f.i32_const(5*l)),dt=f.i32_const(t.alloc(l)),Ct=f.i32_const(t.alloc(l)),xt=f.i32_const(t.alloc(l)),St=f.i32_const(t.alloc(l)),Bt=f.i32_const(t.alloc(l)),At=f.i32_const(t.alloc(l)),wt=f.i32_const(t.alloc(l)),Ot=f.i32_const(t.alloc(l));_.addCode(f.call(w+"_mul",R,T,wt),f.call(w+"_mulNR",T,dt),f.call(w+"_add",R,dt,dt),f.call(w+"_add",R,T,Ot),f.call(w+"_mul",Ot,dt,dt),f.call(w+"_mulNR",wt,Ot),f.call(w+"_add",wt,Ot,Ot),f.call(w+"_sub",dt,Ot,dt),f.call(w+"_add",wt,wt,Ct),f.call(w+"_mul",Z,P,wt),f.call(w+"_mulNR",P,xt),f.call(w+"_add",Z,xt,xt),f.call(w+"_add",Z,P,Ot),f.call(w+"_mul",Ot,xt,xt),f.call(w+"_mulNR",wt,Ot),f.call(w+"_add",wt,Ot,Ot),f.call(w+"_sub",xt,Ot,xt),f.call(w+"_add",wt,wt,St),f.call(w+"_mul",G,D,wt),f.call(w+"_mulNR",D,Bt),f.call(w+"_add",G,Bt,Bt),f.call(w+"_add",G,D,Ot),f.call(w+"_mul",Ot,Bt,Bt),f.call(w+"_mulNR",wt,Ot),f.call(w+"_add",wt,Ot,Ot),f.call(w+"_sub",Bt,Ot,Bt),f.call(w+"_add",wt,wt,At),f.call(w+"_sub",dt,R,Y),f.call(w+"_add",Y,Y,Y),f.call(w+"_add",dt,Y,Y),f.call(w+"_add",Ct,T,mt),f.call(w+"_add",mt,mt,mt),f.call(w+"_add",Ct,mt,mt),f.call(w+"_mul",At,f.i32_const(nt),Ot),f.call(w+"_add",Ot,Z,it),f.call(w+"_add",it,it,it),f.call(w+"_add",Ot,it,it),f.call(w+"_sub",Bt,P,K),f.call(w+"_add",K,K,K),f.call(w+"_add",Bt,K,K),f.call(w+"_sub",xt,G,tt),f.call(w+"_add",tt,tt,tt),f.call(w+"_add",xt,tt,tt),f.call(w+"_add",St,D,pt),f.call(w+"_add",pt,pt,pt),f.call(w+"_add",St,pt,pt))}function zt(_,f,R){let G=U(_).map(K=>K==-1?255:K),P=t.alloc(G),Z=t.addFunction(a+"__cyclotomicExp_"+R);Z.addParam("x","i32"),Z.addParam("r","i32"),Z.addLocal("bit","i32"),Z.addLocal("i","i32");let T=Z.getCodeBuilder(),D=T.getLocal("x"),Y=T.getLocal("r"),tt=T.i32_const(t.alloc(s));Z.addCode(T.call(V+"_conjugate",D,tt),T.call(V+"_one",Y),T.if(T.teeLocal("bit",T.i32_load8_s(T.i32_const(G.length-1),P)),T.if(T.i32_eq(T.getLocal("bit"),T.i32_const(1)),T.call(V+"_mul",Y,D,Y),T.call(V+"_mul",Y,tt,Y))),T.setLocal("i",T.i32_const(G.length-2)),T.block(T.loop(T.call(a+"__cyclotomicSquare",Y,Y),T.if(T.teeLocal("bit",T.i32_load8_s(T.getLocal("i"),P)),T.if(T.i32_eq(T.getLocal("bit"),T.i32_const(1)),T.call(V+"_mul",Y,D,Y),T.call(V+"_mul",Y,tt,Y))),T.br_if(1,T.i32_eqz(T.getLocal("i"))),T.setLocal("i",T.i32_sub(T.getLocal("i"),T.i32_const(1))),T.br(0)))),f&&Z.addCode(T.call(V+"_conjugate",Y,Y))}function Mt(){It(),zt(g,E,"w0");let _=t.addFunction(a+"_finalExponentiation");_.addParam("x","i32"),_.addParam("r","i32");let f=_.getCodeBuilder(),R=f.getLocal("x"),G=f.getLocal("r"),P=f.i32_const(t.alloc(s)),Z=f.i32_const(t.alloc(s)),T=f.i32_const(t.alloc(s)),D=f.i32_const(t.alloc(s)),Y=f.i32_const(t.alloc(s)),tt=f.i32_const(t.alloc(s)),K=f.i32_const(t.alloc(s));_.addCode(f.call(V+"_frobeniusMap6",R,P),f.call(V+"_inverse",R,Z),f.call(V+"_mul",P,Z,T),f.call(V+"_copy",T,Z),f.call(V+"_frobeniusMap2",T,T),f.call(V+"_mul",T,Z,T),f.call(a+"__cyclotomicSquare",T,Z),f.call(V+"_conjugate",Z,Z),f.call(a+"__cyclotomicExp_w0",T,D),f.call(a+"__cyclotomicSquare",D,Y),f.call(V+"_mul",Z,D,tt),f.call(a+"__cyclotomicExp_w0",tt,Z),f.call(a+"__cyclotomicExp_w0",Z,P),f.call(a+"__cyclotomicExp_w0",P,K),f.call(V+"_mul",K,Y,K),f.call(a+"__cyclotomicExp_w0",K,Y),f.call(V+"_conjugate",tt,tt),f.call(V+"_mul",Y,tt,Y),f.call(V+"_mul",Y,T,Y),f.call(V+"_conjugate",T,tt),f.call(V+"_mul",Z,T,Z),f.call(V+"_frobeniusMap3",Z,Z),f.call(V+"_mul",K,tt,K),f.call(V+"_frobeniusMap1",K,K),f.call(V+"_mul",D,P,D),f.call(V+"_frobeniusMap2",D,D),f.call(V+"_mul",D,Z,D),f.call(V+"_mul",D,K,D),f.call(V+"_mul",D,Y,G))}function kt(){let _=t.addFunction(a+"_finalExponentiationOld");_.addParam("x","i32"),_.addParam("r","i32");let R=t.alloc(Qt.bigInt2BytesLE(322277361516934140462891564586510139908379969514828494218366688025288661041104682794998680497580008899973249814104447692778988208376779573819485263026159588510513834876303014016798809919343532899164848730280942609956670917565618115867287399623286813270357901731510188149934363360381614501334086825442271920079363289954510565375378443704372994881406797882676971082200626541916413184642520269678897559532260949334760604962086348898118982248842634379637598665468817769075878555493752214492790122785850202957575200176084204422751485957336465472324810982833638490904279282696134323072515220044451592646885410572234451732790590013479358343841220074174848221722017083597872017638514103174122784843925578370430843522959600095676285723737049438346544753168912974976791528535276317256904336520179281145394686565050419250614107803233314658825463117900250701199181529205942363159325765991819433914303908860460720581408201373164047773794825411011922305820065611121544561808414055302212057471395719432072209245600258134364584636810093520285711072578721435517884103526483832733289802426157301542744476740008494780363354305116978805620671467071400711358839553375340724899735460480144599782014906586543813292157922220645089192130209334926661588737007768565838519456601560804957985667880395221049249803753582637708560n,544)),G=_.getCodeBuilder();_.addCode(G.call(V+"_exp",G.getLocal("x"),G.i32_const(R),G.i32_const(544),G.getLocal("r")))}let Pt=t.alloc(r),qt=t.alloc(z);function Rt(_){let f=t.addFunction(a+"_pairingEq"+_);for(let Z=0;Z<_;Z++)f.addParam("p_"+Z,"i32"),f.addParam("q_"+Z,"i32");f.addParam("c","i32"),f.setReturnType("i32");let R=f.getCodeBuilder(),G=R.i32_const(t.alloc(s)),P=R.i32_const(t.alloc(s));f.addCode(R.call(V+"_one",G));for(let Z=0;Z<_;Z++)f.addCode(R.call(a+"_prepareG1",R.getLocal("p_"+Z),R.i32_const(Pt))),f.addCode(R.call(a+"_prepareG2",R.getLocal("q_"+Z),R.i32_const(qt))),f.addCode(R.if(R.i32_eqz(R.call(S+"_inGroupAffine",R.i32_const(Pt))),R.ret(R.i32_const(0))),R.if(R.i32_eqz(R.call(O+"_inGroupAffine",R.i32_const(qt))),R.ret(R.i32_const(0)))),f.addCode(R.call(a+"_millerLoop",R.i32_const(Pt),R.i32_const(qt),P)),f.addCode(R.call(V+"_mul",G,P,G));f.addCode(R.call(a+"_finalExponentiation",G,G)),f.addCode(R.call(V+"_eq",G,R.getLocal("c")))}function Kt(){let _=t.addFunction(a+"_pairing");_.addParam("p","i32"),_.addParam("q","i32"),_.addParam("r","i32");let f=_.getCodeBuilder(),R=f.i32_const(t.alloc(s));_.addCode(f.call(a+"_prepareG1",f.getLocal("p"),f.i32_const(Pt))),_.addCode(f.call(a+"_prepareG2",f.getLocal("q"),f.i32_const(qt))),_.addCode(f.call(a+"_millerLoop",f.i32_const(Pt),f.i32_const(qt),R)),_.addCode(f.call(a+"_finalExponentiation",R,f.getLocal("r")))}function Ut(){let _=t.addFunction(O+"_inGroupAffine");_.addParam("p","i32"),_.setReturnType("i32");let f=_.getCodeBuilder(),R=[2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279894n,2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279893n],G=4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,P=[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],Z=f.i32_const(t.alloc([...Qt.bigInt2BytesLE(F(R[0]),d),...Qt.bigInt2BytesLE(F(R[1]),d)])),T=f.i32_const(t.alloc(Qt.bigInt2BytesLE(F(G),d))),D=f.i32_const(t.alloc([...Qt.bigInt2BytesLE(F(P[0]),d),...Qt.bigInt2BytesLE(F(P[1]),d)])),Y=f.i32_const(t.alloc(Qt.bigInt2BytesLE(g,8))),tt=f.getLocal("p"),K=f.i32_add(f.getLocal("p"),f.i32_const(l)),it=f.i32_const(t.alloc(b)),mt=f.i32_const(t.alloc(l)),pt=f.i32_const(t.alloc(l)),dt=t.alloc(l*2),Ct=f.i32_const(dt),xt=f.i32_const(dt),St=f.i32_const(dt),Bt=f.i32_const(dt+b),At=f.i32_const(dt+l),wt=f.i32_const(dt+l),Ot=f.i32_const(dt+l+b),Jt=t.alloc(l*3),cn=f.i32_const(Jt),oo=f.i32_const(Jt),Nn=f.i32_const(Jt),$n=f.i32_const(Jt+b),io=f.i32_const(Jt+l),Zn=f.i32_const(Jt+l),jn=f.i32_const(Jt+l+b),eo=f.i32_const(Jt+l*2);_.addCode(f.if(f.call(O+"_isZeroAffine",f.getLocal("p")),f.ret(f.i32_const(1))),f.if(f.i32_eqz(f.call(O+"_inCurveAffine",f.getLocal("p"))),f.ret(f.i32_const(0))),f.call(w+"_mul",tt,Z,mt),f.call(w+"_mul",K,Z,pt),f.call(w+"_mul1",mt,T,xt),f.call(w+"_neg",pt,At),f.call(w+"_neg",mt,oo),f.call(w+"_mul",pt,D,io),f.call(M+"_sub",St,Bt,it),f.call(M+"_add",St,Bt,Bt),f.call(M+"_copy",it,St),f.call(M+"_sub",wt,Ot,it),f.call(M+"_add",wt,Ot,Ot),f.call(M+"_copy",it,wt),f.call(M+"_add",Nn,$n,it),f.call(M+"_sub",Nn,$n,$n),f.call(M+"_copy",it,Nn),f.call(M+"_sub",jn,Zn,it),f.call(M+"_add",Zn,jn,jn),f.call(M+"_copy",it,Zn),f.call(w+"_one",eo),f.call(O+"_timesScalar",cn,Y,f.i32_const(8),cn),f.call(O+"_addMixed",cn,Ct,cn),f.ret(f.call(O+"_eqMixed",cn,f.getLocal("p"))));let An=t.addFunction(O+"_inGroup");An.addParam("pIn","i32"),An.setReturnType("i32");let fn=An.getCodeBuilder(),da=fn.i32_const(t.alloc(l*2));An.addCode(fn.call(O+"_toAffine",fn.getLocal("pIn"),da),fn.ret(fn.call(O+"_inGroupAffine",da)))}function X(){let _=t.addFunction(S+"_inGroupAffine");_.addParam("p","i32"),_.setReturnType("i32");let f=_.getCodeBuilder(),R=4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,G=793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,P=(g*g-1n)/3n,Z=f.i32_const(t.alloc(Qt.bigInt2BytesLE(F(R),d))),T=f.i32_const(t.alloc(Qt.bigInt2BytesLE(F(G),d))),D=f.i32_const(t.alloc(Qt.bigInt2BytesLE(P,16))),Y=f.getLocal("p"),tt=f.i32_add(f.getLocal("p"),f.i32_const(b)),K=t.alloc(b*3),it=f.i32_const(K),mt=f.i32_const(K),pt=f.i32_const(K+b),dt=t.alloc(b*2),Ct=f.i32_const(dt),xt=f.i32_const(dt),St=f.i32_const(dt+b);_.addCode(f.if(f.call(S+"_isZeroAffine",f.getLocal("p")),f.ret(f.i32_const(1))),f.if(f.i32_eqz(f.call(S+"_inCurveAffine",f.getLocal("p"))),f.ret(f.i32_const(0))),f.call(M+"_mul",Y,Z,mt),f.call(M+"_copy",tt,pt),f.call(M+"_mul",Y,T,xt),f.call(M+"_copy",tt,St),f.call(S+"_doubleAffine",it,it),f.call(S+"_subMixed",it,f.getLocal("p"),it),f.call(S+"_subMixed",it,Ct,it),f.call(S+"_timesScalar",it,D,f.i32_const(16),it),f.ret(f.call(S+"_eqMixed",it,Ct)));let Bt=t.addFunction(S+"_inGroup");Bt.addParam("pIn","i32"),Bt.setReturnType("i32");let At=Bt.getCodeBuilder(),wt=At.i32_const(t.alloc(b*2));Bt.addCode(At.call(S+"_toAffine",At.getLocal("pIn"),wt),At.ret(At.call(S+"_inGroupAffine",wt)))}for(let _=0;_<10;_++)Et(_),t.exportFunction(V+"_frobeniusMap"+_);X(),Ut(),ft(),ct(),et(),_t(),bt(),kt(),Mt();for(let _=1;_<=5;_++)Rt(_),t.exportFunction(a+"_pairingEq"+_);Kt(),t.exportFunction(a+"_pairing"),t.exportFunction(a+"_prepareG1"),t.exportFunction(a+"_prepareG2"),t.exportFunction(a+"_millerLoop"),t.exportFunction(a+"_finalExponentiation"),t.exportFunction(a+"_finalExponentiationOld"),t.exportFunction(a+"__cyclotomicSquare"),t.exportFunction(a+"__cyclotomicExp_w0"),t.exportFunction(j+"_mul1"),t.exportFunction(j+"_mul01"),t.exportFunction(V+"_mul014"),t.exportFunction(S+"_inGroupAffine"),t.exportFunction(S+"_inGroup"),t.exportFunction(O+"_inGroupAffine"),t.exportFunction(O+"_inGroup")},im=Db,em=om;Ni=[];for(let c=0;c<256;c++)Ni[c]=rm(c,8);dm=Object.freeze({__proto__:null,array2buffer:$r,beBuff2int:cm,beInt2Buff:sm,bitReverse:nh,buffReverseBits:ah,buffer2array:Pc,leBuff2int:lm,leInt2Buff:th,log2:ta,stringifyBigInts:Cr,stringifyFElements:xr,unstringifyBigInts:Br,unstringifyFElements:Ar}),Rn=1<<30,pn=class c{constructor(t){this.buffers=[],this.byteLength=t;for(let n=0;n<t;n+=Rn){let a=Math.min(t-n,Rn);this.buffers.push(new Uint8Array(a))}}slice(t,n){n===void 0&&(n=this.byteLength),t===void 0&&(t=0);let a=n-t,o=Math.floor(t/Rn),e=Math.floor((t+a-1)/Rn);if(o==e||a==0)return this.buffers[o].slice(t%Rn,t%Rn+a);let h,d=o,b=t%Rn,l=a;for(;l>0;){let s=b+l>Rn?Rn-b:l,m=new Uint8Array(this.buffers[d].buffer,this.buffers[d].byteOffset+b,s);if(s==a)return m.slice();h||(a<=Rn?h=new Uint8Array(a):h=new c(a)),h.set(m,a-l),l=l-s,d++,b=0}return h}set(t,n){n===void 0&&(n=0);let a=t.byteLength;if(a==0)return;let o=Math.floor(n/Rn),e=Math.floor((n+a-1)/Rn);if(o==e)return t instanceof c&&t.buffers.length==1?this.buffers[o].set(t.buffers[0],n%Rn):this.buffers[o].set(t,n%Rn);let h=o,d=n%Rn,b=a;for(;b>0;){let l=d+b>Rn?Rn-d:b,s=t.slice(a-b,a-b+l);new Uint8Array(this.buffers[h].buffer,this.buffers[h].byteOffset+d,l).set(s),b=b-l,h++,d=0}}};Mc=class{constructor(t,n,a,o){if(this.tm=t,this.prefix=n,this.p=o,this.n8=a,this.type="F1",this.m=1,this.half=ko(o,ho),this.bitLength=ji(o),this.mask=Ma(Ec(ho,this.bitLength),ho),this.pOp1=t.alloc(a),this.pOp2=t.alloc(a),this.pOp3=t.alloc(a),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(a/8),this.n32=Math.floor(a/4),this.n64*8!=this.n8)throw new Error("n8 must be a multiple of 8");this.half=ko(this.p,ho),this.nqr=this.two;let e=this.exp(this.nqr,this.half);for(;!this.eq(e,this.negone);)this.nqr=this.add(this.nqr,this.one),e=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let h=Ma(this.p,ho);for(;!Pr(h);)this.s=this.s+1,h=ko(h,ho);this.w=[],this.w[this.s]=this.exp(this.nqr,h);for(let d=this.s-1;d>=0;d--)this.w[d]=this.square(this.w[d+1]);if(!this.eq(this.w[0],this.one))throw new Error("Error calculating roots of unity");this.batchToMontgomery=Xa(t,n+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=Xa(t,n+"_batchFromMontgomery",this.n8,this.n8)}op2(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){return this.op2("_add",t,n)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=No(wn(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,n){if(t instanceof Uint8Array)return t;let a=wn(t,n);v3(a)?(a=O3(a),vc(a,this.p)&&(a=Ca(a,this.p)),a=Ma(this.p,a)):vc(a,this.p)&&(a=Ca(a,this.p));let o=th(a,this.n8);return this.toMontgomery(o)}toString(t,n){let a=this.fromMontgomery(t),o=Zi(a,0);return Nc(o,n)}fromRng(t){let n,a=new Uint8Array(this.n8);do{n=T3;for(let o=0;o<this.n64;o++)n=Mr(n,Ec(t.nextU64(),64*o));n=Rr(n,this.mask)}while(M3(n,this.p));return $i(a,0,n,this.n8),a}random(){return this.fromRng(zr())}toObject(t){let n=this.fromMontgomery(t);return Zi(n,0)}fromObject(t){let n=new Uint8Array(this.n8);return $i(n,0,t,this.n8),this.toMontgomery(n)}toRprLE(t,n,a){t.set(this.fromMontgomery(a),n)}toRprBE(t,n,a){let o=this.fromMontgomery(a);for(let e=0;e<this.n8/2;e++){let h=o[e];o[e]=o[this.n8-1-e],o[this.n8-1-e]=h}t.set(o,n)}fromRprLE(t,n){n=n||0;let a=t.slice(n,n+this.n8);return this.toMontgomery(a)}async batchInverse(t){let n=!1,a=this.n8,o=this.n8;Array.isArray(t)?(t=$r(t,a),n=!0):t=t.slice(0,t.byteLength);let e=Math.floor(t.byteLength/a);if(e*a!==t.byteLength)throw new Error("Invalid buffer size");let h=Math.floor(e/this.tm.concurrency),d=[];for(let m=0;m<this.tm.concurrency;m++){let B;if(m<this.tm.concurrency-1?B=h:B=e-m*h,B==0)continue;let v=[{cmd:"ALLOCSET",var:0,buff:t.slice(m*h*a,m*h*a+B*a)},{cmd:"ALLOC",var:1,len:o*B},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:a},{val:B},{var:1},{val:o}]},{cmd:"GET",out:0,var:1,len:o*B}];d.push(this.tm.queueAction(v))}let b=await Promise.all(d),l;t instanceof pn?l=new pn(e*o):l=new Uint8Array(e*o);let s=0;for(let m=0;m<b.length;m++)l.set(b[m][0],s),s+=b[m][0].byteLength;return n?Pc(l,o):l}},Rc=class{constructor(t,n,a){this.tm=t,this.prefix=n,this.F=a,this.type="F2",this.m=a.m*2,this.n8=this.F.n8*2,this.n32=this.F.n32*2,this.n64=this.F.n64*2,this.pOp1=t.alloc(a.n8*2),this.pOp2=t.alloc(a.n8*2),this.pOp3=t.alloc(a.n8*2),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){return this.op2("_add",t,n)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}mul1(t,n){return this.op2("_mul1",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=No(wn(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,n){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&t.length==2){let a=this.F.e(t[0],n),o=this.F.e(t[1],n),e=new Uint8Array(this.F.n8*2);return e.set(a),e.set(o,this.F.n8*2),e}else throw new Error("invalid F2")}toString(t,n){let a=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8),n);return`[${a}, ${o}]`}fromRng(t){let n=this.F.fromRng(t),a=this.F.fromRng(t),o=new Uint8Array(this.F.n8*2);return o.set(n),o.set(a,this.F.n8),o}random(){return this.fromRng(zr())}toObject(t){let n=this.F.toObject(t.slice(0,this.F.n8)),a=this.F.toObject(t.slice(this.F.n8,this.F.n8*2));return[n,a]}fromObject(t){let n=new Uint8Array(this.F.n8*2),a=this.F.fromObject(t[0]),o=this.F.fromObject(t[1]);return n.set(a),n.set(o,this.F.n8),n}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}},Er=class{constructor(t,n,a){this.tm=t,this.prefix=n,this.F=a,this.type="F3",this.m=a.m*3,this.n8=this.F.n8*3,this.n32=this.F.n32*3,this.n64=this.F.n64*3,this.pOp1=t.alloc(a.n8*3),this.pOp2=t.alloc(a.n8*3),this.pOp3=t.alloc(a.n8*3),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}add(t,n){return this.op2("_add",t,n)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=No(wn(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,n){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&t.length==3){let a=this.F.e(t[0],n),o=this.F.e(t[1],n),e=this.F.e(t[2],n),h=new Uint8Array(this.F.n8*3);return h.set(a),h.set(o,this.F.n8),h.set(e,this.F.n8*2),h}else throw new Error("invalid F3")}toString(t,n){let a=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8,this.F.n8*2),n),e=this.F.toString(t.slice(this.F.n8*2),n);return`[${a}, ${o}, ${e}]`}fromRng(t){let n=this.F.fromRng(t),a=this.F.fromRng(t),o=this.F.fromRng(t),e=new Uint8Array(this.F.n8*3);return e.set(n),e.set(a,this.F.n8),e.set(o,this.F.n8*2),e}random(){return this.fromRng(zr())}toObject(t){let n=this.F.toObject(t.slice(0,this.F.n8)),a=this.F.toObject(t.slice(this.F.n8,this.F.n8*2)),o=this.F.toObject(t.slice(this.F.n8*2,this.F.n8*3));return[n,a,o]}fromObject(t){let n=new Uint8Array(this.F.n8*3),a=this.F.fromObject(t[0]),o=this.F.fromObject(t[1]),e=this.F.fromObject(t[2]);return n.set(a),n.set(o,this.F.n8),n.set(e,this.F.n8*2),n}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,this.F.n8*2)}c3(t){return t.slice(this.F.n8*2)}},zc=class{constructor(t,n,a,o,e,h){this.tm=t,this.prefix=n,this.F=a,this.pOp1=t.alloc(a.n8*3),this.pOp2=t.alloc(a.n8*3),this.pOp3=t.alloc(a.n8*3),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,a.n8*3),this.tm.instance.exports[n+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,a.n8*2),this.one=this.tm.getBuff(o,a.n8*3),this.g=this.one,this.oneAffine=this.tm.getBuff(o,a.n8*2),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(e,a.n8),h&&(this.cofactor=No(h)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=Xa(t,n+"_batchLEMtoC",a.n8*2,a.n8),this.batchLEMtoU=Xa(t,n+"_batchLEMtoU",a.n8*2,a.n8*2),this.batchCtoLEM=Xa(t,n+"_batchCtoLEM",a.n8,a.n8*2),this.batchUtoLEM=Xa(t,n+"_batchUtoLEM",a.n8*2,a.n8*2),this.batchToJacobian=Xa(t,n+"_batchToJacobian",a.n8*2,a.n8*3),this.batchToAffine=Xa(t,n+"_batchToAffine",a.n8*3,a.n8*2)}op2(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}op2bool(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}op1Affine(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*2)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2("_add",t,n);if(n.byteLength==this.F.n8*2)return this.op2("_addMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2("_addMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2("_addAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}sub(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2("_sub",t,n);if(n.byteLength==this.F.n8*2)return this.op2("_subMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2("_subMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2("_subAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}neg(t){if(t.byteLength==this.F.n8*3)return this.op1("_neg",t);if(t.byteLength==this.F.n8*2)return this.op1Affine("_negAffine",t);throw new Error("invalid point size")}double(t){if(t.byteLength==this.F.n8*3)return this.op1("_double",t);if(t.byteLength==this.F.n8*2)return this.op1("_doubleAffine",t);throw new Error("invalid point size")}isZero(t){if(t.byteLength==this.F.n8*3)return this.op1Bool("_isZero",t);if(t.byteLength==this.F.n8*2)return this.op1Bool("_isZeroAffine",t);throw new Error("invalid point size")}timesScalar(t,n){n instanceof Uint8Array||(n=No(wn(n)));let a;if(t.byteLength==this.F.n8*3)a=this.prefix+"_timesScalar";else if(t.byteLength==this.F.n8*2)a=this.prefix+"_timesScalarAffine";else throw new Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[a](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}timesFr(t,n){let a;if(t.byteLength==this.F.n8*3)a=this.prefix+"_timesFr";else if(t.byteLength==this.F.n8*2)a=this.prefix+"_timesFrAffine";else throw new Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[a](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}eq(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2bool("_eq",t,n);if(n.byteLength==this.F.n8*2)return this.op2bool("_eqMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2bool("_eqMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2bool("_eqAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}toAffine(t){if(t.byteLength==this.F.n8*3)return this.op1Affine("_toAffine",t);if(t.byteLength==this.F.n8*2)return t;throw new Error("invalid point size")}toJacobian(t){if(t.byteLength==this.F.n8*3)return t;if(t.byteLength==this.F.n8*2)return this.op1("_toJacobian",t);throw new Error("invalid point size")}toRprUncompressed(t,n,a){if(this.tm.setBuff(this.pOp1,a),a.byteLength==this.F.n8*3)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(a.byteLength!=this.F.n8*2)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);let o=this.tm.getBuff(this.pOp1,this.F.n8*2);t.set(o,n)}fromRprUncompressed(t,n){let a=t.slice(n,n+this.F.n8*2);return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,this.F.n8*2)}toRprCompressed(t,n,a){if(this.tm.setBuff(this.pOp1,a),a.byteLength==this.F.n8*3)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(a.byteLength!=this.F.n8*2)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);let o=this.tm.getBuff(this.pOp1,this.F.n8);t.set(o,n)}fromRprCompressed(t,n){let a=t.slice(n,n+this.F.n8);return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,this.F.n8*2)}toUncompressed(t){let n=new Uint8Array(this.F.n8*2);return this.toRprUncompressed(n,0,t),n}toRprLEM(t,n,a){if(a.byteLength==this.F.n8*2){t.set(a,n);return}else if(a.byteLength==this.F.n8*3){this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);let o=this.tm.getBuff(this.pOp1,this.F.n8*2);t.set(o,n)}else throw new Error("invalid point size")}fromRprLEM(t,n){return n=n||0,t.slice(n,n+this.F.n8*2)}toString(t,n){if(t.byteLength==this.F.n8*3){let a=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8,this.F.n8*2),n),e=this.F.toString(t.slice(this.F.n8*2),n);return`[ ${a}, ${o}, ${e} ]`}else if(t.byteLength==this.F.n8*2){let a=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8),n);return`[ ${a}, ${o} ]`}else throw new Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;let n=this.F,a=this.toAffine(t),o=a.slice(0,this.F.n8),e=a.slice(this.F.n8,this.F.n8*2),h=n.add(n.mul(n.square(o),o),this.b),d=n.square(e);return n.eq(h,d)}fromRng(t){let n=this.F,a=[],o,e;do a[0]=n.fromRng(t),o=t.nextBool(),e=n.add(n.mul(n.square(a[0]),a[0]),this.b);while(!n.isSquare(e));a[1]=n.sqrt(e);let h=n.isNegative(a[1]);o^h&&(a[1]=n.neg(a[1]));let d=new Uint8Array(this.F.n8*2);return d.set(a[0]),d.set(a[1],this.F.n8),this.cofactor&&(d=this.timesScalar(d,this.cofactor)),d}toObject(t){if(this.isZero(t))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];let n=this.F.toObject(t.slice(0,this.F.n8)),a=this.F.toObject(t.slice(this.F.n8,this.F.n8*2)),o;return t.byteLength==this.F.n8*3?o=this.F.toObject(t.slice(this.F.n8*2,this.F.n8*3)):o=this.F.toObject(this.F.one),[n,a,o]}fromObject(t){let n=this.F.fromObject(t[0]),a=this.F.fromObject(t[1]),o;if(t.length==3?o=this.F.fromObject(t[2]):o=this.F.one,this.F.isZero(o,this.F.one))return this.zeroAffine;if(this.F.eq(o,this.F.one)){let e=new Uint8Array(this.F.n8*2);return e.set(n),e.set(a,this.F.n8),e}else{let e=new Uint8Array(this.F.n8*3);return e.set(n),e.set(a,this.F.n8),e.set(o,this.F.n8*2),e}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){return this.toAffine(t).slice(0,this.F.n8)}y(t){return this.toAffine(t).slice(this.F.n8)}};_r=25,Tc=class{constructor(){this.promise=new Promise((t,n)=>{this.reject=n,this.resolve=t})}};B3=`(function thread(self) {
    const MAXMEM = 32767;
    let instance;
    let memory;

    if (self) {
        self.onmessage = function(e) {
            let data;
            if (e.data) {
                data = e.data;
            } else {
                data = e;
            }

            if (data[0].cmd == "INIT") {
                init(data[0]).then(function() {
                    self.postMessage(data.result);
                });
            } else if (data[0].cmd == "TERMINATE") {
                self.close();
            } else {
                const res = runTask(data);
                self.postMessage(res);
            }
        };
    }

    async function init(data) {
        const code = new Uint8Array(data.code);
        const wasmModule = await WebAssembly.compile(code);
        memory = new WebAssembly.Memory({initial:data.init, maximum: MAXMEM});

        instance = await WebAssembly.instantiate(wasmModule, {
            env: {
                "memory": memory
            }
        });
    }



    function alloc(length) {
        const u32 = new Uint32Array(memory.buffer, 0, 1);
        while (u32[0] & 3) u32[0]++;  // Return always aligned pointers
        const res = u32[0];
        u32[0] += length;
        if (u32[0] + length > memory.buffer.byteLength) {
            const currentPages = memory.buffer.byteLength / 0x10000;
            let requiredPages = Math.floor((u32[0] + length) / 0x10000)+1;
            if (requiredPages>MAXMEM) requiredPages=MAXMEM;
            memory.grow(requiredPages-currentPages);
        }
        return res;
    }

    function allocBuffer(buffer) {
        const p = alloc(buffer.byteLength);
        setBuffer(p, buffer);
        return p;
    }

    function getBuffer(pointer, length) {
        const u8 = new Uint8Array(memory.buffer);
        return new Uint8Array(u8.buffer, u8.byteOffset + pointer, length);
    }

    function setBuffer(pointer, buffer) {
        const u8 = new Uint8Array(memory.buffer);
        u8.set(new Uint8Array(buffer), pointer);
    }

    function runTask(task) {
        if (task[0].cmd == "INIT") {
            return init(task[0]);
        }
        const ctx = {
            vars: [],
            out: []
        };
        const u32a = new Uint32Array(memory.buffer, 0, 1);
        const oldAlloc = u32a[0];
        for (let i=0; i<task.length; i++) {
            switch (task[i].cmd) {
            case "ALLOCSET":
                ctx.vars[task[i].var] = allocBuffer(task[i].buff);
                break;
            case "ALLOC":
                ctx.vars[task[i].var] = alloc(task[i].len);
                break;
            case "SET":
                setBuffer(ctx.vars[task[i].var], task[i].buff);
                break;
            case "CALL": {
                const params = [];
                for (let j=0; j<task[i].params.length; j++) {
                    const p = task[i].params[j];
                    if (typeof p.var !== "undefined") {
                        params.push(ctx.vars[p.var] + (p.offset || 0));
                    } else if (typeof p.val != "undefined") {
                        params.push(p.val);
                    }
                }
                instance.exports[task[i].fnName](...params);
                break;
            }
            case "GET":
                ctx.out[task[i].out] = getBuffer(ctx.vars[task[i].var], task[i].len).slice();
                break;
            default:
                throw new Error("Invalid cmd");
            }
        }
        const u32b = new Uint32Array(memory.buffer, 0, 1);
        u32b[0] = oldAlloc;
        return ctx.out;
    }


    return runTask;
})(self)`;if(globalThis?.Blob){let c=new TextEncoder().encode(B3),t=new Blob([c],{type:"application/javascript"});vr=URL.createObjectURL(t)}else vr="data:application/javascript;base64,"+globalThis.btoa(B3);Sr=class{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(this.oldPFree!=0)throw new Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(this.oldPFree==0)throw new Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,n,a,o){if(this.working[t])throw new Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=o||new Tc,this.workers[t].postMessage(n,a),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(this.working[t]==!1){let n=this.actionQueue.shift();this.postAction(t,n.data,n.transfers,n.deferred)}}queueAction(t,n){let a=new Tc;if(this.singleThread){let o=this.taskManager(t);a.resolve(o)}else this.actionQueue.push({data:t,transfers:n,deferred:a}),this.processWorks();return a.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){let n=this.alloc(t.byteLength);return this.setBuff(n,t),n}getBuff(t,n){return this.u8.slice(t,t+n)}setBuff(t,n){this.u8.set(new Uint8Array(n),t)}alloc(t){for(;this.u32[0]&3;)this.u32[0]++;let n=this.u32[0];return this.u32[0]+=t,n}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);await _m(200)}};x3=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];Ir=class{constructor(t){this.func=t,this.functionName=t.functionName,this.module=t.module}setLocal(t,n){let a=this.func.localIdxByName[t];if(a===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...n,33,...Xt(a)]}teeLocal(t,n){let a=this.func.localIdxByName[t];if(a===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...n,34,...Xt(a)]}getLocal(t){let n=this.func.localIdxByName[t];if(n===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[32,...Xt(n)]}i64_load8_s(t,n,a){let o=n||0,e=a===void 0?0:a;return[...t,48,e,...Xt(o)]}i64_load8_u(t,n,a){let o=n||0,e=a===void 0?0:a;return[...t,49,e,...Xt(o)]}i64_load16_s(t,n,a){let o=n||0,e=a===void 0?1:a;return[...t,50,e,...Xt(o)]}i64_load16_u(t,n,a){let o=n||0,e=a===void 0?1:a;return[...t,51,e,...Xt(o)]}i64_load32_s(t,n,a){let o=n||0,e=a===void 0?2:a;return[...t,52,e,...Xt(o)]}i64_load32_u(t,n,a){let o=n||0,e=a===void 0?2:a;return[...t,53,e,...Xt(o)]}i64_load(t,n,a){let o=n||0,e=a===void 0?3:a;return[...t,41,e,...Xt(o)]}i64_store(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=3,d=n):Array.isArray(a)?(e=n,h=3,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,55,h,...Xt(e)]}i64_store32(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=2,d=n):Array.isArray(a)?(e=n,h=2,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,62,h,...Xt(e)]}i64_store16(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=1,d=n):Array.isArray(a)?(e=n,h=1,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,61,h,...Xt(e)]}i64_store8(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=0,d=n):Array.isArray(a)?(e=n,h=0,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,60,h,...Xt(e)]}i32_load8_s(t,n,a){let o=n||0,e=a===void 0?0:a;return[...t,44,e,...Xt(o)]}i32_load8_u(t,n,a){let o=n||0,e=a===void 0?0:a;return[...t,45,e,...Xt(o)]}i32_load16_s(t,n,a){let o=n||0,e=a===void 0?1:a;return[...t,46,e,...Xt(o)]}i32_load16_u(t,n,a){let o=n||0,e=a===void 0?1:a;return[...t,47,e,...Xt(o)]}i32_load(t,n,a){let o=n||0,e=a===void 0?2:a;return[...t,40,e,...Xt(o)]}i32_store(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=2,d=n):Array.isArray(a)?(e=n,h=2,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,54,h,...Xt(e)]}i32_store16(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=1,d=n):Array.isArray(a)?(e=n,h=1,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,59,h,...Xt(e)]}i32_store8(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=0,d=n):Array.isArray(a)?(e=n,h=0,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,58,h,...Xt(e)]}call(t,...n){let a=this.module.functionIdxByName[t];if(a===void 0)throw new Error(`Function not defined: Function: ${t}`);return[...[].concat(...n),16,...Xt(a)]}call_indirect(t,...n){return[...[].concat(...n),...t,17,0,0]}if(t,n,a){return a?[...t,4,64,...n,5,...a,11]:[...t,4,64,...n,11]}block(t){return[2,64,...t,11]}loop(...t){return[3,64,...[].concat(...t),11]}br_if(t,n){return[...n,13,...Xt(t)]}br(t){return[12,...Xt(t)]}ret(t){return[...t,15]}drop(t){return[...t,26]}i64_const(t){return[66,...bm(t)]}i32_const(t){return[65,...qr(t)]}i64_eqz(t){return[...t,80]}i64_eq(t,n){return[...t,...n,81]}i64_ne(t,n){return[...t,...n,82]}i64_lt_s(t,n){return[...t,...n,83]}i64_lt_u(t,n){return[...t,...n,84]}i64_gt_s(t,n){return[...t,...n,85]}i64_gt_u(t,n){return[...t,...n,86]}i64_le_s(t,n){return[...t,...n,87]}i64_le_u(t,n){return[...t,...n,88]}i64_ge_s(t,n){return[...t,...n,89]}i64_ge_u(t,n){return[...t,...n,90]}i64_add(t,n){return[...t,...n,124]}i64_sub(t,n){return[...t,...n,125]}i64_mul(t,n){return[...t,...n,126]}i64_div_s(t,n){return[...t,...n,127]}i64_div_u(t,n){return[...t,...n,128]}i64_rem_s(t,n){return[...t,...n,129]}i64_rem_u(t,n){return[...t,...n,130]}i64_and(t,n){return[...t,...n,131]}i64_or(t,n){return[...t,...n,132]}i64_xor(t,n){return[...t,...n,133]}i64_shl(t,n){return[...t,...n,134]}i64_shr_s(t,n){return[...t,...n,135]}i64_shr_u(t,n){return[...t,...n,136]}i64_extend_i32_s(t){return[...t,172]}i64_extend_i32_u(t){return[...t,173]}i64_clz(t){return[...t,121]}i64_ctz(t){return[...t,122]}i32_eqz(t){return[...t,69]}i32_eq(t,n){return[...t,...n,70]}i32_ne(t,n){return[...t,...n,71]}i32_lt_s(t,n){return[...t,...n,72]}i32_lt_u(t,n){return[...t,...n,73]}i32_gt_s(t,n){return[...t,...n,74]}i32_gt_u(t,n){return[...t,...n,75]}i32_le_s(t,n){return[...t,...n,76]}i32_le_u(t,n){return[...t,...n,77]}i32_ge_s(t,n){return[...t,...n,78]}i32_ge_u(t,n){return[...t,...n,79]}i32_add(t,n){return[...t,...n,106]}i32_sub(t,n){return[...t,...n,107]}i32_mul(t,n){return[...t,...n,108]}i32_div_s(t,n){return[...t,...n,109]}i32_div_u(t,n){return[...t,...n,110]}i32_rem_s(t,n){return[...t,...n,111]}i32_rem_u(t,n){return[...t,...n,112]}i32_and(t,n){return[...t,...n,113]}i32_or(t,n){return[...t,...n,114]}i32_xor(t,n){return[...t,...n,115]}i32_shl(t,n){return[...t,...n,116]}i32_shr_s(t,n){return[...t,...n,117]}i32_shr_u(t,n){return[...t,...n,118]}i32_rotl(t,n){return[...t,...n,119]}i32_rotr(t,n){return[...t,...n,120]}i32_wrap_i64(t){return[...t,167]}i32_clz(t){return[...t,103]}i32_ctz(t){return[...t,104]}unreachable(){return[0]}current_memory(){return[63,0]}comment(){return[]}},Lr={i32:127,i64:126,f32:125,f64:124,anyfunc:112,func:96,emptyblock:64},Gc=class{constructor(t,n,a,o,e){if(a=="import")this.fnType="import",this.moduleName=o,this.fieldName=e;else if(a=="internal")this.fnType="internal";else throw new Error("Invalid function fnType: "+a);this.module=t,this.fnName=n,this.params=[],this.locals=[],this.localIdxByName={},this.code=[],this.returnType=null,this.nextLocal=0}addParam(t,n){if(this.localIdxByName[t])throw new Error(`param already exists. Function: ${this.fnName}, Param: ${t} `);let a=this.nextLocal++;this.localIdxByName[t]=a,this.params.push({type:n})}addLocal(t,n,a){let o=a||1;if(this.localIdxByName[t])throw new Error(`local already exists. Function: ${this.fnName}, Param: ${t} `);let e=this.nextLocal++;this.localIdxByName[t]=e,this.locals.push({type:n,length:o})}setReturnType(t){if(this.returnType)throw new Error(`returnType already defined. Function: ${this.fnName}`);this.returnType=t}getSignature(){let t=[...Xt(this.params.length),...this.params.map(a=>Lr[a.type])],n=this.returnType?[1,Lr[this.returnType]]:[0];return[96,...t,...n]}getBody(){let t=this.locals.map(a=>[...Xt(a.length),Lr[a.type]]),n=[...Xt(this.locals.length),...[].concat(...t),...this.code,11];return[...Xt(n.length),...n]}addCode(...t){this.code.push(...[].concat(...t))}getCodeBuilder(){return new Ir(this)}},kc=class{constructor(){this.functions=[],this.functionIdxByName={},this.nImportFunctions=0,this.nInternalFunctions=0,this.memory={pagesSize:1,moduleName:"env",fieldName:"memory"},this.free=8,this.datas=[],this.modules={},this.exports=[],this.functionsTable=[]}build(){return this._setSignatures(),new Uint8Array([...gr(1836278016),...gr(1),...this._buildType(),...this._buildImport(),...this._buildFunctionDeclarations(),...this._buildFunctionsTable(),...this._buildExports(),...this._buildElements(),...this._buildCode(),...this._buildData()])}addFunction(t){if(typeof this.functionIdxByName[t]<"u")throw new Error(`Function already defined: ${t}`);let n=this.functions.length;return this.functionIdxByName[t]=n,this.functions.push(new Gc(this,t,"internal")),this.nInternalFunctions++,this.functions[n]}addIimportFunction(t,n,a){if(typeof this.functionIdxByName[t]<"u")throw new Error(`Function already defined: ${t}`);if(this.functions.length>0&&this.functions[this.functions.length-1].type=="internal")throw new Error(`Import functions must be declared before internal: ${t}`);let o=a||t,e=this.functions.length;return this.functionIdxByName[t]=e,this.functions.push(new Gc(this,t,"import",n,o)),this.nImportFunctions++,this.functions[e]}setMemory(t,n,a){this.memory={pagesSize:t,moduleName:n||"env",fieldName:a||"memory"}}exportFunction(t,n){let a=n||t;if(typeof this.functionIdxByName[t]>"u")throw new Error(`Function not defined: ${t}`);let o=this.functionIdxByName[t];a!=t&&(this.functionIdxByName[a]=o),this.exports.push({exportName:a,idx:o})}addFunctionToTable(t){let n=this.functionIdxByName[t];this.functionsTable.push(n)}addData(t,n){this.datas.push({offset:t,bytes:n})}alloc(t,n){let a,o;(Array.isArray(t)||ArrayBuffer.isView(t))&&typeof n>"u"?(a=t.length,o=t):(a=t,o=n),a=(a-1>>3)+1<<3;let e=this.free;return this.free+=a,o&&this.addData(e,o),e}allocString(t){let a=new globalThis.TextEncoder().encode(t);return this.alloc([...a,0])}_setSignatures(){this.signatures=[];let t={};if(this.functionsTable.length>0){let n=this.functions[this.functionsTable[0]].getSignature(),a="s_"+E3(n);t[a]=0,this.signatures.push(n)}for(let n=0;n<this.functions.length;n++){let a=this.functions[n].getSignature(),o="s_"+E3(a);typeof t[o]>"u"&&(t[o]=this.signatures.length,this.signatures.push(a)),this.functions[n].signatureIdx=t[o]}}_buildSection(t,n){return[t,...Xt(n.length),...n]}_buildType(){return this._buildSection(1,[...Xt(this.signatures.length),...[].concat(...this.signatures)])}_buildImport(){let t=[];t.push([...ki(this.memory.moduleName),...ki(this.memory.fieldName),2,0,...Xt(this.memory.pagesSize)]);for(let n=0;n<this.nImportFunctions;n++)t.push([...ki(this.functions[n].moduleName),...ki(this.functions[n].fieldName),0,...Xt(this.functions[n].signatureIdx)]);return this._buildSection(2,Xt(t.length).concat(...t))}_buildFunctionDeclarations(){let t=[];for(let n=this.nImportFunctions;n<this.nImportFunctions+this.nInternalFunctions;n++)t.push(...Xt(this.functions[n].signatureIdx));return this._buildSection(3,[...Xt(t.length),...t])}_buildFunctionsTable(){return this.functionsTable.length==0?[]:this._buildSection(4,[...Xt(1),112,0,...Xt(this.functionsTable.length)])}_buildElements(){if(this.functionsTable.length==0)return[];let t=[];for(let n=0;n<this.functionsTable.length;n++)t.push(...Xt(this.functionsTable[n]));return this._buildSection(9,[...Xt(1),...Xt(0),65,...qr(0),11,...Xt(this.functionsTable.length),...t])}_buildExports(){let t=[];for(let n=0;n<this.exports.length;n++)t.push([...ki(this.exports[n].exportName),0,...Xt(this.exports[n].idx)]);return this._buildSection(7,Xt(t.length).concat(...t))}_buildCode(){let t=[];for(let n=this.nImportFunctions;n<this.nImportFunctions+this.nInternalFunctions;n++)t.push(this.functions[n].getBody());return this._buildSection(10,Xt(t.length).concat(...t))}_buildData(){let t=[];t.push([0,65,0,11,4,...gr(this.free)]);for(let n=0;n<this.datas.length;n++)t.push([0,65,...qr(this.datas[n].offset),11,...Xt(this.datas[n].bytes.length),...this.datas[n].bytes]);return this._buildSection(11,Xt(t.length).concat(...t))}};globalThis.curve_bn128=null;globalThis.curve_bls12381=null;mm=wn("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),ym=wn("21888242871839275222246405745257275088548364400416034343698204186575808495617"),wm=wn("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),Fm=wn("21888242871839275222246405745257275088696311157297823662689037894645226208583");Am=eb,Em=dm});var uh=Sn(Vr=>{"use strict";Object.defineProperty(Vr,"__esModule",{value:!0});var ea=(lh(),Ee(sh));function rh(c){let t=[];return n(t,c),t;function n(a,o){if(Array.isArray(o))for(let e=0;e<o.length;e++)n(a,o[e]);else a.push(o)}}function vm(c,t){let n=BigInt(c)%t;return n<0&&(n+=t),n}function dh(c){let t=BigInt(2)**BigInt(64),n=BigInt("0xCBF29CE484222325");for(let e=0;e<c.length;e++)n^=BigInt(c[e].charCodeAt(0)),n*=BigInt(1099511628211),n%=t;let a=n.toString(16),o=16-a.length;return a="0".repeat(o).concat(a),a}function Sm(c,t){let n=[],a=BigInt(c),o=BigInt(4294967296);for(;a;)n.unshift(Number(a%o)),a=a/o;if(t){let e=t-n.length;for(;e>0;)n.unshift(0),e--}return n}async function qm(c,t){let n,a,o;t=t||{};let e=1,h=0,d=0,b=!1;if(c instanceof WebAssembly.Instance)n=c,b=!0;else{let B=32767;if(t.memorySize&&(B=parseInt(t.memorySize),B<0))throw new Error("Invalid memory size");let p=!1;for(;!p;)try{o=new WebAssembly.Memory({initial:B}),p=!0}catch(S){if(B<=1)throw S;console.warn("Could not allocate "+B*1024*64+" bytes. This may cause severe instability. Trying with "+B*1024*64/2+" bytes"),B=Math.floor(B/2)}let v=await WebAssembly.compile(c),M="",x="";n=await WebAssembly.instantiate(v,{env:{memory:o},runtime:{printDebug:function(S){console.log("printDebug:",S)},exceptionHandler:function(S){let w;throw S===1?w="Signal not found. ":S===2?w="Too many signals set. ":S===3?w="Signal already set. ":S===4?w="Assert Failed. ":S===5?w="Not enough memory. ":S===6?w="Input signal array access exceeds the size. ":w="Unknown error. ",console.error("ERROR: ",S,M),new Error(w+M)},printErrorMessage:function(){M+=s()+`
`},writeBufferMessage:function(){let S=s();S===`
`?(console.log(x),x=""):(x!==""&&(x+=" "),x+=S)},showSharedRWMemory:function(){let S=n.exports.getFieldNumLen32(),w=new Uint32Array(S);for(let k=0;k<S;k++)w[S-1-k]=n.exports.readSharedRWMemory(k);if(e>=2&&(h>=1||d>=7)){x!==""&&(x+=" ");let k=ea.Scalar.fromArray(w,4294967296).toString();x+=k}else console.log(ea.Scalar.fromArray(w,4294967296))},error:function(S,w,k,O,W,F){let u;throw S===7?u=m(w)+" "+a.getFr(O).toString()+" != "+a.getFr(W).toString()+" "+m(F):S===9?u=m(w)+" "+a.getFr(O).toString()+" "+m(W):S===5&&t.sym?u=m(w)+" "+t.sym.labelIdx2Name[W]:u=m(w)+" "+k+" "+O+" "+W+" "+F,console.log("ERROR: ",S,u),new Error(u)},log:function(S){console.log(a.getFr(S).toString())},logGetSignal:function(S,w){t.logGetSignal&&t.logGetSignal(S,a.getFr(w))},logSetSignal:function(S,w){t.logSetSignal&&t.logSetSignal(S,a.getFr(w))},logStartComponent:function(S){t.logStartComponent&&t.logStartComponent(S)},logFinishComponent:function(S){t.logFinishComponent&&t.logFinishComponent(S)}}})}typeof n.exports.getVersion=="function"&&(e=n.exports.getVersion()),typeof n.exports.getMinorVersion=="function"&&(h=n.exports.getMinorVersion()),typeof n.exports.getPatchVersion=="function"&&(d=n.exports.getPatchVersion());let l=t&&(t.sanityCheck||t.logGetSignal||t.logSetSignal||t.logStartComponent||t.logFinishComponent);if(e===2)a=new jr(n,l);else if(e===1){if(b)throw new Error("Loading code from WebAssembly instance is not supported for circom version 1");a=new Zr(o,n,l)}else throw new Error(`Unsupported circom version: ${e}`);return a;function s(){let B="",p=n.exports.getMessageChar();for(;p!==0;)B+=String.fromCharCode(p),p=n.exports.getMessageChar();return B}function m(B){let p=new Uint8Array(o.buffer),v=[];for(let M=0;p[B+M]>0;M++)v.push(p[B+M]);return String.fromCharCode.apply(null,v)}}var Zr=class{constructor(t,n,a){this.memory=t,this.i32=new Uint32Array(t.buffer),this.instance=n,this.n32=(this.instance.exports.getFrLen()>>2)-2;let o=this.instance.exports.getPRawPrime(),e=new Array(this.n32);for(let h=0;h<this.n32;h++)e[this.n32-1-h]=this.i32[(o>>2)+h];this.prime=ea.Scalar.fromArray(e,4294967296),this.Fr=new ea.F1Field(this.prime),this.mask32=ea.Scalar.fromString("FFFFFFFF",16),this.NVars=this.instance.exports.getNVars(),this.n64=Math.floor((this.Fr.bitLength-1)/64)+1,this.R=this.Fr.e(ea.Scalar.shiftLeft(1,this.n64*64)),this.RInv=this.Fr.inv(this.R),this.sanityCheck=a}circom_version(){return 1}async _doCalculateWitness(t,n){this.instance.exports.init(this.sanityCheck||n?1:0);let a=this.allocInt(),o=this.allocFr();Object.keys(t).forEach(h=>{let d=dh(h),b=parseInt(d.slice(0,8),16),l=parseInt(d.slice(8,16),16);try{this.instance.exports.getSignalOffset32(a,0,b,l)}catch{throw new Error(`Signal ${h} is not an input of the circuit.`)}let s=this.getInt(a),m=rh(t[h]);for(let B=0;B<m.length;B++)this.setFr(o,m[B]),this.instance.exports.setSignal(0,0,s+B,o)})}async calculateWitness(t,n){let a=this,o=a.i32[0],e=[];await a._doCalculateWitness(t,n);for(let h=0;h<a.NVars;h++){let d=a.instance.exports.getPWitness(h);e.push(a.getFr(d))}return a.i32[0]=o,e}async calculateBinWitness(t,n){let a=this,o=a.i32[0];await a._doCalculateWitness(t,n);let e=a.instance.exports.getWitnessBuffer();a.i32[0]=o;let h=a.memory.buffer.slice(e,e+a.NVars*a.n64*8);return new Uint8Array(h)}allocInt(){let t=this.i32[0];return this.i32[0]=t+8,t}allocFr(){let t=this.i32[0];return this.i32[0]=t+this.n32*4+8,t}getInt(t){return this.i32[t>>2]}setInt(t,n){this.i32[t>>2]=n}getFr(t){let n=this,a=t>>2;if(n.i32[a+1]&2147483648){let e=new Array(n.n32);for(let d=0;d<n.n32;d++)e[n.n32-1-d]=n.i32[a+2+d];let h=n.Fr.e(ea.Scalar.fromArray(e,4294967296));return n.i32[a+1]&1073741824?o(h):h}else return n.i32[a]&2147483648?n.Fr.e(n.i32[a]-4294967296):n.Fr.e(n.i32[a]);function o(e){return n.Fr.mul(n.RInv,e)}}setFr(t,n){let a=this;n=a.Fr.e(n);let o=a.Fr.neg(a.Fr.e("80000000",16)),e=a.Fr.e("7FFFFFFF",16);if(a.Fr.geq(n,o)&&a.Fr.leq(n,e)){let d;a.Fr.geq(n,a.Fr.zero)?d=ea.Scalar.toNumber(n):(d=ea.Scalar.toNumber(a.Fr.sub(n,o)),d=d-2147483648,d=4294967296+d),a.i32[t>>2]=d,a.i32[(t>>2)+1]=0;return}a.i32[t>>2]=0,a.i32[(t>>2)+1]=2147483648;let h=ea.Scalar.toArray(n,4294967296);for(let d=0;d<a.n32;d++){let b=h.length-1-d;b>=0?a.i32[(t>>2)+2+d]=h[b]:a.i32[(t>>2)+2+d]=0}}},jr=class{constructor(t,n){this.instance=t,this.version=this.instance.exports.getVersion(),this.n32=this.instance.exports.getFieldNumLen32(),this.instance.exports.getRawPrime();let a=new Uint32Array(this.n32);for(let o=0;o<this.n32;o++)a[this.n32-1-o]=this.instance.exports.readSharedRWMemory(o);this.prime=ea.Scalar.fromArray(a,4294967296),this.witnessSize=this.instance.exports.getWitnessSize(),this.sanityCheck=n}circom_version(){return this.instance.exports.getVersion()}async _doCalculateWitness(t,n){this.instance.exports.init(this.sanityCheck||n?1:0);let a=Object.keys(t),o=0;if(a.forEach(e=>{let h=dh(e),d=parseInt(h.slice(0,8),16),b=parseInt(h.slice(8,16),16),l=rh(t[e]);if(typeof this.instance.exports.getInputSignalSize=="function"){let s=this.instance.exports.getInputSignalSize(d,b);if(s<0)throw new Error(`Signal ${e} not found
`);if(l.length<s)throw new Error(`Not enough values for input signal ${e}
`);if(l.length>s)throw new Error(`Too many values for input signal ${e}
`)}for(let s=0;s<l.length;s++){let m=Sm(vm(l[s],this.prime),this.n32);for(let B=0;B<this.n32;B++)this.instance.exports.writeSharedRWMemory(B,m[this.n32-1-B]);try{this.instance.exports.setInputSignal(d,b,s),o++}catch(B){throw new Error(B)}}}),o<this.instance.exports.getInputSize())throw new Error(`Not all inputs have been set. Only ${o} out of ${this.instance.exports.getInputSize()}`)}async calculateWitness(t,n){let a=[];await this._doCalculateWitness(t,n);for(let o=0;o<this.witnessSize;o++){this.instance.exports.getWitness(o);let e=new Uint32Array(this.n32);for(let h=0;h<this.n32;h++)e[this.n32-1-h]=this.instance.exports.readSharedRWMemory(h);a.push(ea.Scalar.fromArray(e,4294967296))}return a}async calculateWTNSBin(t,n){let a=new Uint32Array(this.witnessSize*this.n32+this.n32+11),o=new Uint8Array(a.buffer);await this._doCalculateWitness(t,n),o[0]=119,o[1]=116,o[2]=110,o[3]=115,a[1]=2,a[2]=2,a[3]=1;let e=this.n32*4,d=(8+e).toString(16);a[4]=parseInt(d.slice(0,8),16),a[5]=parseInt(d.slice(8,16),16),a[6]=e,this.instance.exports.getRawPrime();let b=7;for(let m=0;m<this.n32;m++)a[b+m]=this.instance.exports.readSharedRWMemory(m);b+=this.n32,a[b]=this.witnessSize,b++,a[b]=2,b++;let s=(e*this.witnessSize).toString(16);a[b]=parseInt(s.slice(0,8),16),a[b+1]=parseInt(s.slice(8,16),16),b+=2;for(let m=0;m<this.witnessSize;m++){this.instance.exports.getWitness(m);for(let B=0;B<this.n32;B++)a[b+B]=this.instance.exports.readSharedRWMemory(B);b+=this.n32}return o}};Vr.WitnessCalculatorBuilder=qm});var _f={};Ae(_f,{BigBuffer:()=>bn,ChaCha:()=>Jc,EC:()=>ld,F1Field:()=>ed,F2Field:()=>cd,F3Field:()=>sd,PolField:()=>od,Scalar:()=>f8,ZqField:()=>ed,buildBls12381:()=>us,buildBn128:()=>ds,getCurveFromName:()=>h8,getCurveFromQ:()=>_8,getCurveFromR:()=>u8,utils:()=>g8});function ss(c,t){if(!t||t==10)return BigInt(c);if(t==16)return c.slice(0,2)=="0x"?BigInt(c):BigInt("0x"+c)}function Om(c,t){let n=BigInt(0);t=BigInt(t);for(let a=0;a<c.length;a++)n=n*t+BigInt(c[a]);return n}function ae(c){let t=c.toString(16);return(t.length-1)*4+Im[parseInt(t[0],16)]}function Oh(c){return BigInt(c)<BigInt(0)}function bd(c){return!c}function Xc(c,t){return BigInt(c)<<BigInt(t)}function Vo(c,t){return BigInt(c)>>BigInt(t)}function md(c){return(BigInt(c)&BigInt(1))==BigInt(1)}function Ph(c){let t=BigInt(c),n=[];for(;t;){if(t&BigInt(1)){let a=2-Number(t%BigInt(4));n.push(a),t=t-BigInt(a)}else n.push(0);t=t>>BigInt(1)}return n}function Mh(c){let t=BigInt(c),n=[];for(;t;)t&BigInt(1)?n.push(1):n.push(0),t=t>>BigInt(1);return n}function Rh(c){if(c>BigInt(Number.MAX_SAFE_INTEGER))throw new Error("Number too big");return Number(c)}function Rm(c,t){let n=[],a=BigInt(c);for(t=BigInt(t);a;)n.unshift(Number(a%t)),a=a/t;return n}function yd(c,t){return BigInt(c)+BigInt(t)}function za(c,t){return BigInt(c)-BigInt(t)}function zh(c){return-BigInt(c)}function Th(c,t){return BigInt(c)*BigInt(t)}function zm(c){return BigInt(c)*BigInt(c)}function oe(c,t){return BigInt(c)**BigInt(t)}function Tm(c,t){return BigInt(c)**BigInt(t)}function Gm(c){return BigInt(c)>=0?BigInt(c):-BigInt(c)}function Wo(c,t){return BigInt(c)/BigInt(t)}function xa(c,t){return BigInt(c)%BigInt(t)}function fa(c,t){return BigInt(c)==BigInt(t)}function km(c,t){return BigInt(c)!=BigInt(t)}function Um(c,t){return BigInt(c)<BigInt(t)}function Hc(c,t){return BigInt(c)>BigInt(t)}function Nm(c,t){return BigInt(c)<=BigInt(t)}function Gh(c,t){return BigInt(c)>=BigInt(t)}function wd(c,t){return BigInt(c)&BigInt(t)}function $m(c,t){return BigInt(c)|BigInt(t)}function Zm(c,t){return BigInt(c)^BigInt(t)}function jm(c,t){return BigInt(c)&&BigInt(t)}function Vm(c,t){return BigInt(c)||BigInt(t)}function Wm(c){return!BigInt(c)}function te(c,t,n,a){let o="0000000"+n.toString(16),e=new Uint32Array(c.buffer,c.byteOffset+t,a/4),h=((o.length-7)*4-1>>5)+1;for(let d=0;d<h;d++)e[d]=parseInt(o.substring(o.length-8*d-8,o.length-8*d),16);for(let d=h;d<e.length;d++)e[d]=0;for(let d=e.length*4;d<a;d++)c[d]=Rh(wd(Vo(n,d*8),255))}function kh(c,t,n,a){let o="0000000"+n.toString(16),e=new DataView(c.buffer,c.byteOffset+t,a),h=((o.length-7)*4-1>>5)+1;for(let d=0;d<h;d++)e.setUint32(a-d*4-4,parseInt(o.substring(o.length-8*d-8,o.length-8*d),16),!1);for(let d=0;d<a/4-h;d++)e[d]=0}function ne(c,t,n){n=n||c.byteLength,t=t||0;let a=new Uint32Array(c.buffer,c.byteOffset+t,n/4),o=new Array(n/4);return a.forEach((e,h)=>o[o.length-h-1]=e.toString(16).padStart(8,"0")),ss(o.join(""),16)}function Uh(c,t,n){n=n||c.byteLength,t=t||0;let a=new DataView(c.buffer,c.byteOffset+t,n),o=new Array(n/4);for(let e=0;e<n/4;e++)o[e]=a.getUint32(e*4,!1).toString(16).padStart(8,"0");return ss(o.join(""),16)}function ls(c,t){return c.toString(t)}function Qo(c){let t=new Uint8Array(Math.floor((ae(c)-1)/8)+1);return te(t,0,c,t.byteLength),t}function Ba(c){return((c&4294901760)!==0?(c&=4294901760,16):0)|((c&4278255360)!==0?(c&=4278255360,8):0)|((c&4042322160)!==0?(c&=4042322160,4):0)|((c&3435973836)!==0?(c&=3435973836,2):0)|(c&2863311530)!==0}function Lo(c,t,n,a,o){let e=1<<n;if(e==1)return[t[a]];if(e==2)return[c.F.add(t[a],t[a+o]),c.F.sub(t[a],t[a+o])];let h=e>>1,d=Lo(c,t,n-1,a,o*2),b=Lo(c,t,n-1,a+o,o*2),l=new Array(e);for(let s=0;s<h;s++)l[s]=c.F.add(d[s],c.F.mul(c.roots[n][s],b[s])),l[s+h]=c.F.sub(d[s],c.F.mul(c.roots[n][s],b[s]));return l}function Dc(c,t,n){let a=1<<n;if(a==1)return[t[0]];let o=a>>1,e=Dc(c,t.slice(0,o),n-1),h=Dc(c,t.slice(o),n-1),d=new Array(a);for(let b=0;b<o;b++)d[b]=c.F.add(e[b],c.F.mul(c.roots[n][b],h[b])),d[b+o]=c.F.sub(e[b],c.F.mul(c.roots[n][b],h[b]));return d}function Xm(c,t){let n=0,a=c;for(let o=0;o<t;o++)n<<=1,n=n|a&1,a>>=1;return n}function Hm(c,t){return(Ji[c>>>24]|Ji[c>>>16&255]<<8|Ji[c>>>8&255]<<16|Ji[c&255]<<24)>>>32-t}function _h(c,t){for(let n=0;n<c.length;n++){let a=Hm(n,t);if(a>n){let o=c[n];c[n]=c[a],c[a]=o}}}function Kc(c,t,n){let a;if(bd(n))return c.zero;let o=Ph(n);if(o[o.length-1]==1)a=t;else if(o[o.length-1]==-1)a=c.neg(t);else throw new Error("invlaud NAF");for(let e=o.length-2;e>=0;e--)a=c.double(a),o[e]==1?a=c.add(a,t):o[e]==-1&&(a=c.sub(a,t));return a}function Xo(c,t,n){if(bd(n))return c.one;let a=Mh(n);if(a.length==0)return c.one;let o=t;for(let e=a.length-2;e>=0;e--)o=c.square(o),a[e]&&(o=c.mul(o,t));return o}function $h(c){if(c.m%2==1)if(fa(xa(c.p,4),1))if(fa(xa(c.p,8),1))if(fa(xa(c.p,16),1))Dm(c);else if(fa(xa(c.p,16),9))Km(c);else throw new Error("Field withot sqrt");else if(fa(xa(c.p,8),5))Jm(c);else throw new Error("Field withot sqrt");else fa(xa(c.p,4),3)&&Ym(c);else{let t=xa(oe(c.p,c.m/2),4);t==1?t4(c):t==3?n4(c):a4(c)}}function Dm(c){for(c.sqrt_q=oe(c.p,c.m),c.sqrt_s=0,c.sqrt_t=za(c.sqrt_q,1);!md(c.sqrt_t);)c.sqrt_s=c.sqrt_s+1,c.sqrt_t=Wo(c.sqrt_t,2);let t=c.one;for(;c.eq(t,c.one);){let n=c.random();c.sqrt_z=c.pow(n,c.sqrt_t),t=c.pow(c.sqrt_z,2**(c.sqrt_s-1))}c.sqrt_tm1d2=Wo(za(c.sqrt_t,1),2),c.sqrt=function(n){let a=this;if(a.isZero(n))return a.zero;let o=a.pow(n,a.sqrt_tm1d2),e=a.pow(a.mul(a.square(o),n),2**(a.sqrt_s-1));if(a.eq(e,a.negone))return null;let h=a.sqrt_s,d=a.mul(n,o),b=a.mul(d,o),l=a.sqrt_z;for(;!a.eq(b,a.one);){let s=a.square(b),m=1;for(;!a.eq(s,a.one);)s=a.square(s),m++;o=l;for(let B=0;B<h-m-1;B++)o=a.square(o);l=a.square(o),b=a.mul(b,l),d=a.mul(d,o),h=m}return a.geq(d,a.zero)?d:a.neg(d)}}function Km(c){c.sqrt=function(){throw new Error("Sqrt alg 4 not implemented")}}function Jm(c){c.sqrt=function(){throw new Error("Sqrt alg 3 not implemented")}}function Ym(c){c.sqrt_q=oe(c.p,c.m),c.sqrt_e1=Wo(za(c.sqrt_q,3),4),c.sqrt=function(t){if(this.isZero(t))return this.zero;let n=this.pow(t,this.sqrt_e1),a=this.mul(this.square(n),t);if(this.eq(a,this.negone))return null;let o=this.mul(n,t);return c.geq(o,c.zero)?o:c.neg(o)}}function t4(c){c.sqrt=function(){throw new Error("Sqrt alg 10 not implemented")}}function n4(c){c.sqrt_q=oe(c.p,c.m/2),c.sqrt_e34=Wo(za(c.sqrt_q,3),4),c.sqrt_e12=Wo(za(c.sqrt_q,1),2),c.frobenius=function(t,n){return t%2==1?c.conjugate(n):n},c.sqrt=function(t){let n=this,a=n.pow(t,n.sqrt_e34),o=n.mul(n.square(a),t),e=n.mul(n.frobenius(1,o),o);if(n.eq(e,n.negone))return null;let h=n.mul(a,t),d;if(n.eq(o,n.negone))d=n.mul(h,[n.F.zero,n.F.one]);else{let b=n.pow(n.add(n.one,o),n.sqrt_e12);d=n.mul(b,h)}return n.geq(d,n.zero)?d:n.neg(d)}}function a4(c){c.sqrt=function(){throw new Error("Sqrt alg 8 not implemented")}}function Da(c,t,n,a,o){c[t]=c[t]+c[n]>>>0,c[o]=(c[o]^c[t])>>>0,c[o]=(c[o]<<16|c[o]>>>16&65535)>>>0,c[a]=c[a]+c[o]>>>0,c[n]=(c[n]^c[a])>>>0,c[n]=(c[n]<<12|c[n]>>>20&4095)>>>0,c[t]=c[t]+c[n]>>>0,c[o]=(c[o]^c[t])>>>0,c[o]=(c[o]<<8|c[o]>>>24&255)>>>0,c[a]=c[a]+c[o]>>>0,c[n]=(c[n]^c[a])>>>0,c[n]=(c[n]<<7|c[n]>>>25&127)>>>0}function o4(c){Da(c,0,4,8,12),Da(c,1,5,9,13),Da(c,2,6,10,14),Da(c,3,7,11,15),Da(c,0,5,10,15),Da(c,1,6,11,12),Da(c,2,7,8,13),Da(c,3,4,9,14)}function Zh(c){let t=new Uint8Array(c);if(typeof globalThis.crypto<"u")globalThis.crypto.getRandomValues(t);else for(let n=0;n<c;n++)t[n]=Math.random()*4294967296>>>0;return t}function i4(){let c=Zh(32),t=new Uint32Array(c.buffer),n=[];for(let a=0;a<8;a++)n.push(t[a]);return n}function Fd(){return Vc||(Vc=new Jc(i4()),Vc)}function hh(c){return((c&4294901760)!==0?(c&=4294901760,16):0)|((c&4278255360)!==0?(c&=4278255360,8):0)|((c&4042322160)!==0?(c&=4042322160,4):0)|((c&3435973836)!==0?(c&=3435973836,2):0)|(c&2863311530)!==0}function Yc(c,t,n,a,o){let e=1<<n;if(e==1)return[t[a]];if(e==2)return[c.G.add(t[a],t[a+o]),c.G.sub(t[a],t[a+o])];let h=e>>1,d=Yc(c,t,n-1,a,o*2),b=Yc(c,t,n-1,a+o,o*2),l=new Array(e);for(let s=0;s<h;s++)l[s]=c.G.add(d[s],c.opMulGF(b[s],c.roots[n][s])),l[s+h]=c.G.sub(d[s],c.opMulGF(b[s],c.roots[n][s]));return l}function Qc(c,t){if(Array.isArray(t)){for(let n=t.length-1;n>=0;n--)if(!c.F.isZero(t[n]))return Qc(c.F,t[n]);return 0}else{let n=c.neg(t);return Hc(t,n)}}function c4(c,t){let n=c.modules[t].n64*8,a=c.addFunction(t+"_batchInverse");a.addParam("pIn","i32"),a.addParam("inStep","i32"),a.addParam("n","i32"),a.addParam("pOut","i32"),a.addParam("outStep","i32"),a.addLocal("itAux","i32"),a.addLocal("itIn","i32"),a.addLocal("itOut","i32"),a.addLocal("i","i32");let o=a.getCodeBuilder(),e=o.i32_const(c.alloc(n));a.addCode(o.setLocal("itAux",o.i32_load(o.i32_const(0))),o.i32_store(o.i32_const(0),o.i32_add(o.getLocal("itAux"),o.i32_mul(o.i32_add(o.getLocal("n"),o.i32_const(1)),o.i32_const(n))))),a.addCode(o.call(t+"_one",o.getLocal("itAux")),o.setLocal("itIn",o.getLocal("pIn")),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("i",o.i32_const(0)),o.block(o.loop(o.br_if(1,o.i32_eq(o.getLocal("i"),o.getLocal("n"))),o.if(o.call(t+"_isZero",o.getLocal("itIn")),o.call(t+"_copy",o.i32_sub(o.getLocal("itAux"),o.i32_const(n)),o.getLocal("itAux")),o.call(t+"_mul",o.getLocal("itIn"),o.i32_sub(o.getLocal("itAux"),o.i32_const(n)),o.getLocal("itAux"))),o.setLocal("itIn",o.i32_add(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itAux",o.i32_add(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("i",o.i32_add(o.getLocal("i"),o.i32_const(1))),o.br(0))),o.setLocal("itIn",o.i32_sub(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itAux",o.i32_sub(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("itOut",o.i32_add(o.getLocal("pOut"),o.i32_mul(o.i32_sub(o.getLocal("n"),o.i32_const(1)),o.getLocal("outStep")))),o.call(t+"_inverse",o.getLocal("itAux"),o.getLocal("itAux")),o.block(o.loop(o.br_if(1,o.i32_eqz(o.getLocal("i"))),o.if(o.call(t+"_isZero",o.getLocal("itIn")),[...o.call(t+"_copy",o.getLocal("itAux"),o.i32_sub(o.getLocal("itAux"),o.i32_const(n))),...o.call(t+"_zero",o.getLocal("itOut"))],[...o.call(t+"_copy",o.i32_sub(o.getLocal("itAux"),o.i32_const(n)),e),...o.call(t+"_mul",o.getLocal("itAux"),o.getLocal("itIn"),o.i32_sub(o.getLocal("itAux"),o.i32_const(n))),...o.call(t+"_mul",o.getLocal("itAux"),e,o.getLocal("itOut"))]),o.setLocal("itIn",o.i32_sub(o.getLocal("itIn"),o.getLocal("inStep"))),o.setLocal("itOut",o.i32_sub(o.getLocal("itOut"),o.getLocal("outStep"))),o.setLocal("itAux",o.i32_sub(o.getLocal("itAux"),o.i32_const(n))),o.setLocal("i",o.i32_sub(o.getLocal("i"),o.i32_const(1))),o.br(0)))),a.addCode(o.i32_store(o.i32_const(0),o.getLocal("itAux")))}function s4(c,t,n,a,o,e){typeof e>"u"&&(a<o?e=!0:e=!1);let h=c.addFunction(t);h.addParam("pIn","i32"),h.addParam("n","i32"),h.addParam("pOut","i32"),h.addLocal("i","i32"),h.addLocal("itIn","i32"),h.addLocal("itOut","i32");let d=h.getCodeBuilder();e?h.addCode(d.setLocal("itIn",d.i32_add(d.getLocal("pIn"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(a)))),d.setLocal("itOut",d.i32_add(d.getLocal("pOut"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(o)))),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn"),d.getLocal("itOut")),d.setLocal("itIn",d.i32_sub(d.getLocal("itIn"),d.i32_const(a))),d.setLocal("itOut",d.i32_sub(d.getLocal("itOut"),d.i32_const(o))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0)))):h.addCode(d.setLocal("itIn",d.getLocal("pIn")),d.setLocal("itOut",d.getLocal("pOut")),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn"),d.getLocal("itOut")),d.setLocal("itIn",d.i32_add(d.getLocal("itIn"),d.i32_const(a))),d.setLocal("itOut",d.i32_add(d.getLocal("itOut"),d.i32_const(o))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0))))}function r4(c,t,n,a,o,e){typeof e>"u"&&(a<o?e=!0:e=!1);let h=c.addFunction(t);h.addParam("pIn1","i32"),h.addParam("pIn2","i32"),h.addParam("n","i32"),h.addParam("pOut","i32"),h.addLocal("i","i32"),h.addLocal("itIn1","i32"),h.addLocal("itIn2","i32"),h.addLocal("itOut","i32");let d=h.getCodeBuilder();e?h.addCode(d.setLocal("itIn1",d.i32_add(d.getLocal("pIn1"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(a)))),d.setLocal("itIn2",d.i32_add(d.getLocal("pIn2"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(a)))),d.setLocal("itOut",d.i32_add(d.getLocal("pOut"),d.i32_mul(d.i32_sub(d.getLocal("n"),d.i32_const(1)),d.i32_const(o)))),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn1"),d.getLocal("itIn2"),d.getLocal("itOut")),d.setLocal("itIn1",d.i32_sub(d.getLocal("itIn1"),d.i32_const(a))),d.setLocal("itIn2",d.i32_sub(d.getLocal("itIn2"),d.i32_const(a))),d.setLocal("itOut",d.i32_sub(d.getLocal("itOut"),d.i32_const(o))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0)))):h.addCode(d.setLocal("itIn1",d.getLocal("pIn1")),d.setLocal("itIn2",d.getLocal("pIn2")),d.setLocal("itOut",d.getLocal("pOut")),d.setLocal("i",d.i32_const(0)),d.block(d.loop(d.br_if(1,d.i32_eq(d.getLocal("i"),d.getLocal("n"))),d.call(n,d.getLocal("itIn1"),d.getLocal("itIn2"),d.getLocal("itOut")),d.setLocal("itIn1",d.i32_add(d.getLocal("itIn1"),d.i32_const(a))),d.setLocal("itIn2",d.i32_add(d.getLocal("itIn2"),d.i32_const(a))),d.setLocal("itOut",d.i32_add(d.getLocal("itOut"),d.i32_const(o))),d.setLocal("i",d.i32_add(d.getLocal("i"),d.i32_const(1))),d.br(0))))}function Vh(c,t){return c===t?0:c>t?1:-1}function xd(c){return c*c}function Wh(c){return c%2n!==0n}function Ad(c){return c%2n===0n}function rs(c){return c<0n}function d4(c){return c>0n}function Qh(c){return rs(c)?c.toString(2).length-1:c.toString(2).length}function ie(c){return c<0n?-c:c}function Ho(c){return ie(c)===1n}function Xh(c,t){for(var n=0n,a=1n,o=t,e=ie(c),h,d,b;e!==0n;)h=o/e,d=n,b=o,n=a,o=e,a=d-h*a,e=b-h*e;if(!Ho(o))throw new Error(c.toString()+" and "+t.toString()+" are not co-prime");return Vh(n,0n)===-1&&(n=n+t),rs(c)?-n:n}function Hh(c,t,n){if(n===0n)throw new Error("Cannot take modPow with modulus 0");var a=1n,o=c%n;for(rs(t)&&(t=t*-1n,o=Xh(o,n));d4(t);){if(o===0n)return 0n;Wh(t)&&(a=a*o%n),t=t/2n,o=xd(o)%n}return a}function u4(c,t){return c=c>=0n?c:-c,t=t>=0n?t:-t,c===t?0:c>t?1:-1}function fh(c,t){return t===0n?!1:Ho(t)?!0:u4(t,2n)===0?Ad(c):c%t===0n}function _4(c){var t=ie(c);if(Ho(t))return!1;if(t===2n||t===3n||t===5n)return!0;if(Ad(t)||fh(t,3n)||fh(t,5n))return!1;if(t<49n)return!0}function h4(c){return c-1n}function gh(c,t){for(var n=h4(c),a=n,o=0,e,h,d;Ad(a);)a=a/2n,o++;t:for(h=0;h<t.length;h++)if(!(c<t[h])&&(d=Hh(BigInt(t[h]),a,c),!(Ho(d)||d===n))){for(e=o-1;e!=0;e--){if(d=xd(d)%c,Ho(d))return!1;if(d===n)continue t}return!1}return!0}function f4(c){var t=_4(c);if(t!==void 0)return t;var n=ie(c),a=Qh(n);if(a<=64)return gh(n,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var o=Math.log(2)*Number(a),e=Math.ceil(o),h=[],d=0;d<e;d++)h.push(BigInt(d+2));return gh(n,h)}function rd(c){if(typeof c=="bigint"||c.eq!==void 0)return c.toString(10);if(c instanceof Uint8Array)return ne(c,0);if(Array.isArray(c))return c.map(rd);if(typeof c=="object"){let t={};return Object.keys(c).forEach(a=>{t[a]=rd(c[a])}),t}else return c}function dd(c){if(typeof c=="string"&&/^[0-9]+$/.test(c))return BigInt(c);if(typeof c=="string"&&/^0x[0-9a-fA-F]+$/.test(c))return BigInt(c);if(Array.isArray(c))return c.map(dd);if(typeof c=="object"){if(c===null)return null;let t={};return Object.keys(c).forEach(a=>{t[a]=dd(c[a])}),t}else return c}function X4(c){let t=BigInt(0),n=c.length,a=0,o=new DataView(c.buffer,c.byteOffset,c.byteLength);for(;n>0;)n>=4?(n-=4,t+=BigInt(o.getUint32(n))<<BigInt(a*8),a+=4):n>=2?(n-=2,t+=BigInt(o.getUint16(n))<<BigInt(a*8),a+=2):(n-=1,t+=BigInt(o.getUint8(n))<<BigInt(a*8),a+=1);return t}function H4(c,t){let n=c,a=new Uint8Array(t),o=new DataView(a.buffer),e=t;for(;e>0;)e-4>=0?(e-=4,o.setUint32(e,Number(n&BigInt(4294967295))),n=n>>BigInt(32)):e-2>=0?(e-=2,o.setUint16(e,Number(n&BigInt(65535))),n=n>>BigInt(16)):(e-=1,o.setUint8(e,Number(n&BigInt(255))),n=n>>BigInt(8));if(n)throw new Error("Number does not fit in this length");return a}function D4(c){let t=BigInt(0),n=0,a=new DataView(c.buffer,c.byteOffset,c.byteLength);for(;n<c.length;)n+4<=c.length?(t+=BigInt(a.getUint32(n,!0))<<BigInt(n*8),n+=4):n+2<=c.length?(t+=BigInt(a.getUint16(n,!0))<<BigInt(n*8),n+=2):(t+=BigInt(a.getUint8(n,!0))<<BigInt(n*8),n+=1);return t}function ef(c,t){let n=c;typeof t>"u"&&(t=Math.floor((ae(c)-1)/8)+1,t==0&&(t=1));let a=new Uint8Array(t),o=new DataView(a.buffer),e=0;for(;e<t;)e+4<=t?(o.setUint32(e,Number(n&BigInt(4294967295)),!0),e+=4,n=n>>BigInt(32)):e+2<=t?(o.setUint16(e,Number(n&BigInt(65535)),!0),e+=2,n=n>>BigInt(16)):(o.setUint8(e,Number(n&BigInt(255)),!0),e+=1,n=n>>BigInt(8));if(n)throw new Error("Number does not fit in this length");return a}function ud(c,t){if(typeof t=="bigint"||t.eq!==void 0)return t.toString(10);if(t instanceof Uint8Array)return c.toString(c.e(t));if(Array.isArray(t))return t.map(ud.bind(this,c));if(typeof t=="object"){let n={};return Object.keys(t).forEach(o=>{n[o]=ud(c,t[o])}),n}else return t}function _d(c,t){if(typeof t=="string"&&/^[0-9]+$/.test(t))return c.e(t);if(typeof t=="string"&&/^0x[0-9a-fA-F]+$/.test(t))return c.e(t);if(Array.isArray(t))return t.map(_d.bind(this,c));if(typeof t=="object"){if(t===null)return null;let n={};return Object.keys(t).forEach(o=>{n[o]=_d(c,t[o])}),n}else return t}function K4(c,t){let n=0,a=c;for(let o=0;o<t;o++)n<<=1,n=n|a&1,a>>=1;return n}function cf(c,t){return(Yi[c>>>24]|Yi[c>>>16&255]<<8|Yi[c>>>8&255]<<16|Yi[c&255]<<24)>>>32-t}function na(c){return((c&4294901760)!==0?(c&=4294901760,16):0)|((c&4278255360)!==0?(c&=4278255360,8):0)|((c&4042322160)!==0?(c&=4042322160,4):0)|((c&3435973836)!==0?(c&=3435973836,2):0)|(c&2863311530)!==0}function sf(c,t){let n=c.byteLength/t,a=na(n);if(n!=1<<a)throw new Error("Invalid number of pointers");for(let o=0;o<n;o++){let e=cf(o,a);if(o>e){let h=c.slice(o*t,(o+1)*t);c.set(c.slice(e*t,(e+1)*t),o*t),c.set(h,e*t)}}}function vd(c,t){let n=new Uint8Array(t*c.length);for(let a=0;a<c.length;a++)n.set(c[a],a*t);return n}function ts(c,t){let n=c.byteLength/t,a=new Array(n);for(let o=0;o<n;o++)a[o]=c.slice(o*t,o*t+t);return a}function Ka(c,t,n,a){return async function(e){let h=Math.floor(e.byteLength/n);if(h*n!==e.byteLength)throw new Error("Invalid buffer size");let d=Math.floor(h/c.concurrency),b=[];for(let B=0;B<c.concurrency;B++){let p;if(B<c.concurrency-1?p=d:p=h-B*d,p==0)continue;let M=[{cmd:"ALLOCSET",var:0,buff:e.slice(B*d*n,B*d*n+p*n)},{cmd:"ALLOC",var:1,len:a*p},{cmd:"CALL",fnName:t,params:[{var:0},{val:p},{var:1}]},{cmd:"GET",out:0,var:1,len:a*p}];b.push(c.queueAction(M))}let l=await Promise.all(b),s;e instanceof bn?s=new bn(h*a):s=new Uint8Array(h*a);let m=0;for(let B=0;B<l.length;B++)s.set(l[B][0],m),m+=l[B][0].byteLength;return s}}function Y4(c){let n,a;c&&(c.onmessage=function(s){let m;if(s.data?m=s.data:m=s,m[0].cmd=="INIT")o(m[0]).then(function(){c.postMessage(m.result)});else if(m[0].cmd=="TERMINATE")c.close();else{let B=l(m);c.postMessage(B)}});async function o(s){let m=new Uint8Array(s.code),B=await WebAssembly.compile(m);a=new WebAssembly.Memory({initial:s.init,maximum:32767}),n=await WebAssembly.instantiate(B,{env:{memory:a}})}function e(s){let m=new Uint32Array(a.buffer,0,1);for(;m[0]&3;)m[0]++;let B=m[0];if(m[0]+=s,m[0]+s>a.buffer.byteLength){let p=a.buffer.byteLength/65536,v=Math.floor((m[0]+s)/65536)+1;v>32767&&(v=32767),a.grow(v-p)}return B}function h(s){let m=e(s.byteLength);return b(m,s),m}function d(s,m){let B=new Uint8Array(a.buffer);return new Uint8Array(B.buffer,B.byteOffset+s,m)}function b(s,m){new Uint8Array(a.buffer).set(new Uint8Array(m),s)}function l(s){if(s[0].cmd=="INIT")return o(s[0]);let m={vars:[],out:[]},p=new Uint32Array(a.buffer,0,1)[0];for(let M=0;M<s.length;M++)switch(s[M].cmd){case"ALLOCSET":m.vars[s[M].var]=h(s[M].buff);break;case"ALLOC":m.vars[s[M].var]=e(s[M].len);break;case"SET":b(m.vars[s[M].var],s[M].buff);break;case"CALL":{let x=[];for(let S=0;S<s[M].params.length;S++){let w=s[M].params[S];typeof w.var<"u"?x.push(m.vars[w.var]+(w.offset||0)):typeof w.val<"u"&&x.push(w.val)}n.exports[s[M].fnName](...x);break}case"GET":m.out[s[M].out]=d(m.vars[s[M].var],s[M].len).slice();break;default:throw new Error("Invalid cmd")}let v=new Uint32Array(a.buffer,0,1);return v[0]=p,m.out}return l}function t8(c){return new Promise(t=>setTimeout(t,c))}async function n8(c,t){let n=new gd;n.memory=new WebAssembly.Memory({initial:Jr}),n.u8=new Uint8Array(n.memory.buffer),n.u32=new Uint32Array(n.memory.buffer);let a=await WebAssembly.compile(c.code);if(n.instance=await WebAssembly.instantiate(a,{env:{memory:n.memory}}),globalThis?.Worker||(t=!0),n.singleThread=t,n.initalPFree=n.u32[0],n.pq=c.pq,n.pr=c.pr,n.pG1gen=c.pG1gen,n.pG1zero=c.pG1zero,n.pG2gen=c.pG2gen,n.pG2zero=c.pG2zero,n.pOneT=c.pOneT,t)n.code=c.code,n.taskManager=Y4(),await n.taskManager([{cmd:"INIT",init:Jr,code:n.code.slice()}]),n.concurrency=1;else{n.workers=[],n.pendingDeferreds=[],n.working=[];let e=2;typeof navigator=="object"&&navigator.hardwareConcurrency&&(e=navigator.hardwareConcurrency),e==0&&(e=2),e>64&&(e=64),n.concurrency=e;for(let d=0;d<e;d++)n.workers[d]=new Worker(fd),n.workers[d].addEventListener("message",o(d)),n.working[d]=!1;let h=[];for(let d=0;d<n.workers.length;d++){let b=c.code.slice();h.push(n.postAction(d,[{cmd:"INIT",init:Jr,code:b}],[b.buffer]))}await Promise.all(h)}return n;function o(e){return function(h){let d;h&&h.data?d=h.data:d=h,n.working[e]=!1,n.pendingDeferreds[e].resolve(d),n.processWorks()}}}function Yr(c,t){let n=c[t],a=c.Fr,o=c.tm;c[t].batchApplyKey=async function(e,h,d,b,l){b=b||"affine",l=l||"affine";let s,m,B,p,v;if(t=="G1")b=="jacobian"?(B=n.F.n8*3,s="g1m_batchApplyKey"):(B=n.F.n8*2,s="g1m_batchApplyKeyMixed"),p=n.F.n8*3,l=="jacobian"?v=n.F.n8*3:(m="g1m_batchToAffine",v=n.F.n8*2);else if(t=="G2")b=="jacobian"?(B=n.F.n8*3,s="g2m_batchApplyKey"):(B=n.F.n8*2,s="g2m_batchApplyKeyMixed"),p=n.F.n8*3,l=="jacobian"?v=n.F.n8*3:(m="g2m_batchToAffine",v=n.F.n8*2);else if(t=="Fr")s="frm_batchApplyKey",B=n.n8,p=n.n8,v=n.n8;else throw new Error("Invalid group: "+t);let M=Math.floor(e.byteLength/B),x=Math.floor(M/o.concurrency),S=[];d=a.e(d);let w=a.e(h);for(let F=0;F<o.concurrency;F++){let u;if(F<o.concurrency-1?u=x:u=M-F*x,u==0)continue;let L=[];L.push({cmd:"ALLOCSET",var:0,buff:e.slice(F*x*B,F*x*B+u*B)}),L.push({cmd:"ALLOCSET",var:1,buff:w}),L.push({cmd:"ALLOCSET",var:2,buff:d}),L.push({cmd:"ALLOC",var:3,len:u*Math.max(p,v)}),L.push({cmd:"CALL",fnName:s,params:[{var:0},{val:u},{var:1},{var:2},{var:3}]}),m&&L.push({cmd:"CALL",fnName:m,params:[{var:3},{val:u},{var:3}]}),L.push({cmd:"GET",out:0,var:3,len:u*v}),S.push(o.queueAction(L)),w=a.mul(w,a.exp(d,u))}let k=await Promise.all(S),O;e instanceof bn?O=new bn(M*v):O=new Uint8Array(M*v);let W=0;for(let F=0;F<k.length;F++)O.set(k[F][0],W),W+=k[F][0].byteLength;return O}}function a8(c){let t=c.tm;c.pairing=function(a,o){t.startSyncOp();let e=t.allocBuff(c.G1.toJacobian(a)),h=t.allocBuff(c.G2.toJacobian(o)),d=t.alloc(c.Gt.n8);t.instance.exports[c.name+"_pairing"](e,h,d);let b=t.getBuff(d,c.Gt.n8);return t.endSyncOp(),b},c.pairingEq=async function(){let a,o;arguments.length%2==1?(a=arguments[arguments.length-1],o=(arguments.length-1)/2):(a=c.Gt.one,o=arguments.length/2);let e=[];for(let s=0;s<o;s++){let m=[],B=c.G1.toJacobian(arguments[s*2]);m.push({cmd:"ALLOCSET",var:0,buff:B}),m.push({cmd:"ALLOC",var:1,len:c.prePSize});let p=c.G2.toJacobian(arguments[s*2+1]);m.push({cmd:"ALLOCSET",var:2,buff:p}),m.push({cmd:"ALLOC",var:3,len:c.preQSize}),m.push({cmd:"ALLOC",var:4,len:c.Gt.n8}),m.push({cmd:"CALL",fnName:c.name+"_prepareG1",params:[{var:0},{var:1}]}),m.push({cmd:"CALL",fnName:c.name+"_prepareG2",params:[{var:2},{var:3}]}),m.push({cmd:"CALL",fnName:c.name+"_millerLoop",params:[{var:1},{var:3},{var:4}]}),m.push({cmd:"GET",out:0,var:4,len:c.Gt.n8}),e.push(t.queueAction(m))}let h=await Promise.all(e);t.startSyncOp();let d=t.alloc(c.Gt.n8);t.instance.exports.ftm_one(d);for(let s=0;s<h.length;s++){let m=t.allocBuff(h[s][0]);t.instance.exports.ftm_mul(d,m,d)}t.instance.exports[c.name+"_finalExponentiation"](d,d);let b=t.allocBuff(a),l=!!t.instance.exports.ftm_eq(d,b);return t.endSyncOp(),l},c.prepareG1=function(n){this.tm.startSyncOp();let a=this.tm.allocBuff(n),o=this.tm.alloc(this.prePSize);this.tm.instance.exports[this.name+"_prepareG1"](a,o);let e=this.tm.getBuff(o,this.prePSize);return this.tm.endSyncOp(),e},c.prepareG2=function(n){this.tm.startSyncOp();let a=this.tm.allocBuff(n),o=this.tm.alloc(this.preQSize);this.tm.instance.exports[this.name+"_prepareG2"](a,o);let e=this.tm.getBuff(o,this.preQSize);return this.tm.endSyncOp(),e},c.millerLoop=function(n,a){this.tm.startSyncOp();let o=this.tm.allocBuff(n),e=this.tm.allocBuff(a),h=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_millerLoop"](o,e,h);let d=this.tm.getBuff(h,this.Gt.n8);return this.tm.endSyncOp(),d},c.finalExponentiation=function(n){this.tm.startSyncOp();let a=this.tm.allocBuff(n),o=this.tm.alloc(this.Gt.n8);this.tm.instance.exports[this.name+"_finalExponentiation"](a,o);let e=this.tm.getBuff(o,this.Gt.n8);return this.tm.endSyncOp(),e}}function qh(c,t){let n=c[t],a=n.tm;async function o(h,d,b,l,s){if(!(h instanceof Uint8Array))throw l&&l.error(`${s} _multiExpChunk buffBases is not Uint8Array`),new Error(`${s} _multiExpChunk buffBases is not Uint8Array`);if(!(d instanceof Uint8Array))throw l&&l.error(`${s} _multiExpChunk buffScalars is not Uint8Array`),new Error(`${s} _multiExpChunk buffScalars is not Uint8Array`);b=b||"affine";let m,B;if(t=="G1")b=="affine"?(B="g1m_multiexpAffine_chunk",m=n.F.n8*2):(B="g1m_multiexp_chunk",m=n.F.n8*3);else if(t=="G2")b=="affine"?(B="g2m_multiexpAffine_chunk",m=n.F.n8*2):(B="g2m_multiexp_chunk",m=n.F.n8*3);else throw new Error("Invalid group");let p=Math.floor(h.byteLength/m);if(p==0)return n.zero;let v=Math.floor(d.byteLength/p);if(v*p!=d.byteLength)throw new Error("Scalar size does not match");let M=Sh[na(p)],x=Math.floor((v*8-1)/M)+1,S=[];for(let O=0;O<x;O++){let W=[{cmd:"ALLOCSET",var:0,buff:h},{cmd:"ALLOCSET",var:1,buff:d},{cmd:"ALLOC",var:2,len:n.F.n8*3},{cmd:"CALL",fnName:B,params:[{var:0},{var:1},{val:v},{val:p},{val:O*M},{val:Math.min(v*8-O*M,M)},{var:2}]},{cmd:"GET",out:0,var:2,len:n.F.n8*3}];S.push(n.tm.queueAction(W))}let w=await Promise.all(S),k=n.zero;for(let O=w.length-1;O>=0;O--){if(!n.isZero(k))for(let W=0;W<M;W++)k=n.double(k);k=n.add(k,w[O][0])}return k}async function e(h,d,b,l,s){let p;if(t=="G1")b=="affine"?p=n.F.n8*2:p=n.F.n8*3;else if(t=="G2")b=="affine"?p=n.F.n8*2:p=n.F.n8*3;else throw new Error("Invalid group");let v=Math.floor(h.byteLength/p),M=Math.floor(d.byteLength/v);if(M*v!=d.byteLength)throw new Error("Scalar size does not match");let x=Sh[na(v)],S=Math.floor((M*8-1)/x)+1,w;w=Math.floor(v/(a.concurrency/S)),w>4194304&&(w=4194304),w<1024&&(w=1024);let k=[];for(let F=0;F<v;F+=w){l&&l.debug(`Multiexp start: ${s}: ${F}/${v}`);let u=Math.min(v-F,w),L=h.slice(F*p,(F+u)*p),$=d.slice(F*M,(F+u)*M);k.push(o(L,$,b,l,s).then(Q=>(l&&l.debug(`Multiexp end: ${s}: ${F}/${v}`),Q)))}let O=await Promise.all(k),W=n.zero;for(let F=O.length-1;F>=0;F--)W=n.add(W,O[F]);return W}n.multiExp=async function(d,b,l,s){return await e(d,b,"jacobian",l,s)},n.multiExpAffine=async function(d,b,l,s){return await e(d,b,"affine",l,s)}}function td(c,t){let n=c[t],a=c.Fr,o=n.tm;async function e(l,s,m,B,p,v){m=m||"affine",B=B||"affine";let M=14,x,S,w,k,O,W,F,u;t=="G1"?(m=="affine"?(x=n.F.n8*2,k="g1m_batchToJacobian"):x=n.F.n8*3,S=n.F.n8*3,s&&(u="g1m_fftFinal"),F="g1m_fftJoin",W="g1m_fftMix",B=="affine"?(w=n.F.n8*2,O="g1m_batchToAffine"):w=n.F.n8*3):t=="G2"?(m=="affine"?(x=n.F.n8*2,k="g2m_batchToJacobian"):x=n.F.n8*3,S=n.F.n8*3,s&&(u="g2m_fftFinal"),F="g2m_fftJoin",W="g2m_fftMix",B=="affine"?(w=n.F.n8*2,O="g2m_batchToAffine"):w=n.F.n8*3):t=="Fr"&&(x=n.n8,S=n.n8,w=n.n8,s&&(u="frm_fftFinal"),W="frm_fftMix",F="frm_fftJoin");let L=!1;Array.isArray(l)?(l=vd(l,x),L=!0):l=l.slice(0,l.byteLength);let $=l.byteLength/x,Q=na($);if(1<<Q!=$)throw new Error("fft must be multiple of 2");if(Q==a.s+1){let j;return s?j=await d(l,m,B,p,v):j=await h(l,m,B,p,v),L?ts(j,w):j}let H;s&&(H=a.inv(a.e($)));let q;sf(l,x);let y,I=Math.min(1<<M,$),N=$/I;for(;N<o.concurrency&&I>=16;)N*=2,I/=2;let nt=na(I),J=[];for(let j=0;j<N;j++){p&&p.debug(`${v}: fft ${Q} mix start: ${j}/${N}`);let ot=[];ot.push({cmd:"ALLOC",var:0,len:S*I});let V=l.slice(I*j*x,I*(j+1)*x);ot.push({cmd:"SET",var:0,buff:V}),k&&ot.push({cmd:"CALL",fnName:k,params:[{var:0},{val:I},{var:0}]});for(let at=1;at<=nt;at++)ot.push({cmd:"CALL",fnName:W,params:[{var:0},{val:I},{val:at}]});nt==Q?(u&&(ot.push({cmd:"ALLOCSET",var:1,buff:H}),ot.push({cmd:"CALL",fnName:u,params:[{var:0},{val:I},{var:1}]})),O&&ot.push({cmd:"CALL",fnName:O,params:[{var:0},{val:I},{var:0}]}),ot.push({cmd:"GET",out:0,var:0,len:I*w})):ot.push({cmd:"GET",out:0,var:0,len:S*I}),J.push(o.queueAction(ot).then(at=>(p&&p.debug(`${v}: fft ${Q} mix end: ${j}/${N}`),at)))}y=await Promise.all(J);for(let j=0;j<N;j++)y[j]=y[j][0];for(let j=nt+1;j<=Q;j++){p&&p.debug(`${v}: fft  ${Q}  join: ${j}/${Q}`);let ot=1<<Q-j,V=N/ot,at=[];for(let rt=0;rt<ot;rt++)for(let ht=0;ht<V/2;ht++){let A=a.exp(a.w[j],ht*I),i=a.w[j],C=rt*V+ht,r=rt*V+ht+V/2,z=[];z.push({cmd:"ALLOCSET",var:0,buff:y[C]}),z.push({cmd:"ALLOCSET",var:1,buff:y[r]}),z.push({cmd:"ALLOCSET",var:2,buff:A}),z.push({cmd:"ALLOCSET",var:3,buff:i}),z.push({cmd:"CALL",fnName:F,params:[{var:0},{var:1},{val:I},{var:2},{var:3}]}),j==Q?(u&&(z.push({cmd:"ALLOCSET",var:4,buff:H}),z.push({cmd:"CALL",fnName:u,params:[{var:0},{val:I},{var:4}]}),z.push({cmd:"CALL",fnName:u,params:[{var:1},{val:I},{var:4}]})),O&&(z.push({cmd:"CALL",fnName:O,params:[{var:0},{val:I},{var:0}]}),z.push({cmd:"CALL",fnName:O,params:[{var:1},{val:I},{var:1}]})),z.push({cmd:"GET",out:0,var:0,len:I*w}),z.push({cmd:"GET",out:1,var:1,len:I*w})):(z.push({cmd:"GET",out:0,var:0,len:I*S}),z.push({cmd:"GET",out:1,var:1,len:I*S})),at.push(o.queueAction(z).then(E=>(p&&p.debug(`${v}: fft ${Q} join  ${j}/${Q}  ${rt+1}/${ot} ${ht}/${V/2}`),E)))}let Lt=await Promise.all(at);for(let rt=0;rt<ot;rt++)for(let ht=0;ht<V/2;ht++){let A=rt*V+ht,i=rt*V+ht+V/2,C=Lt.shift();y[A]=C[0],y[i]=C[1]}}if(l instanceof bn?q=new bn($*w):q=new Uint8Array($*w),s){q.set(y[0].slice((I-1)*w));let j=w;for(let ot=N-1;ot>0;ot--)q.set(y[ot],j),j+=I*w,delete y[ot];q.set(y[0].slice(0,(I-1)*w),j),delete y[0]}else for(let j=0;j<N;j++)q.set(y[j],I*w*j),delete y[j];return L?ts(q,w):q}async function h(l,s,m,B,p){let v,M;v=l.slice(0,l.byteLength/2),M=l.slice(l.byteLength/2,l.byteLength);let x=[];[v,M]=await b(v,M,"fftJoinExt",a.one,a.shift,s,"jacobian",B,p),x.push(e(v,!1,"jacobian",m,B,p)),x.push(e(M,!1,"jacobian",m,B,p));let S=await Promise.all(x),w;return S[0].byteLength>1<<28?w=new bn(S[0].byteLength*2):w=new Uint8Array(S[0].byteLength*2),w.set(S[0]),w.set(S[1],S[0].byteLength),w}async function d(l,s,m,B,p){let v,M;v=l.slice(0,l.byteLength/2),M=l.slice(l.byteLength/2,l.byteLength);let x=[];x.push(e(v,!0,s,"jacobian",B,p)),x.push(e(M,!0,s,"jacobian",B,p)),[v,M]=await Promise.all(x);let S=await b(v,M,"fftJoinExtInv",a.one,a.shiftInv,"jacobian",m,B,p),w;return S[0].byteLength>1<<28?w=new bn(S[0].byteLength*2):w=new Uint8Array(S[0].byteLength*2),w.set(S[0]),w.set(S[1],S[0].byteLength),w}async function b(l,s,m,B,p,v,M,x,S){let O,W,F,u,L,$;if(t=="G1")v=="affine"?(L=n.F.n8*2,W="g1m_batchToJacobian"):L=n.F.n8*3,$=n.F.n8*3,O="g1m_"+m,M=="affine"?(F="g1m_batchToAffine",u=n.F.n8*2):u=n.F.n8*3;else if(t=="G2")v=="affine"?(L=n.F.n8*2,W="g2m_batchToJacobian"):L=n.F.n8*3,O="g2m_"+m,$=n.F.n8*3,M=="affine"?(F="g2m_batchToAffine",u=n.F.n8*2):u=n.F.n8*3;else if(t=="Fr")L=a.n8,u=a.n8,$=a.n8,O="frm_"+m;else throw new Error("Invalid group");if(l.byteLength!=s.byteLength)throw new Error("Invalid buffer size");let Q=Math.floor(l.byteLength/L);if(Q!=1<<na(Q))throw new Error("Invalid number of points");let H=Math.floor(Q/o.concurrency);H<16&&(H=16),H>65536&&(H=65536);let q=[];for(let J=0;J<Q;J+=H){x&&x.debug(`${S}: fftJoinExt Start: ${J}/${Q}`);let j=Math.min(Q-J,H),ot=a.mul(B,a.exp(p,J)),V=[],at=l.slice(J*L,(J+j)*L),Lt=s.slice(J*L,(J+j)*L);V.push({cmd:"ALLOC",var:0,len:$*j}),V.push({cmd:"SET",var:0,buff:at}),V.push({cmd:"ALLOC",var:1,len:$*j}),V.push({cmd:"SET",var:1,buff:Lt}),V.push({cmd:"ALLOCSET",var:2,buff:ot}),V.push({cmd:"ALLOCSET",var:3,buff:p}),W&&(V.push({cmd:"CALL",fnName:W,params:[{var:0},{val:j},{var:0}]}),V.push({cmd:"CALL",fnName:W,params:[{var:1},{val:j},{var:1}]})),V.push({cmd:"CALL",fnName:O,params:[{var:0},{var:1},{val:j},{var:2},{var:3},{val:a.s}]}),F&&(V.push({cmd:"CALL",fnName:F,params:[{var:0},{val:j},{var:0}]}),V.push({cmd:"CALL",fnName:F,params:[{var:1},{val:j},{var:1}]})),V.push({cmd:"GET",out:0,var:0,len:j*u}),V.push({cmd:"GET",out:1,var:1,len:j*u}),q.push(o.queueAction(V).then(rt=>(x&&x.debug(`${S}: fftJoinExt End: ${J}/${Q}`),rt)))}let y=await Promise.all(q),I,N;Q*u>1<<28?(I=new bn(Q*u),N=new bn(Q*u)):(I=new Uint8Array(Q*u),N=new Uint8Array(Q*u));let nt=0;for(let J=0;J<y.length;J++)I.set(y[J][0],nt),N.set(y[J][1],nt),nt+=y[J][0].byteLength;return[I,N]}n.fft=async function(l,s,m,B,p){return await e(l,!1,s,m,B,p)},n.ifft=async function(l,s,m,B,p){return await e(l,!0,s,m,B,p)},n.lagrangeEvaluations=async function(l,s,m,B,p){s=s||"affine",m=m||"affine";let v;if(t=="G1")s=="affine"?v=n.F.n8*2:v=n.F.n8*3;else if(t=="G2")s=="affine"?v=n.F.n8*2:v=n.F.n8*3;else if(t=="Fr")v=a.n8;else throw new Error("Invalid group");let M=l.byteLength/v,x=na(M);if(2**x*v!=l.byteLength)throw B&&B.error("lagrangeEvaluations iinvalid input size"),new Error("lagrangeEvaluations invalid Input size");if(x<=a.s)return await n.ifft(l,s,m,B,p);if(x>a.s+1)throw B&&B.error("lagrangeEvaluations input too big"),new Error("lagrangeEvaluations input too big");let S=l.slice(0,l.byteLength/2),w=l.slice(l.byteLength/2,l.byteLength),k=a.exp(a.shift,M/2),O=a.inv(a.sub(a.one,k));[S,w]=await b(S,w,"prepareLagrangeEvaluation",O,a.shiftInv,s,"jacobian",B,p+" prep");let W=[];W.push(e(S,!0,"jacobian",m,B,p+" t0")),W.push(e(w,!0,"jacobian",m,B,p+" t1")),[S,w]=await Promise.all(W);let F;return S.byteLength>1<<28?F=new bn(S.byteLength*2):F=new Uint8Array(S.byteLength*2),F.set(S),F.set(w,S.byteLength),F},n.fftMix=async function(s){let m=n.F.n8*3,B,p;if(t=="G1")B="g1m_fftMix",p="g1m_fftJoin";else if(t=="G2")B="g2m_fftMix",p="g2m_fftJoin";else if(t=="Fr")B="frm_fftMix",p="frm_fftJoin";else throw new Error("Invalid group");let v=Math.floor(s.byteLength/m),M=na(v),x=1<<na(o.concurrency);v<=x*2&&(x=1);let S=v/x,w=na(S),k=[];for(let L=0;L<x;L++){let $=[],Q=s.slice(L*S*m,(L+1)*S*m);$.push({cmd:"ALLOCSET",var:0,buff:Q});for(let H=1;H<=w;H++)$.push({cmd:"CALL",fnName:B,params:[{var:0},{val:S},{val:H}]});$.push({cmd:"GET",out:0,var:0,len:S*m}),k.push(o.queueAction($))}let O=await Promise.all(k),W=[];for(let L=0;L<O.length;L++)W[L]=O[L][0];for(let L=w+1;L<=M;L++){let $=1<<M-L,Q=x/$,H=[];for(let y=0;y<$;y++)for(let I=0;I<Q/2;I++){let N=a.exp(a.w[L],I*S),nt=a.w[L],J=y*Q+I,j=y*Q+I+Q/2,ot=[];ot.push({cmd:"ALLOCSET",var:0,buff:W[J]}),ot.push({cmd:"ALLOCSET",var:1,buff:W[j]}),ot.push({cmd:"ALLOCSET",var:2,buff:N}),ot.push({cmd:"ALLOCSET",var:3,buff:nt}),ot.push({cmd:"CALL",fnName:p,params:[{var:0},{var:1},{val:S},{var:2},{var:3}]}),ot.push({cmd:"GET",out:0,var:0,len:S*m}),ot.push({cmd:"GET",out:1,var:1,len:S*m}),H.push(o.queueAction(ot))}let q=await Promise.all(H);for(let y=0;y<$;y++)for(let I=0;I<Q/2;I++){let N=y*Q+I,nt=y*Q+I+Q/2,J=q.shift();W[N]=J[0],W[nt]=J[1]}}let F;s instanceof bn?F=new bn(v*m):F=new Uint8Array(v*m);let u=0;for(let L=0;L<x;L++)F.set(W[L],u),u+=W[L].byteLength;return F},n.fftJoin=async function(s,m,B,p){let v=n.F.n8*3,M;if(t=="G1")M="g1m_fftJoin";else if(t=="G2")M="g2m_fftJoin";else if(t=="Fr")M="frm_fftJoin";else throw new Error("Invalid group");if(s.byteLength!=m.byteLength)throw new Error("Invalid buffer size");let x=Math.floor(s.byteLength/v);if(x!=1<<na(x))throw new Error("Invalid number of points");let S=1<<na(o.concurrency);x<=S*2&&(S=1);let w=x/S,k=[];for(let L=0;L<S;L++){let $=[],Q=a.mul(B,a.exp(p,L*w)),H=s.slice(L*w*v,(L+1)*w*v),q=m.slice(L*w*v,(L+1)*w*v);$.push({cmd:"ALLOCSET",var:0,buff:H}),$.push({cmd:"ALLOCSET",var:1,buff:q}),$.push({cmd:"ALLOCSET",var:2,buff:Q}),$.push({cmd:"ALLOCSET",var:3,buff:p}),$.push({cmd:"CALL",fnName:M,params:[{var:0},{var:1},{val:w},{var:2},{var:3}]}),$.push({cmd:"GET",out:0,var:0,len:w*v}),$.push({cmd:"GET",out:1,var:1,len:w*v}),k.push(o.queueAction($))}let O=await Promise.all(k),W,F;s instanceof bn?(W=new bn(x*v),F=new bn(x*v)):(W=new Uint8Array(x*v),F=new Uint8Array(x*v));let u=0;for(let L=0;L<O.length;L++)W.set(O[L][0],u),F.set(O[L][1],u),u+=O[L][0].byteLength;return[W,F]},n.fftFinal=async function(s,m){let B=n.F.n8*3,p=n.F.n8*2,v,M;if(t=="G1")v="g1m_fftFinal",M="g1m_batchToAffine";else if(t=="G2")v="g2m_fftFinal",M="g2m_batchToAffine";else throw new Error("Invalid group");let x=Math.floor(s.byteLength/B);if(x!=1<<na(x))throw new Error("Invalid number of points");let S=Math.floor(x/o.concurrency),w=[];for(let F=0;F<o.concurrency;F++){let u;if(F<o.concurrency-1?u=S:u=x-F*S,u==0)continue;let L=[],$=s.slice(F*S*B,(F*S+u)*B);L.push({cmd:"ALLOCSET",var:0,buff:$}),L.push({cmd:"ALLOCSET",var:1,buff:m}),L.push({cmd:"CALL",fnName:v,params:[{var:0},{val:u},{var:1}]}),L.push({cmd:"CALL",fnName:M,params:[{var:0},{val:u},{var:0}]}),L.push({cmd:"GET",out:0,var:0,len:u*p}),w.push(o.queueAction(L))}let k=await Promise.all(w),O;s instanceof bn?O=new bn(x*p):O=new Uint8Array(x*p);let W=0;for(let F=k.length-1;F>=0;F--)O.set(k[F][0],W),W+=k[F][0].byteLength;return O}}async function lf(c){let t=await n8(c.wasm,c.singleThread),n={};return n.q=Fn(c.wasm.q.toString()),n.r=Fn(c.wasm.r.toString()),n.name=c.name,n.tm=t,n.prePSize=c.wasm.prePSize,n.preQSize=c.wasm.preQSize,n.Fr=new ns(t,"frm",c.n8r,c.r),n.F1=new ns(t,"f1m",c.n8q,c.q),n.F2=new as(t,"f2m",n.F1),n.G1=new os(t,"g1m",n.F1,c.wasm.pG1gen,c.wasm.pG1b,c.cofactorG1),n.G2=new os(t,"g2m",n.F2,c.wasm.pG2gen,c.wasm.pG2b,c.cofactorG2),n.F6=new hd(t,"f6m",n.F2),n.F12=new as(t,"ftm",n.F6),n.Gt=n.F12,Yr(n,"G1"),Yr(n,"G2"),Yr(n,"Fr"),qh(n,"G1"),qh(n,"G2"),td(n,"G1"),td(n,"G2"),td(n,"Fr"),a8(n),n.array2buffer=function(a,o){let e=new Uint8Array(o*a.length);for(let h=0;h<a.length;h++)e.set(a[h],h*o);return e},n.buffer2array=function(a,o){let e=a.byteLength/o,h=new Array(e);for(let d=0;d<e;d++)h[d]=a.slice(d*o,d*o+o);return h},n}function Do(c){return BigInt(c)}function rf(c){return c<0n}function o8(c){return c===0n}function i8(c){return rf(c)?c.toString(2).length-1:c.toString(2).length}function nd(c){let t=[],n=Do(c);return t.push(Number(n&0xFFn)),t.push(Number(n>>8n&0xFFn)),t.push(Number(n>>16n&0xFFn)),t.push(Number(n>>24n&0xFFn)),t}function e8(c){for(var t=[],n=0;n<c.length;n++){var a=c.charCodeAt(n);a<128?t.push(a):a<2048?t.push(192|a>>6,128|a&63):a<55296||a>=57344?t.push(224|a>>12,128|a>>6&63,128|a&63):(n++,a=65536+((a&1023)<<10|c.charCodeAt(n)&1023),t.push(240|a>>18,128|a>>12&63,128|a>>6&63,128|a&63))}return t}function Ki(c){let t=e8(c);return[...Dt(t.length),...t]}function df(c){let t=[],n=Do(c);if(rf(n))throw new Error("Number cannot be negative");for(;!o8(n);)t.push(Number(n&0x7Fn)),n=n>>7n;t.length==0&&t.push(0);for(let a=0;a<t.length-1;a++)t[a]=t[a]|128;return t}function uf(c){let t,n,a=i8(c);c<0?(n=!0,t=(1n<<BigInt(a))+c):(n=!1,t=Do(c));let o=7-a%7,e=(1n<<BigInt(o))-1n<<BigInt(a),h=(1<<7-o)-1|128,d=df(t+e);return n||(d[d.length-1]=d[d.length-1]&h),d}function Ld(c){let t=Do(c);if(t>0xFFFFFFFFn)throw new Error("Number too big");if(t>0x7FFFFFFFn&&(t=t-0x100000000n),t<-2147483648n)throw new Error("Number too small");return uf(t)}function c8(c){let t=Do(c);if(t>0xFFFFFFFFFFFFFFFFn)throw new Error("Number too big");if(t>0x7FFFFFFFFFFFFFFFn&&(t=t-0x10000000000000000n),t<-9223372036854775808n)throw new Error("Number too small");return uf(t)}function Dt(c){let t=Do(c);if(t>0xFFFFFFFFn)throw new Error("Number too big");return df(t)}function Ih(c){return Array.from(c,function(t){return("0"+(t&255).toString(16)).slice(-2)}).join("")}async function ds(c,t){if(!c&&globalThis.curve_bn128)return globalThis.curve_bn128;let n=new cs;n.setMemory(25),W4(n),t&&t(n);let a={};a.code=n.build(),a.pq=n.modules.f1m.pq,a.pr=n.modules.frm.pq,a.pG1gen=n.modules.bn128.pG1gen,a.pG1zero=n.modules.bn128.pG1zero,a.pG1b=n.modules.bn128.pG1b,a.pG2gen=n.modules.bn128.pG2gen,a.pG2zero=n.modules.bn128.pG2zero,a.pG2b=n.modules.bn128.pG2b,a.pOneT=n.modules.bn128.pOneT,a.prePSize=n.modules.bn128.prePSize,a.preQSize=n.modules.bn128.preQSize,a.n8q=32,a.n8r=32,a.q=n.modules.bn128.q,a.r=n.modules.bn128.r;let o={name:"bn128",wasm:a,q:Fn("21888242871839275222246405745257275088696311157297823662689037894645226208583"),r:Fn("21888242871839275222246405745257275088548364400416034343698204186575808495617"),n8q:32,n8r:32,cofactorG2:Fn("30644e72e131a029b85045b68181585e06ceecda572a2489345f2299c0f9fa8d",16),singleThread:!!c},e=await lf(o);return e.terminate=async function(){o.singleThread||(globalThis.curve_bn128=null,await this.tm.terminate())},c||(globalThis.curve_bn128=e),e}async function us(c,t){if(!c&&globalThis.curve_bls12381)return globalThis.curve_bls12381;let n=new cs;n.setMemory(25),Q4(n),t&&t(n);let a={};a.code=n.build(),a.pq=n.modules.f1m.pq,a.pr=n.modules.frm.pq,a.pG1gen=n.modules.bls12381.pG1gen,a.pG1zero=n.modules.bls12381.pG1zero,a.pG1b=n.modules.bls12381.pG1b,a.pG2gen=n.modules.bls12381.pG2gen,a.pG2zero=n.modules.bls12381.pG2zero,a.pG2b=n.modules.bls12381.pG2b,a.pOneT=n.modules.bls12381.pOneT,a.prePSize=n.modules.bls12381.prePSize,a.preQSize=n.modules.bls12381.preQSize,a.n8q=48,a.n8r=32,a.q=n.modules.bls12381.q,a.r=n.modules.bls12381.r;let o={name:"bls12381",wasm:a,q:Fn("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),r:Fn("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),n8q:48,n8r:32,cofactorG1:Fn("0x396c8c005555e1568c00aaab0000aaab",16),cofactorG2:Fn("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5",16),singleThread:!!c},e=await lf(o);return e.terminate=async function(){o.singleThread||(globalThis.curve_bls12381=null,await this.tm.terminate())},c||(globalThis.curve_bls12381=e),e}async function u8(c,t,n){let a;if(fa(c,l8))a=await ds(t,n);else if(fa(c,s8))a=await us(t,n);else throw new Error(`Curve not supported: ${ls(c)}`);return a}async function _8(c,t,n){let a;if(fa(c,d8))a=await ds(t,n);else if(fa(c,r8))a=await us(t,n);else throw new Error(`Curve not supported: ${ls(c,16)}`);return a}async function h8(c,t,n){let a,o=e(c);if(["BN128","BN254","ALTBN128"].indexOf(o)>=0)a=await ds(t,n);else if(["BLS12381"].indexOf(o)>=0)a=await us(t,n);else throw new Error(`Curve not supported: ${c}`);return a;function e(h){return h.toUpperCase().match(/[A-Za-z0-9]+/g).join("")}}var Im,Fn,Pm,Mm,Nh,go,Qm,od,Ji,Jc,Vc,id,ed,cd,sd,ld,Ja,e4,Cd,Bd,jh,l4,Hn,g4,Ra,L4,p4,Wr,Qr,b4,Xr,Lh,ph,m4,y4,Ed,w4,F4,Dh,C4,B4,Hr,Kh,x4,A4,Jh,E4,v4,bh,Qi,mh,Yh,S4,yh,Xi,Wc,tf,nf,af,of,on,q4,I4,wh,O4,Fh,Dr,P4,M4,Hi,R4,z4,Ch,T4,G4,Ht,k4,U4,Bh,N4,xh,Kr,$4,Z4,Di,Ah,Eh,j4,V4,W4,Q4,Yi,J4,zn,bn,ns,as,hd,os,Jr,is,fd,vh,gd,Sh,pd,ad,es,cs,s8,l8,r8,d8,f8,g8,hf=xe(()=>{Im=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];Fn=ss;Pm=Xc,Mm=Vo;Nh=Fn(0),go=Fn(1),Qm=Object.freeze({__proto__:null,abs:Gm,add:yd,band:wd,bitLength:ae,bits:Mh,bor:$m,bxor:Zm,div:Wo,e:Fn,eq:fa,exp:Tm,fromArray:Om,fromRprBE:Uh,fromRprLE:ne,fromString:ss,geq:Gh,gt:Hc,isNegative:Oh,isOdd:md,isZero:bd,land:jm,leq:Nm,lnot:Wm,lor:Vm,lt:Um,mod:xa,mul:Th,naf:Ph,neg:zh,neq:km,one:go,pow:oe,shiftLeft:Xc,shiftRight:Vo,shl:Pm,shr:Mm,square:zm,sub:za,toArray:Rm,toLEBuff:Qo,toNumber:Rh,toRprBE:kh,toRprLE:te,toString:ls,zero:Nh}),od=class{constructor(t){this.F=t;let n=t.sqrt_t,a=t.sqrt_s,o=this.F.add(this.F.add(this.F.two,this.F.two),this.F.one);this.w=new Array(a+1),this.wi=new Array(a+1),this.w[a]=this.F.pow(o,n),this.wi[a]=this.F.inv(this.w[a]);let e=a-1;for(;e>=0;)this.w[e]=this.F.square(this.w[e+1]),this.wi[e]=this.F.square(this.wi[e+1]),e--;this.roots=[],this._setRoots(15)}_setRoots(t){t>this.F.sqrt_s&&(t=this.s);for(let n=t;n>=0&&!this.roots[n];n--){let a=this.F.one,o=1<<n,e=new Array(o);for(let h=0;h<o;h++)e[h]=a,a=this.F.mul(a,this.w[n]);this.roots[n]=e}}add(t,n){let a=Math.max(t.length,n.length),o=new Array(a);for(let e=0;e<a;e++)o[e]=this.F.add(t[e]||this.F.zero,n[e]||this.F.zero);return this.reduce(o)}double(t){return this.add(t,t)}sub(t,n){let a=Math.max(t.length,n.length),o=new Array(a);for(let e=0;e<a;e++)o[e]=this.F.sub(t[e]||this.F.zero,n[e]||this.F.zero);return this.reduce(o)}mulScalar(t,n){if(this.F.eq(n,this.F.zero))return[];if(this.F.eq(n,this.F.one))return t;let a=new Array(t.length);for(let o=0;o<t.length;o++)a[o]=this.F.mul(t[o],n);return a}mul(t,n){return t.length==0?[]:n.length==0?[]:t.length==1?this.mulScalar(n,t[0]):n.length==1?this.mulScalar(t,n[0]):(n.length>t.length&&([n,t]=[t,n]),n.length<=2||n.length<Ba(t.length)?this.mulNormal(t,n):this.mulFFT(t,n))}mulNormal(t,n){let a=[];for(let o=0;o<n.length;o++)a=this.add(a,this.scaleX(this.mulScalar(t,n[o]),o));return a}mulFFT(t,n){let a=Math.max(t.length,n.length),o=Ba(a-1)+2;this._setRoots(o);let e=1<<o,h=this.extend(t,e),d=this.extend(n,e),b=Lo(this,h,o,0,1),l=Lo(this,d,o,0,1),s=new Array(e);for(let v=0;v<e;v++)s[v]=this.F.mul(b[v],l[v]);let m=Lo(this,s,o,0,1),B=this.F.inv(this.F.mulScalar(this.F.one,e)),p=new Array(e);for(let v=0;v<e;v++)p[v]=this.F.mul(m[(e-v)%e],B);return this.reduce(p)}square(t){return this.mul(t,t)}scaleX(t,n){return n==0?t:n>0?new Array(n).fill(this.F.zero).concat(t):-n>=t.length?[]:t.slice(-n)}eval2(t,n){let a=this.F.zero,o=this.F.one;for(let e=0;e<t.length;e++)a=this.F.add(a,this.F.mul(t[e],o)),o=this.F.mul(o,n);return a}evaluate(t,n){let a=this.F;if(t.length==0)return a.zero;let o=this._next2Power(t.length),e=this.extend(t,o);return h(e,n,0,1,o);function h(d,b,l,s,m){if(m==1)return d[l];let B=a.square(b);return a.add(h(d,B,l,s<<1,m>>1),a.mul(b,h(d,B,l+s,s<<1,m>>1)))}}lagrange(t){let n=[this.F.one];for(let o=0;o<t.length;o++)n=this.mul(n,[this.F.neg(t[o][0]),this.F.one]);let a=[];for(let o=0;o<t.length;o++){let e=this.ruffini(n,t[o][0]),h=this.F.mul(this.F.inv(this.evaluate(e,t[o][0])),t[o][1]);e=this.mulScalar(e,h),a=this.add(a,e)}return a}fft(t){if(t.length<=1)return t;let n=Ba(t.length-1)+1;this._setRoots(n);let a=1<<n,o=this.extend(t,a);return Lo(this,o,n,0,1)}fft2(t){if(t.length<=1)return t;let n=Ba(t.length-1)+1;this._setRoots(n);let a=1<<n,o=this.extend(t,a);return _h(o,n),Dc(this,o,n)}ifft(t){if(t.length<=1)return t;let n=Ba(t.length-1)+1;this._setRoots(n);let a=1<<n,o=this.extend(t,a),e=Lo(this,o,n,0,1),h=this.F.inv(this.F.mulScalar(this.F.one,a)),d=new Array(a);for(let b=0;b<a;b++)d[b]=this.F.mul(e[(a-b)%a],h);return d}ifft2(t){if(t.length<=1)return t;let n=Ba(t.length-1)+1;this._setRoots(n);let a=1<<n,o=this.extend(t,a);_h(o,n);let e=Dc(this,o,n),h=this.F.inv(this.F.mulScalar(this.F.one,a)),d=new Array(a);for(let b=0;b<a;b++)d[b]=this.F.mul(e[(a-b)%a],h);return d}_fft(t,n,a,o){let e=1<<n;if(e==1)return[t[a]];let h=e>>1,d=this._fft(t,n-1,a,o*2),b=this._fft(t,n-1,a+o,o*2),l=new Array(e),s=this.F.one;for(let m=0;m<h;m++)l[m]=this.F.add(d[m],this.F.mul(s,b[m])),l[m+h]=this.F.sub(d[m],this.F.mul(s,b[m])),s=this.F.mul(s,this.w[n]);return l}extend(t,n){if(n==t.length)return t;let a=new Array(n-t.length).fill(this.F.zero);return t.concat(a)}reduce(t){if(t.length==0||!this.F.eq(t[t.length-1],this.F.zero))return t;let n=t.length-1;for(;n>0&&this.F.eq(t[n],this.F.zero);)n--;return t.slice(0,n+1)}eq(t,n){let a=this.reduce(t),o=this.reduce(n);if(a.length!=o.length)return!1;for(let e=0;e<o.length;e++)if(!this.F.eq(a[e],o[e]))return!1;return!0}ruffini(t,n){let a=new Array(t.length-1);a[a.length-1]=t[t.length-1];for(let o=a.length-2;o>=0;o--)a[o]=this.F.add(this.F.mul(a[o+1],n),t[o+1]);return a}_next2Power(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t++,t}toString(t){let n=this.normalize(t),a="";for(let o=n.length-1;o>=0;o--)this.F.eq(t[o],this.F.zero)||(a!=""&&(a+=" + "),a=a+t[o].toString(10),o>0&&(a=a+"x",o>1&&(a=a+"^"+o)));return a}normalize(t){let n=new Array(t.length);for(let a=0;a<t.length;a++)n[a]=this.F.normalize(t[a]);return n}_reciprocal(t,n){let a=1<<n;if(a==1)return[this.F.inv(t[0])];let o=this.scaleX(t,-a/2),e=this._reciprocal(o,n-1),h=this.scaleX(this.double(e),3*a/2-2),d=this.mul(this.square(e),t);return this.scaleX(this.sub(h,d),-(a-2))}_div2(t,n){let a=Ba(n.length-1)+1,o=1<<a,e=o-n.length,h=this._reciprocal(this.scaleX(n,e),a);return this.scaleX(h,t-2*o+2+e)}div(t,n){if(t.length<n.length)return[];let a=Ba(n.length-1)+1,o=1<<a,e=this.scaleX(t,o-n.length),h=this.scaleX(n,o-n.length),d=h.length-1,b=e.length-1,l=this._reciprocal(h,a),s;b>2*d&&(s=this.sub(this.scaleX([this.F.one],2*d),this.mul(l,h)));let m=[],B=e,p,v,M=!1;for(;!M;)p=this.mul(B,l),m=this.add(m,this.scaleX(p,-2*d)),b>2*d?(v=this.mul(B,s),B=this.scaleX(v,-2*d),b=B.length-1):M=!0;return m}oneRoot(t,n){let a=Ba(t-1)+1,o=this.F.one,e=n;if(n>=t)throw new Error("Given 'i' should be lower than 'n'");if(1<<a!==t)throw new Error(`Internal errlr: ${t} should equal ${1<<a}`);for(;e>0;)e&!0&&(o=this.F.mul(o,this.w[a])),e=e>>1,a--;return o}computeVanishingPolinomial(t,n){let a=1<<t;return this.F.sub(this.F.pow(n,a),this.F.one)}evaluateLagrangePolynomials(t,n){let a=1<<t,o=this.F.pow(n,a),e=new Array(a).fill(this.F.zero);this._setRoots(t);let h=this.w[t];if(this.F.eq(o,this.F.one)){for(let l=0;l<a;l++)if(this.F.eq(this.roots[t][0],n))return e[l]=this.F.one,e}let d=this.F.sub(o,this.F.one),b=this.F.mul(d,this.F.inv(this.F.e(a)));for(let l=0;l<a;l++)e[l]=this.F.mul(b,this.F.inv(this.F.sub(n,this.roots[t][l]))),b=this.F.mul(b,h);return e}log2(t){return Ba(t)}};Ji=[];for(let c=0;c<256;c++)Ji[c]=Xm(c,8);Jc=class{constructor(t){t=t||[0,0,0,0,0,0,0,0],this.state=[1634760805,857760878,2036477234,1797285236,t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],0,0,0,0],this.idx=16,this.buff=new Array(16)}nextU32(){return this.idx==16&&this.update(),this.buff[this.idx++]}nextU64(){return yd(Th(this.nextU32(),4294967296),this.nextU32())}nextBool(){return(this.nextU32()&1)==1}update(){for(let t=0;t<16;t++)this.buff[t]=this.state[t];for(let t=0;t<10;t++)o4(this.buff);for(let t=0;t<16;t++)this.buff[t]=this.buff[t]+this.state[t]>>>0;this.idx=0,this.state[12]=this.state[12]+1>>>0,this.state[12]==0&&(this.state[13]=this.state[13]+1>>>0,this.state[13]==0&&(this.state[14]=this.state[14]+1>>>0,this.state[14]==0&&(this.state[15]=this.state[15]+1>>>0)))}};Vc=null;id=class{constructor(t,n,a){this.F=n,this.G=t,this.opMulGF=a;let o=n.sqrt_t||n.t,e=n.sqrt_s||n.s,h=n.one;for(;n.eq(n.pow(h,n.half),n.one);)h=n.add(h,n.one);this.w=new Array(e+1),this.wi=new Array(e+1),this.w[e]=this.F.pow(h,o),this.wi[e]=this.F.inv(this.w[e]);let d=e-1;for(;d>=0;)this.w[d]=this.F.square(this.w[d+1]),this.wi[d]=this.F.square(this.wi[d+1]),d--;this.roots=[],this._setRoots(Math.min(e,15))}_setRoots(t){for(let n=t;n>=0&&!this.roots[n];n--){let a=this.F.one,o=1<<n,e=new Array(o);for(let h=0;h<o;h++)e[h]=a,a=this.F.mul(a,this.w[n]);this.roots[n]=e}}fft(t){if(t.length<=1)return t;let n=hh(t.length-1)+1;this._setRoots(n);let a=1<<n;if(t.length!=a)throw new Error("Size must be multiple of 2");return Yc(this,t,n,0,1)}ifft(t){if(t.length<=1)return t;let n=hh(t.length-1)+1;this._setRoots(n);let a=1<<n;if(t.length!=a)throw new Error("Size must be multiple of 2");let o=Yc(this,t,n,0,1),e=this.F.inv(this.F.mulScalar(this.F.one,a)),h=new Array(a);for(let d=0;d<a;d++)h[d]=this.opMulGF(o[(a-d)%a],e);return h}};ed=class{constructor(t){this.type="F1",this.one=BigInt(1),this.zero=BigInt(0),this.p=BigInt(t),this.m=1,this.negone=this.p-this.one,this.two=BigInt(2),this.half=this.p>>this.one,this.bitLength=ae(this.p),this.mask=(this.one<<BigInt(this.bitLength))-this.one,this.n64=Math.floor((this.bitLength-1)/64)+1,this.n32=this.n64*2,this.n8=this.n64*8,this.R=this.e(this.one<<BigInt(this.n64*64)),this.Ri=this.inv(this.R);let n=this.negone>>this.one;this.nqr=this.two;let a=this.pow(this.nqr,n);for(;!this.eq(a,this.negone);)this.nqr=this.nqr+this.one,a=this.pow(this.nqr,n);for(this.s=0,this.t=this.negone;(this.t&this.one)==this.zero;)this.s=this.s+1,this.t=this.t>>this.one;this.nqr_to_t=this.pow(this.nqr,this.t),$h(this),this.FFT=new id(this,this,this.mul.bind(this)),this.fft=this.FFT.fft.bind(this.FFT),this.ifft=this.FFT.ifft.bind(this.FFT),this.w=this.FFT.w,this.wi=this.FFT.wi,this.shift=this.square(this.nqr),this.k=this.exp(this.nqr,2**this.s)}e(t,n){let a;if(n?n==16&&(a=BigInt("0x"+t)):a=BigInt(t),a<0){let o=-a;return o>=this.p&&(o=o%this.p),this.p-o}else return a>=this.p?a%this.p:a}add(t,n){let a=t+n;return a>=this.p?a-this.p:a}sub(t,n){return t>=n?t-n:this.p-n+t}neg(t){return t&&this.p-t}mul(t,n){return t*n%this.p}mulScalar(t,n){return t*this.e(n)%this.p}square(t){return t*t%this.p}eq(t,n){return t==n}neq(t,n){return t!=n}lt(t,n){let a=t>this.half?t-this.p:t,o=n>this.half?n-this.p:n;return a<o}gt(t,n){let a=t>this.half?t-this.p:t,o=n>this.half?n-this.p:n;return a>o}leq(t,n){let a=t>this.half?t-this.p:t,o=n>this.half?n-this.p:n;return a<=o}geq(t,n){let a=t>this.half?t-this.p:t,o=n>this.half?n-this.p:n;return a>=o}div(t,n){return this.mul(t,this.inv(n))}idiv(t,n){if(!n)throw new Error("Division by zero");return t/n}inv(t){if(!t)throw new Error("Division by zero");let n=this.zero,a=this.p,o=this.one,e=t%this.p;for(;e;){let h=a/e;[n,o]=[o,n-h*o],[a,e]=[e,a-h*e]}return n<this.zero&&(n+=this.p),n}mod(t,n){return t%n}pow(t,n){return Xo(this,t,n)}exp(t,n){return Xo(this,t,n)}band(t,n){let a=t&n&this.mask;return a>=this.p?a-this.p:a}bor(t,n){let a=(t|n)&this.mask;return a>=this.p?a-this.p:a}bxor(t,n){let a=(t^n)&this.mask;return a>=this.p?a-this.p:a}bnot(t){let n=t^this.mask;return n>=this.p?n-this.p:n}shl(t,n){if(Number(n)<this.bitLength){let a=t<<n&this.mask;return a>=this.p?a-this.p:a}else{let a=this.p-n;return Number(a)<this.bitLength?t>>a:this.zero}}shr(t,n){if(Number(n)<this.bitLength)return t>>n;{let a=this.p-n;if(Number(a)<this.bitLength){let o=t<<a&this.mask;return o>=this.p?o-this.p:o}else return 0}}land(t,n){return t&&n?this.one:this.zero}lor(t,n){return t||n?this.one:this.zero}lnot(t){return t?this.zero:this.one}sqrt_old(t){if(t==this.zero)return this.zero;if(this.pow(t,this.negone>>this.one)!=this.one)return null;let a=this.s,o=this.nqr_to_t,e=this.pow(t,this.t),h=this.pow(t,this.add(this.t,this.one)>>this.one);for(;e!=this.one;){let d=this.square(e),b=1;for(;d!=this.one;)b++,d=this.square(d);let l=o;for(let s=0;s<a-b-1;s++)l=this.square(l);a=b,o=this.square(l),e=this.mul(e,o),h=this.mul(h,l)}return h>this.p>>this.one&&(h=this.neg(h)),h}normalize(t,n){if(t=BigInt(t,n),t<0){let a=-t;return a>=this.p&&(a=a%this.p),this.p-a}else return t>=this.p?t%this.p:t}random(){let t=this.bitLength*2/8,n=this.zero;for(let a=0;a<t;a++)n=(n<<BigInt(8))+BigInt(Zh(1)[0]);return n%this.p}toString(t,n){n=n||10;let a;return t>this.half&&n==10?a="-"+(this.p-t).toString(n):a=t.toString(n),a}isZero(t){return t==this.zero}fromRng(t){let n;do{n=this.zero;for(let a=0;a<this.n64;a++)n+=t.nextU64()<<BigInt(64*a);n&=this.mask}while(n>=this.p);return n=n*this.Ri%this.p,n}fft(t){return this.FFT.fft(t)}ifft(t){return this.FFT.ifft(t)}toRprLE(t,n,a){te(t,n,a,this.n64*8)}toRprBE(t,n,a){kh(t,n,a,this.n64*8)}toRprBEM(t,n,a){return this.toRprBE(t,n,this.mul(this.R,a))}toRprLEM(t,n,a){return this.toRprLE(t,n,this.mul(this.R,a))}fromRprLE(t,n){return ne(t,n,this.n8)}fromRprBE(t,n){return Uh(t,n,this.n8)}fromRprLEM(t,n){return this.mul(this.fromRprLE(t,n),this.Ri)}fromRprBEM(t,n){return this.mul(this.fromRprBE(t,n),this.Ri)}toObject(t){return t}},cd=class{constructor(t,n){this.type="F2",this.F=t,this.zero=[this.F.zero,this.F.zero],this.one=[this.F.one,this.F.zero],this.negone=this.neg(this.one),this.nonResidue=n,this.m=t.m*2,this.p=t.p,this.n64=t.n64*2,this.n32=this.n64*2,this.n8=this.n64*8,$h(this)}_mulByNonResidue(t){return this.F.mul(this.nonResidue,t)}copy(t){return[this.F.copy(t[0]),this.F.copy(t[1])]}add(t,n){return[this.F.add(t[0],n[0]),this.F.add(t[1],n[1])]}double(t){return this.add(t,t)}sub(t,n){return[this.F.sub(t[0],n[0]),this.F.sub(t[1],n[1])]}neg(t){return this.sub(this.zero,t)}conjugate(t){return[t[0],this.F.neg(t[1])]}mul(t,n){let a=this.F.mul(t[0],n[0]),o=this.F.mul(t[1],n[1]);return[this.F.add(a,this._mulByNonResidue(o)),this.F.sub(this.F.mul(this.F.add(t[0],t[1]),this.F.add(n[0],n[1])),this.F.add(a,o))]}inv(t){let n=this.F.square(t[0]),a=this.F.square(t[1]),o=this.F.sub(n,this._mulByNonResidue(a)),e=this.F.inv(o);return[this.F.mul(t[0],e),this.F.neg(this.F.mul(t[1],e))]}div(t,n){return this.mul(t,this.inv(n))}square(t){let n=this.F.mul(t[0],t[1]);return[this.F.sub(this.F.mul(this.F.add(t[0],t[1]),this.F.add(t[0],this._mulByNonResidue(t[1]))),this.F.add(n,this._mulByNonResidue(n))),this.F.add(n,n)]}isZero(t){return this.F.isZero(t[0])&&this.F.isZero(t[1])}eq(t,n){return this.F.eq(t[0],n[0])&&this.F.eq(t[1],n[1])}mulScalar(t,n){return Kc(this,t,n)}pow(t,n){return Xo(this,t,n)}exp(t,n){return Xo(this,t,n)}toString(t){return`[ ${this.F.toString(t[0])} , ${this.F.toString(t[1])} ]`}fromRng(t){let n=this.F.fromRng(t),a=this.F.fromRng(t);return[n,a]}gt(t,n){return this.F.gt(t[0],n[0])?!0:this.F.gt(n[0],t[0])?!1:!!this.F.gt(t[1],n[1])}geq(t,n){return this.gt(t,n)||this.eq(t,n)}lt(t,n){return!this.geq(t,n)}leq(t,n){return!this.gt(t,n)}neq(t,n){return!this.eq(t,n)}random(){return[this.F.random(),this.F.random()]}toRprLE(t,n,a){this.F.toRprLE(t,n,a[0]),this.F.toRprLE(t,n+this.F.n8,a[1])}toRprBE(t,n,a){this.F.toRprBE(t,n,a[1]),this.F.toRprBE(t,n+this.F.n8,a[0])}toRprLEM(t,n,a){this.F.toRprLEM(t,n,a[0]),this.F.toRprLEM(t,n+this.F.n8,a[1])}toRprBEM(t,n,a){this.F.toRprBEM(t,n,a[1]),this.F.toRprBEM(t,n+this.F.n8,a[0])}fromRprLE(t,n){n=n||0;let a=this.F.fromRprLE(t,n),o=this.F.fromRprLE(t,n+this.F.n8);return[a,o]}fromRprBE(t,n){n=n||0;let a=this.F.fromRprBE(t,n);return[this.F.fromRprBE(t,n+this.F.n8),a]}fromRprLEM(t,n){n=n||0;let a=this.F.fromRprLEM(t,n),o=this.F.fromRprLEM(t,n+this.F.n8);return[a,o]}fromRprBEM(t,n){n=n||0;let a=this.F.fromRprBEM(t,n);return[this.F.fromRprBEM(t,n+this.F.n8),a]}toObject(t){return t}},sd=class{constructor(t,n){this.type="F3",this.F=t,this.zero=[this.F.zero,this.F.zero,this.F.zero],this.one=[this.F.one,this.F.zero,this.F.zero],this.negone=this.neg(this.one),this.nonResidue=n,this.m=t.m*3,this.p=t.p,this.n64=t.n64*3,this.n32=this.n64*2,this.n8=this.n64*8}_mulByNonResidue(t){return this.F.mul(this.nonResidue,t)}copy(t){return[this.F.copy(t[0]),this.F.copy(t[1]),this.F.copy(t[2])]}add(t,n){return[this.F.add(t[0],n[0]),this.F.add(t[1],n[1]),this.F.add(t[2],n[2])]}double(t){return this.add(t,t)}sub(t,n){return[this.F.sub(t[0],n[0]),this.F.sub(t[1],n[1]),this.F.sub(t[2],n[2])]}neg(t){return this.sub(this.zero,t)}mul(t,n){let a=this.F.mul(t[0],n[0]),o=this.F.mul(t[1],n[1]),e=this.F.mul(t[2],n[2]);return[this.F.add(a,this._mulByNonResidue(this.F.sub(this.F.mul(this.F.add(t[1],t[2]),this.F.add(n[1],n[2])),this.F.add(o,e)))),this.F.add(this.F.sub(this.F.mul(this.F.add(t[0],t[1]),this.F.add(n[0],n[1])),this.F.add(a,o)),this._mulByNonResidue(e)),this.F.add(this.F.sub(this.F.mul(this.F.add(t[0],t[2]),this.F.add(n[0],n[2])),this.F.add(a,e)),o)]}inv(t){let n=this.F.square(t[0]),a=this.F.square(t[1]),o=this.F.square(t[2]),e=this.F.mul(t[0],t[1]),h=this.F.mul(t[0],t[2]),d=this.F.mul(t[1],t[2]),b=this.F.sub(n,this._mulByNonResidue(d)),l=this.F.sub(this._mulByNonResidue(o),e),s=this.F.sub(a,h),m=this.F.inv(this.F.add(this.F.mul(t[0],b),this._mulByNonResidue(this.F.add(this.F.mul(t[2],l),this.F.mul(t[1],s)))));return[this.F.mul(m,b),this.F.mul(m,l),this.F.mul(m,s)]}div(t,n){return this.mul(t,this.inv(n))}square(t){let n=this.F.square(t[0]),a=this.F.mul(t[0],t[1]),o=this.F.add(a,a),e=this.F.square(this.F.add(this.F.sub(t[0],t[1]),t[2])),h=this.F.mul(t[1],t[2]),d=this.F.add(h,h),b=this.F.square(t[2]);return[this.F.add(n,this._mulByNonResidue(d)),this.F.add(o,this._mulByNonResidue(b)),this.F.sub(this.F.add(this.F.add(o,e),d),this.F.add(n,b))]}isZero(t){return this.F.isZero(t[0])&&this.F.isZero(t[1])&&this.F.isZero(t[2])}eq(t,n){return this.F.eq(t[0],n[0])&&this.F.eq(t[1],n[1])&&this.F.eq(t[2],n[2])}affine(t){return[this.F.affine(t[0]),this.F.affine(t[1]),this.F.affine(t[2])]}mulScalar(t,n){return Kc(this,t,n)}pow(t,n){return Xo(this,t,n)}exp(t,n){return Xo(this,t,n)}toString(t){return`[ ${this.F.toString(t[0])} , ${this.F.toString(t[1])}, ${this.F.toString(t[2])} ]`}fromRng(t){let n=this.F.fromRng(t),a=this.F.fromRng(t),o=this.F.fromRng(t);return[n,a,o]}gt(t,n){return this.F.gt(t[0],n[0])?!0:this.F.gt(n[0],t[0])?!1:this.F.gt(t[1],n[1])?!0:this.F.gt(n[1],t[1])?!1:!!this.F.gt(t[2],n[2])}geq(t,n){return this.gt(t,n)||this.eq(t,n)}lt(t,n){return!this.geq(t,n)}leq(t,n){return!this.gt(t,n)}neq(t,n){return!this.eq(t,n)}random(){return[this.F.random(),this.F.random(),this.F.random()]}toRprLE(t,n,a){this.F.toRprLE(t,n,a[0]),this.F.toRprLE(t,n+this.F.n8,a[1]),this.F.toRprLE(t,n+this.F.n8*2,a[2])}toRprBE(t,n,a){this.F.toRprBE(t,n,a[2]),this.F.toRprBE(t,n+this.F.n8,a[1]),this.F.toRprBE(t,n+this.F.n8*2,a[0])}toRprLEM(t,n,a){this.F.toRprLEM(t,n,a[0]),this.F.toRprLEM(t,n+this.F.n8,a[1]),this.F.toRprLEM(t,n+this.F.n8*2,a[2])}toRprBEM(t,n,a){this.F.toRprBEM(t,n,a[2]),this.F.toRprBEM(t,n+this.F.n8,a[1]),this.F.toRprBEM(t,n+this.F.n8*2,a[0])}fromRprLE(t,n){n=n||0;let a=this.F.fromRprLE(t,n),o=this.F.fromRprLE(t,n+this.n8),e=this.F.fromRprLE(t,n+this.n8*2);return[a,o,e]}fromRprBE(t,n){n=n||0;let a=this.F.fromRprBE(t,n),o=this.F.fromRprBE(t,n+this.n8);return[this.F.fromRprBE(t,n+this.n8*2),o,a]}fromRprLEM(t,n){n=n||0;let a=this.F.fromRprLEM(t,n),o=this.F.fromRprLEM(t,n+this.n8),e=this.F.fromRprLEM(t,n+this.n8*2);return[a,o,e]}fromRprBEM(t,n){n=n||0;let a=this.F.fromRprBEM(t,n),o=this.F.fromRprBEM(t,n+this.n8);return[this.F.fromRprBEM(t,n+this.n8*2),o,a]}toObject(t){return t}};ld=class{constructor(t,n){this.F=t,this.g=n,this.g.length==2&&(this.g[2]=this.F.one),this.zero=[this.F.zero,this.F.one,this.F.zero]}add(t,n){let a=this.F;if(this.eq(t,this.zero))return n;if(this.eq(n,this.zero))return t;let o=new Array(3),e=a.square(t[2]),h=a.square(n[2]),d=a.mul(t[0],h),b=a.mul(n[0],e),l=a.mul(t[2],e),s=a.mul(n[2],h),m=a.mul(t[1],s),B=a.mul(n[1],l);if(a.eq(d,b)&&a.eq(m,B))return this.double(t);let p=a.sub(b,d),v=a.sub(B,m),M=a.square(a.add(p,p)),x=a.mul(p,M),S=a.add(v,v),w=a.mul(d,M);o[0]=a.sub(a.sub(a.square(S),x),a.add(w,w));let k=a.mul(m,x);return o[1]=a.sub(a.mul(S,a.sub(w,o[0])),a.add(k,k)),o[2]=a.mul(p,a.sub(a.square(a.add(t[2],n[2])),a.add(e,h))),o}neg(t){return[t[0],this.F.neg(t[1]),t[2]]}sub(t,n){return this.add(t,this.neg(n))}double(t){let n=this.F,a=new Array(3);if(this.eq(t,this.zero))return t;let o=n.square(t[0]),e=n.square(t[1]),h=n.square(e),d=n.sub(n.square(n.add(t[0],e)),n.add(o,h));d=n.add(d,d);let b=n.add(n.add(o,o),o),l=n.square(b);a[0]=n.sub(l,n.add(d,d));let s=n.add(h,h);s=n.add(s,s),s=n.add(s,s),a[1]=n.sub(n.mul(b,n.sub(d,a[0])),s);let m=n.mul(t[1],t[2]);return a[2]=n.add(m,m),a}timesScalar(t,n){return Kc(this,t,n)}mulScalar(t,n){return Kc(this,t,n)}affine(t){let n=this.F;if(this.isZero(t))return this.zero;if(n.eq(t[2],n.one))return t;{let a=n.inv(t[2]),o=n.square(a),e=n.mul(o,a),h=new Array(3);return h[0]=n.mul(t[0],o),h[1]=n.mul(t[1],e),h[2]=n.one,h}}multiAffine(t){let n=Object.keys(t),a=this.F,o=new Array(n.length+1);o[0]=a.one;for(let e=0;e<n.length;e++)a.eq(t[n[e]][2],a.zero)?o[e+1]=o[e]:o[e+1]=a.mul(o[e],t[n[e]][2]);o[n.length]=a.inv(o[n.length]);for(let e=n.length-1;e>=0;e--)if(a.eq(t[n[e]][2],a.zero))o[e]=o[e+1],t[n[e]]=this.zero;else{let h=a.mul(o[e],o[e+1]);o[e]=a.mul(t[n[e]][2],o[e+1]);let d=a.square(h),b=a.mul(d,h);t[n[e]][0]=a.mul(t[n[e]][0],d),t[n[e]][1]=a.mul(t[n[e]][1],b),t[n[e]][2]=a.one}}eq(t,n){let a=this.F;if(this.F.eq(t[2],this.F.zero))return this.F.eq(n[2],this.F.zero);if(this.F.eq(n[2],this.F.zero))return!1;let o=a.square(t[2]),e=a.square(n[2]),h=a.mul(t[0],e),d=a.mul(n[0],o),b=a.mul(t[2],o),l=a.mul(n[2],e),s=a.mul(t[1],l),m=a.mul(n[1],b);return a.eq(h,d)&&a.eq(s,m)}isZero(t){return this.F.isZero(t[2])}toString(t){let n=this.affine(t);return`[ ${this.F.toString(n[0])} , ${this.F.toString(n[1])} ]`}fromRng(t){let n=this.F,a=[],o;do{a[0]=n.fromRng(t),o=t.nextBool();let h=n.add(n.mul(n.square(a[0]),a[0]),this.b);a[1]=n.sqrt(h)}while(a[1]==null||n.isZero[a]);let e=Qc(n,a[1]);return o^e&&(a[1]=n.neg(a[1])),a[2]=n.one,this.cofactor&&(a=this.mulScalar(a,this.cofactor)),a=this.affine(a),a}toRprLE(t,n,a){if(a=this.affine(a),this.isZero(a)){new Uint8Array(t,n,this.F.n8*2).fill(0);return}this.F.toRprLE(t,n,a[0]),this.F.toRprLE(t,n+this.F.n8,a[1])}toRprBE(t,n,a){if(a=this.affine(a),this.isZero(a)){new Uint8Array(t,n,this.F.n8*2).fill(0);return}this.F.toRprBE(t,n,a[0]),this.F.toRprBE(t,n+this.F.n8,a[1])}toRprLEM(t,n,a){if(a=this.affine(a),this.isZero(a)){new Uint8Array(t,n,this.F.n8*2).fill(0);return}this.F.toRprLEM(t,n,a[0]),this.F.toRprLEM(t,n+this.F.n8,a[1])}toRprLEJM(t,n,a){if(a=this.affine(a),this.isZero(a)){new Uint8Array(t,n,this.F.n8*2).fill(0);return}this.F.toRprLEM(t,n,a[0]),this.F.toRprLEM(t,n+this.F.n8,a[1]),this.F.toRprLEM(t,n+2*this.F.n8,a[2])}toRprBEM(t,n,a){if(a=this.affine(a),this.isZero(a)){new Uint8Array(t,n,this.F.n8*2).fill(0);return}this.F.toRprBEM(t,n,a[0]),this.F.toRprBEM(t,n+this.F.n8,a[1])}fromRprLE(t,n){n=n||0;let a=this.F.fromRprLE(t,n),o=this.F.fromRprLE(t,n+this.F.n8);return this.F.isZero(a)&&this.F.isZero(o)?this.zero:[a,o,this.F.one]}fromRprBE(t,n){n=n||0;let a=this.F.fromRprBE(t,n),o=this.F.fromRprBE(t,n+this.F.n8);return this.F.isZero(a)&&this.F.isZero(o)?this.zero:[a,o,this.F.one]}fromRprLEM(t,n){n=n||0;let a=this.F.fromRprLEM(t,n),o=this.F.fromRprLEM(t,n+this.F.n8);return this.F.isZero(a)&&this.F.isZero(o)?this.zero:[a,o,this.F.one]}fromRprLEJM(t,n){n=n||0;let a=this.F.fromRprLEM(t,n),o=this.F.fromRprLEM(t,n+this.F.n8),e=this.F.fromRprLEM(t,n+this.F.n8*2);return this.F.isZero(a)&&this.F.isZero(o)?this.zero:[a,o,e]}fromRprBEM(t,n){n=n||0;let a=this.F.fromRprBEM(t,n),o=this.F.fromRprBEM(t,n+this.F.n8);return this.F.isZero(a)&&this.F.isZero(o)?this.zero:[a,o,this.F.one]}fromRprCompressed(t,n){let a=this.F,o=new Uint8Array(t.buffer,n,a.n8);if(o[0]&64)return this.zero;let e=new Array(3),h=(o[0]&128)!=0;o[0]=o[0]&127,e[0]=a.fromRprBE(t,n),h&&(o[0]=o[0]|128);let d=a.add(a.mul(a.square(e[0]),e[0]),this.b);if(e[1]=a.sqrt(d),e[1]===null)throw new Error("Invalid Point!");let b=Qc(a,e[1]);return h^b&&(e[1]=a.neg(e[1])),e[2]=a.one,e}toRprCompressed(t,n,a){a=this.affine(a);let o=new Uint8Array(t.buffer,n,this.F.n8);if(this.isZero(a)){o.fill(0),o[0]=64;return}this.F.toRprBE(t,n,a[0]),Qc(this.F,a[1])&&(o[0]=o[0]|128)}fromRprUncompressed(t,n){return t[0]&64?this.zero:this.fromRprBE(t,n)}toRprUncompressed(t,n,a){this.toRprBE(t,n,a),this.isZero(a)&&(t[n]=t[n]|64)}},Ja={};Ja.bigInt2BytesLE=function(t,n){let a=Array(n),o=BigInt(t);for(let e=0;e<n;e++)a[e]=Number(o&0xFFn),o=o>>8n;return a};Ja.bigInt2U32LE=function(t,n){let a=Array(n),o=BigInt(t);for(let e=0;e<n;e++)a[e]=Number(o&0xFFFFFFFFn),o=o>>32n;return a};Ja.isOcamNum=function(c){return!(!Array.isArray(c)||c.length!=3||typeof c[0]!="number"||typeof c[1]!="number"||!Array.isArray(c[2]))};e4=function(t,n,a){let o=a||"int";if(t.modules[o])return o;t.modules[o]={};let e=n*2,h=n*8;function d(){let F=t.addFunction(o+"_copy");F.addParam("px","i32"),F.addParam("pr","i32");let u=F.getCodeBuilder();for(let L=0;L<n;L++)F.addCode(u.i64_store(u.getLocal("pr"),L*8,u.i64_load(u.getLocal("px"),L*8)))}function b(){let F=t.addFunction(o+"_zero");F.addParam("pr","i32");let u=F.getCodeBuilder();for(let L=0;L<n;L++)F.addCode(u.i64_store(u.getLocal("pr"),L*8,u.i64_const(0)))}function l(){let F=t.addFunction(o+"_one");F.addParam("pr","i32");let u=F.getCodeBuilder();F.addCode(u.i64_store(u.getLocal("pr"),0,u.i64_const(1)));for(let L=1;L<n;L++)F.addCode(u.i64_store(u.getLocal("pr"),L*8,u.i64_const(0)))}function s(){let F=t.addFunction(o+"_isZero");F.addParam("px","i32"),F.setReturnType("i32");let u=F.getCodeBuilder();function L($){return $==0?u.ret(u.i64_eqz(u.i64_load(u.getLocal("px")))):u.if(u.i64_eqz(u.i64_load(u.getLocal("px"),$*8)),L($-1),u.ret(u.i32_const(0)))}F.addCode(L(n-1)),F.addCode(u.ret(u.i32_const(0)))}function m(){let F=t.addFunction(o+"_eq");F.addParam("px","i32"),F.addParam("py","i32"),F.setReturnType("i32");let u=F.getCodeBuilder();function L($){return $==0?u.ret(u.i64_eq(u.i64_load(u.getLocal("px")),u.i64_load(u.getLocal("py")))):u.if(u.i64_eq(u.i64_load(u.getLocal("px"),$*8),u.i64_load(u.getLocal("py"),$*8)),L($-1),u.ret(u.i32_const(0)))}F.addCode(L(n-1)),F.addCode(u.ret(u.i32_const(0)))}function B(){let F=t.addFunction(o+"_gte");F.addParam("px","i32"),F.addParam("py","i32"),F.setReturnType("i32");let u=F.getCodeBuilder();function L($){return $==0?u.ret(u.i64_ge_u(u.i64_load(u.getLocal("px")),u.i64_load(u.getLocal("py")))):u.if(u.i64_lt_u(u.i64_load(u.getLocal("px"),$*8),u.i64_load(u.getLocal("py"),$*8)),u.ret(u.i32_const(0)),u.if(u.i64_gt_u(u.i64_load(u.getLocal("px"),$*8),u.i64_load(u.getLocal("py"),$*8)),u.ret(u.i32_const(1)),L($-1)))}F.addCode(L(n-1)),F.addCode(u.ret(u.i32_const(0)))}function p(){let F=t.addFunction(o+"_add");F.addParam("x","i32"),F.addParam("y","i32"),F.addParam("r","i32"),F.setReturnType("i32"),F.addLocal("c","i64");let u=F.getCodeBuilder();F.addCode(u.setLocal("c",u.i64_add(u.i64_load32_u(u.getLocal("x")),u.i64_load32_u(u.getLocal("y"))))),F.addCode(u.i64_store32(u.getLocal("r"),u.getLocal("c")));for(let L=1;L<e;L++)F.addCode(u.setLocal("c",u.i64_add(u.i64_add(u.i64_load32_u(u.getLocal("x"),4*L),u.i64_load32_u(u.getLocal("y"),4*L)),u.i64_shr_u(u.getLocal("c"),u.i64_const(32))))),F.addCode(u.i64_store32(u.getLocal("r"),L*4,u.getLocal("c")));F.addCode(u.i32_wrap_i64(u.i64_shr_u(u.getLocal("c"),u.i64_const(32))))}function v(){let F=t.addFunction(o+"_sub");F.addParam("x","i32"),F.addParam("y","i32"),F.addParam("r","i32"),F.setReturnType("i32"),F.addLocal("c","i64");let u=F.getCodeBuilder();F.addCode(u.setLocal("c",u.i64_sub(u.i64_load32_u(u.getLocal("x")),u.i64_load32_u(u.getLocal("y"))))),F.addCode(u.i64_store32(u.getLocal("r"),u.i64_and(u.getLocal("c"),u.i64_const("0xFFFFFFFF"))));for(let L=1;L<e;L++)F.addCode(u.setLocal("c",u.i64_add(u.i64_sub(u.i64_load32_u(u.getLocal("x"),4*L),u.i64_load32_u(u.getLocal("y"),4*L)),u.i64_shr_s(u.getLocal("c"),u.i64_const(32))))),F.addCode(u.i64_store32(u.getLocal("r"),L*4,u.i64_and(u.getLocal("c"),u.i64_const("0xFFFFFFFF"))));F.addCode(u.i32_wrap_i64(u.i64_shr_s(u.getLocal("c"),u.i64_const(32))))}function M(){let F=t.addFunction(o+"_mul");F.addParam("x","i32"),F.addParam("y","i32"),F.addParam("r","i32"),F.addLocal("c0","i64"),F.addLocal("c1","i64");for(let y=0;y<e;y++)F.addLocal("x"+y,"i64"),F.addLocal("y"+y,"i64");let u=F.getCodeBuilder(),L=[],$=[];function Q(y,I){let N,nt;return L[y]?N=u.getLocal("x"+y):(N=u.teeLocal("x"+y,u.i64_load32_u(u.getLocal("x"),y*4)),L[y]=!0),$[I]?nt=u.getLocal("y"+I):(nt=u.teeLocal("y"+I,u.i64_load32_u(u.getLocal("y"),I*4)),$[I]=!0),u.i64_mul(N,nt)}let H="c0",q="c1";for(let y=0;y<e*2-1;y++){for(let I=Math.max(0,y-e+1);I<=y&&I<e;I++){let N=y-I;F.addCode(u.setLocal(H,u.i64_add(u.i64_and(u.getLocal(H),u.i64_const(4294967295)),Q(I,N)))),F.addCode(u.setLocal(q,u.i64_add(u.getLocal(q),u.i64_shr_u(u.getLocal(H),u.i64_const(32)))))}F.addCode(u.i64_store32(u.getLocal("r"),y*4,u.getLocal(H))),[H,q]=[q,H],F.addCode(u.setLocal(q,u.i64_shr_u(u.getLocal(H),u.i64_const(32))))}F.addCode(u.i64_store32(u.getLocal("r"),e*4*2-4,u.getLocal(H)))}function x(){let F=t.addFunction(o+"_square");F.addParam("x","i32"),F.addParam("r","i32"),F.addLocal("c0","i64"),F.addLocal("c1","i64"),F.addLocal("c0_old","i64"),F.addLocal("c1_old","i64");for(let I=0;I<e;I++)F.addLocal("x"+I,"i64");let u=F.getCodeBuilder(),L=[];function $(I,N){let nt,J;return L[I]?nt=u.getLocal("x"+I):(nt=u.teeLocal("x"+I,u.i64_load32_u(u.getLocal("x"),I*4)),L[I]=!0),L[N]?J=u.getLocal("x"+N):(J=u.teeLocal("x"+N,u.i64_load32_u(u.getLocal("x"),N*4)),L[N]=!0),u.i64_mul(nt,J)}let Q="c0",H="c1",q="c0_old",y="c1_old";for(let I=0;I<e*2-1;I++){F.addCode(u.setLocal(Q,u.i64_const(0)),u.setLocal(H,u.i64_const(0)));for(let N=Math.max(0,I-e+1);N<I+1>>1&&N<e;N++){let nt=I-N;F.addCode(u.setLocal(Q,u.i64_add(u.i64_and(u.getLocal(Q),u.i64_const(4294967295)),$(N,nt)))),F.addCode(u.setLocal(H,u.i64_add(u.getLocal(H),u.i64_shr_u(u.getLocal(Q),u.i64_const(32)))))}F.addCode(u.setLocal(Q,u.i64_shl(u.i64_and(u.getLocal(Q),u.i64_const(4294967295)),u.i64_const(1)))),F.addCode(u.setLocal(H,u.i64_add(u.i64_shl(u.getLocal(H),u.i64_const(1)),u.i64_shr_u(u.getLocal(Q),u.i64_const(32))))),I%2==0&&(F.addCode(u.setLocal(Q,u.i64_add(u.i64_and(u.getLocal(Q),u.i64_const(4294967295)),$(I>>1,I>>1)))),F.addCode(u.setLocal(H,u.i64_add(u.getLocal(H),u.i64_shr_u(u.getLocal(Q),u.i64_const(32)))))),I>0&&(F.addCode(u.setLocal(Q,u.i64_add(u.i64_and(u.getLocal(Q),u.i64_const(4294967295)),u.i64_and(u.getLocal(q),u.i64_const(4294967295))))),F.addCode(u.setLocal(H,u.i64_add(u.i64_add(u.getLocal(H),u.i64_shr_u(u.getLocal(Q),u.i64_const(32))),u.getLocal(y))))),F.addCode(u.i64_store32(u.getLocal("r"),I*4,u.getLocal(Q))),F.addCode(u.setLocal(q,u.getLocal(H)),u.setLocal(y,u.i64_shr_u(u.getLocal(q),u.i64_const(32))))}F.addCode(u.i64_store32(u.getLocal("r"),e*4*2-4,u.getLocal(q)))}function S(){let F=t.addFunction(o+"_squareOld");F.addParam("x","i32"),F.addParam("r","i32");let u=F.getCodeBuilder();F.addCode(u.call(o+"_mul",u.getLocal("x"),u.getLocal("x"),u.getLocal("r")))}function w(){let F=t.addFunction(o+"__mul1");F.addParam("px","i32"),F.addParam("y","i64"),F.addParam("pr","i32"),F.addLocal("c","i64");let u=F.getCodeBuilder();F.addCode(u.setLocal("c",u.i64_mul(u.i64_load32_u(u.getLocal("px"),0,0),u.getLocal("y")))),F.addCode(u.i64_store32(u.getLocal("pr"),0,0,u.getLocal("c")));for(let L=1;L<e;L++)F.addCode(u.setLocal("c",u.i64_add(u.i64_mul(u.i64_load32_u(u.getLocal("px"),4*L,0),u.getLocal("y")),u.i64_shr_u(u.getLocal("c"),u.i64_const(32))))),F.addCode(u.i64_store32(u.getLocal("pr"),L*4,0,u.getLocal("c")))}function k(){let F=t.addFunction(o+"__add1");F.addParam("x","i32"),F.addParam("y","i64"),F.addLocal("c","i64"),F.addLocal("px","i32");let u=F.getCodeBuilder();F.addCode(u.setLocal("px",u.getLocal("x"))),F.addCode(u.setLocal("c",u.i64_add(u.i64_load32_u(u.getLocal("px"),0,0),u.getLocal("y")))),F.addCode(u.i64_store32(u.getLocal("px"),0,0,u.getLocal("c"))),F.addCode(u.setLocal("c",u.i64_shr_u(u.getLocal("c"),u.i64_const(32)))),F.addCode(u.block(u.loop(u.br_if(1,u.i64_eqz(u.getLocal("c"))),u.setLocal("px",u.i32_add(u.getLocal("px"),u.i32_const(4))),u.setLocal("c",u.i64_add(u.i64_load32_u(u.getLocal("px"),0,0),u.getLocal("c"))),u.i64_store32(u.getLocal("px"),0,0,u.getLocal("c")),u.setLocal("c",u.i64_shr_u(u.getLocal("c"),u.i64_const(32))),u.br(0))))}function O(){w(),k();let F=t.addFunction(o+"_div");F.addParam("x","i32"),F.addParam("y","i32"),F.addParam("c","i32"),F.addParam("r","i32"),F.addLocal("rr","i32"),F.addLocal("cc","i32"),F.addLocal("eX","i32"),F.addLocal("eY","i32"),F.addLocal("sy","i64"),F.addLocal("sx","i64"),F.addLocal("ec","i32");let u=F.getCodeBuilder(),L=u.i32_const(t.alloc(h)),$=u.i32_const(t.alloc(h)),Q=u.i32_const(t.alloc(h)),H=u.getLocal("cc"),q=u.getLocal("rr"),y=t.alloc(h*2),I=u.i32_const(y),N=u.i32_const(y+h);F.addCode(u.if(u.getLocal("c"),u.setLocal("cc",u.getLocal("c")),u.setLocal("cc",$))),F.addCode(u.if(u.getLocal("r"),u.setLocal("rr",u.getLocal("r")),u.setLocal("rr",Q))),F.addCode(u.call(o+"_copy",u.getLocal("x"),q)),F.addCode(u.call(o+"_copy",u.getLocal("y"),L)),F.addCode(u.call(o+"_zero",H)),F.addCode(u.call(o+"_zero",I)),F.addCode(u.setLocal("eX",u.i32_const(h-1))),F.addCode(u.setLocal("eY",u.i32_const(h-1))),F.addCode(u.block(u.loop(u.br_if(1,u.i32_or(u.i32_load8_u(u.i32_add(L,u.getLocal("eY")),0,0),u.i32_eq(u.getLocal("eY"),u.i32_const(3)))),u.setLocal("eY",u.i32_sub(u.getLocal("eY"),u.i32_const(1))),u.br(0)))),F.addCode(u.setLocal("sy",u.i64_add(u.i64_load32_u(u.i32_sub(u.i32_add(L,u.getLocal("eY")),u.i32_const(3)),0,0),u.i64_const(1)))),F.addCode(u.if(u.i64_eq(u.getLocal("sy"),u.i64_const(1)),u.drop(u.i64_div_u(u.i64_const(0),u.i64_const(0))))),F.addCode(u.block(u.loop(u.block(u.loop(u.br_if(1,u.i32_or(u.i32_load8_u(u.i32_add(q,u.getLocal("eX")),0,0),u.i32_eq(u.getLocal("eX"),u.i32_const(7)))),u.setLocal("eX",u.i32_sub(u.getLocal("eX"),u.i32_const(1))),u.br(0))),u.setLocal("sx",u.i64_load(u.i32_sub(u.i32_add(q,u.getLocal("eX")),u.i32_const(7)),0,0)),u.setLocal("sx",u.i64_div_u(u.getLocal("sx"),u.getLocal("sy"))),u.setLocal("ec",u.i32_sub(u.i32_sub(u.getLocal("eX"),u.getLocal("eY")),u.i32_const(4))),u.block(u.loop(u.br_if(1,u.i32_and(u.i64_eqz(u.i64_and(u.getLocal("sx"),u.i64_const("0xFFFFFFFF00000000"))),u.i32_ge_s(u.getLocal("ec"),u.i32_const(0)))),u.setLocal("sx",u.i64_shr_u(u.getLocal("sx"),u.i64_const(8))),u.setLocal("ec",u.i32_add(u.getLocal("ec"),u.i32_const(1))),u.br(0))),u.if(u.i64_eqz(u.getLocal("sx")),[...u.br_if(2,u.i32_eqz(u.call(o+"_gte",q,L))),...u.setLocal("sx",u.i64_const(1)),...u.setLocal("ec",u.i32_const(0))]),u.call(o+"__mul1",L,u.getLocal("sx"),N),u.drop(u.call(o+"_sub",q,u.i32_sub(N,u.getLocal("ec")),q)),u.call(o+"__add1",u.i32_add(H,u.getLocal("ec")),u.getLocal("sx")),u.br(0))))}function W(){let F=t.addFunction(o+"_inverseMod");F.addParam("px","i32"),F.addParam("pm","i32"),F.addParam("pr","i32"),F.addLocal("t","i32"),F.addLocal("newt","i32"),F.addLocal("r","i32"),F.addLocal("qq","i32"),F.addLocal("qr","i32"),F.addLocal("newr","i32"),F.addLocal("swp","i32"),F.addLocal("x","i32"),F.addLocal("signt","i32"),F.addLocal("signnewt","i32"),F.addLocal("signx","i32");let u=F.getCodeBuilder(),L=u.i32_const(t.alloc(h)),$=u.i32_const(t.alloc(h)),Q=u.i32_const(t.alloc(h)),H=u.i32_const(t.alloc(h)),q=u.i32_const(t.alloc(h)),y=u.i32_const(t.alloc(h)),I=u.i32_const(t.alloc(h*2)),N=u.i32_const(t.alloc(h));F.addCode(u.setLocal("t",L),u.call(o+"_zero",L),u.setLocal("signt",u.i32_const(0))),F.addCode(u.setLocal("r",$),u.call(o+"_copy",u.getLocal("pm"),$)),F.addCode(u.setLocal("newt",Q),u.call(o+"_one",Q),u.setLocal("signnewt",u.i32_const(0))),F.addCode(u.setLocal("newr",H),u.call(o+"_copy",u.getLocal("px"),H)),F.addCode(u.setLocal("qq",q)),F.addCode(u.setLocal("qr",y)),F.addCode(u.setLocal("x",N)),F.addCode(u.block(u.loop(u.br_if(1,u.call(o+"_isZero",u.getLocal("newr"))),u.call(o+"_div",u.getLocal("r"),u.getLocal("newr"),u.getLocal("qq"),u.getLocal("qr")),u.call(o+"_mul",u.getLocal("qq"),u.getLocal("newt"),I),u.if(u.getLocal("signt"),u.if(u.getLocal("signnewt"),u.if(u.call(o+"_gte",I,u.getLocal("t")),[...u.drop(u.call(o+"_sub",I,u.getLocal("t"),u.getLocal("x"))),...u.setLocal("signx",u.i32_const(0))],[...u.drop(u.call(o+"_sub",u.getLocal("t"),I,u.getLocal("x"))),...u.setLocal("signx",u.i32_const(1))]),[...u.drop(u.call(o+"_add",I,u.getLocal("t"),u.getLocal("x"))),...u.setLocal("signx",u.i32_const(1))]),u.if(u.getLocal("signnewt"),[...u.drop(u.call(o+"_add",I,u.getLocal("t"),u.getLocal("x"))),...u.setLocal("signx",u.i32_const(0))],u.if(u.call(o+"_gte",u.getLocal("t"),I),[...u.drop(u.call(o+"_sub",u.getLocal("t"),I,u.getLocal("x"))),...u.setLocal("signx",u.i32_const(0))],[...u.drop(u.call(o+"_sub",I,u.getLocal("t"),u.getLocal("x"))),...u.setLocal("signx",u.i32_const(1))]))),u.setLocal("swp",u.getLocal("t")),u.setLocal("t",u.getLocal("newt")),u.setLocal("newt",u.getLocal("x")),u.setLocal("x",u.getLocal("swp")),u.setLocal("signt",u.getLocal("signnewt")),u.setLocal("signnewt",u.getLocal("signx")),u.setLocal("swp",u.getLocal("r")),u.setLocal("r",u.getLocal("newr")),u.setLocal("newr",u.getLocal("qr")),u.setLocal("qr",u.getLocal("swp")),u.br(0)))),F.addCode(u.if(u.getLocal("signt"),u.drop(u.call(o+"_sub",u.getLocal("pm"),u.getLocal("t"),u.getLocal("pr"))),u.call(o+"_copy",u.getLocal("t"),u.getLocal("pr"))))}return d(),b(),s(),l(),m(),B(),p(),v(),M(),x(),S(),O(),W(),t.exportFunction(o+"_copy"),t.exportFunction(o+"_zero"),t.exportFunction(o+"_one"),t.exportFunction(o+"_isZero"),t.exportFunction(o+"_eq"),t.exportFunction(o+"_gte"),t.exportFunction(o+"_add"),t.exportFunction(o+"_sub"),t.exportFunction(o+"_mul"),t.exportFunction(o+"_square"),t.exportFunction(o+"_squareOld"),t.exportFunction(o+"_div"),t.exportFunction(o+"_inverseMod"),o},Cd=function(t,n,a,o,e,h,d){let b=t.addFunction(n);b.addParam("base","i32"),b.addParam("scalar","i32"),b.addParam("scalarLength","i32"),b.addParam("r","i32"),b.addLocal("i","i32"),b.addLocal("b","i32");let l=b.getCodeBuilder(),s=l.i32_const(t.alloc(a));b.addCode(l.if(l.i32_eqz(l.getLocal("scalarLength")),[...l.call(d,l.getLocal("r")),...l.ret([])])),b.addCode(l.call(h,l.getLocal("base"),s)),b.addCode(l.call(d,l.getLocal("r"))),b.addCode(l.setLocal("i",l.getLocal("scalarLength"))),b.addCode(l.block(l.loop(l.setLocal("i",l.i32_sub(l.getLocal("i"),l.i32_const(1))),l.setLocal("b",l.i32_load8_u(l.i32_add(l.getLocal("scalar"),l.getLocal("i")))),...m(),l.br_if(1,l.i32_eqz(l.getLocal("i"))),l.br(0))));function m(){let B=[];for(let p=0;p<8;p++)B.push(...l.call(e,l.getLocal("r"),l.getLocal("r")),...l.if(l.i32_ge_u(l.getLocal("b"),l.i32_const(128>>p)),[...l.setLocal("b",l.i32_sub(l.getLocal("b"),l.i32_const(128>>p))),...l.call(o,l.getLocal("r"),s,l.getLocal("r"))]));return B}},Bd=c4;jh=s4;l4=r4;Hn={};Hn.bitLength=Qh;Hn.isOdd=Wh;Hn.isNegative=rs;Hn.abs=ie;Hn.isUnit=Ho;Hn.compare=Vh;Hn.modInv=Xh;Hn.modPow=Hh;Hn.isPrime=f4;Hn.square=xd;g4=e4,Ra=Ja,L4=Cd,p4=Bd,Wr=jh,Qr=l4,{bitLength:b4,modInv:Xr,modPow:Lh,isPrime:ph,isOdd:m4,square:y4}=Hn,Ed=function(t,n,a,o){let e=BigInt(n),h=Math.floor((b4(e-1n)-1)/64)+1,d=h*2,b=h*8,l=a||"f1m";if(t.modules[l])return l;let s=g4(t,h,o),m=t.alloc(b,Ra.bigInt2BytesLE(e,b)),B=t.alloc(Ra.bigInt2BytesLE(y4(1n<<BigInt(h*64))%e,b)),p=t.alloc(Ra.bigInt2BytesLE((1n<<BigInt(h*64))%e,b)),v=t.alloc(Ra.bigInt2BytesLE(0n,b)),M=e-1n,x=M>>1n,S=t.alloc(b,Ra.bigInt2BytesLE(x,b)),w=x+1n,k=t.alloc(b,Ra.bigInt2BytesLE(w,b));t.modules[l]={pq:m,pR2:B,n64:h,q:e,pOne:p,pZero:v,pePlusOne:k};function O(){let E=t.addFunction(l+"_one");E.addParam("pr","i32");let g=E.getCodeBuilder();E.addCode(g.call(s+"_copy",g.i32_const(p),g.getLocal("pr")))}function W(){let E=t.addFunction(l+"_add");E.addParam("x","i32"),E.addParam("y","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.if(g.call(s+"_add",g.getLocal("x"),g.getLocal("y"),g.getLocal("r")),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))),g.if(g.call(s+"_gte",g.getLocal("r"),g.i32_const(m)),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))))))}function F(){let E=t.addFunction(l+"_sub");E.addParam("x","i32"),E.addParam("y","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.if(g.call(s+"_sub",g.getLocal("x"),g.getLocal("y"),g.getLocal("r")),g.drop(g.call(s+"_add",g.getLocal("r"),g.i32_const(m),g.getLocal("r")))))}function u(){let E=t.addFunction(l+"_neg");E.addParam("x","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.call(l+"_sub",g.i32_const(v),g.getLocal("x"),g.getLocal("r")))}function L(){let E=t.addFunction(l+"_isNegative");E.addParam("x","i32"),E.setReturnType("i32");let g=E.getCodeBuilder(),U=g.i32_const(t.alloc(b));E.addCode(g.call(l+"_fromMontgomery",g.getLocal("x"),U),g.call(s+"_gte",U,g.i32_const(k)))}function $(){let E=t.addFunction(l+"_sign");E.addParam("x","i32"),E.setReturnType("i32");let g=E.getCodeBuilder(),U=g.i32_const(t.alloc(b));E.addCode(g.if(g.call(s+"_isZero",g.getLocal("x")),g.ret(g.i32_const(0))),g.call(l+"_fromMontgomery",g.getLocal("x"),U),g.if(g.call(s+"_gte",U,g.i32_const(k)),g.ret(g.i32_const(-1))),g.ret(g.i32_const(1)))}function Q(){let E=t.alloc(d*d*8),g=t.addFunction(l+"_mReduct");g.addParam("t","i32"),g.addParam("r","i32"),g.addLocal("np32","i64"),g.addLocal("c","i64"),g.addLocal("m","i64");let U=g.getCodeBuilder(),st=Number(0x100000000n-Xr(e,0x100000000n));g.addCode(U.setLocal("np32",U.i64_const(st)));for(let et=0;et<d;et++){g.addCode(U.setLocal("c",U.i64_const(0))),g.addCode(U.setLocal("m",U.i64_and(U.i64_mul(U.i64_load32_u(U.getLocal("t"),et*4),U.getLocal("np32")),U.i64_const("0xFFFFFFFF"))));for(let ct=0;ct<d;ct++)g.addCode(U.setLocal("c",U.i64_add(U.i64_add(U.i64_load32_u(U.getLocal("t"),(et+ct)*4),U.i64_shr_u(U.getLocal("c"),U.i64_const(32))),U.i64_mul(U.i64_load32_u(U.i32_const(m),ct*4),U.getLocal("m"))))),g.addCode(U.i64_store32(U.getLocal("t"),(et+ct)*4,U.getLocal("c")));g.addCode(U.i64_store32(U.i32_const(E),et*4,U.i64_shr_u(U.getLocal("c"),U.i64_const(32))))}g.addCode(U.call(l+"_add",U.i32_const(E),U.i32_add(U.getLocal("t"),U.i32_const(d*4)),U.getLocal("r")))}function H(){let E=t.addFunction(l+"_mul");E.addParam("x","i32"),E.addParam("y","i32"),E.addParam("r","i32"),E.addLocal("c0","i64"),E.addLocal("c1","i64"),E.addLocal("np32","i64");for(let ut=0;ut<d;ut++)E.addLocal("x"+ut,"i64"),E.addLocal("y"+ut,"i64"),E.addLocal("m"+ut,"i64"),E.addLocal("q"+ut,"i64");let g=E.getCodeBuilder(),U=Number(0x100000000n-Xr(e,0x100000000n));E.addCode(g.setLocal("np32",g.i64_const(U)));let st=[],et=[],ct=[];function ft(ut,lt){let bt,Et;return st[ut]?bt=g.getLocal("x"+ut):(bt=g.teeLocal("x"+ut,g.i64_load32_u(g.getLocal("x"),ut*4)),st[ut]=!0),et[lt]?Et=g.getLocal("y"+lt):(Et=g.teeLocal("y"+lt,g.i64_load32_u(g.getLocal("y"),lt*4)),et[lt]=!0),g.i64_mul(bt,Et)}function _t(ut,lt){let bt,Et;return ct[ut]?bt=g.getLocal("q"+ut):(bt=g.teeLocal("q"+ut,g.i64_load32_u(g.i32_const(0),m+ut*4)),ct[ut]=!0),Et=g.getLocal("m"+lt),g.i64_mul(bt,Et)}let gt="c0",yt="c1";for(let ut=0;ut<d*2-1;ut++){for(let lt=Math.max(0,ut-d+1);lt<=ut&&lt<d;lt++){let bt=ut-lt;E.addCode(g.setLocal(gt,g.i64_add(g.i64_and(g.getLocal(gt),g.i64_const(4294967295)),ft(lt,bt)))),E.addCode(g.setLocal(yt,g.i64_add(g.getLocal(yt),g.i64_shr_u(g.getLocal(gt),g.i64_const(32)))))}for(let lt=Math.max(1,ut-d+1);lt<=ut&&lt<d;lt++){let bt=ut-lt;E.addCode(g.setLocal(gt,g.i64_add(g.i64_and(g.getLocal(gt),g.i64_const(4294967295)),_t(lt,bt)))),E.addCode(g.setLocal(yt,g.i64_add(g.getLocal(yt),g.i64_shr_u(g.getLocal(gt),g.i64_const(32)))))}ut<d&&(E.addCode(g.setLocal("m"+ut,g.i64_and(g.i64_mul(g.i64_and(g.getLocal(gt),g.i64_const(4294967295)),g.getLocal("np32")),g.i64_const("0xFFFFFFFF")))),E.addCode(g.setLocal(gt,g.i64_add(g.i64_and(g.getLocal(gt),g.i64_const(4294967295)),_t(0,ut)))),E.addCode(g.setLocal(yt,g.i64_add(g.getLocal(yt),g.i64_shr_u(g.getLocal(gt),g.i64_const(32)))))),ut>=d&&E.addCode(g.i64_store32(g.getLocal("r"),(ut-d)*4,g.getLocal(gt))),[gt,yt]=[yt,gt],E.addCode(g.setLocal(yt,g.i64_shr_u(g.getLocal(gt),g.i64_const(32))))}E.addCode(g.i64_store32(g.getLocal("r"),d*4-4,g.getLocal(gt))),E.addCode(g.if(g.i32_wrap_i64(g.getLocal(yt)),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))),g.if(g.call(s+"_gte",g.getLocal("r"),g.i32_const(m)),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))))))}function q(){let E=t.addFunction(l+"_square");E.addParam("x","i32"),E.addParam("r","i32"),E.addLocal("c0","i64"),E.addLocal("c1","i64"),E.addLocal("c0_old","i64"),E.addLocal("c1_old","i64"),E.addLocal("np32","i64");for(let lt=0;lt<d;lt++)E.addLocal("x"+lt,"i64"),E.addLocal("m"+lt,"i64"),E.addLocal("q"+lt,"i64");let g=E.getCodeBuilder(),U=Number(0x100000000n-Xr(e,0x100000000n));E.addCode(g.setLocal("np32",g.i64_const(U)));let st=[],et=[];function ct(lt,bt){let Et,It;return st[lt]?Et=g.getLocal("x"+lt):(Et=g.teeLocal("x"+lt,g.i64_load32_u(g.getLocal("x"),lt*4)),st[lt]=!0),st[bt]?It=g.getLocal("x"+bt):(It=g.teeLocal("x"+bt,g.i64_load32_u(g.getLocal("x"),bt*4)),st[bt]=!0),g.i64_mul(Et,It)}function ft(lt,bt){let Et,It;return et[lt]?Et=g.getLocal("q"+lt):(Et=g.teeLocal("q"+lt,g.i64_load32_u(g.i32_const(0),m+lt*4)),et[lt]=!0),It=g.getLocal("m"+bt),g.i64_mul(Et,It)}let _t="c0",gt="c1",yt="c0_old",ut="c1_old";for(let lt=0;lt<d*2-1;lt++){E.addCode(g.setLocal(_t,g.i64_const(0)),g.setLocal(gt,g.i64_const(0)));for(let bt=Math.max(0,lt-d+1);bt<lt+1>>1&&bt<d;bt++){let Et=lt-bt;E.addCode(g.setLocal(_t,g.i64_add(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),ct(bt,Et)))),E.addCode(g.setLocal(gt,g.i64_add(g.getLocal(gt),g.i64_shr_u(g.getLocal(_t),g.i64_const(32)))))}E.addCode(g.setLocal(_t,g.i64_shl(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),g.i64_const(1)))),E.addCode(g.setLocal(gt,g.i64_add(g.i64_shl(g.getLocal(gt),g.i64_const(1)),g.i64_shr_u(g.getLocal(_t),g.i64_const(32))))),lt%2==0&&(E.addCode(g.setLocal(_t,g.i64_add(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),ct(lt>>1,lt>>1)))),E.addCode(g.setLocal(gt,g.i64_add(g.getLocal(gt),g.i64_shr_u(g.getLocal(_t),g.i64_const(32)))))),lt>0&&(E.addCode(g.setLocal(_t,g.i64_add(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),g.i64_and(g.getLocal(yt),g.i64_const(4294967295))))),E.addCode(g.setLocal(gt,g.i64_add(g.i64_add(g.getLocal(gt),g.i64_shr_u(g.getLocal(_t),g.i64_const(32))),g.getLocal(ut)))));for(let bt=Math.max(1,lt-d+1);bt<=lt&&bt<d;bt++){let Et=lt-bt;E.addCode(g.setLocal(_t,g.i64_add(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),ft(bt,Et)))),E.addCode(g.setLocal(gt,g.i64_add(g.getLocal(gt),g.i64_shr_u(g.getLocal(_t),g.i64_const(32)))))}lt<d&&(E.addCode(g.setLocal("m"+lt,g.i64_and(g.i64_mul(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),g.getLocal("np32")),g.i64_const("0xFFFFFFFF")))),E.addCode(g.setLocal(_t,g.i64_add(g.i64_and(g.getLocal(_t),g.i64_const(4294967295)),ft(0,lt)))),E.addCode(g.setLocal(gt,g.i64_add(g.getLocal(gt),g.i64_shr_u(g.getLocal(_t),g.i64_const(32)))))),lt>=d&&E.addCode(g.i64_store32(g.getLocal("r"),(lt-d)*4,g.getLocal(_t))),E.addCode(g.setLocal(yt,g.getLocal(gt)),g.setLocal(ut,g.i64_shr_u(g.getLocal(yt),g.i64_const(32))))}E.addCode(g.i64_store32(g.getLocal("r"),d*4-4,g.getLocal(yt))),E.addCode(g.if(g.i32_wrap_i64(g.getLocal(ut)),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))),g.if(g.call(s+"_gte",g.getLocal("r"),g.i32_const(m)),g.drop(g.call(s+"_sub",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))))))}function y(){let E=t.addFunction(l+"_squareOld");E.addParam("x","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.call(l+"_mul",g.getLocal("x"),g.getLocal("x"),g.getLocal("r")))}function I(){let E=t.addFunction(l+"_toMontgomery");E.addParam("x","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.call(l+"_mul",g.getLocal("x"),g.i32_const(B),g.getLocal("r")))}function N(){let E=t.alloc(b*2),g=t.addFunction(l+"_fromMontgomery");g.addParam("x","i32"),g.addParam("r","i32");let U=g.getCodeBuilder();g.addCode(U.call(s+"_copy",U.getLocal("x"),U.i32_const(E))),g.addCode(U.call(s+"_zero",U.i32_const(E+b))),g.addCode(U.call(l+"_mReduct",U.i32_const(E),U.getLocal("r")))}function nt(){let E=t.addFunction(l+"_inverse");E.addParam("x","i32"),E.addParam("r","i32");let g=E.getCodeBuilder();E.addCode(g.call(l+"_fromMontgomery",g.getLocal("x"),g.getLocal("r"))),E.addCode(g.call(s+"_inverseMod",g.getLocal("r"),g.i32_const(m),g.getLocal("r"))),E.addCode(g.call(l+"_toMontgomery",g.getLocal("r"),g.getLocal("r")))}let J=2n;if(ph(e))for(;Lh(J,x,e)!==M;)J=J+1n;let j=0,ot=M;for(;!m4(ot)&&ot!==0n;)j++,ot=ot>>1n;let V=t.alloc(b,Ra.bigInt2BytesLE(ot,b)),at=Lh(J,ot,e),Lt=t.alloc(Ra.bigInt2BytesLE((at<<BigInt(h*64))%e,b)),rt=ot+1n>>1n,ht=t.alloc(b,Ra.bigInt2BytesLE(rt,b));function A(){let E=t.addFunction(l+"_sqrt");E.addParam("n","i32"),E.addParam("r","i32"),E.addLocal("m","i32"),E.addLocal("i","i32"),E.addLocal("j","i32");let g=E.getCodeBuilder(),U=g.i32_const(p),st=g.i32_const(t.alloc(b)),et=g.i32_const(t.alloc(b)),ct=g.i32_const(t.alloc(b)),ft=g.i32_const(t.alloc(b)),_t=g.i32_const(t.alloc(b));E.addCode(g.if(g.call(l+"_isZero",g.getLocal("n")),g.ret(g.call(l+"_zero",g.getLocal("r")))),g.setLocal("m",g.i32_const(j)),g.call(l+"_copy",g.i32_const(Lt),st),g.call(l+"_exp",g.getLocal("n"),g.i32_const(V),g.i32_const(b),et),g.call(l+"_exp",g.getLocal("n"),g.i32_const(ht),g.i32_const(b),ct),g.block(g.loop(g.br_if(1,g.call(l+"_eq",et,U)),g.call(l+"_square",et,ft),g.setLocal("i",g.i32_const(1)),g.block(g.loop(g.br_if(1,g.call(l+"_eq",ft,U)),g.call(l+"_square",ft,ft),g.setLocal("i",g.i32_add(g.getLocal("i"),g.i32_const(1))),g.br(0))),g.call(l+"_copy",st,_t),g.setLocal("j",g.i32_sub(g.i32_sub(g.getLocal("m"),g.getLocal("i")),g.i32_const(1))),g.block(g.loop(g.br_if(1,g.i32_eqz(g.getLocal("j"))),g.call(l+"_square",_t,_t),g.setLocal("j",g.i32_sub(g.getLocal("j"),g.i32_const(1))),g.br(0))),g.setLocal("m",g.getLocal("i")),g.call(l+"_square",_t,st),g.call(l+"_mul",et,st,et),g.call(l+"_mul",ct,_t,ct),g.br(0))),g.if(g.call(l+"_isNegative",ct),g.call(l+"_neg",ct,g.getLocal("r")),g.call(l+"_copy",ct,g.getLocal("r"))))}function i(){let E=t.addFunction(l+"_isSquare");E.addParam("n","i32"),E.setReturnType("i32");let g=E.getCodeBuilder(),U=g.i32_const(p),st=g.i32_const(t.alloc(b));E.addCode(g.if(g.call(l+"_isZero",g.getLocal("n")),g.ret(g.i32_const(1))),g.call(l+"_exp",g.getLocal("n"),g.i32_const(S),g.i32_const(b),st),g.call(l+"_eq",st,U))}function C(){let E=t.addFunction(l+"_load");E.addParam("scalar","i32"),E.addParam("scalarLen","i32"),E.addParam("r","i32"),E.addLocal("p","i32"),E.addLocal("l","i32"),E.addLocal("i","i32"),E.addLocal("j","i32");let g=E.getCodeBuilder(),U=g.i32_const(t.alloc(b)),st=t.alloc(b),et=g.i32_const(st);E.addCode(g.call(s+"_zero",g.getLocal("r")),g.setLocal("i",g.i32_const(b)),g.setLocal("p",g.getLocal("scalar")),g.block(g.loop(g.br_if(1,g.i32_gt_u(g.getLocal("i"),g.getLocal("scalarLen"))),g.if(g.i32_eq(g.getLocal("i"),g.i32_const(b)),g.call(l+"_one",U),g.call(l+"_mul",U,g.i32_const(B),U)),g.call(l+"_mul",g.getLocal("p"),U,et),g.call(l+"_add",g.getLocal("r"),et,g.getLocal("r")),g.setLocal("p",g.i32_add(g.getLocal("p"),g.i32_const(b))),g.setLocal("i",g.i32_add(g.getLocal("i"),g.i32_const(b))),g.br(0))),g.setLocal("l",g.i32_rem_u(g.getLocal("scalarLen"),g.i32_const(b))),g.if(g.i32_eqz(g.getLocal("l")),g.ret([])),g.call(s+"_zero",et),g.setLocal("j",g.i32_const(0)),g.block(g.loop(g.br_if(1,g.i32_eq(g.getLocal("j"),g.getLocal("l"))),g.i32_store8(g.getLocal("j"),st,g.i32_load8_u(g.getLocal("p"))),g.setLocal("p",g.i32_add(g.getLocal("p"),g.i32_const(1))),g.setLocal("j",g.i32_add(g.getLocal("j"),g.i32_const(1))),g.br(0))),g.if(g.i32_eq(g.getLocal("i"),g.i32_const(b)),g.call(l+"_one",U),g.call(l+"_mul",U,g.i32_const(B),U)),g.call(l+"_mul",et,U,et),g.call(l+"_add",g.getLocal("r"),et,g.getLocal("r")))}function r(){let E=t.addFunction(l+"_timesScalar");E.addParam("x","i32"),E.addParam("scalar","i32"),E.addParam("scalarLen","i32"),E.addParam("r","i32");let g=E.getCodeBuilder(),U=g.i32_const(t.alloc(b));E.addCode(g.call(l+"_load",g.getLocal("scalar"),g.getLocal("scalarLen"),U),g.call(l+"_toMontgomery",U,U),g.call(l+"_mul",g.getLocal("x"),U,g.getLocal("r")))}function z(){let E=t.addFunction(l+"_isOne");E.addParam("x","i32"),E.setReturnType("i32");let g=E.getCodeBuilder();E.addCode(g.ret(g.call(s+"_eq",g.getLocal("x"),g.i32_const(p))))}return t.exportFunction(s+"_copy",l+"_copy"),t.exportFunction(s+"_zero",l+"_zero"),t.exportFunction(s+"_isZero",l+"_isZero"),t.exportFunction(s+"_eq",l+"_eq"),z(),W(),F(),u(),Q(),H(),q(),y(),I(),N(),L(),$(),nt(),O(),C(),r(),p4(t,l),Wr(t,l+"_batchToMontgomery",l+"_toMontgomery",b,b),Wr(t,l+"_batchFromMontgomery",l+"_fromMontgomery",b,b),Wr(t,l+"_batchNeg",l+"_neg",b,b),Qr(t,l+"_batchAdd",l+"_add",b,b),Qr(t,l+"_batchSub",l+"_sub",b,b),Qr(t,l+"_batchMul",l+"_mul",b,b),t.exportFunction(l+"_add"),t.exportFunction(l+"_sub"),t.exportFunction(l+"_neg"),t.exportFunction(l+"_isNegative"),t.exportFunction(l+"_isOne"),t.exportFunction(l+"_sign"),t.exportFunction(l+"_mReduct"),t.exportFunction(l+"_mul"),t.exportFunction(l+"_square"),t.exportFunction(l+"_squareOld"),t.exportFunction(l+"_fromMontgomery"),t.exportFunction(l+"_toMontgomery"),t.exportFunction(l+"_inverse"),t.exportFunction(l+"_one"),t.exportFunction(l+"_load"),t.exportFunction(l+"_timesScalar"),L4(t,l+"_exp",b,l+"_mul",l+"_square",s+"_copy",l+"_one"),t.exportFunction(l+"_exp"),t.exportFunction(l+"_batchInverse"),ph(e)&&(A(),i(),t.exportFunction(l+"_sqrt"),t.exportFunction(l+"_isSquare")),t.exportFunction(l+"_batchToMontgomery"),t.exportFunction(l+"_batchFromMontgomery"),l},w4=Ed,{bitLength:F4}=Hn,Dh=function(t,n,a,o,e){let h=BigInt(n),d=Math.floor((F4(h-1n)-1)/64)+1,b=d*8,l=a||"f1";if(t.modules[l])return l;t.modules[l]={n64:d};let s=e||"int",m=w4(t,h,o,s),B=t.modules[m].pR2,p=t.modules[m].pq,v=t.modules[m].pePlusOne;function M(){let k=t.alloc(b),O=t.addFunction(l+"_mul");O.addParam("x","i32"),O.addParam("y","i32"),O.addParam("r","i32");let W=O.getCodeBuilder();O.addCode(W.call(m+"_mul",W.getLocal("x"),W.getLocal("y"),W.i32_const(k))),O.addCode(W.call(m+"_mul",W.i32_const(k),W.i32_const(B),W.getLocal("r")))}function x(){let k=t.addFunction(l+"_square");k.addParam("x","i32"),k.addParam("r","i32");let O=k.getCodeBuilder();k.addCode(O.call(l+"_mul",O.getLocal("x"),O.getLocal("x"),O.getLocal("r")))}function S(){let k=t.addFunction(l+"_inverse");k.addParam("x","i32"),k.addParam("r","i32");let O=k.getCodeBuilder();k.addCode(O.call(s+"_inverseMod",O.getLocal("x"),O.i32_const(p),O.getLocal("r")))}function w(){let k=t.addFunction(l+"_isNegative");k.addParam("x","i32"),k.setReturnType("i32");let O=k.getCodeBuilder();k.addCode(O.call(s+"_gte",O.getLocal("x"),O.i32_const(v)))}return M(),x(),S(),w(),t.exportFunction(m+"_add",l+"_add"),t.exportFunction(m+"_sub",l+"_sub"),t.exportFunction(m+"_neg",l+"_neg"),t.exportFunction(l+"_mul"),t.exportFunction(l+"_square"),t.exportFunction(l+"_inverse"),t.exportFunction(l+"_isNegative"),t.exportFunction(m+"_copy",l+"_copy"),t.exportFunction(m+"_zero",l+"_zero"),t.exportFunction(m+"_one",l+"_one"),t.exportFunction(m+"_isZero",l+"_isZero"),t.exportFunction(m+"_eq",l+"_eq"),l},C4=Cd,B4=Bd,Hr=Ja,Kh=function(t,n,a,o){if(t.modules[a])return a;let e=t.modules[o].n64*8,h=t.modules[o].q;t.modules[a]={n64:t.modules[o].n64*2};function d(){let q=t.addFunction(a+"_add");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("y"),J=y.i32_add(y.getLocal("y"),y.i32_const(e)),j=y.getLocal("r"),ot=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_add",I,nt,j),y.call(o+"_add",N,J,ot))}function b(){let q=t.addFunction(a+"_timesScalar");q.addParam("x","i32"),q.addParam("scalar","i32"),q.addParam("scalarLen","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_timesScalar",I,y.getLocal("scalar"),y.getLocal("scalarLen"),nt),y.call(o+"_timesScalar",N,y.getLocal("scalar"),y.getLocal("scalarLen"),J))}function l(){let q=t.addFunction(a+"_sub");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("y"),J=y.i32_add(y.getLocal("y"),y.i32_const(e)),j=y.getLocal("r"),ot=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_sub",I,nt,j),y.call(o+"_sub",N,J,ot))}function s(){let q=t.addFunction(a+"_neg");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_neg",I,nt),y.call(o+"_neg",N,J))}function m(){let q=t.addFunction(a+"_conjugate");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_copy",I,nt),y.call(o+"_neg",N,J))}function B(){let q=t.addFunction(a+"_isNegative");q.addParam("x","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.if(y.call(o+"_isZero",N),y.ret(y.call(o+"_isNegative",I))),y.ret(y.call(o+"_isNegative",N)))}function p(){let q=t.addFunction(a+"_mul");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("y"),J=y.i32_add(y.getLocal("y"),y.i32_const(e)),j=y.getLocal("r"),ot=y.i32_add(y.getLocal("r"),y.i32_const(e)),V=y.i32_const(t.alloc(e)),at=y.i32_const(t.alloc(e)),Lt=y.i32_const(t.alloc(e)),rt=y.i32_const(t.alloc(e));q.addCode(y.call(o+"_mul",I,nt,V),y.call(o+"_mul",N,J,at),y.call(o+"_add",I,N,Lt),y.call(o+"_add",nt,J,rt),y.call(o+"_mul",Lt,rt,Lt),y.call(n,at,j),y.call(o+"_add",V,j,j),y.call(o+"_add",V,at,ot),y.call(o+"_sub",Lt,ot,ot))}function v(){let q=t.addFunction(a+"_mul1");q.addParam("x","i32"),q.addParam("y","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("y"),J=y.getLocal("r"),j=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_mul",I,nt,J),y.call(o+"_mul",N,nt,j))}function M(){let q=t.addFunction(a+"_square");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e)),j=y.i32_const(t.alloc(e)),ot=y.i32_const(t.alloc(e)),V=y.i32_const(t.alloc(e)),at=y.i32_const(t.alloc(e));q.addCode(y.call(o+"_mul",I,N,j),y.call(o+"_add",I,N,ot),y.call(n,N,V),y.call(o+"_add",I,V,V),y.call(n,j,at),y.call(o+"_add",at,j,at),y.call(o+"_mul",ot,V,nt),y.call(o+"_sub",nt,at,nt),y.call(o+"_add",j,j,J))}function x(){let q=t.addFunction(a+"_toMontgomery");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_toMontgomery",I,nt),y.call(o+"_toMontgomery",N,J))}function S(){let q=t.addFunction(a+"_fromMontgomery");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_fromMontgomery",I,nt),y.call(o+"_fromMontgomery",N,J))}function w(){let q=t.addFunction(a+"_copy");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e));q.addCode(y.call(o+"_copy",I,nt),y.call(o+"_copy",N,J))}function k(){let q=t.addFunction(a+"_zero");q.addParam("x","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.call(o+"_zero",I),y.call(o+"_zero",N))}function O(){let q=t.addFunction(a+"_one");q.addParam("x","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.call(o+"_one",I),y.call(o+"_zero",N))}function W(){let q=t.addFunction(a+"_eq");q.addParam("x","i32"),q.addParam("y","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("y"),J=y.i32_add(y.getLocal("y"),y.i32_const(e));q.addCode(y.i32_and(y.call(o+"_eq",I,nt),y.call(o+"_eq",N,J)))}function F(){let q=t.addFunction(a+"_isZero");q.addParam("x","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.i32_and(y.call(o+"_isZero",I),y.call(o+"_isZero",N)))}function u(){let q=t.addFunction(a+"_inverse");q.addParam("x","i32"),q.addParam("r","i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e)),nt=y.getLocal("r"),J=y.i32_add(y.getLocal("r"),y.i32_const(e)),j=y.i32_const(t.alloc(e)),ot=y.i32_const(t.alloc(e)),V=y.i32_const(t.alloc(e)),at=y.i32_const(t.alloc(e));q.addCode(y.call(o+"_square",I,j),y.call(o+"_square",N,ot),y.call(n,ot,V),y.call(o+"_sub",j,V,V),y.call(o+"_inverse",V,at),y.call(o+"_mul",I,at,nt),y.call(o+"_mul",N,at,J),y.call(o+"_neg",J,J))}function L(){let q=t.addFunction(a+"_sign");q.addParam("x","i32"),q.addLocal("s","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.setLocal("s",y.call(o+"_sign",N)),y.if(y.getLocal("s"),y.ret(y.getLocal("s"))),y.ret(y.call(o+"_sign",I)))}function $(){let q=t.addFunction(a+"_isOne");q.addParam("x","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.getLocal("x"),N=y.i32_add(y.getLocal("x"),y.i32_const(e));q.addCode(y.ret(y.i32_and(y.call(o+"_isOne",I),y.call(o+"_isZero",N))))}function Q(){let q=t.addFunction(a+"_sqrt");q.addParam("a","i32"),q.addParam("pr","i32");let y=q.getCodeBuilder(),I=y.i32_const(t.alloc(Hr.bigInt2BytesLE((BigInt(h||0)-3n)/4n,e))),N=y.i32_const(t.alloc(Hr.bigInt2BytesLE((BigInt(h||0)-1n)/2n,e))),nt=y.getLocal("a"),J=y.i32_const(t.alloc(e*2)),j=y.i32_const(t.alloc(e*2)),ot=y.i32_const(t.alloc(e*2)),V=t.alloc(e*2),at=y.i32_const(V),Lt=y.i32_const(V),rt=y.i32_const(V+e),ht=y.i32_const(t.alloc(e*2)),A=y.i32_const(t.alloc(e*2));q.addCode(y.call(a+"_one",at),y.call(a+"_neg",at,at),y.call(a+"_exp",nt,I,y.i32_const(e),J),y.call(a+"_square",J,j),y.call(a+"_mul",nt,j,j),y.call(a+"_conjugate",j,ot),y.call(a+"_mul",ot,j,ot),y.if(y.call(a+"_eq",ot,at),y.unreachable()),y.call(a+"_mul",J,nt,ht),y.if(y.call(a+"_eq",j,at),[...y.call(o+"_zero",Lt),...y.call(o+"_one",rt),...y.call(a+"_mul",at,ht,y.getLocal("pr"))],[...y.call(a+"_one",A),...y.call(a+"_add",A,j,A),...y.call(a+"_exp",A,N,y.i32_const(e),A),...y.call(a+"_mul",A,ht,y.getLocal("pr"))]))}function H(){let q=t.addFunction(a+"_isSquare");q.addParam("a","i32"),q.setReturnType("i32");let y=q.getCodeBuilder(),I=y.i32_const(t.alloc(Hr.bigInt2BytesLE((BigInt(h||0)-3n)/4n,e))),N=y.getLocal("a"),nt=y.i32_const(t.alloc(e*2)),J=y.i32_const(t.alloc(e*2)),j=y.i32_const(t.alloc(e*2)),ot=t.alloc(e*2),V=y.i32_const(ot);q.addCode(y.call(a+"_one",V),y.call(a+"_neg",V,V),y.call(a+"_exp",N,I,y.i32_const(e),nt),y.call(a+"_square",nt,J),y.call(a+"_mul",N,J,J),y.call(a+"_conjugate",J,j),y.call(a+"_mul",j,J,j),y.if(y.call(a+"_eq",j,V),y.ret(y.i32_const(0))),y.ret(y.i32_const(1)))}return F(),$(),k(),O(),w(),p(),v(),M(),d(),l(),s(),m(),x(),S(),W(),u(),b(),L(),B(),t.exportFunction(a+"_isZero"),t.exportFunction(a+"_isOne"),t.exportFunction(a+"_zero"),t.exportFunction(a+"_one"),t.exportFunction(a+"_copy"),t.exportFunction(a+"_mul"),t.exportFunction(a+"_mul1"),t.exportFunction(a+"_square"),t.exportFunction(a+"_add"),t.exportFunction(a+"_sub"),t.exportFunction(a+"_neg"),t.exportFunction(a+"_sign"),t.exportFunction(a+"_conjugate"),t.exportFunction(a+"_fromMontgomery"),t.exportFunction(a+"_toMontgomery"),t.exportFunction(a+"_eq"),t.exportFunction(a+"_inverse"),B4(t,a),C4(t,a+"_exp",e*2,a+"_mul",a+"_square",a+"_copy",a+"_one"),Q(),H(),t.exportFunction(a+"_exp"),t.exportFunction(a+"_timesScalar"),t.exportFunction(a+"_batchInverse"),t.exportFunction(a+"_sqrt"),t.exportFunction(a+"_isSquare"),t.exportFunction(a+"_isNegative"),a},x4=Cd,A4=Bd,Jh=function(t,n,a,o){if(t.modules[a])return a;let e=t.modules[o].n64*8;t.modules[a]={n64:t.modules[o].n64*3};function h(){let u=t.addFunction(a+"_add");u.addParam("x","i32"),u.addParam("y","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("y"),y=L.i32_add(L.getLocal("y"),L.i32_const(e)),I=L.i32_add(L.getLocal("y"),L.i32_const(2*e)),N=L.getLocal("r"),nt=L.i32_add(L.getLocal("r"),L.i32_const(e)),J=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_add",$,q,N),L.call(o+"_add",Q,y,nt),L.call(o+"_add",H,I,J))}function d(){let u=t.addFunction(a+"_timesScalar");u.addParam("x","i32"),u.addParam("scalar","i32"),u.addParam("scalarLen","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_timesScalar",$,L.getLocal("scalar"),L.getLocal("scalarLen"),q),L.call(o+"_timesScalar",Q,L.getLocal("scalar"),L.getLocal("scalarLen"),y),L.call(o+"_timesScalar",H,L.getLocal("scalar"),L.getLocal("scalarLen"),I))}function b(){let u=t.addFunction(a+"_sub");u.addParam("x","i32"),u.addParam("y","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("y"),y=L.i32_add(L.getLocal("y"),L.i32_const(e)),I=L.i32_add(L.getLocal("y"),L.i32_const(2*e)),N=L.getLocal("r"),nt=L.i32_add(L.getLocal("r"),L.i32_const(e)),J=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_sub",$,q,N),L.call(o+"_sub",Q,y,nt),L.call(o+"_sub",H,I,J))}function l(){let u=t.addFunction(a+"_neg");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_neg",$,q),L.call(o+"_neg",Q,y),L.call(o+"_neg",H,I))}function s(){let u=t.addFunction(a+"_isNegative");u.addParam("x","i32"),u.setReturnType("i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e));u.addCode(L.if(L.call(o+"_isZero",H),L.if(L.call(o+"_isZero",Q),L.ret(L.call(o+"_isNegative",$)),L.ret(L.call(o+"_isNegative",Q)))),L.ret(L.call(o+"_isNegative",H)))}function m(){let u=t.addFunction(a+"_mul");u.addParam("x","i32"),u.addParam("y","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("y"),y=L.i32_add(L.getLocal("y"),L.i32_const(e)),I=L.i32_add(L.getLocal("y"),L.i32_const(2*e)),N=L.getLocal("r"),nt=L.i32_add(L.getLocal("r"),L.i32_const(e)),J=L.i32_add(L.getLocal("r"),L.i32_const(2*e)),j=L.i32_const(t.alloc(e)),ot=L.i32_const(t.alloc(e)),V=L.i32_const(t.alloc(e)),at=L.i32_const(t.alloc(e)),Lt=L.i32_const(t.alloc(e)),rt=L.i32_const(t.alloc(e)),ht=L.i32_const(t.alloc(e)),A=L.i32_const(t.alloc(e)),i=L.i32_const(t.alloc(e)),C=L.i32_const(t.alloc(e)),r=L.i32_const(t.alloc(e)),z=L.i32_const(t.alloc(e)),E=L.i32_const(t.alloc(e));u.addCode(L.call(o+"_mul",$,q,j),L.call(o+"_mul",Q,y,ot),L.call(o+"_mul",H,I,V),L.call(o+"_add",$,Q,at),L.call(o+"_add",q,y,Lt),L.call(o+"_add",$,H,rt),L.call(o+"_add",q,I,ht),L.call(o+"_add",Q,H,A),L.call(o+"_add",y,I,i),L.call(o+"_add",j,ot,C),L.call(o+"_add",j,V,r),L.call(o+"_add",ot,V,z),L.call(o+"_mul",A,i,N),L.call(o+"_sub",N,z,N),L.call(n,N,N),L.call(o+"_add",j,N,N),L.call(o+"_mul",at,Lt,nt),L.call(o+"_sub",nt,C,nt),L.call(n,V,E),L.call(o+"_add",nt,E,nt),L.call(o+"_mul",rt,ht,J),L.call(o+"_sub",J,r,J),L.call(o+"_add",J,ot,J))}function B(){let u=t.addFunction(a+"_square");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e)),N=L.i32_const(t.alloc(e)),nt=L.i32_const(t.alloc(e)),J=L.i32_const(t.alloc(e)),j=L.i32_const(t.alloc(e)),ot=L.i32_const(t.alloc(e)),V=L.i32_const(t.alloc(e)),at=L.i32_const(t.alloc(e));u.addCode(L.call(o+"_square",$,N),L.call(o+"_mul",$,Q,nt),L.call(o+"_add",nt,nt,J),L.call(o+"_sub",$,Q,j),L.call(o+"_add",j,H,j),L.call(o+"_square",j,j),L.call(o+"_mul",Q,H,ot),L.call(o+"_add",ot,ot,V),L.call(o+"_square",H,at),L.call(n,V,q),L.call(o+"_add",N,q,q),L.call(n,at,y),L.call(o+"_add",J,y,y),L.call(o+"_add",N,at,I),L.call(o+"_sub",V,I,I),L.call(o+"_add",j,I,I),L.call(o+"_add",J,I,I))}function p(){let u=t.addFunction(a+"_toMontgomery");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_toMontgomery",$,q),L.call(o+"_toMontgomery",Q,y),L.call(o+"_toMontgomery",H,I))}function v(){let u=t.addFunction(a+"_fromMontgomery");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_fromMontgomery",$,q),L.call(o+"_fromMontgomery",Q,y),L.call(o+"_fromMontgomery",H,I))}function M(){let u=t.addFunction(a+"_copy");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e));u.addCode(L.call(o+"_copy",$,q),L.call(o+"_copy",Q,y),L.call(o+"_copy",H,I))}function x(){let u=t.addFunction(a+"_zero");u.addParam("x","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e));u.addCode(L.call(o+"_zero",$),L.call(o+"_zero",Q),L.call(o+"_zero",H))}function S(){let u=t.addFunction(a+"_one");u.addParam("x","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e));u.addCode(L.call(o+"_one",$),L.call(o+"_zero",Q),L.call(o+"_zero",H))}function w(){let u=t.addFunction(a+"_eq");u.addParam("x","i32"),u.addParam("y","i32"),u.setReturnType("i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("y"),y=L.i32_add(L.getLocal("y"),L.i32_const(e)),I=L.i32_add(L.getLocal("y"),L.i32_const(2*e));u.addCode(L.i32_and(L.i32_and(L.call(o+"_eq",$,q),L.call(o+"_eq",Q,y)),L.call(o+"_eq",H,I)))}function k(){let u=t.addFunction(a+"_isZero");u.addParam("x","i32"),u.setReturnType("i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e));u.addCode(L.i32_and(L.i32_and(L.call(o+"_isZero",$),L.call(o+"_isZero",Q)),L.call(o+"_isZero",H)))}function O(){let u=t.addFunction(a+"_inverse");u.addParam("x","i32"),u.addParam("r","i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e)),q=L.getLocal("r"),y=L.i32_add(L.getLocal("r"),L.i32_const(e)),I=L.i32_add(L.getLocal("r"),L.i32_const(2*e)),N=L.i32_const(t.alloc(e)),nt=L.i32_const(t.alloc(e)),J=L.i32_const(t.alloc(e)),j=L.i32_const(t.alloc(e)),ot=L.i32_const(t.alloc(e)),V=L.i32_const(t.alloc(e)),at=L.i32_const(t.alloc(e)),Lt=L.i32_const(t.alloc(e)),rt=L.i32_const(t.alloc(e)),ht=L.i32_const(t.alloc(e)),A=L.i32_const(t.alloc(e));u.addCode(L.call(o+"_square",$,N),L.call(o+"_square",Q,nt),L.call(o+"_square",H,J),L.call(o+"_mul",$,Q,j),L.call(o+"_mul",$,H,ot),L.call(o+"_mul",Q,H,V),L.call(n,V,at),L.call(o+"_sub",N,at,at),L.call(n,J,Lt),L.call(o+"_sub",Lt,j,Lt),L.call(o+"_sub",nt,ot,rt),L.call(o+"_mul",H,Lt,ht),L.call(o+"_mul",Q,rt,A),L.call(o+"_add",ht,A,ht),L.call(n,ht,ht),L.call(o+"_mul",$,at,A),L.call(o+"_add",A,ht,ht),L.call(o+"_inverse",ht,ht),L.call(o+"_mul",ht,at,q),L.call(o+"_mul",ht,Lt,y),L.call(o+"_mul",ht,rt,I))}function W(){let u=t.addFunction(a+"_sign");u.addParam("x","i32"),u.addLocal("s","i32"),u.setReturnType("i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(2*e));u.addCode(L.setLocal("s",L.call(o+"_sign",H)),L.if(L.getLocal("s"),L.ret(L.getLocal("s"))),L.setLocal("s",L.call(o+"_sign",Q)),L.if(L.getLocal("s"),L.ret(L.getLocal("s"))),L.ret(L.call(o+"_sign",$)))}function F(){let u=t.addFunction(a+"_isOne");u.addParam("x","i32"),u.setReturnType("i32");let L=u.getCodeBuilder(),$=L.getLocal("x"),Q=L.i32_add(L.getLocal("x"),L.i32_const(e)),H=L.i32_add(L.getLocal("x"),L.i32_const(e*2));u.addCode(L.ret(L.i32_and(L.i32_and(L.call(o+"_isOne",$),L.call(o+"_isZero",Q)),L.call(o+"_isZero",H))))}return k(),F(),x(),S(),M(),m(),B(),h(),b(),l(),W(),p(),v(),w(),O(),d(),s(),t.exportFunction(a+"_isZero"),t.exportFunction(a+"_isOne"),t.exportFunction(a+"_zero"),t.exportFunction(a+"_one"),t.exportFunction(a+"_copy"),t.exportFunction(a+"_mul"),t.exportFunction(a+"_square"),t.exportFunction(a+"_add"),t.exportFunction(a+"_sub"),t.exportFunction(a+"_neg"),t.exportFunction(a+"_sign"),t.exportFunction(a+"_fromMontgomery"),t.exportFunction(a+"_toMontgomery"),t.exportFunction(a+"_eq"),t.exportFunction(a+"_inverse"),A4(t,a),x4(t,a+"_exp",e*3,a+"_mul",a+"_square",a+"_copy",a+"_one"),t.exportFunction(a+"_exp"),t.exportFunction(a+"_timesScalar"),t.exportFunction(a+"_batchInverse"),t.exportFunction(a+"_isNegative"),a},E4=function(t,n,a,o,e,h,d,b){let l=t.addFunction(n);l.addParam("base","i32"),l.addParam("scalar","i32"),l.addParam("scalarLength","i32"),l.addParam("r","i32"),l.addLocal("old0","i32"),l.addLocal("nbits","i32"),l.addLocal("i","i32"),l.addLocal("last","i32"),l.addLocal("cur","i32"),l.addLocal("carry","i32"),l.addLocal("p","i32");let s=l.getCodeBuilder(),m=s.i32_const(t.alloc(a));function B(v){return s.i32_and(s.i32_shr_u(s.i32_load(s.i32_add(s.getLocal("scalar"),s.i32_and(s.i32_shr_u(v,s.i32_const(3)),s.i32_const(4294967292)))),s.i32_and(v,s.i32_const(31))),s.i32_const(1))}function p(v){return[...s.i32_store8(s.getLocal("p"),s.i32_const(v)),...s.setLocal("p",s.i32_add(s.getLocal("p"),s.i32_const(1)))]}l.addCode(s.if(s.i32_eqz(s.getLocal("scalarLength")),[...s.call(b,s.getLocal("r")),...s.ret([])]),s.setLocal("nbits",s.i32_shl(s.getLocal("scalarLength"),s.i32_const(3))),s.setLocal("old0",s.i32_load(s.i32_const(0))),s.setLocal("p",s.getLocal("old0")),s.i32_store(s.i32_const(0),s.i32_and(s.i32_add(s.i32_add(s.getLocal("old0"),s.i32_const(32)),s.getLocal("nbits")),s.i32_const(4294967288))),s.setLocal("i",s.i32_const(1)),s.setLocal("last",B(s.i32_const(0))),s.setLocal("carry",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("nbits"))),s.setLocal("cur",B(s.getLocal("i"))),s.if(s.getLocal("last"),s.if(s.getLocal("cur"),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...p(1)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...p(255)]),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...p(255)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(0)),...p(1)])),s.if(s.getLocal("cur"),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(1)),...p(0)],[...s.setLocal("last",s.i32_const(1)),...s.setLocal("carry",s.i32_const(0)),...p(0)]),s.if(s.getLocal("carry"),[...s.setLocal("last",s.i32_const(1)),...s.setLocal("carry",s.i32_const(0)),...p(0)],[...s.setLocal("last",s.i32_const(0)),...s.setLocal("carry",s.i32_const(0)),...p(0)]))),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0))),s.if(s.getLocal("last"),s.if(s.getLocal("carry"),[...p(255),...p(0),...p(1)],[...p(1)]),s.if(s.getLocal("carry"),[...p(0),...p(1)])),s.setLocal("p",s.i32_sub(s.getLocal("p"),s.i32_const(1))),s.call(d,s.getLocal("base"),m),s.call(b,s.getLocal("r")),s.block(s.loop(s.call(e,s.getLocal("r"),s.getLocal("r")),s.setLocal("cur",s.i32_load8_u(s.getLocal("p"))),s.if(s.getLocal("cur"),s.if(s.i32_eq(s.getLocal("cur"),s.i32_const(1)),s.call(o,s.getLocal("r"),m,s.getLocal("r")),s.call(h,s.getLocal("r"),m,s.getLocal("r")))),s.br_if(1,s.i32_eq(s.getLocal("old0"),s.getLocal("p"))),s.setLocal("p",s.i32_sub(s.getLocal("p"),s.i32_const(1))),s.br(0))),s.i32_store(s.i32_const(0),s.getLocal("old0")))},v4=function(t,n,a,o,e){let d=t.modules[n].n64*8;function b(){let B=t.addFunction(a+"_getChunk");B.addParam("pScalar","i32"),B.addParam("scalarSize","i32"),B.addParam("startBit","i32"),B.addParam("chunkSize","i32"),B.addLocal("bitsToEnd","i32"),B.addLocal("mask","i32"),B.setReturnType("i32");let p=B.getCodeBuilder();B.addCode(p.setLocal("bitsToEnd",p.i32_sub(p.i32_mul(p.getLocal("scalarSize"),p.i32_const(8)),p.getLocal("startBit"))),p.if(p.i32_gt_s(p.getLocal("chunkSize"),p.getLocal("bitsToEnd")),p.setLocal("mask",p.i32_sub(p.i32_shl(p.i32_const(1),p.getLocal("bitsToEnd")),p.i32_const(1))),p.setLocal("mask",p.i32_sub(p.i32_shl(p.i32_const(1),p.getLocal("chunkSize")),p.i32_const(1)))),p.i32_and(p.i32_shr_u(p.i32_load(p.i32_add(p.getLocal("pScalar"),p.i32_shr_u(p.getLocal("startBit"),p.i32_const(3))),0,0),p.i32_and(p.getLocal("startBit"),p.i32_const(7))),p.getLocal("mask")))}function l(){let B=t.addFunction(a+"_chunk");B.addParam("pBases","i32"),B.addParam("pScalars","i32"),B.addParam("scalarSize","i32"),B.addParam("n","i32"),B.addParam("startBit","i32"),B.addParam("chunkSize","i32"),B.addParam("pr","i32"),B.addLocal("nChunks","i32"),B.addLocal("itScalar","i32"),B.addLocal("endScalar","i32"),B.addLocal("itBase","i32"),B.addLocal("i","i32"),B.addLocal("j","i32"),B.addLocal("nTable","i32"),B.addLocal("pTable","i32"),B.addLocal("idx","i32"),B.addLocal("pIdxTable","i32");let p=B.getCodeBuilder();B.addCode(p.if(p.i32_eqz(p.getLocal("n")),[...p.call(n+"_zero",p.getLocal("pr")),...p.ret([])]),p.setLocal("nTable",p.i32_shl(p.i32_const(1),p.getLocal("chunkSize"))),p.setLocal("pTable",p.i32_load(p.i32_const(0))),p.i32_store(p.i32_const(0),p.i32_add(p.getLocal("pTable"),p.i32_mul(p.getLocal("nTable"),p.i32_const(d)))),p.setLocal("j",p.i32_const(0)),p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("j"),p.getLocal("nTable"))),p.call(n+"_zero",p.i32_add(p.getLocal("pTable"),p.i32_mul(p.getLocal("j"),p.i32_const(d)))),p.setLocal("j",p.i32_add(p.getLocal("j"),p.i32_const(1))),p.br(0))),p.setLocal("itBase",p.getLocal("pBases")),p.setLocal("itScalar",p.getLocal("pScalars")),p.setLocal("endScalar",p.i32_add(p.getLocal("pScalars"),p.i32_mul(p.getLocal("n"),p.getLocal("scalarSize")))),p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("itScalar"),p.getLocal("endScalar"))),p.setLocal("idx",p.call(a+"_getChunk",p.getLocal("itScalar"),p.getLocal("scalarSize"),p.getLocal("startBit"),p.getLocal("chunkSize"))),p.if(p.getLocal("idx"),[...p.setLocal("pIdxTable",p.i32_add(p.getLocal("pTable"),p.i32_mul(p.i32_sub(p.getLocal("idx"),p.i32_const(1)),p.i32_const(d)))),...p.call(o,p.getLocal("pIdxTable"),p.getLocal("itBase"),p.getLocal("pIdxTable"))]),p.setLocal("itScalar",p.i32_add(p.getLocal("itScalar"),p.getLocal("scalarSize"))),p.setLocal("itBase",p.i32_add(p.getLocal("itBase"),p.i32_const(e))),p.br(0))),p.call(a+"_reduceTable",p.getLocal("pTable"),p.getLocal("chunkSize")),p.call(n+"_copy",p.getLocal("pTable"),p.getLocal("pr")),p.i32_store(p.i32_const(0),p.getLocal("pTable")))}function s(){let B=t.addFunction(a);B.addParam("pBases","i32"),B.addParam("pScalars","i32"),B.addParam("scalarSize","i32"),B.addParam("n","i32"),B.addParam("pr","i32"),B.addLocal("chunkSize","i32"),B.addLocal("nChunks","i32"),B.addLocal("itScalar","i32"),B.addLocal("endScalar","i32"),B.addLocal("itBase","i32"),B.addLocal("itBit","i32"),B.addLocal("i","i32"),B.addLocal("j","i32"),B.addLocal("nTable","i32"),B.addLocal("pTable","i32"),B.addLocal("idx","i32"),B.addLocal("pIdxTable","i32");let p=B.getCodeBuilder(),v=p.i32_const(t.alloc(d)),M=t.alloc([17,17,17,17,17,17,17,17,17,17,16,16,15,14,13,13,12,11,10,9,8,7,7,6,5,4,3,2,1,1,1,1]);B.addCode(p.call(n+"_zero",p.getLocal("pr")),p.if(p.i32_eqz(p.getLocal("n")),p.ret([])),p.setLocal("chunkSize",p.i32_load8_u(p.i32_clz(p.getLocal("n")),M)),p.setLocal("nChunks",p.i32_add(p.i32_div_u(p.i32_sub(p.i32_shl(p.getLocal("scalarSize"),p.i32_const(3)),p.i32_const(1)),p.getLocal("chunkSize")),p.i32_const(1))),p.setLocal("itBit",p.i32_mul(p.i32_sub(p.getLocal("nChunks"),p.i32_const(1)),p.getLocal("chunkSize"))),p.block(p.loop(p.br_if(1,p.i32_lt_s(p.getLocal("itBit"),p.i32_const(0))),p.if(p.i32_eqz(p.call(n+"_isZero",p.getLocal("pr"))),[...p.setLocal("j",p.i32_const(0)),...p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("j"),p.getLocal("chunkSize"))),p.call(n+"_double",p.getLocal("pr"),p.getLocal("pr")),p.setLocal("j",p.i32_add(p.getLocal("j"),p.i32_const(1))),p.br(0)))]),p.call(a+"_chunk",p.getLocal("pBases"),p.getLocal("pScalars"),p.getLocal("scalarSize"),p.getLocal("n"),p.getLocal("itBit"),p.getLocal("chunkSize"),v),p.call(n+"_add",p.getLocal("pr"),v,p.getLocal("pr")),p.setLocal("itBit",p.i32_sub(p.getLocal("itBit"),p.getLocal("chunkSize"))),p.br(0))))}function m(){let B=t.addFunction(a+"_reduceTable");B.addParam("pTable","i32"),B.addParam("p","i32"),B.addLocal("half","i32"),B.addLocal("it1","i32"),B.addLocal("it2","i32"),B.addLocal("pAcc","i32");let p=B.getCodeBuilder();B.addCode(p.if(p.i32_eq(p.getLocal("p"),p.i32_const(1)),p.ret([])),p.setLocal("half",p.i32_shl(p.i32_const(1),p.i32_sub(p.getLocal("p"),p.i32_const(1)))),p.setLocal("it1",p.getLocal("pTable")),p.setLocal("it2",p.i32_add(p.getLocal("pTable"),p.i32_mul(p.getLocal("half"),p.i32_const(d)))),p.setLocal("pAcc",p.i32_sub(p.getLocal("it2"),p.i32_const(d))),p.block(p.loop(p.br_if(1,p.i32_eq(p.getLocal("it1"),p.getLocal("pAcc"))),p.call(n+"_add",p.getLocal("it1"),p.getLocal("it2"),p.getLocal("it1")),p.call(n+"_add",p.getLocal("pAcc"),p.getLocal("it2"),p.getLocal("pAcc")),p.setLocal("it1",p.i32_add(p.getLocal("it1"),p.i32_const(d))),p.setLocal("it2",p.i32_add(p.getLocal("it2"),p.i32_const(d))),p.br(0))),p.call(a+"_reduceTable",p.getLocal("pTable"),p.i32_sub(p.getLocal("p"),p.i32_const(1))),p.setLocal("p",p.i32_sub(p.getLocal("p"),p.i32_const(1))),p.block(p.loop(p.br_if(1,p.i32_eqz(p.getLocal("p"))),p.call(n+"_double",p.getLocal("pAcc"),p.getLocal("pAcc")),p.setLocal("p",p.i32_sub(p.getLocal("p"),p.i32_const(1))),p.br(0))),p.call(n+"_add",p.getLocal("pTable"),p.getLocal("pAcc"),p.getLocal("pTable")))}b(),m(),l(),s(),t.exportFunction(a),t.exportFunction(a+"_chunk")},bh=E4,Qi=jh,mh=v4,Yh=function(t,n,a,o){let e=t.modules[a].n64,h=e*8;if(t.modules[n])return n;t.modules[n]={n64:e*3};function d(){let A=t.addFunction(n+"_isZero");A.addParam("p1","i32"),A.setReturnType("i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_isZero",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))))}function b(){let A=t.addFunction(n+"_isZeroAffine");A.addParam("p1","i32"),A.setReturnType("i32");let i=A.getCodeBuilder();A.addCode(i.i32_and(i.call(a+"_isZero",i.getLocal("p1")),i.call(a+"_isZero",i.i32_add(i.getLocal("p1"),i.i32_const(h)))))}function l(){let A=t.addFunction(n+"_copy");A.addParam("ps","i32"),A.addParam("pd","i32");let i=A.getCodeBuilder();for(let C=0;C<e*3;C++)A.addCode(i.i64_store(i.getLocal("pd"),C*8,i.i64_load(i.getLocal("ps"),C*8)))}function s(){let A=t.addFunction(n+"_copyAffine");A.addParam("ps","i32"),A.addParam("pd","i32");let i=A.getCodeBuilder();for(let C=0;C<e*2;C++)A.addCode(i.i64_store(i.getLocal("pd"),C*8,i.i64_load(i.getLocal("ps"),C*8)))}function m(){let A=t.addFunction(n+"_zero");A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_zero",i.getLocal("pr"))),A.addCode(i.call(a+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(h)))),A.addCode(i.call(a+"_zero",i.i32_add(i.getLocal("pr"),i.i32_const(h*2))))}function B(){let A=t.addFunction(n+"_zeroAffine");A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_zero",i.getLocal("pr"))),A.addCode(i.call(a+"_zero",i.i32_add(i.getLocal("pr"),i.i32_const(h))))}function p(){let A=t.addFunction(n+"_eq");A.addParam("p1","i32"),A.addParam("p2","i32"),A.setReturnType("i32"),A.addLocal("z1","i32"),A.addLocal("z2","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h));A.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));let z=i.getLocal("z1"),E=i.getLocal("p2"),g=i.i32_add(i.getLocal("p2"),i.i32_const(h));A.addCode(i.setLocal("z2",i.i32_add(i.getLocal("p2"),i.i32_const(h*2))));let U=i.getLocal("z2"),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),yt=i.i32_const(t.alloc(h)),ut=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),i.ret(i.call(n+"_isZero",i.getLocal("p2")))),i.if(i.call(n+"_isZero",i.getLocal("p2")),i.ret(i.i32_const(0))),i.if(i.call(a+"_isOne",z),i.ret(i.call(n+"_eqMixed",i.getLocal("p2"),i.getLocal("p1")))),i.if(i.call(a+"_isOne",U),i.ret(i.call(n+"_eqMixed",i.getLocal("p1"),i.getLocal("p2")))),i.call(a+"_square",z,st),i.call(a+"_square",U,et),i.call(a+"_mul",C,et,ct),i.call(a+"_mul",E,st,ft),i.call(a+"_mul",z,st,_t),i.call(a+"_mul",U,et,gt),i.call(a+"_mul",r,gt,yt),i.call(a+"_mul",g,_t,ut),i.if(i.call(a+"_eq",ct,ft),i.if(i.call(a+"_eq",yt,ut),i.ret(i.i32_const(1)))),i.ret(i.i32_const(0)))}function v(){let A=t.addFunction(n+"_eqMixed");A.addParam("p1","i32"),A.addParam("p2","i32"),A.setReturnType("i32"),A.addLocal("z1","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h));A.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));let z=i.getLocal("z1"),E=i.getLocal("p2"),g=i.i32_add(i.getLocal("p2"),i.i32_const(h)),U=i.i32_const(t.alloc(h)),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),i.ret(i.call(n+"_isZeroAffine",i.getLocal("p2")))),i.if(i.call(n+"_isZeroAffine",i.getLocal("p2")),i.ret(i.i32_const(0))),i.if(i.call(a+"_isOne",z),i.ret(i.call(n+"_eqAffine",i.getLocal("p1"),i.getLocal("p2")))),i.call(a+"_square",z,U),i.call(a+"_mul",E,U,st),i.call(a+"_mul",z,U,et),i.call(a+"_mul",g,et,ct),i.if(i.call(a+"_eq",C,st),i.if(i.call(a+"_eq",r,ct),i.ret(i.i32_const(1)))),i.ret(i.i32_const(0)))}function M(){let A=t.addFunction(n+"_double");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.i32_add(i.getLocal("p1"),i.i32_const(h*2)),E=i.getLocal("pr"),g=i.i32_add(i.getLocal("pr"),i.i32_const(h)),U=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),yt=i.i32_const(t.alloc(h)),ut=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(n+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(a+"_isOne",z),[...i.ret(i.call(n+"_doubleAffine",i.getLocal("p1"),i.getLocal("pr"))),...i.ret([])]),i.call(a+"_square",C,st),i.call(a+"_square",r,et),i.call(a+"_square",et,ct),i.call(a+"_add",C,et,ft),i.call(a+"_square",ft,ft),i.call(a+"_sub",ft,st,ft),i.call(a+"_sub",ft,ct,ft),i.call(a+"_add",ft,ft,ft),i.call(a+"_add",st,st,_t),i.call(a+"_add",_t,st,_t),i.call(a+"_square",_t,gt),i.call(a+"_mul",r,z,yt),i.call(a+"_add",ft,ft,E),i.call(a+"_sub",gt,E,E),i.call(a+"_add",ct,ct,ut),i.call(a+"_add",ut,ut,ut),i.call(a+"_add",ut,ut,ut),i.call(a+"_sub",ft,E,g),i.call(a+"_mul",g,_t,g),i.call(a+"_sub",g,ut,g),i.call(a+"_add",yt,yt,U))}function x(){let A=t.addFunction(n+"_doubleAffine");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.getLocal("pr"),E=i.i32_add(i.getLocal("pr"),i.i32_const(h)),g=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),U=i.i32_const(t.alloc(h)),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("p1")),[...i.call(n+"_toJacobian",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.call(a+"_square",C,U),i.call(a+"_square",r,st),i.call(a+"_square",st,et),i.call(a+"_add",C,st,ct),i.call(a+"_square",ct,ct),i.call(a+"_sub",ct,U,ct),i.call(a+"_sub",ct,et,ct),i.call(a+"_add",ct,ct,ct),i.call(a+"_add",U,U,ft),i.call(a+"_add",ft,U,ft),i.call(a+"_add",r,r,g),i.call(a+"_square",ft,z),i.call(a+"_sub",z,ct,z),i.call(a+"_sub",z,ct,z),i.call(a+"_add",et,et,_t),i.call(a+"_add",_t,_t,_t),i.call(a+"_add",_t,_t,_t),i.call(a+"_sub",ct,z,E),i.call(a+"_mul",E,ft,E),i.call(a+"_sub",E,_t,E))}function S(){let A=t.addFunction(n+"_eqAffine");A.addParam("p1","i32"),A.addParam("p2","i32"),A.setReturnType("i32"),A.addLocal("z1","i32");let i=A.getCodeBuilder();A.addCode(i.ret(i.i32_and(i.call(a+"_eq",i.getLocal("p1"),i.getLocal("p2")),i.call(a+"_eq",i.i32_add(i.getLocal("p1"),i.i32_const(h)),i.i32_add(i.getLocal("p2"),i.i32_const(h))))))}function w(){let A=t.addFunction(n+"_toMontgomery");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_toMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<3;C++)A.addCode(i.call(a+"_toMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*h)),i.i32_add(i.getLocal("pr"),i.i32_const(C*h))))}function k(){let A=t.addFunction(n+"_toMontgomeryAffine");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_toMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<2;C++)A.addCode(i.call(a+"_toMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*h)),i.i32_add(i.getLocal("pr"),i.i32_const(C*h))))}function O(){let A=t.addFunction(n+"_fromMontgomery");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_fromMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<3;C++)A.addCode(i.call(a+"_fromMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*h)),i.i32_add(i.getLocal("pr"),i.i32_const(C*h))))}function W(){let A=t.addFunction(n+"_fromMontgomeryAffine");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder();A.addCode(i.call(a+"_fromMontgomery",i.getLocal("p1"),i.getLocal("pr")));for(let C=1;C<2;C++)A.addCode(i.call(a+"_fromMontgomery",i.i32_add(i.getLocal("p1"),i.i32_const(C*h)),i.i32_add(i.getLocal("pr"),i.i32_const(C*h))))}function F(){let A=t.addFunction(n+"_add");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32"),A.addLocal("z1","i32"),A.addLocal("z2","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h));A.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));let z=i.getLocal("z1"),E=i.getLocal("p2"),g=i.i32_add(i.getLocal("p2"),i.i32_const(h));A.addCode(i.setLocal("z2",i.i32_add(i.getLocal("p2"),i.i32_const(h*2))));let U=i.getLocal("z2"),st=i.getLocal("pr"),et=i.i32_add(i.getLocal("pr"),i.i32_const(h)),ct=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),yt=i.i32_const(t.alloc(h)),ut=i.i32_const(t.alloc(h)),lt=i.i32_const(t.alloc(h)),bt=i.i32_const(t.alloc(h)),Et=i.i32_const(t.alloc(h)),It=i.i32_const(t.alloc(h)),zt=i.i32_const(t.alloc(h)),Mt=i.i32_const(t.alloc(h)),kt=i.i32_const(t.alloc(h)),Pt=i.i32_const(t.alloc(h)),qt=i.i32_const(t.alloc(h)),Rt=i.i32_const(t.alloc(h)),Kt=i.i32_const(t.alloc(h)),Ut=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(n+"_copy",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(n+"_isZero",i.getLocal("p2")),[...i.call(n+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(a+"_isOne",z),[...i.call(n+"_addMixed",E,C,st),...i.ret([])]),i.if(i.call(a+"_isOne",U),[...i.call(n+"_addMixed",C,E,st),...i.ret([])]),i.call(a+"_square",z,ft),i.call(a+"_square",U,_t),i.call(a+"_mul",C,_t,gt),i.call(a+"_mul",E,ft,yt),i.call(a+"_mul",z,ft,ut),i.call(a+"_mul",U,_t,lt),i.call(a+"_mul",r,lt,bt),i.call(a+"_mul",g,ut,Et),i.if(i.call(a+"_eq",gt,yt),i.if(i.call(a+"_eq",bt,Et),[...i.call(n+"_double",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])])),i.call(a+"_sub",yt,gt,It),i.call(a+"_sub",Et,bt,zt),i.call(a+"_add",It,It,Mt),i.call(a+"_square",Mt,Mt),i.call(a+"_mul",It,Mt,kt),i.call(a+"_add",zt,zt,Pt),i.call(a+"_mul",gt,Mt,Rt),i.call(a+"_square",Pt,qt),i.call(a+"_add",Rt,Rt,Kt),i.call(a+"_sub",qt,kt,st),i.call(a+"_sub",st,Kt,st),i.call(a+"_mul",bt,kt,Ut),i.call(a+"_add",Ut,Ut,Ut),i.call(a+"_sub",Rt,st,et),i.call(a+"_mul",et,Pt,et),i.call(a+"_sub",et,Ut,et),i.call(a+"_add",z,U,ct),i.call(a+"_square",ct,ct),i.call(a+"_sub",ct,ft,ct),i.call(a+"_sub",ct,_t,ct),i.call(a+"_mul",ct,It,ct))}function u(){let A=t.addFunction(n+"_addMixed");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32"),A.addLocal("z1","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h));A.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));let z=i.getLocal("z1"),E=i.getLocal("p2"),g=i.i32_add(i.getLocal("p2"),i.i32_const(h)),U=i.getLocal("pr"),st=i.i32_add(i.getLocal("pr"),i.i32_const(h)),et=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),ct=i.i32_const(t.alloc(h)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),yt=i.i32_const(t.alloc(h)),ut=i.i32_const(t.alloc(h)),lt=i.i32_const(t.alloc(h)),bt=i.i32_const(t.alloc(h)),Et=i.i32_const(t.alloc(h)),It=i.i32_const(t.alloc(h)),zt=i.i32_const(t.alloc(h)),Mt=i.i32_const(t.alloc(h)),kt=i.i32_const(t.alloc(h)),Pt=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(n+"_copyAffine",i.getLocal("p2"),i.getLocal("pr")),...i.call(a+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(h*2))),...i.ret([])]),i.if(i.call(n+"_isZeroAffine",i.getLocal("p2")),[...i.call(n+"_copy",i.getLocal("p1"),i.getLocal("pr")),...i.ret([])]),i.if(i.call(a+"_isOne",z),[...i.call(n+"_addAffine",C,E,U),...i.ret([])]),i.call(a+"_square",z,ct),i.call(a+"_mul",E,ct,ft),i.call(a+"_mul",z,ct,_t),i.call(a+"_mul",g,_t,gt),i.if(i.call(a+"_eq",C,ft),i.if(i.call(a+"_eq",r,gt),[...i.call(n+"_doubleAffine",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])])),i.call(a+"_sub",ft,C,yt),i.call(a+"_sub",gt,r,lt),i.call(a+"_square",yt,ut),i.call(a+"_add",ut,ut,bt),i.call(a+"_add",bt,bt,bt),i.call(a+"_mul",yt,bt,Et),i.call(a+"_add",lt,lt,It),i.call(a+"_mul",C,bt,Mt),i.call(a+"_square",It,zt),i.call(a+"_add",Mt,Mt,kt),i.call(a+"_sub",zt,Et,U),i.call(a+"_sub",U,kt,U),i.call(a+"_mul",r,Et,Pt),i.call(a+"_add",Pt,Pt,Pt),i.call(a+"_sub",Mt,U,st),i.call(a+"_mul",st,It,st),i.call(a+"_sub",st,Pt,st),i.call(a+"_add",z,yt,et),i.call(a+"_square",et,et),i.call(a+"_sub",et,ct,et),i.call(a+"_sub",et,ut,et))}function L(){let A=t.addFunction(n+"_addAffine");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32"),A.addLocal("z1","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h));A.addCode(i.setLocal("z1",i.i32_add(i.getLocal("p1"),i.i32_const(h*2))));let z=i.getLocal("p2"),E=i.i32_add(i.getLocal("p2"),i.i32_const(h)),g=i.getLocal("pr"),U=i.i32_add(i.getLocal("pr"),i.i32_const(h)),st=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h)),ft=i.i32_const(t.alloc(h)),_t=i.i32_const(t.alloc(h)),gt=i.i32_const(t.alloc(h)),yt=i.i32_const(t.alloc(h)),ut=i.i32_const(t.alloc(h)),lt=i.i32_const(t.alloc(h)),bt=i.i32_const(t.alloc(h)),Et=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("p1")),[...i.call(n+"_copyAffine",i.getLocal("p2"),i.getLocal("pr")),...i.call(a+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(h*2))),...i.ret([])]),i.if(i.call(n+"_isZeroAffine",i.getLocal("p2")),[...i.call(n+"_copyAffine",i.getLocal("p1"),i.getLocal("pr")),...i.call(a+"_one",i.i32_add(i.getLocal("pr"),i.i32_const(h*2))),...i.ret([])]),i.if(i.call(a+"_eq",C,z),i.if(i.call(a+"_eq",r,E),[...i.call(n+"_doubleAffine",i.getLocal("p2"),i.getLocal("pr")),...i.ret([])])),i.call(a+"_sub",z,C,et),i.call(a+"_sub",E,r,ft),i.call(a+"_square",et,ct),i.call(a+"_add",ct,ct,_t),i.call(a+"_add",_t,_t,_t),i.call(a+"_mul",et,_t,gt),i.call(a+"_add",ft,ft,yt),i.call(a+"_mul",C,_t,lt),i.call(a+"_square",yt,ut),i.call(a+"_add",lt,lt,bt),i.call(a+"_sub",ut,gt,g),i.call(a+"_sub",g,bt,g),i.call(a+"_mul",r,gt,Et),i.call(a+"_add",Et,Et,Et),i.call(a+"_sub",lt,g,U),i.call(a+"_mul",U,yt,U),i.call(a+"_sub",U,Et,U),i.call(a+"_add",et,et,st))}function $(){let A=t.addFunction(n+"_neg");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.i32_add(i.getLocal("p1"),i.i32_const(h*2)),E=i.getLocal("pr"),g=i.i32_add(i.getLocal("pr"),i.i32_const(h)),U=i.i32_add(i.getLocal("pr"),i.i32_const(h*2));A.addCode(i.call(a+"_copy",C,E),i.call(a+"_neg",r,g),i.call(a+"_copy",z,U))}function Q(){let A=t.addFunction(n+"_negAffine");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.getLocal("pr"),E=i.i32_add(i.getLocal("pr"),i.i32_const(h));A.addCode(i.call(a+"_copy",C,z),i.call(a+"_neg",r,E))}function H(){let A=t.addFunction(n+"_sub");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h*3));A.addCode(i.call(n+"_neg",i.getLocal("p2"),C),i.call(n+"_add",i.getLocal("p1"),C,i.getLocal("pr")))}function q(){let A=t.addFunction(n+"_subMixed");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h*3));A.addCode(i.call(n+"_negAffine",i.getLocal("p2"),C),i.call(n+"_addMixed",i.getLocal("p1"),C,i.getLocal("pr")))}function y(){let A=t.addFunction(n+"_subAffine");A.addParam("p1","i32"),A.addParam("p2","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h*3));A.addCode(i.call(n+"_negAffine",i.getLocal("p2"),C),i.call(n+"_addAffine",i.getLocal("p1"),C,i.getLocal("pr")))}function I(){let A=t.addFunction(n+"_normalize");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.i32_add(i.getLocal("p1"),i.i32_const(h*2)),E=i.getLocal("pr"),g=i.i32_add(i.getLocal("pr"),i.i32_const(h)),U=i.i32_add(i.getLocal("pr"),i.i32_const(h*2)),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h)),ct=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),i.call(n+"_zero",i.getLocal("pr")),[...i.call(a+"_inverse",z,st),...i.call(a+"_square",st,et),...i.call(a+"_mul",st,et,ct),...i.call(a+"_mul",C,et,E),...i.call(a+"_mul",r,ct,g),...i.call(a+"_one",U)]))}function N(){let A=t.addFunction(n+"_toAffine");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.i32_add(i.getLocal("p1"),i.i32_const(h*2)),E=i.getLocal("pr"),g=i.i32_add(i.getLocal("pr"),i.i32_const(h)),U=i.i32_const(t.alloc(h)),st=i.i32_const(t.alloc(h)),et=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZero",i.getLocal("p1")),[...i.call(a+"_zero",E),...i.call(a+"_zero",g)],[...i.call(a+"_inverse",z,U),...i.call(a+"_square",U,st),...i.call(a+"_mul",U,st,et),...i.call(a+"_mul",C,st,E),...i.call(a+"_mul",r,et,g)]))}function nt(){let A=t.addFunction(n+"_toJacobian");A.addParam("p1","i32"),A.addParam("pr","i32");let i=A.getCodeBuilder(),C=i.getLocal("p1"),r=i.i32_add(i.getLocal("p1"),i.i32_const(h)),z=i.getLocal("pr"),E=i.i32_add(i.getLocal("pr"),i.i32_const(h)),g=i.i32_add(i.getLocal("pr"),i.i32_const(h*2));A.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("p1")),i.call(n+"_zero",i.getLocal("pr")),[...i.call(a+"_one",g),...i.call(a+"_copy",r,E),...i.call(a+"_copy",C,z)]))}function J(){let A=t.addFunction(n+"_batchToAffine");A.addParam("pIn","i32"),A.addParam("n","i32"),A.addParam("pOut","i32"),A.addLocal("pAux","i32"),A.addLocal("itIn","i32"),A.addLocal("itAux","i32"),A.addLocal("itOut","i32"),A.addLocal("i","i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h));A.addCode(i.setLocal("pAux",i.i32_load(i.i32_const(0))),i.i32_store(i.i32_const(0),i.i32_add(i.getLocal("pAux"),i.i32_mul(i.getLocal("n"),i.i32_const(h)))),i.call(a+"_batchInverse",i.i32_add(i.getLocal("pIn"),i.i32_const(h*2)),i.i32_const(h*3),i.getLocal("n"),i.getLocal("pAux"),i.i32_const(h)),i.setLocal("itIn",i.getLocal("pIn")),i.setLocal("itAux",i.getLocal("pAux")),i.setLocal("itOut",i.getLocal("pOut")),i.setLocal("i",i.i32_const(0)),i.block(i.loop(i.br_if(1,i.i32_eq(i.getLocal("i"),i.getLocal("n"))),i.if(i.call(a+"_isZero",i.getLocal("itAux")),[...i.call(a+"_zero",i.getLocal("itOut")),...i.call(a+"_zero",i.i32_add(i.getLocal("itOut"),i.i32_const(h)))],[...i.call(a+"_mul",i.getLocal("itAux"),i.i32_add(i.getLocal("itIn"),i.i32_const(h)),C),...i.call(a+"_square",i.getLocal("itAux"),i.getLocal("itAux")),...i.call(a+"_mul",i.getLocal("itAux"),i.getLocal("itIn"),i.getLocal("itOut")),...i.call(a+"_mul",i.getLocal("itAux"),C,i.i32_add(i.getLocal("itOut"),i.i32_const(h)))]),i.setLocal("itIn",i.i32_add(i.getLocal("itIn"),i.i32_const(h*3))),i.setLocal("itOut",i.i32_add(i.getLocal("itOut"),i.i32_const(h*2))),i.setLocal("itAux",i.i32_add(i.getLocal("itAux"),i.i32_const(h))),i.setLocal("i",i.i32_add(i.getLocal("i"),i.i32_const(1))),i.br(0))),i.i32_store(i.i32_const(0),i.getLocal("pAux")))}function j(){let A=t.addFunction(n+"__reverseBytes");A.addParam("pIn","i32"),A.addParam("n","i32"),A.addParam("pOut","i32"),A.addLocal("itOut","i32"),A.addLocal("itIn","i32");let i=A.getCodeBuilder();A.addCode(i.setLocal("itOut",i.i32_sub(i.i32_add(i.getLocal("pOut"),i.getLocal("n")),i.i32_const(1))),i.setLocal("itIn",i.getLocal("pIn")),i.block(i.loop(i.br_if(1,i.i32_lt_s(i.getLocal("itOut"),i.getLocal("pOut"))),i.i32_store8(i.getLocal("itOut"),i.i32_load8_u(i.getLocal("itIn"))),i.setLocal("itOut",i.i32_sub(i.getLocal("itOut"),i.i32_const(1))),i.setLocal("itIn",i.i32_add(i.getLocal("itIn"),i.i32_const(1))),i.br(0))))}function ot(){let A=t.addFunction(n+"_LEMtoC");A.addParam("pIn","i32"),A.addParam("pOut","i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h));A.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("pIn")),[...i.call(a+"_zero",i.getLocal("pOut")),...i.i32_store8(i.getLocal("pOut"),i.i32_const(64)),...i.ret([])]),i.call(a+"_fromMontgomery",i.getLocal("pIn"),C),i.call(n+"__reverseBytes",C,i.i32_const(h),i.getLocal("pOut")),i.if(i.i32_eq(i.call(a+"_sign",i.i32_add(i.getLocal("pIn"),i.i32_const(h))),i.i32_const(-1)),i.i32_store8(i.getLocal("pOut"),i.i32_or(i.i32_load8_u(i.getLocal("pOut")),i.i32_const(128)))))}function V(){let A=t.addFunction(n+"_LEMtoU");A.addParam("pIn","i32"),A.addParam("pOut","i32");let i=A.getCodeBuilder(),C=t.alloc(h*2),r=i.i32_const(C),z=i.i32_const(C),E=i.i32_const(C+h);A.addCode(i.if(i.call(n+"_isZeroAffine",i.getLocal("pIn")),[...i.call(n+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.call(n+"_fromMontgomeryAffine",i.getLocal("pIn"),r),i.call(n+"__reverseBytes",z,i.i32_const(h),i.getLocal("pOut")),i.call(n+"__reverseBytes",E,i.i32_const(h),i.i32_add(i.getLocal("pOut"),i.i32_const(h))))}function at(){let A=t.addFunction(n+"_UtoLEM");A.addParam("pIn","i32"),A.addParam("pOut","i32");let i=A.getCodeBuilder(),C=t.alloc(h*2),r=i.i32_const(C),z=i.i32_const(C),E=i.i32_const(C+h);A.addCode(i.if(i.i32_and(i.i32_load8_u(i.getLocal("pIn")),i.i32_const(64)),[...i.call(n+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.call(n+"__reverseBytes",i.getLocal("pIn"),i.i32_const(h),z),i.call(n+"__reverseBytes",i.i32_add(i.getLocal("pIn"),i.i32_const(h)),i.i32_const(h),E),i.call(n+"_toMontgomeryAffine",r,i.getLocal("pOut")))}function Lt(){let A=t.addFunction(n+"_CtoLEM");A.addParam("pIn","i32"),A.addParam("pOut","i32"),A.addLocal("firstByte","i32"),A.addLocal("greatest","i32");let i=A.getCodeBuilder(),C=t.alloc(h*2),r=i.i32_const(C),z=i.i32_const(C+h);A.addCode(i.setLocal("firstByte",i.i32_load8_u(i.getLocal("pIn"))),i.if(i.i32_and(i.getLocal("firstByte"),i.i32_const(64)),[...i.call(n+"_zeroAffine",i.getLocal("pOut")),...i.ret([])]),i.setLocal("greatest",i.i32_and(i.getLocal("firstByte"),i.i32_const(128))),i.call(a+"_copy",i.getLocal("pIn"),z),i.i32_store8(z,i.i32_and(i.getLocal("firstByte"),i.i32_const(63))),i.call(n+"__reverseBytes",z,i.i32_const(h),r),i.call(a+"_toMontgomery",r,i.getLocal("pOut")),i.call(a+"_square",i.getLocal("pOut"),z),i.call(a+"_mul",i.getLocal("pOut"),z,z),i.call(a+"_add",z,i.i32_const(o),z),i.call(a+"_sqrt",z,z),i.call(a+"_neg",z,r),i.if(i.i32_eq(i.call(a+"_sign",z),i.i32_const(-1)),i.if(i.getLocal("greatest"),i.call(a+"_copy",z,i.i32_add(i.getLocal("pOut"),i.i32_const(h))),i.call(a+"_neg",z,i.i32_add(i.getLocal("pOut"),i.i32_const(h)))),i.if(i.getLocal("greatest"),i.call(a+"_neg",z,i.i32_add(i.getLocal("pOut"),i.i32_const(h))),i.call(a+"_copy",z,i.i32_add(i.getLocal("pOut"),i.i32_const(h))))))}function rt(){let A=t.addFunction(n+"_inCurveAffine");A.addParam("pIn","i32"),A.setReturnType("i32");let i=A.getCodeBuilder(),C=i.getLocal("pIn"),r=i.i32_add(i.getLocal("pIn"),i.i32_const(h)),z=i.i32_const(t.alloc(h)),E=i.i32_const(t.alloc(h));A.addCode(i.call(a+"_square",r,z),i.call(a+"_square",C,E),i.call(a+"_mul",C,E,E),i.call(a+"_add",E,i.i32_const(o),E),i.ret(i.call(a+"_eq",z,E)))}function ht(){let A=t.addFunction(n+"_inCurve");A.addParam("pIn","i32"),A.setReturnType("i32");let i=A.getCodeBuilder(),C=i.i32_const(t.alloc(h*2));A.addCode(i.call(n+"_toAffine",i.getLocal("pIn"),C),i.ret(i.call(n+"_inCurveAffine",C)))}return b(),d(),B(),m(),s(),l(),nt(),S(),v(),p(),x(),M(),L(),u(),F(),Q(),$(),y(),q(),H(),W(),O(),k(),w(),N(),rt(),ht(),J(),I(),j(),V(),ot(),at(),Lt(),Qi(t,n+"_batchLEMtoU",n+"_LEMtoU",h*2,h*2),Qi(t,n+"_batchLEMtoC",n+"_LEMtoC",h*2,h),Qi(t,n+"_batchUtoLEM",n+"_UtoLEM",h*2,h*2),Qi(t,n+"_batchCtoLEM",n+"_CtoLEM",h,h*2,!0),Qi(t,n+"_batchToJacobian",n+"_toJacobian",h*2,h*3,!0),mh(t,n,n+"_multiexp",n+"_add",h*3),mh(t,n,n+"_multiexpAffine",n+"_addMixed",h*2),bh(t,n+"_timesScalar",h*3,n+"_add",n+"_double",n+"_sub",n+"_copy",n+"_zero"),bh(t,n+"_timesScalarAffine",h*2,n+"_addMixed",n+"_double",n+"_subMixed",n+"_copyAffine",n+"_zero"),t.exportFunction(n+"_isZero"),t.exportFunction(n+"_isZeroAffine"),t.exportFunction(n+"_eq"),t.exportFunction(n+"_eqMixed"),t.exportFunction(n+"_eqAffine"),t.exportFunction(n+"_copy"),t.exportFunction(n+"_copyAffine"),t.exportFunction(n+"_zero"),t.exportFunction(n+"_zeroAffine"),t.exportFunction(n+"_double"),t.exportFunction(n+"_doubleAffine"),t.exportFunction(n+"_add"),t.exportFunction(n+"_addMixed"),t.exportFunction(n+"_addAffine"),t.exportFunction(n+"_neg"),t.exportFunction(n+"_negAffine"),t.exportFunction(n+"_sub"),t.exportFunction(n+"_subMixed"),t.exportFunction(n+"_subAffine"),t.exportFunction(n+"_fromMontgomery"),t.exportFunction(n+"_fromMontgomeryAffine"),t.exportFunction(n+"_toMontgomery"),t.exportFunction(n+"_toMontgomeryAffine"),t.exportFunction(n+"_timesScalar"),t.exportFunction(n+"_timesScalarAffine"),t.exportFunction(n+"_normalize"),t.exportFunction(n+"_LEMtoU"),t.exportFunction(n+"_LEMtoC"),t.exportFunction(n+"_UtoLEM"),t.exportFunction(n+"_CtoLEM"),t.exportFunction(n+"_batchLEMtoU"),t.exportFunction(n+"_batchLEMtoC"),t.exportFunction(n+"_batchUtoLEM"),t.exportFunction(n+"_batchCtoLEM"),t.exportFunction(n+"_toAffine"),t.exportFunction(n+"_toJacobian"),t.exportFunction(n+"_batchToAffine"),t.exportFunction(n+"_batchToJacobian"),t.exportFunction(n+"_inCurve"),t.exportFunction(n+"_inCurveAffine"),n},{isOdd:S4,modInv:yh,modPow:Xi}=Hn,Wc=Ja,tf=function(t,n,a,o,e){let d=t.modules[o].n64*8,l=t.modules[a].n64*8,s=t.modules[o].q,m=s-1n,B=0;for(;!S4(m);)B++,m=m>>1n;let p=2n;for(;Xi(p,s>>1n,s)===1n;)p=p+1n;let v=new Array(B+1);v[B]=Xi(p,m,s);let M=B-1;for(;M>=0;)v[M]=Xi(v[M+1],2n,s),M--;let x=[],S=(1n<<BigInt(d*8))%s;for(let C=0;C<v.length;C++){let r=v[C]*S%s;x.push(...Wc.bigInt2BytesLE(r,d))}let w=t.alloc(x),k=new Array(B+1);k[0]=1n;for(let C=1;C<=B;C++)k[C]=k[C-1]*2n;let O=[];for(let C=0;C<=B;C++){let r=yh(k[C],s)*S%s;O.push(...Wc.bigInt2BytesLE(r,d))}let W=t.alloc(O),F=Xi(p,2n,s),u=[],L=[];for(let C=0;C<=B;C++){let r=Xi(F,2n**BigInt(C),s),z=yh(s+1n-r,s);u.push(...Wc.bigInt2BytesLE(r*S%s,d)),L.push(...Wc.bigInt2BytesLE(z*S%s,d))}let $=t.alloc(u),Q=t.alloc(L);function H(C){let r=0;for(let z=0;z<8;z++)C&1<<z&&(r=r|128>>z);return r}let q=Array(256);for(let C=0;C<256;C++)q[C]=H(C);let y=t.alloc(q);function I(){let C=t.addFunction(n+"__log2");C.addParam("n","i32"),C.setReturnType("i32"),C.addLocal("bits","i32"),C.addLocal("aux","i32");let r=C.getCodeBuilder();C.addCode(r.setLocal("aux",r.i32_shr_u(r.getLocal("n"),r.i32_const(1)))),C.addCode(r.setLocal("bits",r.i32_const(0))),C.addCode(r.block(r.loop(r.br_if(1,r.i32_eqz(r.getLocal("aux"))),r.setLocal("aux",r.i32_shr_u(r.getLocal("aux"),r.i32_const(1))),r.setLocal("bits",r.i32_add(r.getLocal("bits"),r.i32_const(1))),r.br(0)))),C.addCode(r.if(r.i32_ne(r.getLocal("n"),r.i32_shl(r.i32_const(1),r.getLocal("bits"))),r.unreachable())),C.addCode(r.if(r.i32_gt_u(r.getLocal("bits"),r.i32_const(B)),r.unreachable())),C.addCode(r.getLocal("bits"))}function N(){let C=t.addFunction(n+"_fft");C.addParam("px","i32"),C.addParam("n","i32"),C.addLocal("bits","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d));C.addCode(r.setLocal("bits",r.call(n+"__log2",r.getLocal("n"))),r.call(o+"_one",z),r.call(n+"_rawfft",r.getLocal("px"),r.getLocal("bits"),r.i32_const(0),z))}function nt(){let C=t.addFunction(n+"_ifft");C.addParam("px","i32"),C.addParam("n","i32"),C.addLocal("bits","i32"),C.addLocal("pInv2","i32");let r=C.getCodeBuilder();C.addCode(r.setLocal("bits",r.call(n+"__log2",r.getLocal("n"))),r.setLocal("pInv2",r.i32_add(r.i32_const(W),r.i32_mul(r.getLocal("bits"),r.i32_const(d)))),r.call(n+"_rawfft",r.getLocal("px"),r.getLocal("bits"),r.i32_const(1),r.getLocal("pInv2")))}function J(){let C=t.addFunction(n+"_rawfft");C.addParam("px","i32"),C.addParam("bits","i32"),C.addParam("reverse","i32"),C.addParam("mulFactor","i32"),C.addLocal("s","i32"),C.addLocal("k","i32"),C.addLocal("j","i32"),C.addLocal("m","i32"),C.addLocal("mdiv2","i32"),C.addLocal("n","i32"),C.addLocal("pwm","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l)),g=r.i32_const(t.alloc(l));C.addCode(r.call(n+"__reversePermutation",r.getLocal("px"),r.getLocal("bits")),r.setLocal("n",r.i32_shl(r.i32_const(1),r.getLocal("bits"))),r.setLocal("s",r.i32_const(1)),r.block(r.loop(r.br_if(1,r.i32_gt_u(r.getLocal("s"),r.getLocal("bits"))),r.setLocal("m",r.i32_shl(r.i32_const(1),r.getLocal("s"))),r.setLocal("pwm",r.i32_add(r.i32_const(w),r.i32_mul(r.getLocal("s"),r.i32_const(d)))),r.setLocal("k",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_ge_u(r.getLocal("k"),r.getLocal("n"))),r.call(o+"_one",z),r.setLocal("mdiv2",r.i32_shr_u(r.getLocal("m"),r.i32_const(1))),r.setLocal("j",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_ge_u(r.getLocal("j"),r.getLocal("mdiv2"))),r.setLocal("idx1",r.i32_add(r.getLocal("px"),r.i32_mul(r.i32_add(r.getLocal("k"),r.getLocal("j")),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("idx1"),r.i32_mul(r.getLocal("mdiv2"),r.i32_const(l)))),r.call(e,r.getLocal("idx2"),z,E),r.call(a+"_copy",r.getLocal("idx1"),g),r.call(a+"_add",g,E,r.getLocal("idx1")),r.call(a+"_sub",g,E,r.getLocal("idx2")),r.call(o+"_mul",z,r.getLocal("pwm"),z),r.setLocal("j",r.i32_add(r.getLocal("j"),r.i32_const(1))),r.br(0))),r.setLocal("k",r.i32_add(r.getLocal("k"),r.getLocal("m"))),r.br(0))),r.setLocal("s",r.i32_add(r.getLocal("s"),r.i32_const(1))),r.br(0))),r.call(n+"__fftFinal",r.getLocal("px"),r.getLocal("bits"),r.getLocal("reverse"),r.getLocal("mulFactor")))}function j(){let C=t.addFunction(n+"__fftFinal");C.addParam("px","i32"),C.addParam("bits","i32"),C.addParam("reverse","i32"),C.addParam("mulFactor","i32"),C.addLocal("n","i32"),C.addLocal("ndiv2","i32"),C.addLocal("pInv2","i32"),C.addLocal("i","i32"),C.addLocal("mask","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(l));C.addCode(r.if(r.i32_and(r.i32_eqz(r.getLocal("reverse")),r.call(o+"_isOne",r.getLocal("mulFactor"))),r.ret([])),r.setLocal("n",r.i32_shl(r.i32_const(1),r.getLocal("bits"))),r.setLocal("mask",r.i32_sub(r.getLocal("n"),r.i32_const(1))),r.setLocal("i",r.i32_const(1)),r.setLocal("ndiv2",r.i32_shr_u(r.getLocal("n"),r.i32_const(1))),r.block(r.loop(r.br_if(1,r.i32_ge_u(r.getLocal("i"),r.getLocal("ndiv2"))),r.setLocal("idx1",r.i32_add(r.getLocal("px"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("px"),r.i32_mul(r.i32_sub(r.getLocal("n"),r.getLocal("i")),r.i32_const(l)))),r.if(r.getLocal("reverse"),r.if(r.call(o+"_isOne",r.getLocal("mulFactor")),[...r.call(a+"_copy",r.getLocal("idx1"),z),...r.call(a+"_copy",r.getLocal("idx2"),r.getLocal("idx1")),...r.call(a+"_copy",z,r.getLocal("idx2"))],[...r.call(a+"_copy",r.getLocal("idx1"),z),...r.call(e,r.getLocal("idx2"),r.getLocal("mulFactor"),r.getLocal("idx1")),...r.call(e,z,r.getLocal("mulFactor"),r.getLocal("idx2"))]),r.if(r.call(o+"_isOne",r.getLocal("mulFactor")),[],[...r.call(e,r.getLocal("idx1"),r.getLocal("mulFactor"),r.getLocal("idx1")),...r.call(e,r.getLocal("idx2"),r.getLocal("mulFactor"),r.getLocal("idx2"))])),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))),r.if(r.call(o+"_isOne",r.getLocal("mulFactor")),[],[...r.call(e,r.getLocal("px"),r.getLocal("mulFactor"),r.getLocal("px")),...r.setLocal("idx2",r.i32_add(r.getLocal("px"),r.i32_mul(r.getLocal("ndiv2"),r.i32_const(l)))),...r.call(e,r.getLocal("idx2"),r.getLocal("mulFactor"),r.getLocal("idx2"))]))}function ot(){let C=t.addFunction(n+"__reversePermutation");C.addParam("px","i32"),C.addParam("bits","i32"),C.addLocal("n","i32"),C.addLocal("i","i32"),C.addLocal("ri","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(l));C.addCode(r.setLocal("n",r.i32_shl(r.i32_const(1),r.getLocal("bits"))),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.setLocal("idx1",r.i32_add(r.getLocal("px"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("ri",r.call(n+"__rev",r.getLocal("i"),r.getLocal("bits"))),r.setLocal("idx2",r.i32_add(r.getLocal("px"),r.i32_mul(r.getLocal("ri"),r.i32_const(l)))),r.if(r.i32_lt_u(r.getLocal("i"),r.getLocal("ri")),[...r.call(a+"_copy",r.getLocal("idx1"),z),...r.call(a+"_copy",r.getLocal("idx2"),r.getLocal("idx1")),...r.call(a+"_copy",z,r.getLocal("idx2"))]),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function V(){let C=t.addFunction(n+"__rev");C.addParam("x","i32"),C.addParam("bits","i32"),C.setReturnType("i32");let r=C.getCodeBuilder();C.addCode(r.i32_rotl(r.i32_add(r.i32_add(r.i32_shl(r.i32_load8_u(r.i32_and(r.getLocal("x"),r.i32_const(255)),y,0),r.i32_const(24)),r.i32_shl(r.i32_load8_u(r.i32_and(r.i32_shr_u(r.getLocal("x"),r.i32_const(8)),r.i32_const(255)),y,0),r.i32_const(16))),r.i32_add(r.i32_shl(r.i32_load8_u(r.i32_and(r.i32_shr_u(r.getLocal("x"),r.i32_const(16)),r.i32_const(255)),y,0),r.i32_const(8)),r.i32_load8_u(r.i32_and(r.i32_shr_u(r.getLocal("x"),r.i32_const(24)),r.i32_const(255)),y,0))),r.getLocal("bits")))}function at(){let C=t.addFunction(n+"_fftJoin");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l)),g=r.i32_const(t.alloc(l));C.addCode(r.call(o+"_copy",r.getLocal("first"),z),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff1"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("pBuff2"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.call(e,r.getLocal("idx2"),z,E),r.call(a+"_copy",r.getLocal("idx1"),g),r.call(a+"_add",g,E,r.getLocal("idx1")),r.call(a+"_sub",g,E,r.getLocal("idx2")),r.call(o+"_mul",z,r.getLocal("inc"),z),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function Lt(){let C=t.addFunction(n+"_fftJoinExt");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addParam("totalBits","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("pShiftToM","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l));C.addCode(r.setLocal("pShiftToM",r.i32_add(r.i32_const($),r.i32_mul(r.getLocal("totalBits"),r.i32_const(d)))),r.call(o+"_copy",r.getLocal("first"),z),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff1"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("pBuff2"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.call(a+"_add",r.getLocal("idx1"),r.getLocal("idx2"),E),r.call(e,r.getLocal("idx2"),r.getLocal("pShiftToM"),r.getLocal("idx2")),r.call(a+"_add",r.getLocal("idx1"),r.getLocal("idx2"),r.getLocal("idx2")),r.call(e,r.getLocal("idx2"),z,r.getLocal("idx2")),r.call(a+"_copy",E,r.getLocal("idx1")),r.call(o+"_mul",z,r.getLocal("inc"),z),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function rt(){let C=t.addFunction(n+"_fftJoinExtInv");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addParam("totalBits","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("pShiftToM","i32"),C.addLocal("pSConst","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l));C.addCode(r.setLocal("pShiftToM",r.i32_add(r.i32_const($),r.i32_mul(r.getLocal("totalBits"),r.i32_const(d)))),r.setLocal("pSConst",r.i32_add(r.i32_const(Q),r.i32_mul(r.getLocal("totalBits"),r.i32_const(d)))),r.call(o+"_copy",r.getLocal("first"),z),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff1"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("pBuff2"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.call(e,r.getLocal("idx2"),z,E),r.call(a+"_sub",r.getLocal("idx1"),E,r.getLocal("idx2")),r.call(e,r.getLocal("idx2"),r.getLocal("pSConst"),r.getLocal("idx2")),r.call(e,r.getLocal("idx1"),r.getLocal("pShiftToM"),r.getLocal("idx1")),r.call(a+"_sub",E,r.getLocal("idx1"),r.getLocal("idx1")),r.call(e,r.getLocal("idx1"),r.getLocal("pSConst"),r.getLocal("idx1")),r.call(o+"_mul",z,r.getLocal("inc"),z),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function ht(){let C=t.addFunction(n+"_prepareLagrangeEvaluation");C.addParam("pBuff1","i32"),C.addParam("pBuff2","i32"),C.addParam("n","i32"),C.addParam("first","i32"),C.addParam("inc","i32"),C.addParam("totalBits","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("pShiftToM","i32"),C.addLocal("pSConst","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l));C.addCode(r.setLocal("pShiftToM",r.i32_add(r.i32_const($),r.i32_mul(r.getLocal("totalBits"),r.i32_const(d)))),r.setLocal("pSConst",r.i32_add(r.i32_const(Q),r.i32_mul(r.getLocal("totalBits"),r.i32_const(d)))),r.call(o+"_copy",r.getLocal("first"),z),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("n"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff1"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("pBuff2"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.call(e,r.getLocal("idx1"),r.getLocal("pShiftToM"),E),r.call(a+"_sub",r.getLocal("idx2"),E,E),r.call(a+"_sub",r.getLocal("idx1"),r.getLocal("idx2"),r.getLocal("idx2")),r.call(e,E,r.getLocal("pSConst"),r.getLocal("idx1")),r.call(e,r.getLocal("idx2"),z,r.getLocal("idx2")),r.call(o+"_mul",z,r.getLocal("inc"),z),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function A(){let C=t.addFunction(n+"_fftMix");C.addParam("pBuff","i32"),C.addParam("n","i32"),C.addParam("exp","i32"),C.addLocal("nGroups","i32"),C.addLocal("nPerGroup","i32"),C.addLocal("nPerGroupDiv2","i32"),C.addLocal("pairOffset","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("j","i32"),C.addLocal("pwm","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(d)),E=r.i32_const(t.alloc(l)),g=r.i32_const(t.alloc(l));C.addCode(r.setLocal("nPerGroup",r.i32_shl(r.i32_const(1),r.getLocal("exp"))),r.setLocal("nPerGroupDiv2",r.i32_shr_u(r.getLocal("nPerGroup"),r.i32_const(1))),r.setLocal("nGroups",r.i32_shr_u(r.getLocal("n"),r.getLocal("exp"))),r.setLocal("pairOffset",r.i32_mul(r.getLocal("nPerGroupDiv2"),r.i32_const(l))),r.setLocal("pwm",r.i32_add(r.i32_const(w),r.i32_mul(r.getLocal("exp"),r.i32_const(d)))),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("i"),r.getLocal("nGroups"))),r.call(o+"_one",z),r.setLocal("j",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_eq(r.getLocal("j"),r.getLocal("nPerGroupDiv2"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff"),r.i32_mul(r.i32_add(r.i32_mul(r.getLocal("i"),r.getLocal("nPerGroup")),r.getLocal("j")),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("idx1"),r.getLocal("pairOffset"))),r.call(e,r.getLocal("idx2"),z,E),r.call(a+"_copy",r.getLocal("idx1"),g),r.call(a+"_add",g,E,r.getLocal("idx1")),r.call(a+"_sub",g,E,r.getLocal("idx2")),r.call(o+"_mul",z,r.getLocal("pwm"),z),r.setLocal("j",r.i32_add(r.getLocal("j"),r.i32_const(1))),r.br(0))),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}function i(){let C=t.addFunction(n+"_fftFinal");C.addParam("pBuff","i32"),C.addParam("n","i32"),C.addParam("factor","i32"),C.addLocal("idx1","i32"),C.addLocal("idx2","i32"),C.addLocal("i","i32"),C.addLocal("ndiv2","i32");let r=C.getCodeBuilder(),z=r.i32_const(t.alloc(l));C.addCode(r.setLocal("ndiv2",r.i32_shr_u(r.getLocal("n"),r.i32_const(1))),r.if(r.i32_and(r.getLocal("n"),r.i32_const(1)),r.call(e,r.i32_add(r.getLocal("pBuff"),r.i32_mul(r.getLocal("ndiv2"),r.i32_const(l))),r.getLocal("factor"),r.i32_add(r.getLocal("pBuff"),r.i32_mul(r.getLocal("ndiv2"),r.i32_const(l))))),r.setLocal("i",r.i32_const(0)),r.block(r.loop(r.br_if(1,r.i32_ge_u(r.getLocal("i"),r.getLocal("ndiv2"))),r.setLocal("idx1",r.i32_add(r.getLocal("pBuff"),r.i32_mul(r.getLocal("i"),r.i32_const(l)))),r.setLocal("idx2",r.i32_add(r.getLocal("pBuff"),r.i32_mul(r.i32_sub(r.i32_sub(r.getLocal("n"),r.i32_const(1)),r.getLocal("i")),r.i32_const(l)))),r.call(e,r.getLocal("idx2"),r.getLocal("factor"),z),r.call(e,r.getLocal("idx1"),r.getLocal("factor"),r.getLocal("idx2")),r.call(a+"_copy",z,r.getLocal("idx1")),r.setLocal("i",r.i32_add(r.getLocal("i"),r.i32_const(1))),r.br(0))))}V(),ot(),j(),J(),I(),N(),nt(),at(),Lt(),rt(),A(),i(),ht(),t.exportFunction(n+"_fft"),t.exportFunction(n+"_ifft"),t.exportFunction(n+"_rawfft"),t.exportFunction(n+"_fftJoin"),t.exportFunction(n+"_fftJoinExt"),t.exportFunction(n+"_fftJoinExtInv"),t.exportFunction(n+"_fftMix"),t.exportFunction(n+"_fftFinal"),t.exportFunction(n+"_prepareLagrangeEvaluation")},nf=function(t,n,a){let e=t.modules[a].n64*8;function h(){let b=t.addFunction(n+"_zero");b.addParam("px","i32"),b.addParam("n","i32"),b.addLocal("lastp","i32"),b.addLocal("p","i32");let l=b.getCodeBuilder();b.addCode(l.setLocal("p",l.getLocal("px")),l.setLocal("lastp",l.i32_add(l.getLocal("px"),l.i32_mul(l.getLocal("n"),l.i32_const(e)))),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("p"),l.getLocal("lastp"))),l.call(a+"_zero",l.getLocal("p")),l.setLocal("p",l.i32_add(l.getLocal("p"),l.i32_const(e))),l.br(0))))}function d(){let b=t.addFunction(n+"_constructLC");b.addParam("ppolynomials","i32"),b.addParam("psignals","i32"),b.addParam("nSignals","i32"),b.addParam("pres","i32"),b.addLocal("i","i32"),b.addLocal("j","i32"),b.addLocal("pp","i32"),b.addLocal("ps","i32"),b.addLocal("pd","i32"),b.addLocal("ncoefs","i32");let l=b.getCodeBuilder(),s=l.i32_const(t.alloc(e));b.addCode(l.setLocal("i",l.i32_const(0)),l.setLocal("pp",l.getLocal("ppolynomials")),l.setLocal("ps",l.getLocal("psignals")),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("i"),l.getLocal("nSignals"))),l.setLocal("ncoefs",l.i32_load(l.getLocal("pp"))),l.setLocal("pp",l.i32_add(l.getLocal("pp"),l.i32_const(4))),l.setLocal("j",l.i32_const(0)),l.block(l.loop(l.br_if(1,l.i32_eq(l.getLocal("j"),l.getLocal("ncoefs"))),l.setLocal("pd",l.i32_add(l.getLocal("pres"),l.i32_mul(l.i32_load(l.getLocal("pp")),l.i32_const(e)))),l.setLocal("pp",l.i32_add(l.getLocal("pp"),l.i32_const(4))),l.call(a+"_mul",l.getLocal("ps"),l.getLocal("pp"),s),l.call(a+"_add",s,l.getLocal("pd"),l.getLocal("pd")),l.setLocal("pp",l.i32_add(l.getLocal("pp"),l.i32_const(e))),l.setLocal("j",l.i32_add(l.getLocal("j"),l.i32_const(1))),l.br(0))),l.setLocal("ps",l.i32_add(l.getLocal("ps"),l.i32_const(e))),l.setLocal("i",l.i32_add(l.getLocal("i"),l.i32_const(1))),l.br(0))))}return h(),d(),t.exportFunction(n+"_zero"),t.exportFunction(n+"_constructLC"),n},af=function(t,n,a){let e=t.modules[a].n64*8;function h(){let l=t.addFunction(n+"_buildABC");l.addParam("pCoefs","i32"),l.addParam("nCoefs","i32"),l.addParam("pWitness","i32"),l.addParam("pA","i32"),l.addParam("pB","i32"),l.addParam("pC","i32"),l.addParam("offsetOut","i32"),l.addParam("nOut","i32"),l.addParam("offsetWitness","i32"),l.addParam("nWitness","i32"),l.addLocal("it","i32"),l.addLocal("ita","i32"),l.addLocal("itb","i32"),l.addLocal("last","i32"),l.addLocal("m","i32"),l.addLocal("c","i32"),l.addLocal("s","i32"),l.addLocal("pOut","i32");let s=l.getCodeBuilder(),m=s.i32_const(t.alloc(e));l.addCode(s.setLocal("ita",s.getLocal("pA")),s.setLocal("itb",s.getLocal("pB")),s.setLocal("last",s.i32_add(s.getLocal("pA"),s.i32_mul(s.getLocal("nOut"),s.i32_const(e)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(a+"_zero",s.getLocal("ita")),s.call(a+"_zero",s.getLocal("itb")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(e))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(e))),s.br(0))),s.setLocal("it",s.getLocal("pCoefs")),s.setLocal("last",s.i32_add(s.getLocal("pCoefs"),s.i32_mul(s.getLocal("nCoefs"),s.i32_const(e+12)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("it"),s.getLocal("last"))),s.setLocal("s",s.i32_load(s.getLocal("it"),8)),s.if(s.i32_or(s.i32_lt_u(s.getLocal("s"),s.getLocal("offsetWitness")),s.i32_ge_u(s.getLocal("s"),s.i32_add(s.getLocal("offsetWitness"),s.getLocal("nWitness")))),[...s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(e+12))),...s.br(1)]),s.setLocal("m",s.i32_load(s.getLocal("it"))),s.if(s.i32_eq(s.getLocal("m"),s.i32_const(0)),s.setLocal("pOut",s.getLocal("pA")),s.if(s.i32_eq(s.getLocal("m"),s.i32_const(1)),s.setLocal("pOut",s.getLocal("pB")),[...s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(e+12))),...s.br(1)])),s.setLocal("c",s.i32_load(s.getLocal("it"),4)),s.if(s.i32_or(s.i32_lt_u(s.getLocal("c"),s.getLocal("offsetOut")),s.i32_ge_u(s.getLocal("c"),s.i32_add(s.getLocal("offsetOut"),s.getLocal("nOut")))),[...s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(e+12))),...s.br(1)]),s.setLocal("pOut",s.i32_add(s.getLocal("pOut"),s.i32_mul(s.i32_sub(s.getLocal("c"),s.getLocal("offsetOut")),s.i32_const(e)))),s.call(a+"_mul",s.i32_add(s.getLocal("pWitness"),s.i32_mul(s.i32_sub(s.getLocal("s"),s.getLocal("offsetWitness")),s.i32_const(e))),s.i32_add(s.getLocal("it"),s.i32_const(12)),m),s.call(a+"_add",s.getLocal("pOut"),m,s.getLocal("pOut")),s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(e+12))),s.br(0))),s.setLocal("ita",s.getLocal("pA")),s.setLocal("itb",s.getLocal("pB")),s.setLocal("it",s.getLocal("pC")),s.setLocal("last",s.i32_add(s.getLocal("pA"),s.i32_mul(s.getLocal("nOut"),s.i32_const(e)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(a+"_mul",s.getLocal("ita"),s.getLocal("itb"),s.getLocal("it")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(e))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(e))),s.setLocal("it",s.i32_add(s.getLocal("it"),s.i32_const(e))),s.br(0))))}function d(){let l=t.addFunction(n+"_joinABC");l.addParam("pA","i32"),l.addParam("pB","i32"),l.addParam("pC","i32"),l.addParam("n","i32"),l.addParam("pP","i32"),l.addLocal("ita","i32"),l.addLocal("itb","i32"),l.addLocal("itc","i32"),l.addLocal("itp","i32"),l.addLocal("last","i32");let s=l.getCodeBuilder(),m=s.i32_const(t.alloc(e));l.addCode(s.setLocal("ita",s.getLocal("pA")),s.setLocal("itb",s.getLocal("pB")),s.setLocal("itc",s.getLocal("pC")),s.setLocal("itp",s.getLocal("pP")),s.setLocal("last",s.i32_add(s.getLocal("pA"),s.i32_mul(s.getLocal("n"),s.i32_const(e)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(a+"_mul",s.getLocal("ita"),s.getLocal("itb"),m),s.call(a+"_sub",m,s.getLocal("itc"),s.getLocal("itp")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(e))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(e))),s.setLocal("itc",s.i32_add(s.getLocal("itc"),s.i32_const(e))),s.setLocal("itp",s.i32_add(s.getLocal("itp"),s.i32_const(e))),s.br(0))))}function b(){let l=t.addFunction(n+"_batchAdd");l.addParam("pa","i32"),l.addParam("pb","i32"),l.addParam("n","i32"),l.addParam("pr","i32"),l.addLocal("ita","i32"),l.addLocal("itb","i32"),l.addLocal("itr","i32"),l.addLocal("last","i32");let s=l.getCodeBuilder();l.addCode(s.setLocal("ita",s.getLocal("pa")),s.setLocal("itb",s.getLocal("pb")),s.setLocal("itr",s.getLocal("pr")),s.setLocal("last",s.i32_add(s.getLocal("pa"),s.i32_mul(s.getLocal("n"),s.i32_const(e)))),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("ita"),s.getLocal("last"))),s.call(a+"_add",s.getLocal("ita"),s.getLocal("itb"),s.getLocal("itr")),s.setLocal("ita",s.i32_add(s.getLocal("ita"),s.i32_const(e))),s.setLocal("itb",s.i32_add(s.getLocal("itb"),s.i32_const(e))),s.setLocal("itr",s.i32_add(s.getLocal("itr"),s.i32_const(e))),s.br(0))))}return h(),d(),b(),t.exportFunction(n+"_buildABC"),t.exportFunction(n+"_joinABC"),t.exportFunction(n+"_batchAdd"),n},of=function(t,n,a,o,e,h,d,b){let l=t.addFunction(n);l.addParam("pIn","i32"),l.addParam("n","i32"),l.addParam("pFirst","i32"),l.addParam("pInc","i32"),l.addParam("pOut","i32"),l.addLocal("pOldFree","i32"),l.addLocal("i","i32"),l.addLocal("pFrom","i32"),l.addLocal("pTo","i32");let s=l.getCodeBuilder(),m=s.i32_const(t.alloc(d));l.addCode(s.setLocal("pFrom",s.getLocal("pIn")),s.setLocal("pTo",s.getLocal("pOut"))),l.addCode(s.call(o+"_copy",s.getLocal("pFirst"),m)),l.addCode(s.setLocal("i",s.i32_const(0)),s.block(s.loop(s.br_if(1,s.i32_eq(s.getLocal("i"),s.getLocal("n"))),s.call(b,s.getLocal("pFrom"),m,s.getLocal("pTo")),s.setLocal("pFrom",s.i32_add(s.getLocal("pFrom"),s.i32_const(e))),s.setLocal("pTo",s.i32_add(s.getLocal("pTo"),s.i32_const(h))),s.call(o+"_mul",m,s.getLocal("pInc"),m),s.setLocal("i",s.i32_add(s.getLocal("i"),s.i32_const(1))),s.br(0)))),t.exportFunction(n)},on=Ja,q4=Ed,I4=Dh,wh=Kh,O4=Jh,Fh=Yh,Dr=tf,P4=nf,M4=af,Hi=of,{bitLength:R4,modInv:z4,isOdd:Ch,isNegative:T4}=Hn,G4=function(t,n){let a=n||"bn128";if(t.modules[a])return a;let o=21888242871839275222246405745257275088696311157297823662689037894645226208583n,e=21888242871839275222246405745257275088548364400416034343698204186575808495617n,h=Math.floor((R4(o-1n)-1)/64)+1,d=h*8,b=d,l=d,s=l*2,m=l*12,B=t.alloc(on.bigInt2BytesLE(e,b)),p=q4(t,o,"f1m");I4(t,e,"fr","frm");let v=t.alloc(on.bigInt2BytesLE(O(3n),l)),M=Fh(t,"g1m","f1m",v);Dr(t,"frm","frm","frm","frm_mul"),P4(t,"pol","frm"),M4(t,"qap","frm");let x=wh(t,"f1m_neg","f2m","f1m"),S=t.alloc([...on.bigInt2BytesLE(O(19485874751759354771024239261021720505790618469301721065564631296452457478373n),l),...on.bigInt2BytesLE(O(266929791119991161246907387137283842545076965332900288569378510910307636690n),l)]),w=Fh(t,"g2m","f2m",S);function k(X,_){let f=t.addFunction(X);f.addParam("pG","i32"),f.addParam("pFr","i32"),f.addParam("pr","i32");let R=f.getCodeBuilder(),G=R.i32_const(t.alloc(d));f.addCode(R.call("frm_fromMontgomery",R.getLocal("pFr"),G),R.call(_,R.getLocal("pG"),G,R.i32_const(d),R.getLocal("pr"))),t.exportFunction(X)}k("g1m_timesFr","g1m_timesScalar"),Dr(t,"g1m","g1m","frm","g1m_timesFr"),k("g2m_timesFr","g2m_timesScalar"),Dr(t,"g2m","g2m","frm","g2m_timesFr"),k("g1m_timesFrAffine","g1m_timesScalarAffine"),k("g2m_timesFrAffine","g2m_timesScalarAffine"),Hi(t,"frm_batchApplyKey","fmr","frm",d,d,d,"frm_mul"),Hi(t,"g1m_batchApplyKey","g1m","frm",d*3,d*3,d,"g1m_timesFr"),Hi(t,"g1m_batchApplyKeyMixed","g1m","frm",d*2,d*3,d,"g1m_timesFrAffine"),Hi(t,"g2m_batchApplyKey","g2m","frm",d*2*3,d*3*2,d,"g2m_timesFr"),Hi(t,"g2m_batchApplyKeyMixed","g2m","frm",d*2*2,d*3*2,d,"g2m_timesFrAffine");function O(X){return BigInt(X)*(1n<<BigInt(l*8))%o}let W=[1n,2n,1n],F=t.alloc([...on.bigInt2BytesLE(O(W[0]),l),...on.bigInt2BytesLE(O(W[1]),l),...on.bigInt2BytesLE(O(W[2]),l)]),u=[0n,1n,0n],L=t.alloc([...on.bigInt2BytesLE(O(u[0]),l),...on.bigInt2BytesLE(O(u[1]),l),...on.bigInt2BytesLE(O(u[2]),l)]),$=[[10857046999023057135944570762232829481370756359578518086990519993285655852781n,11559732032986387107991004021392285783925812861821192530917403151452391805634n],[8495653923123431417604973247489272438418190587263600148770280649306958101930n,4082367875863433681332203403145435568316851327593401208105741076214120093531n],[1n,0n]],Q=t.alloc([...on.bigInt2BytesLE(O($[0][0]),l),...on.bigInt2BytesLE(O($[0][1]),l),...on.bigInt2BytesLE(O($[1][0]),l),...on.bigInt2BytesLE(O($[1][1]),l),...on.bigInt2BytesLE(O($[2][0]),l),...on.bigInt2BytesLE(O($[2][1]),l)]),H=[[0n,0n],[1n,0n],[0n,0n]],q=t.alloc([...on.bigInt2BytesLE(O(H[0][0]),l),...on.bigInt2BytesLE(O(H[0][1]),l),...on.bigInt2BytesLE(O(H[1][0]),l),...on.bigInt2BytesLE(O(H[1][1]),l),...on.bigInt2BytesLE(O(H[2][0]),l),...on.bigInt2BytesLE(O(H[2][1]),l)]),y=t.alloc([...on.bigInt2BytesLE(O(1),l),...on.bigInt2BytesLE(O(0),l),...on.bigInt2BytesLE(O(0),l),...on.bigInt2BytesLE(O(0),l),...on.bigInt2BytesLE(O(0),l),...on.bigInt2BytesLE(O(0),l),...on.bigInt2BytesLE(O(0),l),...on.bigInt2BytesLE(O(0),l),...on.bigInt2BytesLE(O(0),l),...on.bigInt2BytesLE(O(0),l),...on.bigInt2BytesLE(O(0),l),...on.bigInt2BytesLE(O(0),l)]),I=t.alloc([...on.bigInt2BytesLE(O(9),l),...on.bigInt2BytesLE(O(1),l)]),N=t.alloc([...on.bigInt2BytesLE(O(z4(2n,o)),l),...on.bigInt2BytesLE(0n,l)]),nt=I,J=t.alloc([...on.bigInt2BytesLE(O(19485874751759354771024239261021720505790618469301721065564631296452457478373n),l),...on.bigInt2BytesLE(O(266929791119991161246907387137283842545076965332900288569378510910307636690n),l)]);function j(){let X=t.addFunction(a+"_mulNR6");X.addParam("x","i32"),X.addParam("pr","i32");let _=X.getCodeBuilder();X.addCode(_.call(x+"_mul",_.i32_const(I),_.getLocal("x"),_.getLocal("pr")))}j();let ot=O4(t,a+"_mulNR6","f6m","f2m");function V(){let X=t.addFunction(a+"_mulNR12");X.addParam("x","i32"),X.addParam("pr","i32");let _=X.getCodeBuilder();X.addCode(_.call(x+"_mul",_.i32_const(I),_.i32_add(_.getLocal("x"),_.i32_const(d*4)),_.getLocal("pr")),_.call(x+"_copy",_.getLocal("x"),_.i32_add(_.getLocal("pr"),_.i32_const(d*2))),_.call(x+"_copy",_.i32_add(_.getLocal("x"),_.i32_const(d*2)),_.i32_add(_.getLocal("pr"),_.i32_const(d*4))))}V();let at=wh(t,a+"_mulNR12","ftm",ot),rt=st(29793968203157093288n),ht=t.alloc(rt),A=3*s,i=rt.length-1,r=rt.reduce((X,_)=>X+(_!=0?1:0),0)+i+1,z=6*d,E=3*d*2+r*A;t.modules[a]={n64:h,pG1gen:F,pG1zero:L,pG1b:v,pG2gen:Q,pG2zero:q,pG2b:S,pq:t.modules.f1m.pq,pr:B,pOneT:y,prePSize:z,preQSize:E,r:e.toString(),q:o.toString()};let g=4965661367192848881n;function U(X){let _=X,f=[];for(;_>0n;){if(Ch(_)){let R=2-Number(_%4n);f.push(R),_=_-BigInt(R)}else f.push(0);_=_>>1n}return f}function st(X){let _=X,f=[];for(;_>0n;)Ch(_)?f.push(1):f.push(0),_=_>>1n;return f}function et(){let X=t.addFunction(a+"_prepareG1");X.addParam("pP","i32"),X.addParam("ppreP","i32");let _=X.getCodeBuilder();X.addCode(_.call(M+"_normalize",_.getLocal("pP"),_.getLocal("ppreP")))}function ct(){let X=t.addFunction(a+"_prepAddStep");X.addParam("pQ","i32"),X.addParam("pR","i32"),X.addParam("pCoef","i32");let _=X.getCodeBuilder(),f=_.getLocal("pQ"),R=_.i32_add(_.getLocal("pQ"),_.i32_const(s)),G=_.getLocal("pR"),P=_.i32_add(_.getLocal("pR"),_.i32_const(s)),Z=_.i32_add(_.getLocal("pR"),_.i32_const(2*s)),T=_.getLocal("pCoef"),D=_.i32_add(_.getLocal("pCoef"),_.i32_const(s)),Y=_.i32_add(_.getLocal("pCoef"),_.i32_const(2*s)),tt=D,K=_.i32_const(t.alloc(s)),it=_.i32_const(t.alloc(s)),mt=_.i32_const(t.alloc(s)),pt=_.i32_const(t.alloc(s)),dt=_.i32_const(t.alloc(s)),Ct=_.i32_const(t.alloc(s)),xt=_.i32_const(t.alloc(s));X.addCode(_.call(x+"_mul",f,Z,tt),_.call(x+"_sub",G,tt,tt),_.call(x+"_mul",R,Z,K),_.call(x+"_sub",P,K,K),_.call(x+"_square",tt,it),_.call(x+"_square",K,mt),_.call(x+"_mul",tt,it,pt),_.call(x+"_mul",G,it,dt),_.call(x+"_add",dt,dt,xt),_.call(x+"_mul",Z,mt,Ct),_.call(x+"_add",pt,Ct,Ct),_.call(x+"_sub",Ct,xt,Ct),_.call(x+"_mul",tt,Ct,G),_.call(x+"_mul",pt,P,P),_.call(x+"_sub",dt,Ct,xt),_.call(x+"_mul",K,xt,xt),_.call(x+"_sub",xt,P,P),_.call(x+"_mul",Z,pt,Z),_.call(x+"_mul",tt,R,xt),_.call(x+"_mul",K,f,T),_.call(x+"_sub",T,xt,T),_.call(x+"_mul",T,_.i32_const(nt),T),_.call(x+"_neg",K,Y))}function ft(){let X=t.addFunction(a+"_prepDblStep");X.addParam("pR","i32"),X.addParam("pCoef","i32");let _=X.getCodeBuilder(),f=_.getLocal("pR"),R=_.i32_add(_.getLocal("pR"),_.i32_const(s)),G=_.i32_add(_.getLocal("pR"),_.i32_const(2*s)),P=_.getLocal("pCoef"),Z=_.i32_add(_.getLocal("pCoef"),_.i32_const(s)),T=_.i32_add(_.getLocal("pCoef"),_.i32_const(2*s)),D=_.i32_const(t.alloc(s)),Y=_.i32_const(t.alloc(s)),tt=_.i32_const(t.alloc(s)),K=_.i32_const(t.alloc(s)),it=_.i32_const(t.alloc(s)),mt=_.i32_const(t.alloc(s)),pt=_.i32_const(t.alloc(s)),dt=_.i32_const(t.alloc(s)),Ct=_.i32_const(t.alloc(s)),xt=_.i32_const(t.alloc(s)),St=_.i32_const(t.alloc(s)),Bt=_.i32_const(t.alloc(s));X.addCode(_.call(x+"_mul",R,_.i32_const(N),D),_.call(x+"_mul",f,D,D),_.call(x+"_square",R,Y),_.call(x+"_square",G,tt),_.call(x+"_add",tt,tt,K),_.call(x+"_add",K,tt,K),_.call(x+"_mul",_.i32_const(J),K,it),_.call(x+"_add",it,it,mt),_.call(x+"_add",it,mt,mt),_.call(x+"_add",Y,mt,pt),_.call(x+"_mul",pt,_.i32_const(N),pt),_.call(x+"_add",Y,tt,Bt),_.call(x+"_add",R,G,dt),_.call(x+"_square",dt,dt),_.call(x+"_sub",dt,Bt,dt),_.call(x+"_sub",it,Y,Ct),_.call(x+"_square",f,xt),_.call(x+"_square",it,St),_.call(x+"_sub",Y,mt,Bt),_.call(x+"_mul",D,Bt,f),_.call(x+"_add",St,St,Bt),_.call(x+"_add",St,Bt,Bt),_.call(x+"_square",pt,R),_.call(x+"_sub",R,Bt,R),_.call(x+"_mul",Y,dt,G),_.call(x+"_mul",_.i32_const(nt),Ct,P),_.call(x+"_neg",dt,Z),_.call(x+"_add",xt,xt,T),_.call(x+"_add",xt,T,T))}function _t(){let X=t.addFunction(a+"_mulByQ");X.addParam("p1","i32"),X.addParam("pr","i32");let _=X.getCodeBuilder(),f=_.getLocal("p1"),R=_.i32_add(_.getLocal("p1"),_.i32_const(s)),G=_.i32_add(_.getLocal("p1"),_.i32_const(s*2)),P=_.getLocal("pr"),Z=_.i32_add(_.getLocal("pr"),_.i32_const(s)),T=_.i32_add(_.getLocal("pr"),_.i32_const(s*2)),D=_.i32_const(t.alloc([...on.bigInt2BytesLE(O("21575463638280843010398324269430826099269044274347216827212613867836435027261"),l),...on.bigInt2BytesLE(O("10307601595873709700152284273816112264069230130616436755625194854815875713954"),l)])),Y=_.i32_const(t.alloc([...on.bigInt2BytesLE(O("2821565182194536844548159561693502659359617185244120367078079554186484126554"),l),...on.bigInt2BytesLE(O("3505843767911556378687030309984248845540243509899259641013678093033130930403"),l)]));X.addCode(_.call(x+"_conjugate",f,P),_.call(x+"_mul",D,P,P),_.call(x+"_conjugate",R,Z),_.call(x+"_mul",Y,Z,Z),_.call(x+"_conjugate",G,T))}function gt(){_t();let X=t.addFunction(a+"_prepareG2");X.addParam("pQ","i32"),X.addParam("ppreQ","i32"),X.addLocal("pCoef","i32"),X.addLocal("i","i32");let _=X.getCodeBuilder(),f=_.getLocal("pQ"),R=t.alloc(s*3),G=_.i32_const(R),P=_.i32_const(R),Z=_.i32_const(R+s),T=_.i32_const(R+2*s),D=_.i32_add(_.getLocal("ppreQ"),_.i32_const(0)),Y=_.i32_add(_.getLocal("ppreQ"),_.i32_const(s)),tt=t.alloc(s*3),K=_.i32_const(tt),it=t.alloc(s*3),mt=_.i32_const(it),pt=_.i32_const(it+s);X.addCode(_.call(w+"_normalize",f,D),_.call(x+"_copy",D,P),_.call(x+"_copy",Y,Z),_.call(x+"_one",T)),X.addCode(_.setLocal("pCoef",_.i32_add(_.getLocal("ppreQ"),_.i32_const(s*3))),_.setLocal("i",_.i32_const(rt.length-2)),_.block(_.loop(_.call(a+"_prepDblStep",G,_.getLocal("pCoef")),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))),_.if(_.i32_load8_s(_.getLocal("i"),ht),[..._.call(a+"_prepAddStep",D,G,_.getLocal("pCoef")),..._.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A)))]),_.br_if(1,_.i32_eqz(_.getLocal("i"))),_.setLocal("i",_.i32_sub(_.getLocal("i"),_.i32_const(1))),_.br(0)))),X.addCode(_.call(a+"_mulByQ",D,K),_.call(a+"_mulByQ",K,mt)),X.addCode(_.call(x+"_neg",pt,pt),_.call(a+"_prepAddStep",K,G,_.getLocal("pCoef")),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))),_.call(a+"_prepAddStep",mt,G,_.getLocal("pCoef")),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))))}function yt(){let X=t.addFunction(a+"__mulBy024Old");X.addParam("pEll0","i32"),X.addParam("pEllVW","i32"),X.addParam("pEllVV","i32"),X.addParam("pR","i32");let _=X.getCodeBuilder(),f=_.getLocal("pEll0"),R=_.getLocal("pEllVV"),G=_.getLocal("pEllVW"),P=_.getLocal("pR"),Z=t.alloc(m),T=_.i32_const(Z),D=_.i32_const(Z),Y=_.i32_const(Z+s),tt=_.i32_const(Z+s*2),K=_.i32_const(Z+s*3),it=_.i32_const(Z+s*4),mt=_.i32_const(Z+s*5);X.addCode(_.call(x+"_copy",f,D),_.call(x+"_zero",Y),_.call(x+"_copy",R,tt),_.call(x+"_zero",K),_.call(x+"_copy",G,it),_.call(x+"_zero",mt),_.call(at+"_mul",T,P,P))}function ut(){let X=t.addFunction(a+"__mulBy024");X.addParam("pEll0","i32"),X.addParam("pEllVW","i32"),X.addParam("pEllVV","i32"),X.addParam("pR","i32");let _=X.getCodeBuilder(),f=_.getLocal("pEll0"),R=_.getLocal("pEllVV"),G=_.getLocal("pEllVW"),P=_.getLocal("pR"),Z=_.i32_add(_.getLocal("pR"),_.i32_const(2*d)),T=_.i32_add(_.getLocal("pR"),_.i32_const(4*d)),D=_.i32_add(_.getLocal("pR"),_.i32_const(6*d)),Y=_.i32_add(_.getLocal("pR"),_.i32_const(8*d)),tt=_.i32_add(_.getLocal("pR"),_.i32_const(10*d)),K=_.i32_const(t.alloc(s)),it=_.i32_const(t.alloc(s)),mt=_.i32_const(t.alloc(s)),pt=_.i32_const(t.alloc(s)),dt=_.i32_const(t.alloc(s)),Ct=_.i32_const(t.alloc(s)),xt=_.i32_const(t.alloc(s)),St=_.i32_const(t.alloc(s)),Bt=_.i32_const(t.alloc(s)),At=_.i32_const(t.alloc(s)),wt=_.i32_const(t.alloc(s));X.addCode(_.call(x+"_mul",P,f,xt),_.call(x+"_mul",T,R,St),_.call(x+"_mul",Y,G,Bt),_.call(x+"_add",P,Y,mt),_.call(x+"_add",P,T,it),_.call(x+"_add",Z,D,pt),_.call(x+"_add",pt,tt,pt),_.call(x+"_mul",Z,R,At),_.call(x+"_add",At,Bt,dt),_.call(x+"_mul",_.i32_const(I),dt,Ct),_.call(x+"_add",Ct,xt,P),_.call(x+"_mul",tt,G,dt),_.call(x+"_add",At,dt,At),_.call(x+"_add",dt,St,dt),_.call(x+"_mul",_.i32_const(I),dt,Ct),_.call(x+"_mul",Z,f,dt),_.call(x+"_add",At,dt,At),_.call(x+"_add",Ct,dt,Z),_.call(x+"_add",f,R,K),_.call(x+"_mul",it,K,dt),_.call(x+"_add",xt,St,wt),_.call(x+"_sub",dt,wt,dt),_.call(x+"_mul",D,G,Ct),_.call(x+"_add",At,Ct,At),_.call(x+"_add",T,Y,K),_.call(x+"_add",dt,Ct,T),_.call(x+"_add",R,G,it),_.call(x+"_mul",it,K,dt),_.call(x+"_add",St,Bt,wt),_.call(x+"_sub",dt,wt,dt),_.call(x+"_mul",_.i32_const(I),dt,Ct),_.call(x+"_mul",D,f,dt),_.call(x+"_add",At,dt,At),_.call(x+"_add",Ct,dt,D),_.call(x+"_mul",tt,R,dt),_.call(x+"_add",At,dt,At),_.call(x+"_mul",_.i32_const(I),dt,Ct),_.call(x+"_add",f,G,K),_.call(x+"_mul",mt,K,dt),_.call(x+"_add",xt,Bt,wt),_.call(x+"_sub",dt,wt,dt),_.call(x+"_add",Ct,dt,Y),_.call(x+"_add",f,R,K),_.call(x+"_add",K,G,K),_.call(x+"_mul",pt,K,dt),_.call(x+"_sub",dt,At,tt))}function lt(){let X=t.addFunction(a+"_millerLoop");X.addParam("ppreP","i32"),X.addParam("ppreQ","i32"),X.addParam("r","i32"),X.addLocal("pCoef","i32"),X.addLocal("i","i32");let _=X.getCodeBuilder(),f=_.getLocal("ppreP"),R=_.i32_add(_.getLocal("ppreP"),_.i32_const(l)),G=_.getLocal("pCoef"),P=_.i32_add(_.getLocal("pCoef"),_.i32_const(s)),Z=_.i32_add(_.getLocal("pCoef"),_.i32_const(2*s)),T=t.alloc(s),D=_.i32_const(T),Y=t.alloc(s),tt=_.i32_const(Y),K=_.getLocal("r");X.addCode(_.call(at+"_one",K),_.setLocal("pCoef",_.i32_add(_.getLocal("ppreQ"),_.i32_const(s*3))),_.setLocal("i",_.i32_const(rt.length-2)),_.block(_.loop(_.call(at+"_square",K,K),_.call(x+"_mul1",P,R,D),_.call(x+"_mul1",Z,f,tt),_.call(a+"__mulBy024",G,D,tt,K),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))),_.if(_.i32_load8_s(_.getLocal("i"),ht),[..._.call(x+"_mul1",P,R,D),..._.call(x+"_mul1",Z,f,tt),..._.call(a+"__mulBy024",G,D,tt,K),..._.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A)))]),_.br_if(1,_.i32_eqz(_.getLocal("i"))),_.setLocal("i",_.i32_sub(_.getLocal("i"),_.i32_const(1))),_.br(0)))),X.addCode(_.call(x+"_mul1",P,R,D),_.call(x+"_mul1",Z,f,tt),_.call(a+"__mulBy024",G,D,tt,K),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))),_.call(x+"_mul1",P,R,D),_.call(x+"_mul1",Z,f,tt),_.call(a+"__mulBy024",G,D,tt,K),_.setLocal("pCoef",_.i32_add(_.getLocal("pCoef"),_.i32_const(A))))}function bt(X){let _=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[8376118865763821496583973867626364092589906065868298776909617916018768340080n,16469823323077808223889137241176536799009286646108169935659301613961712198316n],[21888242871839275220042445260109153167277707414472061641714758635765020556617n,0n],[11697423496358154304825782922584725312912383441159505038794027105778954184319n,303847389135065887422783454877609941456349188919719272345083954437860409601n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3321304630594332808241809054958361220322477375291206261884409189760185844239n,5722266937896532885780051958958348231143373700109372999374820235121374419868n],[21888242871839275222246405745257275088696311157297823662689037894645226208582n,0n],[13512124006075453725662431877630910996106405091429524885779419978626457868503n,5418419548761466998357268504080738289687024511189653727029736280683514010267n],[2203960485148121921418603742825762020974279258880205651966n,0n],[10190819375481120917420622822672549775783927716138318623895010788866272024264n,21584395482704209334823622290379665147239961968378104390343953940207365798982n],[2203960485148121921418603742825762020974279258880205651967n,0n],[18566938241244942414004596690298913868373833782006617400804628704885040364344n,16165975933942742336466353786298926857552937457188450663314217659523851788715n]]],f=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[21575463638280843010398324269430826099269044274347216827212613867836435027261n,10307601595873709700152284273816112264069230130616436755625194854815875713954n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[3772000881919853776433695186713858239009073593817195771773381919316419345261n,2236595495967245188281701248203181795121068902605861227855261137820944008926n],[2203960485148121921418603742825762020974279258880205651966n,0n],[18429021223477853657660792034369865839114504446431234726392080002137598044644n,9344045779998320333812420223237981029506012124075525679208581902008406485703n]],[[1n,0n],[2581911344467009335267311115468803099551665605076196740867805258568234346338n,19937756971775647987995932169929341994314640652964949448313374472400716661030n],[2203960485148121921418603742825762020974279258880205651966n,0n],[5324479202449903542726783395506214481928257762400643279780343368557297135718n,16208900380737693084919495127334387981393726419856888799917914180988844123039n],[21888242871839275220042445260109153167277707414472061641714758635765020556616n,0n],[13981852324922362344252311234282257507216387789820983642040889267519694726527n,7629828391165209371577384193250820201684255241773809077146787135900891633097n]]],R=t.addFunction(a+"__frobeniusMap"+X);R.addParam("x","i32"),R.addParam("r","i32");let G=R.getCodeBuilder();for(let Z=0;Z<6;Z++){let T=Z==0?G.getLocal("x"):G.i32_add(G.getLocal("x"),G.i32_const(Z*s)),D=T,Y=G.i32_add(G.getLocal("x"),G.i32_const(Z*s+l)),tt=Z==0?G.getLocal("r"):G.i32_add(G.getLocal("r"),G.i32_const(Z*s)),K=tt,it=G.i32_add(G.getLocal("r"),G.i32_const(Z*s+l)),mt=P(_[Math.floor(Z/3)][X%12],f[Z%3][X%6]),pt=t.alloc([...on.bigInt2BytesLE(O(mt[0]),32),...on.bigInt2BytesLE(O(mt[1]),32)]);X%2==1?R.addCode(G.call(p+"_copy",D,K),G.call(p+"_neg",Y,it),G.call(x+"_mul",tt,G.i32_const(pt),tt)):R.addCode(G.call(x+"_mul",T,G.i32_const(pt),tt))}function P(Z,T){let D=BigInt(Z[0]),Y=BigInt(Z[1]),tt=BigInt(T[0]),K=BigInt(T[1]),it=[(D*tt-Y*K)%o,(D*K+Y*tt)%o];return T4(it[0])&&(it[0]=it[0]+o),it}}function Et(){let X=t.addFunction(a+"__finalExponentiationFirstChunk");X.addParam("x","i32"),X.addParam("r","i32");let _=X.getCodeBuilder(),f=_.getLocal("x"),R=f,G=_.i32_add(f,_.i32_const(d*6)),P=_.getLocal("r"),Z=t.alloc(m),T=_.i32_const(Z),D=T,Y=_.i32_const(Z+d*6),tt=_.i32_const(t.alloc(m)),K=_.i32_const(t.alloc(m)),it=_.i32_const(t.alloc(m));X.addCode(_.call(ot+"_copy",R,D),_.call(ot+"_neg",G,Y),_.call(at+"_inverse",f,tt),_.call(at+"_mul",T,tt,K),_.call(a+"__frobeniusMap2",K,it),_.call(at+"_mul",K,it,P))}function It(){let X=t.addFunction(a+"__cyclotomicSquare");X.addParam("x","i32"),X.addParam("r","i32");let _=X.getCodeBuilder(),f=_.getLocal("x"),R=_.i32_add(_.getLocal("x"),_.i32_const(s)),G=_.i32_add(_.getLocal("x"),_.i32_const(2*s)),P=_.i32_add(_.getLocal("x"),_.i32_const(3*s)),Z=_.i32_add(_.getLocal("x"),_.i32_const(4*s)),T=_.i32_add(_.getLocal("x"),_.i32_const(5*s)),D=_.getLocal("r"),Y=_.i32_add(_.getLocal("r"),_.i32_const(s)),tt=_.i32_add(_.getLocal("r"),_.i32_const(2*s)),K=_.i32_add(_.getLocal("r"),_.i32_const(3*s)),it=_.i32_add(_.getLocal("r"),_.i32_const(4*s)),mt=_.i32_add(_.getLocal("r"),_.i32_const(5*s)),pt=_.i32_const(t.alloc(s)),dt=_.i32_const(t.alloc(s)),Ct=_.i32_const(t.alloc(s)),xt=_.i32_const(t.alloc(s)),St=_.i32_const(t.alloc(s)),Bt=_.i32_const(t.alloc(s)),At=_.i32_const(t.alloc(s)),wt=_.i32_const(t.alloc(s));X.addCode(_.call(x+"_mul",f,Z,At),_.call(x+"_mul",Z,_.i32_const(I),pt),_.call(x+"_add",f,pt,pt),_.call(x+"_add",f,Z,wt),_.call(x+"_mul",wt,pt,pt),_.call(x+"_mul",_.i32_const(I),At,wt),_.call(x+"_add",At,wt,wt),_.call(x+"_sub",pt,wt,pt),_.call(x+"_add",At,At,dt),_.call(x+"_mul",P,G,At),_.call(x+"_mul",G,_.i32_const(I),Ct),_.call(x+"_add",P,Ct,Ct),_.call(x+"_add",P,G,wt),_.call(x+"_mul",wt,Ct,Ct),_.call(x+"_mul",_.i32_const(I),At,wt),_.call(x+"_add",At,wt,wt),_.call(x+"_sub",Ct,wt,Ct),_.call(x+"_add",At,At,xt),_.call(x+"_mul",R,T,At),_.call(x+"_mul",T,_.i32_const(I),St),_.call(x+"_add",R,St,St),_.call(x+"_add",R,T,wt),_.call(x+"_mul",wt,St,St),_.call(x+"_mul",_.i32_const(I),At,wt),_.call(x+"_add",At,wt,wt),_.call(x+"_sub",St,wt,St),_.call(x+"_add",At,At,Bt),_.call(x+"_sub",pt,f,D),_.call(x+"_add",D,D,D),_.call(x+"_add",pt,D,D),_.call(x+"_add",dt,Z,it),_.call(x+"_add",it,it,it),_.call(x+"_add",dt,it,it),_.call(x+"_mul",Bt,_.i32_const(nt),wt),_.call(x+"_add",wt,P,K),_.call(x+"_add",K,K,K),_.call(x+"_add",wt,K,K),_.call(x+"_sub",St,G,tt),_.call(x+"_add",tt,tt,tt),_.call(x+"_add",St,tt,tt),_.call(x+"_sub",Ct,R,Y),_.call(x+"_add",Y,Y,Y),_.call(x+"_add",Ct,Y,Y),_.call(x+"_add",xt,T,mt),_.call(x+"_add",mt,mt,mt),_.call(x+"_add",xt,mt,mt))}function zt(X,_){let f=U(X).map(Y=>Y==-1?255:Y),R=t.alloc(f),G=t.addFunction(a+"__cyclotomicExp_"+_);G.addParam("x","i32"),G.addParam("r","i32"),G.addLocal("bit","i32"),G.addLocal("i","i32");let P=G.getCodeBuilder(),Z=P.getLocal("x"),T=P.getLocal("r"),D=P.i32_const(t.alloc(m));G.addCode(P.call(at+"_conjugate",Z,D),P.call(at+"_one",T),P.if(P.teeLocal("bit",P.i32_load8_s(P.i32_const(f.length-1),R)),P.if(P.i32_eq(P.getLocal("bit"),P.i32_const(1)),P.call(at+"_mul",T,Z,T),P.call(at+"_mul",T,D,T))),P.setLocal("i",P.i32_const(f.length-2)),P.block(P.loop(P.call(a+"__cyclotomicSquare",T,T),P.if(P.teeLocal("bit",P.i32_load8_s(P.getLocal("i"),R)),P.if(P.i32_eq(P.getLocal("bit"),P.i32_const(1)),P.call(at+"_mul",T,Z,T),P.call(at+"_mul",T,D,T))),P.br_if(1,P.i32_eqz(P.getLocal("i"))),P.setLocal("i",P.i32_sub(P.getLocal("i"),P.i32_const(1))),P.br(0))))}function Mt(){It(),zt(g,"w0");let X=t.addFunction(a+"__finalExponentiationLastChunk");X.addParam("x","i32"),X.addParam("r","i32");let _=X.getCodeBuilder(),f=_.getLocal("x"),R=_.getLocal("r"),G=_.i32_const(t.alloc(m)),P=_.i32_const(t.alloc(m)),Z=_.i32_const(t.alloc(m)),T=_.i32_const(t.alloc(m)),D=_.i32_const(t.alloc(m)),Y=_.i32_const(t.alloc(m)),tt=_.i32_const(t.alloc(m)),K=_.i32_const(t.alloc(m)),it=_.i32_const(t.alloc(m)),mt=_.i32_const(t.alloc(m)),pt=_.i32_const(t.alloc(m)),dt=_.i32_const(t.alloc(m)),Ct=_.i32_const(t.alloc(m)),xt=_.i32_const(t.alloc(m)),St=_.i32_const(t.alloc(m)),Bt=_.i32_const(t.alloc(m)),At=_.i32_const(t.alloc(m)),wt=_.i32_const(t.alloc(m)),Ot=_.i32_const(t.alloc(m)),Jt=_.i32_const(t.alloc(m)),cn=_.i32_const(t.alloc(m));X.addCode(_.call(a+"__cyclotomicExp_w0",f,G),_.call(at+"_conjugate",G,G),_.call(a+"__cyclotomicSquare",G,P),_.call(a+"__cyclotomicSquare",P,Z),_.call(at+"_mul",Z,P,T),_.call(a+"__cyclotomicExp_w0",T,D),_.call(at+"_conjugate",D,D),_.call(a+"__cyclotomicSquare",D,Y),_.call(a+"__cyclotomicExp_w0",Y,tt),_.call(at+"_conjugate",tt,tt),_.call(at+"_conjugate",T,K),_.call(at+"_conjugate",tt,it),_.call(at+"_mul",it,D,mt),_.call(at+"_mul",mt,K,pt),_.call(at+"_mul",pt,P,dt),_.call(at+"_mul",pt,D,Ct),_.call(at+"_mul",Ct,f,xt),_.call(a+"__frobeniusMap1",dt,St),_.call(at+"_mul",St,xt,Bt),_.call(a+"__frobeniusMap2",pt,At),_.call(at+"_mul",At,Bt,wt),_.call(at+"_conjugate",f,Ot),_.call(at+"_mul",Ot,dt,Jt),_.call(a+"__frobeniusMap3",Jt,cn),_.call(at+"_mul",cn,wt,R))}function kt(){Et(),Mt();let X=t.addFunction(a+"_finalExponentiation");X.addParam("x","i32"),X.addParam("r","i32");let _=X.getCodeBuilder(),f=_.getLocal("x"),R=_.getLocal("r"),G=_.i32_const(t.alloc(m));X.addCode(_.call(a+"__finalExponentiationFirstChunk",f,G),_.call(a+"__finalExponentiationLastChunk",G,R))}function Pt(){let X=t.addFunction(a+"_finalExponentiationOld");X.addParam("x","i32"),X.addParam("r","i32");let f=t.alloc(on.bigInt2BytesLE(552484233613224096312617126783173147097382103762957654188882734314196910839907541213974502761540629817009608548654680343627701153829446747810907373256841551006201639677726139946029199968412598804882391702273019083653272047566316584365559776493027495458238373902875937659943504873220554161550525926302303331747463515644711876653177129578303191095900909191624817826566688241804408081892785725967931714097716709526092261278071952560171111444072049229123565057483750161460024353346284167282452756217662335528813519139808291170539072125381230815729071544861602750936964829313608137325426383735122175229541155376346436093930287402089517426973178917569713384748081827255472576937471496195752727188261435633271238710131736096299798168852925540549342330775279877006784354801422249722573783561685179618816480037695005515426162362431072245638324744480n,352)),R=X.getCodeBuilder();X.addCode(R.call(at+"_exp",R.getLocal("x"),R.i32_const(f),R.i32_const(352),R.getLocal("r")))}let qt=t.alloc(z),Rt=t.alloc(E);function Kt(X){let _=t.addFunction(a+"_pairingEq"+X);for(let P=0;P<X;P++)_.addParam("p_"+P,"i32"),_.addParam("q_"+P,"i32");_.addParam("c","i32"),_.setReturnType("i32");let f=_.getCodeBuilder(),R=f.i32_const(t.alloc(m)),G=f.i32_const(t.alloc(m));_.addCode(f.call(at+"_one",R));for(let P=0;P<X;P++)_.addCode(f.call(a+"_prepareG1",f.getLocal("p_"+P),f.i32_const(qt))),_.addCode(f.call(a+"_prepareG2",f.getLocal("q_"+P),f.i32_const(Rt))),_.addCode(f.call(a+"_millerLoop",f.i32_const(qt),f.i32_const(Rt),G)),_.addCode(f.call(at+"_mul",R,G,R));_.addCode(f.call(a+"_finalExponentiation",R,R)),_.addCode(f.call(at+"_eq",R,f.getLocal("c")))}function Ut(){let X=t.addFunction(a+"_pairing");X.addParam("p","i32"),X.addParam("q","i32"),X.addParam("r","i32");let _=X.getCodeBuilder(),f=_.i32_const(t.alloc(m));X.addCode(_.call(a+"_prepareG1",_.getLocal("p"),_.i32_const(qt))),X.addCode(_.call(a+"_prepareG2",_.getLocal("q"),_.i32_const(Rt))),X.addCode(_.call(a+"_millerLoop",_.i32_const(qt),_.i32_const(Rt),f)),X.addCode(_.call(a+"_finalExponentiation",f,_.getLocal("r")))}ct(),ft(),et(),gt(),ut(),yt(),lt();for(let X=0;X<10;X++)bt(X),t.exportFunction(a+"__frobeniusMap"+X);Pt(),kt();for(let X=1;X<=5;X++)Kt(X),t.exportFunction(a+"_pairingEq"+X);Ut(),t.exportFunction(a+"_pairing"),t.exportFunction(a+"_prepareG1"),t.exportFunction(a+"_prepareG2"),t.exportFunction(a+"_millerLoop"),t.exportFunction(a+"_finalExponentiation"),t.exportFunction(a+"_finalExponentiationOld"),t.exportFunction(a+"__mulBy024"),t.exportFunction(a+"__mulBy024Old"),t.exportFunction(a+"__cyclotomicSquare"),t.exportFunction(a+"__cyclotomicExp_w0")},Ht=Ja,k4=Ed,U4=Dh,Bh=Kh,N4=Jh,xh=Yh,Kr=tf,$4=nf,Z4=af,Di=of,{bitLength:Ah,isOdd:Eh,isNegative:j4}=Hn,V4=function(t,n){let a=n||"bls12381";if(t.modules[a])return a;let o=0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn,e=0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001n,h=Math.floor((Ah(o-1n)-1)/64)+1,d=h*8,b=d,l=b*2,s=b*12,m=Math.floor((Ah(e-1n)-1)/64)+1,B=m*8,p=B,v=t.alloc(Ht.bigInt2BytesLE(e,p)),M=k4(t,o,"f1m","intq");U4(t,e,"fr","frm","intr");let x=t.alloc(Ht.bigInt2BytesLE(F(4n),b)),S=xh(t,"g1m","f1m",x);Kr(t,"frm","frm","frm","frm_mul"),$4(t,"pol","frm"),Z4(t,"qap","frm");let w=Bh(t,"f1m_neg","f2m","f1m"),k=t.alloc([...Ht.bigInt2BytesLE(F(4n),b),...Ht.bigInt2BytesLE(F(4n),b)]),O=xh(t,"g2m","f2m",k);function W(_,f){let R=t.addFunction(_);R.addParam("pG","i32"),R.addParam("pFr","i32"),R.addParam("pr","i32");let G=R.getCodeBuilder(),P=G.i32_const(t.alloc(B));R.addCode(G.call("frm_fromMontgomery",G.getLocal("pFr"),P),G.call(f,G.getLocal("pG"),P,G.i32_const(B),G.getLocal("pr"))),t.exportFunction(_)}W("g1m_timesFr","g1m_timesScalar"),Kr(t,"g1m","g1m","frm","g1m_timesFr"),W("g2m_timesFr","g2m_timesScalar"),Kr(t,"g2m","g2m","frm","g2m_timesFr"),W("g1m_timesFrAffine","g1m_timesScalarAffine"),W("g2m_timesFrAffine","g2m_timesScalarAffine"),Di(t,"frm_batchApplyKey","fmr","frm",B,B,B,"frm_mul"),Di(t,"g1m_batchApplyKey","g1m","frm",d*3,d*3,B,"g1m_timesFr"),Di(t,"g1m_batchApplyKeyMixed","g1m","frm",d*2,d*3,B,"g1m_timesFrAffine"),Di(t,"g2m_batchApplyKey","g2m","frm",d*2*3,d*3*2,B,"g2m_timesFr"),Di(t,"g2m_batchApplyKeyMixed","g2m","frm",d*2*2,d*3*2,B,"g2m_timesFrAffine");function F(_){return BigInt(_)*(1n<<BigInt(b*8))%o}let u=[3685416753713387016781088315183077757961620795782546409894578378688607592378376318836054947676345821548104185464507n,1339506544944476473020471379941921221584933875938349620426543736416511423956333506472724655353366534992391756441569n,1n],L=t.alloc([...Ht.bigInt2BytesLE(F(u[0]),b),...Ht.bigInt2BytesLE(F(u[1]),b),...Ht.bigInt2BytesLE(F(u[2]),b)]),$=[0n,1n,0n],Q=t.alloc([...Ht.bigInt2BytesLE(F($[0]),b),...Ht.bigInt2BytesLE(F($[1]),b),...Ht.bigInt2BytesLE(F($[2]),b)]),H=[[352701069587466618187139116011060144890029952792775240219908644239793785735715026873347600343865175952761926303160n,3059144344244213709971259814753781636986470325476647558659373206291635324768958432433509563104347017837885763365758n],[1985150602287291935568054521177171638300868978215655730859378665066344726373823718423869104263333984641494340347905n,927553665492332455747201965776037880757740193453592970025027978793976877002675564980949289727957565575433344219582n],[1n,0n]],q=t.alloc([...Ht.bigInt2BytesLE(F(H[0][0]),b),...Ht.bigInt2BytesLE(F(H[0][1]),b),...Ht.bigInt2BytesLE(F(H[1][0]),b),...Ht.bigInt2BytesLE(F(H[1][1]),b),...Ht.bigInt2BytesLE(F(H[2][0]),b),...Ht.bigInt2BytesLE(F(H[2][1]),b)]),y=[[0n,0n],[1n,0n],[0n,0n]],I=t.alloc([...Ht.bigInt2BytesLE(F(y[0][0]),b),...Ht.bigInt2BytesLE(F(y[0][1]),b),...Ht.bigInt2BytesLE(F(y[1][0]),b),...Ht.bigInt2BytesLE(F(y[1][1]),b),...Ht.bigInt2BytesLE(F(y[2][0]),b),...Ht.bigInt2BytesLE(F(y[2][1]),b)]),N=t.alloc([...Ht.bigInt2BytesLE(F(1n),b),...Ht.bigInt2BytesLE(F(0n),b),...Ht.bigInt2BytesLE(F(0n),b),...Ht.bigInt2BytesLE(F(0n),b),...Ht.bigInt2BytesLE(F(0n),b),...Ht.bigInt2BytesLE(F(0n),b),...Ht.bigInt2BytesLE(F(0n),b),...Ht.bigInt2BytesLE(F(0n),b),...Ht.bigInt2BytesLE(F(0n),b),...Ht.bigInt2BytesLE(F(0n),b),...Ht.bigInt2BytesLE(F(0n),b),...Ht.bigInt2BytesLE(F(0n),b)]),nt=t.alloc([...Ht.bigInt2BytesLE(F(1n),b),...Ht.bigInt2BytesLE(F(1n),b)]);function J(){let _=t.addFunction(w+"_mulNR");_.addParam("x","i32"),_.addParam("pr","i32");let f=_.getCodeBuilder(),R=f.i32_const(t.alloc(b)),G=f.getLocal("x"),P=f.i32_add(f.getLocal("x"),f.i32_const(b)),Z=f.getLocal("pr"),T=f.i32_add(f.getLocal("pr"),f.i32_const(b));_.addCode(f.call(M+"_copy",G,R),f.call(M+"_sub",G,P,Z),f.call(M+"_add",R,P,T))}J();let j=N4(t,w+"_mulNR","f6m","f2m");function ot(){let _=t.addFunction(j+"_mulNR");_.addParam("x","i32"),_.addParam("pr","i32");let f=_.getCodeBuilder(),R=f.i32_const(t.alloc(b*2));_.addCode(f.call(w+"_copy",f.getLocal("x"),R),f.call(w+"_mulNR",f.i32_add(f.getLocal("x"),f.i32_const(d*4)),f.getLocal("pr")),f.call(w+"_copy",f.i32_add(f.getLocal("x"),f.i32_const(d*2)),f.i32_add(f.getLocal("pr"),f.i32_const(d*4))),f.call(w+"_copy",R,f.i32_add(f.getLocal("pr"),f.i32_const(d*2))))}ot();let V=Bh(t,j+"_mulNR","ftm",j),Lt=st(0xd201000000010000n),rt=t.alloc(Lt),ht=3*l,A=Lt.length-1,C=Lt.reduce((_,f)=>_+(f!=0?1:0),0)+A+1,r=6*d,z=3*d*2+C*ht,E=!0,g=15132376222941642752n;t.modules[a]={n64q:h,n64r:m,n8q:d,n8r:B,pG1gen:L,pG1zero:Q,pG1b:x,pG2gen:q,pG2zero:I,pG2b:k,pq:t.modules.f1m.pq,pr:v,pOneT:N,r:e,q:o,prePSize:r,preQSize:z};function U(_){let f=_,R=[];for(;f>0n;){if(Eh(f)){let G=2-Number(f%4n);R.push(G),f=f-BigInt(G)}else R.push(0);f=f>>1n}return R}function st(_){let f=_,R=[];for(;f>0n;)Eh(f)?R.push(1):R.push(0),f=f>>1n;return R}function et(){let _=t.addFunction(a+"_prepareG1");_.addParam("pP","i32"),_.addParam("ppreP","i32");let f=_.getCodeBuilder();_.addCode(f.call(S+"_normalize",f.getLocal("pP"),f.getLocal("ppreP")))}function ct(){let _=t.addFunction(a+"_prepDblStep");_.addParam("R","i32"),_.addParam("r","i32");let f=_.getCodeBuilder(),R=f.getLocal("R"),G=f.i32_add(f.getLocal("R"),f.i32_const(2*d)),P=f.i32_add(f.getLocal("R"),f.i32_const(4*d)),Z=f.getLocal("r"),T=f.i32_add(f.getLocal("r"),f.i32_const(2*d)),D=f.i32_add(f.getLocal("r"),f.i32_const(4*d)),Y=f.i32_const(t.alloc(l)),tt=f.i32_const(t.alloc(l)),K=f.i32_const(t.alloc(l)),it=f.i32_const(t.alloc(l)),mt=f.i32_const(t.alloc(l));_.addCode(f.call(w+"_square",R,Z),f.call(w+"_square",G,tt),f.call(w+"_square",tt,K),f.call(w+"_add",tt,R,T),f.call(w+"_square",T,T),f.call(w+"_sub",T,Z,T),f.call(w+"_sub",T,K,T),f.call(w+"_add",T,T,T),f.call(w+"_add",Z,Z,it),f.call(w+"_add",it,Z,it),f.call(w+"_add",R,it,D),f.call(w+"_square",it,mt),f.call(w+"_square",P,Y),f.call(w+"_sub",mt,T,R),f.call(w+"_sub",R,T,R),f.call(w+"_add",P,G,P),f.call(w+"_square",P,P),f.call(w+"_sub",P,tt,P),f.call(w+"_sub",P,Y,P),f.call(w+"_sub",T,R,G),f.call(w+"_mul",G,it,G),f.call(w+"_add",K,K,K),f.call(w+"_add",K,K,K),f.call(w+"_add",K,K,K),f.call(w+"_sub",G,K,G),f.call(w+"_mul",it,Y,T),f.call(w+"_add",T,T,T),f.call(w+"_neg",T,T),f.call(w+"_square",D,D),f.call(w+"_sub",D,Z,D),f.call(w+"_sub",D,mt,D),f.call(w+"_add",tt,tt,tt),f.call(w+"_add",tt,tt,tt),f.call(w+"_sub",D,tt,D),f.call(w+"_mul",P,Y,Z),f.call(w+"_add",Z,Z,Z))}function ft(){let _=t.addFunction(a+"_prepAddStep");_.addParam("R","i32"),_.addParam("Q","i32"),_.addParam("r","i32");let f=_.getCodeBuilder(),R=f.getLocal("R"),G=f.i32_add(f.getLocal("R"),f.i32_const(2*d)),P=f.i32_add(f.getLocal("R"),f.i32_const(4*d)),Z=f.getLocal("Q"),T=f.i32_add(f.getLocal("Q"),f.i32_const(2*d)),D=f.getLocal("r"),Y=f.i32_add(f.getLocal("r"),f.i32_const(2*d)),tt=f.i32_add(f.getLocal("r"),f.i32_const(4*d)),K=f.i32_const(t.alloc(l)),it=f.i32_const(t.alloc(l)),mt=f.i32_const(t.alloc(l)),pt=f.i32_const(t.alloc(l)),dt=f.i32_const(t.alloc(l)),Ct=f.i32_const(t.alloc(l)),xt=f.i32_const(t.alloc(l)),St=f.i32_const(t.alloc(l)),Bt=f.i32_const(t.alloc(l)),At=f.i32_const(t.alloc(l)),wt=f.i32_const(t.alloc(l));_.addCode(f.call(w+"_square",P,K),f.call(w+"_square",T,it),f.call(w+"_mul",K,Z,pt),f.call(w+"_add",T,P,Y),f.call(w+"_square",Y,Y),f.call(w+"_sub",Y,it,Y),f.call(w+"_sub",Y,K,Y),f.call(w+"_mul",Y,K,Y),f.call(w+"_sub",pt,R,dt),f.call(w+"_square",dt,Ct),f.call(w+"_add",Ct,Ct,xt),f.call(w+"_add",xt,xt,xt),f.call(w+"_mul",xt,dt,St),f.call(w+"_sub",Y,G,Bt),f.call(w+"_sub",Bt,G,Bt),f.call(w+"_mul",Bt,Z,tt),f.call(w+"_mul",xt,R,At),f.call(w+"_square",Bt,R),f.call(w+"_sub",R,St,R),f.call(w+"_sub",R,At,R),f.call(w+"_sub",R,At,R),f.call(w+"_add",P,dt,P),f.call(w+"_square",P,P),f.call(w+"_sub",P,K,P),f.call(w+"_sub",P,Ct,P),f.call(w+"_add",T,P,D),f.call(w+"_sub",At,R,wt),f.call(w+"_mul",wt,Bt,wt),f.call(w+"_mul",G,St,pt),f.call(w+"_add",pt,pt,pt),f.call(w+"_sub",wt,pt,G),f.call(w+"_square",D,D),f.call(w+"_sub",D,it,D),f.call(w+"_square",P,mt),f.call(w+"_sub",D,mt,D),f.call(w+"_add",tt,tt,tt),f.call(w+"_sub",tt,D,tt),f.call(w+"_add",P,P,D),f.call(w+"_neg",Bt,Bt),f.call(w+"_add",Bt,Bt,Y))}function _t(){let _=t.addFunction(a+"_prepareG2");_.addParam("pQ","i32"),_.addParam("ppreQ","i32"),_.addLocal("pCoef","i32"),_.addLocal("i","i32");let f=_.getCodeBuilder(),R=f.getLocal("pQ"),G=t.alloc(l*3),P=f.i32_const(G),Z=f.getLocal("ppreQ");_.addCode(f.call(O+"_normalize",R,Z),f.if(f.call(O+"_isZero",Z),f.ret([])),f.call(O+"_copy",Z,P),f.setLocal("pCoef",f.i32_add(f.getLocal("ppreQ"),f.i32_const(l*3)))),_.addCode(f.setLocal("i",f.i32_const(Lt.length-2)),f.block(f.loop(f.call(a+"_prepDblStep",P,f.getLocal("pCoef")),f.setLocal("pCoef",f.i32_add(f.getLocal("pCoef"),f.i32_const(ht))),f.if(f.i32_load8_s(f.getLocal("i"),rt),[...f.call(a+"_prepAddStep",P,Z,f.getLocal("pCoef")),...f.setLocal("pCoef",f.i32_add(f.getLocal("pCoef"),f.i32_const(ht)))]),f.br_if(1,f.i32_eqz(f.getLocal("i"))),f.setLocal("i",f.i32_sub(f.getLocal("i"),f.i32_const(1))),f.br(0))))}function gt(){let _=t.addFunction(j+"_mul1");_.addParam("pA","i32"),_.addParam("pC1","i32"),_.addParam("pR","i32");let f=_.getCodeBuilder(),R=f.getLocal("pA"),G=f.i32_add(f.getLocal("pA"),f.i32_const(b*2)),P=f.i32_add(f.getLocal("pA"),f.i32_const(b*4)),Z=f.getLocal("pC1"),T=f.getLocal("pR"),D=f.i32_add(f.getLocal("pR"),f.i32_const(b*2)),Y=f.i32_add(f.getLocal("pR"),f.i32_const(b*4)),tt=f.i32_const(t.alloc(b*2)),K=f.i32_const(t.alloc(b*2));_.addCode(f.call(w+"_add",R,G,tt),f.call(w+"_add",G,P,K),f.call(w+"_mul",G,Z,Y),f.call(w+"_mul",K,Z,T),f.call(w+"_sub",T,Y,T),f.call(w+"_mulNR",T,T),f.call(w+"_mul",tt,Z,D),f.call(w+"_sub",D,Y,D))}gt();function yt(){let _=t.addFunction(j+"_mul01");_.addParam("pA","i32"),_.addParam("pC0","i32"),_.addParam("pC1","i32"),_.addParam("pR","i32");let f=_.getCodeBuilder(),R=f.getLocal("pA"),G=f.i32_add(f.getLocal("pA"),f.i32_const(b*2)),P=f.i32_add(f.getLocal("pA"),f.i32_const(b*4)),Z=f.getLocal("pC0"),T=f.getLocal("pC1"),D=f.getLocal("pR"),Y=f.i32_add(f.getLocal("pR"),f.i32_const(b*2)),tt=f.i32_add(f.getLocal("pR"),f.i32_const(b*4)),K=f.i32_const(t.alloc(b*2)),it=f.i32_const(t.alloc(b*2)),mt=f.i32_const(t.alloc(b*2)),pt=f.i32_const(t.alloc(b*2));_.addCode(f.call(w+"_mul",R,Z,K),f.call(w+"_mul",G,T,it),f.call(w+"_add",R,G,mt),f.call(w+"_add",R,P,pt),f.call(w+"_add",G,P,D),f.call(w+"_mul",D,T,D),f.call(w+"_sub",D,it,D),f.call(w+"_mulNR",D,D),f.call(w+"_add",D,K,D),f.call(w+"_add",Z,T,Y),f.call(w+"_mul",Y,mt,Y),f.call(w+"_sub",Y,K,Y),f.call(w+"_sub",Y,it,Y),f.call(w+"_mul",pt,Z,tt),f.call(w+"_sub",tt,K,tt),f.call(w+"_add",tt,it,tt))}yt();function ut(){let _=t.addFunction(V+"_mul014");_.addParam("pA","i32"),_.addParam("pC0","i32"),_.addParam("pC1","i32"),_.addParam("pC4","i32"),_.addParam("pR","i32");let f=_.getCodeBuilder(),R=f.getLocal("pA"),G=f.i32_add(f.getLocal("pA"),f.i32_const(b*6)),P=f.getLocal("pC0"),Z=f.getLocal("pC1"),T=f.getLocal("pC4"),D=f.i32_const(t.alloc(b*6)),Y=f.i32_const(t.alloc(b*6)),tt=f.i32_const(t.alloc(b*2)),K=f.getLocal("pR"),it=f.i32_add(f.getLocal("pR"),f.i32_const(b*6));_.addCode(f.call(j+"_mul01",R,P,Z,D),f.call(j+"_mul1",G,T,Y),f.call(w+"_add",Z,T,tt),f.call(j+"_add",G,R,it),f.call(j+"_mul01",it,P,tt,it),f.call(j+"_sub",it,D,it),f.call(j+"_sub",it,Y,it),f.call(j+"_copy",Y,K),f.call(j+"_mulNR",K,K),f.call(j+"_add",K,D,K))}ut();function lt(){let _=t.addFunction(a+"_ell");_.addParam("pP","i32"),_.addParam("pCoefs","i32"),_.addParam("pF","i32");let f=_.getCodeBuilder(),R=f.getLocal("pP"),G=f.i32_add(f.getLocal("pP"),f.i32_const(d)),P=f.getLocal("pF"),Z=f.getLocal("pCoefs"),T=f.i32_add(f.getLocal("pCoefs"),f.i32_const(b)),D=f.i32_add(f.getLocal("pCoefs"),f.i32_const(b*2)),Y=f.i32_add(f.getLocal("pCoefs"),f.i32_const(b*3)),tt=f.i32_add(f.getLocal("pCoefs"),f.i32_const(b*4)),K=t.alloc(b*2),it=f.i32_const(K),mt=f.i32_const(K),pt=f.i32_const(K+b),dt=t.alloc(b*2),Ct=f.i32_const(dt),xt=f.i32_const(dt),St=f.i32_const(dt+b);_.addCode(f.call(M+"_mul",Z,G,mt),f.call(M+"_mul",T,G,pt),f.call(M+"_mul",D,R,xt),f.call(M+"_mul",Y,R,St),f.call(V+"_mul014",P,tt,Ct,it,P))}lt();function bt(){let _=t.addFunction(a+"_millerLoop");_.addParam("ppreP","i32"),_.addParam("ppreQ","i32"),_.addParam("r","i32"),_.addLocal("pCoef","i32"),_.addLocal("i","i32");let f=_.getCodeBuilder(),R=f.getLocal("ppreP"),G=f.getLocal("pCoef"),P=f.getLocal("r");_.addCode(f.call(V+"_one",P),f.if(f.call(S+"_isZero",R),f.ret([])),f.if(f.call(S+"_isZero",f.getLocal("ppreQ")),f.ret([])),f.setLocal("pCoef",f.i32_add(f.getLocal("ppreQ"),f.i32_const(l*3))),f.setLocal("i",f.i32_const(Lt.length-2)),f.block(f.loop(f.call(a+"_ell",R,G,P),f.setLocal("pCoef",f.i32_add(f.getLocal("pCoef"),f.i32_const(ht))),f.if(f.i32_load8_s(f.getLocal("i"),rt),[...f.call(a+"_ell",R,G,P),...f.setLocal("pCoef",f.i32_add(f.getLocal("pCoef"),f.i32_const(ht)))]),f.call(V+"_square",P,P),f.br_if(1,f.i32_eq(f.getLocal("i"),f.i32_const(1))),f.setLocal("i",f.i32_sub(f.getLocal("i"),f.i32_const(1))),f.br(0))),f.call(a+"_ell",R,G,P)),_.addCode(f.call(V+"_conjugate",P,P))}function Et(_){let f=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n,151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n],[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n,877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[151655185184498381465642749684540099398075398968325446656007613510403227271200139370504932015952886146304766135027n,3850754370037169011952147076051364057158807420970682438676050522613628423219637725072182697113062777891589506424760n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[1028732146235106349975324479215795277384839936929757896155643118032610843298655225875571310552543014690878354869257n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[877076961050607968509681729531255177986764537961432449499635504522207616027455086505066378536590128544573588734230n,3125332594171059424908108096204648978570118281977575435832422631601824034463382777937621250592425535493320683825557n]]],R=[[[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n],[1n,0n]],[[1n,0n],[0n,4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[0n,1n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[0n,793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n]],[[1n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939437n,0n],[4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,0n],[4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559786n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,0n],[793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620351n,0n]]],G=t.addFunction(V+"_frobeniusMap"+_);G.addParam("x","i32"),G.addParam("r","i32");let P=G.getCodeBuilder();for(let T=0;T<6;T++){let D=T==0?P.getLocal("x"):P.i32_add(P.getLocal("x"),P.i32_const(T*l)),Y=D,tt=P.i32_add(P.getLocal("x"),P.i32_const(T*l+b)),K=T==0?P.getLocal("r"):P.i32_add(P.getLocal("r"),P.i32_const(T*l)),it=K,mt=P.i32_add(P.getLocal("r"),P.i32_const(T*l+b)),pt=Z(f[Math.floor(T/3)][_%12],R[T%3][_%6]),dt=t.alloc([...Ht.bigInt2BytesLE(F(pt[0]),d),...Ht.bigInt2BytesLE(F(pt[1]),d)]);_%2==1?G.addCode(P.call(M+"_copy",Y,it),P.call(M+"_neg",tt,mt),P.call(w+"_mul",K,P.i32_const(dt),K)):G.addCode(P.call(w+"_mul",D,P.i32_const(dt),K))}function Z(T,D){let Y=T[0],tt=T[1],K=D[0],it=D[1],mt=[(Y*K-tt*it)%o,(Y*it+tt*K)%o];return j4(mt[0])&&(mt[0]=mt[0]+o),mt}}function It(){let _=t.addFunction(a+"__cyclotomicSquare");_.addParam("x","i32"),_.addParam("r","i32");let f=_.getCodeBuilder(),R=f.getLocal("x"),G=f.i32_add(f.getLocal("x"),f.i32_const(l)),P=f.i32_add(f.getLocal("x"),f.i32_const(2*l)),Z=f.i32_add(f.getLocal("x"),f.i32_const(3*l)),T=f.i32_add(f.getLocal("x"),f.i32_const(4*l)),D=f.i32_add(f.getLocal("x"),f.i32_const(5*l)),Y=f.getLocal("r"),tt=f.i32_add(f.getLocal("r"),f.i32_const(l)),K=f.i32_add(f.getLocal("r"),f.i32_const(2*l)),it=f.i32_add(f.getLocal("r"),f.i32_const(3*l)),mt=f.i32_add(f.getLocal("r"),f.i32_const(4*l)),pt=f.i32_add(f.getLocal("r"),f.i32_const(5*l)),dt=f.i32_const(t.alloc(l)),Ct=f.i32_const(t.alloc(l)),xt=f.i32_const(t.alloc(l)),St=f.i32_const(t.alloc(l)),Bt=f.i32_const(t.alloc(l)),At=f.i32_const(t.alloc(l)),wt=f.i32_const(t.alloc(l)),Ot=f.i32_const(t.alloc(l));_.addCode(f.call(w+"_mul",R,T,wt),f.call(w+"_mulNR",T,dt),f.call(w+"_add",R,dt,dt),f.call(w+"_add",R,T,Ot),f.call(w+"_mul",Ot,dt,dt),f.call(w+"_mulNR",wt,Ot),f.call(w+"_add",wt,Ot,Ot),f.call(w+"_sub",dt,Ot,dt),f.call(w+"_add",wt,wt,Ct),f.call(w+"_mul",Z,P,wt),f.call(w+"_mulNR",P,xt),f.call(w+"_add",Z,xt,xt),f.call(w+"_add",Z,P,Ot),f.call(w+"_mul",Ot,xt,xt),f.call(w+"_mulNR",wt,Ot),f.call(w+"_add",wt,Ot,Ot),f.call(w+"_sub",xt,Ot,xt),f.call(w+"_add",wt,wt,St),f.call(w+"_mul",G,D,wt),f.call(w+"_mulNR",D,Bt),f.call(w+"_add",G,Bt,Bt),f.call(w+"_add",G,D,Ot),f.call(w+"_mul",Ot,Bt,Bt),f.call(w+"_mulNR",wt,Ot),f.call(w+"_add",wt,Ot,Ot),f.call(w+"_sub",Bt,Ot,Bt),f.call(w+"_add",wt,wt,At),f.call(w+"_sub",dt,R,Y),f.call(w+"_add",Y,Y,Y),f.call(w+"_add",dt,Y,Y),f.call(w+"_add",Ct,T,mt),f.call(w+"_add",mt,mt,mt),f.call(w+"_add",Ct,mt,mt),f.call(w+"_mul",At,f.i32_const(nt),Ot),f.call(w+"_add",Ot,Z,it),f.call(w+"_add",it,it,it),f.call(w+"_add",Ot,it,it),f.call(w+"_sub",Bt,P,K),f.call(w+"_add",K,K,K),f.call(w+"_add",Bt,K,K),f.call(w+"_sub",xt,G,tt),f.call(w+"_add",tt,tt,tt),f.call(w+"_add",xt,tt,tt),f.call(w+"_add",St,D,pt),f.call(w+"_add",pt,pt,pt),f.call(w+"_add",St,pt,pt))}function zt(_,f,R){let G=U(_).map(K=>K==-1?255:K),P=t.alloc(G),Z=t.addFunction(a+"__cyclotomicExp_"+R);Z.addParam("x","i32"),Z.addParam("r","i32"),Z.addLocal("bit","i32"),Z.addLocal("i","i32");let T=Z.getCodeBuilder(),D=T.getLocal("x"),Y=T.getLocal("r"),tt=T.i32_const(t.alloc(s));Z.addCode(T.call(V+"_conjugate",D,tt),T.call(V+"_one",Y),T.if(T.teeLocal("bit",T.i32_load8_s(T.i32_const(G.length-1),P)),T.if(T.i32_eq(T.getLocal("bit"),T.i32_const(1)),T.call(V+"_mul",Y,D,Y),T.call(V+"_mul",Y,tt,Y))),T.setLocal("i",T.i32_const(G.length-2)),T.block(T.loop(T.call(a+"__cyclotomicSquare",Y,Y),T.if(T.teeLocal("bit",T.i32_load8_s(T.getLocal("i"),P)),T.if(T.i32_eq(T.getLocal("bit"),T.i32_const(1)),T.call(V+"_mul",Y,D,Y),T.call(V+"_mul",Y,tt,Y))),T.br_if(1,T.i32_eqz(T.getLocal("i"))),T.setLocal("i",T.i32_sub(T.getLocal("i"),T.i32_const(1))),T.br(0)))),f&&Z.addCode(T.call(V+"_conjugate",Y,Y))}function Mt(){It(),zt(g,E,"w0");let _=t.addFunction(a+"_finalExponentiation");_.addParam("x","i32"),_.addParam("r","i32");let f=_.getCodeBuilder(),R=f.getLocal("x"),G=f.getLocal("r"),P=f.i32_const(t.alloc(s)),Z=f.i32_const(t.alloc(s)),T=f.i32_const(t.alloc(s)),D=f.i32_const(t.alloc(s)),Y=f.i32_const(t.alloc(s)),tt=f.i32_const(t.alloc(s)),K=f.i32_const(t.alloc(s));_.addCode(f.call(V+"_frobeniusMap6",R,P),f.call(V+"_inverse",R,Z),f.call(V+"_mul",P,Z,T),f.call(V+"_copy",T,Z),f.call(V+"_frobeniusMap2",T,T),f.call(V+"_mul",T,Z,T),f.call(a+"__cyclotomicSquare",T,Z),f.call(V+"_conjugate",Z,Z),f.call(a+"__cyclotomicExp_w0",T,D),f.call(a+"__cyclotomicSquare",D,Y),f.call(V+"_mul",Z,D,tt),f.call(a+"__cyclotomicExp_w0",tt,Z),f.call(a+"__cyclotomicExp_w0",Z,P),f.call(a+"__cyclotomicExp_w0",P,K),f.call(V+"_mul",K,Y,K),f.call(a+"__cyclotomicExp_w0",K,Y),f.call(V+"_conjugate",tt,tt),f.call(V+"_mul",Y,tt,Y),f.call(V+"_mul",Y,T,Y),f.call(V+"_conjugate",T,tt),f.call(V+"_mul",Z,T,Z),f.call(V+"_frobeniusMap3",Z,Z),f.call(V+"_mul",K,tt,K),f.call(V+"_frobeniusMap1",K,K),f.call(V+"_mul",D,P,D),f.call(V+"_frobeniusMap2",D,D),f.call(V+"_mul",D,Z,D),f.call(V+"_mul",D,K,D),f.call(V+"_mul",D,Y,G))}function kt(){let _=t.addFunction(a+"_finalExponentiationOld");_.addParam("x","i32"),_.addParam("r","i32");let R=t.alloc(Ht.bigInt2BytesLE(322277361516934140462891564586510139908379969514828494218366688025288661041104682794998680497580008899973249814104447692778988208376779573819485263026159588510513834876303014016798809919343532899164848730280942609956670917565618115867287399623286813270357901731510188149934363360381614501334086825442271920079363289954510565375378443704372994881406797882676971082200626541916413184642520269678897559532260949334760604962086348898118982248842634379637598665468817769075878555493752214492790122785850202957575200176084204422751485957336465472324810982833638490904279282696134323072515220044451592646885410572234451732790590013479358343841220074174848221722017083597872017638514103174122784843925578370430843522959600095676285723737049438346544753168912974976791528535276317256904336520179281145394686565050419250614107803233314658825463117900250701199181529205942363159325765991819433914303908860460720581408201373164047773794825411011922305820065611121544561808414055302212057471395719432072209245600258134364584636810093520285711072578721435517884103526483832733289802426157301542744476740008494780363354305116978805620671467071400711358839553375340724899735460480144599782014906586543813292157922220645089192130209334926661588737007768565838519456601560804957985667880395221049249803753582637708560n,544)),G=_.getCodeBuilder();_.addCode(G.call(V+"_exp",G.getLocal("x"),G.i32_const(R),G.i32_const(544),G.getLocal("r")))}let Pt=t.alloc(r),qt=t.alloc(z);function Rt(_){let f=t.addFunction(a+"_pairingEq"+_);for(let Z=0;Z<_;Z++)f.addParam("p_"+Z,"i32"),f.addParam("q_"+Z,"i32");f.addParam("c","i32"),f.setReturnType("i32");let R=f.getCodeBuilder(),G=R.i32_const(t.alloc(s)),P=R.i32_const(t.alloc(s));f.addCode(R.call(V+"_one",G));for(let Z=0;Z<_;Z++)f.addCode(R.call(a+"_prepareG1",R.getLocal("p_"+Z),R.i32_const(Pt))),f.addCode(R.call(a+"_prepareG2",R.getLocal("q_"+Z),R.i32_const(qt))),f.addCode(R.if(R.i32_eqz(R.call(S+"_inGroupAffine",R.i32_const(Pt))),R.ret(R.i32_const(0))),R.if(R.i32_eqz(R.call(O+"_inGroupAffine",R.i32_const(qt))),R.ret(R.i32_const(0)))),f.addCode(R.call(a+"_millerLoop",R.i32_const(Pt),R.i32_const(qt),P)),f.addCode(R.call(V+"_mul",G,P,G));f.addCode(R.call(a+"_finalExponentiation",G,G)),f.addCode(R.call(V+"_eq",G,R.getLocal("c")))}function Kt(){let _=t.addFunction(a+"_pairing");_.addParam("p","i32"),_.addParam("q","i32"),_.addParam("r","i32");let f=_.getCodeBuilder(),R=f.i32_const(t.alloc(s));_.addCode(f.call(a+"_prepareG1",f.getLocal("p"),f.i32_const(Pt))),_.addCode(f.call(a+"_prepareG2",f.getLocal("q"),f.i32_const(qt))),_.addCode(f.call(a+"_millerLoop",f.i32_const(Pt),f.i32_const(qt),R)),_.addCode(f.call(a+"_finalExponentiation",R,f.getLocal("r")))}function Ut(){let _=t.addFunction(O+"_inGroupAffine");_.addParam("p","i32"),_.setReturnType("i32");let f=_.getCodeBuilder(),R=[2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279894n,2001204777610833696708894912867952078278441409969503942666029068062015825245418932221343814564507832018947136279893n],G=4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,P=[2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n,2973677408986561043442465346520108879172042883009249989176415018091420807192182638567116318576472649347015917690530n],Z=f.i32_const(t.alloc([...Ht.bigInt2BytesLE(F(R[0]),d),...Ht.bigInt2BytesLE(F(R[1]),d)])),T=f.i32_const(t.alloc(Ht.bigInt2BytesLE(F(G),d))),D=f.i32_const(t.alloc([...Ht.bigInt2BytesLE(F(P[0]),d),...Ht.bigInt2BytesLE(F(P[1]),d)])),Y=f.i32_const(t.alloc(Ht.bigInt2BytesLE(g,8))),tt=f.getLocal("p"),K=f.i32_add(f.getLocal("p"),f.i32_const(l)),it=f.i32_const(t.alloc(b)),mt=f.i32_const(t.alloc(l)),pt=f.i32_const(t.alloc(l)),dt=t.alloc(l*2),Ct=f.i32_const(dt),xt=f.i32_const(dt),St=f.i32_const(dt),Bt=f.i32_const(dt+b),At=f.i32_const(dt+l),wt=f.i32_const(dt+l),Ot=f.i32_const(dt+l+b),Jt=t.alloc(l*3),cn=f.i32_const(Jt),oo=f.i32_const(Jt),Nn=f.i32_const(Jt),$n=f.i32_const(Jt+b),io=f.i32_const(Jt+l),Zn=f.i32_const(Jt+l),jn=f.i32_const(Jt+l+b),eo=f.i32_const(Jt+l*2);_.addCode(f.if(f.call(O+"_isZeroAffine",f.getLocal("p")),f.ret(f.i32_const(1))),f.if(f.i32_eqz(f.call(O+"_inCurveAffine",f.getLocal("p"))),f.ret(f.i32_const(0))),f.call(w+"_mul",tt,Z,mt),f.call(w+"_mul",K,Z,pt),f.call(w+"_mul1",mt,T,xt),f.call(w+"_neg",pt,At),f.call(w+"_neg",mt,oo),f.call(w+"_mul",pt,D,io),f.call(M+"_sub",St,Bt,it),f.call(M+"_add",St,Bt,Bt),f.call(M+"_copy",it,St),f.call(M+"_sub",wt,Ot,it),f.call(M+"_add",wt,Ot,Ot),f.call(M+"_copy",it,wt),f.call(M+"_add",Nn,$n,it),f.call(M+"_sub",Nn,$n,$n),f.call(M+"_copy",it,Nn),f.call(M+"_sub",jn,Zn,it),f.call(M+"_add",Zn,jn,jn),f.call(M+"_copy",it,Zn),f.call(w+"_one",eo),f.call(O+"_timesScalar",cn,Y,f.i32_const(8),cn),f.call(O+"_addMixed",cn,Ct,cn),f.ret(f.call(O+"_eqMixed",cn,f.getLocal("p"))));let An=t.addFunction(O+"_inGroup");An.addParam("pIn","i32"),An.setReturnType("i32");let fn=An.getCodeBuilder(),da=fn.i32_const(t.alloc(l*2));An.addCode(fn.call(O+"_toAffine",fn.getLocal("pIn"),da),fn.ret(fn.call(O+"_inGroupAffine",da)))}function X(){let _=t.addFunction(S+"_inGroupAffine");_.addParam("p","i32"),_.setReturnType("i32");let f=_.getCodeBuilder(),R=4002409555221667392624310435006688643935503118305586438271171395842971157480381377015405980053539358417135540939436n,G=793479390729215512621379701633421447060886740281060493010456487427281649075476305620758731620350n,P=(g*g-1n)/3n,Z=f.i32_const(t.alloc(Ht.bigInt2BytesLE(F(R),d))),T=f.i32_const(t.alloc(Ht.bigInt2BytesLE(F(G),d))),D=f.i32_const(t.alloc(Ht.bigInt2BytesLE(P,16))),Y=f.getLocal("p"),tt=f.i32_add(f.getLocal("p"),f.i32_const(b)),K=t.alloc(b*3),it=f.i32_const(K),mt=f.i32_const(K),pt=f.i32_const(K+b),dt=t.alloc(b*2),Ct=f.i32_const(dt),xt=f.i32_const(dt),St=f.i32_const(dt+b);_.addCode(f.if(f.call(S+"_isZeroAffine",f.getLocal("p")),f.ret(f.i32_const(1))),f.if(f.i32_eqz(f.call(S+"_inCurveAffine",f.getLocal("p"))),f.ret(f.i32_const(0))),f.call(M+"_mul",Y,Z,mt),f.call(M+"_copy",tt,pt),f.call(M+"_mul",Y,T,xt),f.call(M+"_copy",tt,St),f.call(S+"_doubleAffine",it,it),f.call(S+"_subMixed",it,f.getLocal("p"),it),f.call(S+"_subMixed",it,Ct,it),f.call(S+"_timesScalar",it,D,f.i32_const(16),it),f.ret(f.call(S+"_eqMixed",it,Ct)));let Bt=t.addFunction(S+"_inGroup");Bt.addParam("pIn","i32"),Bt.setReturnType("i32");let At=Bt.getCodeBuilder(),wt=At.i32_const(t.alloc(b*2));Bt.addCode(At.call(S+"_toAffine",At.getLocal("pIn"),wt),At.ret(At.call(S+"_inGroupAffine",wt)))}for(let _=0;_<10;_++)Et(_),t.exportFunction(V+"_frobeniusMap"+_);X(),Ut(),ft(),ct(),et(),_t(),bt(),kt(),Mt();for(let _=1;_<=5;_++)Rt(_),t.exportFunction(a+"_pairingEq"+_);Kt(),t.exportFunction(a+"_pairing"),t.exportFunction(a+"_prepareG1"),t.exportFunction(a+"_prepareG2"),t.exportFunction(a+"_millerLoop"),t.exportFunction(a+"_finalExponentiation"),t.exportFunction(a+"_finalExponentiationOld"),t.exportFunction(a+"__cyclotomicSquare"),t.exportFunction(a+"__cyclotomicExp_w0"),t.exportFunction(j+"_mul1"),t.exportFunction(j+"_mul01"),t.exportFunction(V+"_mul014"),t.exportFunction(S+"_inGroupAffine"),t.exportFunction(S+"_inGroup"),t.exportFunction(O+"_inGroupAffine"),t.exportFunction(O+"_inGroup")},W4=G4,Q4=V4;Yi=[];for(let c=0;c<256;c++)Yi[c]=K4(c,8);J4=Object.freeze({__proto__:null,array2buffer:vd,beBuff2int:X4,beInt2Buff:H4,bitReverse:cf,buffReverseBits:sf,buffer2array:ts,leBuff2int:D4,leInt2Buff:ef,log2:na,stringifyBigInts:rd,stringifyFElements:ud,unstringifyBigInts:dd,unstringifyFElements:_d}),zn=1<<30,bn=class c{constructor(t){this.buffers=[],this.byteLength=t;for(let n=0;n<t;n+=zn){let a=Math.min(t-n,zn);this.buffers.push(new Uint8Array(a))}}slice(t,n){n===void 0&&(n=this.byteLength),t===void 0&&(t=0);let a=n-t,o=Math.floor(t/zn),e=Math.floor((t+a-1)/zn);if(o==e||a==0)return this.buffers[o].slice(t%zn,t%zn+a);let h,d=o,b=t%zn,l=a;for(;l>0;){let s=b+l>zn?zn-b:l,m=new Uint8Array(this.buffers[d].buffer,this.buffers[d].byteOffset+b,s);if(s==a)return m.slice();h||(a<=zn?h=new Uint8Array(a):h=new c(a)),h.set(m,a-l),l=l-s,d++,b=0}return h}set(t,n){n===void 0&&(n=0);let a=t.byteLength;if(a==0)return;let o=Math.floor(n/zn),e=Math.floor((n+a-1)/zn);if(o==e)return t instanceof c&&t.buffers.length==1?this.buffers[o].set(t.buffers[0],n%zn):this.buffers[o].set(t,n%zn);let h=o,d=n%zn,b=a;for(;b>0;){let l=d+b>zn?zn-d:b,s=t.slice(a-b,a-b+l);new Uint8Array(this.buffers[h].buffer,this.buffers[h].byteOffset+d,l).set(s),b=b-l,h++,d=0}}};ns=class{constructor(t,n,a,o){if(this.tm=t,this.prefix=n,this.p=o,this.n8=a,this.type="F1",this.m=1,this.half=Vo(o,go),this.bitLength=ae(o),this.mask=za(Xc(go,this.bitLength),go),this.pOp1=t.alloc(a),this.pOp2=t.alloc(a),this.pOp3=t.alloc(a),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=this.tm.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.n64=Math.floor(a/8),this.n32=Math.floor(a/4),this.n64*8!=this.n8)throw new Error("n8 must be a multiple of 8");this.half=Vo(this.p,go),this.nqr=this.two;let e=this.exp(this.nqr,this.half);for(;!this.eq(e,this.negone);)this.nqr=this.add(this.nqr,this.one),e=this.exp(this.nqr,this.half);this.shift=this.mul(this.nqr,this.nqr),this.shiftInv=this.inv(this.shift),this.s=0;let h=za(this.p,go);for(;!md(h);)this.s=this.s+1,h=Vo(h,go);this.w=[],this.w[this.s]=this.exp(this.nqr,h);for(let d=this.s-1;d>=0;d--)this.w[d]=this.square(this.w[d+1]);if(!this.eq(this.w[0],this.one))throw new Error("Error calculating roots of unity");this.batchToMontgomery=Ka(t,n+"_batchToMontgomery",this.n8,this.n8),this.batchFromMontgomery=Ka(t,n+"_batchFromMontgomery",this.n8,this.n8)}op2(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){return this.op2("_add",t,n)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=Qo(Fn(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}isNegative(t){return this.op1Bool("_isNegative",t)}e(t,n){if(t instanceof Uint8Array)return t;let a=Fn(t,n);Oh(a)?(a=zh(a),Hc(a,this.p)&&(a=xa(a,this.p)),a=za(this.p,a)):Hc(a,this.p)&&(a=xa(a,this.p));let o=ef(a,this.n8);return this.toMontgomery(o)}toString(t,n){let a=this.fromMontgomery(t),o=ne(a,0);return ls(o,n)}fromRng(t){let n,a=new Uint8Array(this.n8);do{n=Nh;for(let o=0;o<this.n64;o++)n=yd(n,Xc(t.nextU64(),64*o));n=wd(n,this.mask)}while(Gh(n,this.p));return te(a,0,n,this.n8),a}random(){return this.fromRng(Fd())}toObject(t){let n=this.fromMontgomery(t);return ne(n,0)}fromObject(t){let n=new Uint8Array(this.n8);return te(n,0,t,this.n8),this.toMontgomery(n)}toRprLE(t,n,a){t.set(this.fromMontgomery(a),n)}toRprBE(t,n,a){let o=this.fromMontgomery(a);for(let e=0;e<this.n8/2;e++){let h=o[e];o[e]=o[this.n8-1-e],o[this.n8-1-e]=h}t.set(o,n)}fromRprLE(t,n){n=n||0;let a=t.slice(n,n+this.n8);return this.toMontgomery(a)}async batchInverse(t){let n=!1,a=this.n8,o=this.n8;Array.isArray(t)?(t=vd(t,a),n=!0):t=t.slice(0,t.byteLength);let e=Math.floor(t.byteLength/a);if(e*a!==t.byteLength)throw new Error("Invalid buffer size");let h=Math.floor(e/this.tm.concurrency),d=[];for(let m=0;m<this.tm.concurrency;m++){let B;if(m<this.tm.concurrency-1?B=h:B=e-m*h,B==0)continue;let v=[{cmd:"ALLOCSET",var:0,buff:t.slice(m*h*a,m*h*a+B*a)},{cmd:"ALLOC",var:1,len:o*B},{cmd:"CALL",fnName:this.prefix+"_batchInverse",params:[{var:0},{val:a},{val:B},{var:1},{val:o}]},{cmd:"GET",out:0,var:1,len:o*B}];d.push(this.tm.queueAction(v))}let b=await Promise.all(d),l;t instanceof bn?l=new bn(e*o):l=new Uint8Array(e*o);let s=0;for(let m=0;m<b.length;m++)l.set(b[m][0],s),s+=b[m][0].byteLength;return n?ts(l,o):l}},as=class{constructor(t,n,a){this.tm=t,this.prefix=n,this.F=a,this.type="F2",this.m=a.m*2,this.n8=this.F.n8*2,this.n32=this.F.n32*2,this.n64=this.F.n64*2,this.pOp1=t.alloc(a.n8*2),this.pOp2=t.alloc(a.n8*2),this.pOp3=t.alloc(a.n8*2),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){return this.op2("_add",t,n)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}mul1(t,n){return this.op2("_mul1",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=Qo(Fn(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}e(t,n){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&t.length==2){let a=this.F.e(t[0],n),o=this.F.e(t[1],n),e=new Uint8Array(this.F.n8*2);return e.set(a),e.set(o,this.F.n8*2),e}else throw new Error("invalid F2")}toString(t,n){let a=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8),n);return`[${a}, ${o}]`}fromRng(t){let n=this.F.fromRng(t),a=this.F.fromRng(t),o=new Uint8Array(this.F.n8*2);return o.set(n),o.set(a,this.F.n8),o}random(){return this.fromRng(Fd())}toObject(t){let n=this.F.toObject(t.slice(0,this.F.n8)),a=this.F.toObject(t.slice(this.F.n8,this.F.n8*2));return[n,a]}fromObject(t){let n=new Uint8Array(this.F.n8*2),a=this.F.fromObject(t[0]),o=this.F.fromObject(t[1]);return n.set(a),n.set(o,this.F.n8),n}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8)}},hd=class{constructor(t,n,a){this.tm=t,this.prefix=n,this.F=a,this.type="F3",this.m=a.m*3,this.n8=this.F.n8*3,this.n32=this.F.n32*3,this.n64=this.F.n64*3,this.pOp1=t.alloc(a.n8*3),this.pOp2=t.alloc(a.n8*3),this.pOp3=t.alloc(a.n8*3),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=t.getBuff(this.pOp1,this.n8),this.tm.instance.exports[n+"_one"](this.pOp1),this.one=t.getBuff(this.pOp1,this.n8),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one)}op2(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op2Bool(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}eq(t,n){return this.op2Bool("_eq",t,n)}isZero(t){return this.op1Bool("_isZero",t)}add(t,n){return this.op2("_add",t,n)}sub(t,n){return this.op2("_sub",t,n)}neg(t){return this.op1("_neg",t)}inv(t){return this.op1("_inverse",t)}isNegative(t){return this.op1Bool("_isNegative",t)}toMontgomery(t){return this.op1("_toMontgomery",t)}fromMontgomery(t){return this.op1("_fromMontgomery",t)}mul(t,n){return this.op2("_mul",t,n)}div(t,n){return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_inverse"](this.pOp2,this.pOp2),this.tm.instance.exports[this.prefix+"_mul"](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.n8)}square(t){return this.op1("_square",t)}isSquare(t){return this.op1Bool("_isSquare",t)}sqrt(t){return this.op1("_sqrt",t)}exp(t,n){return n instanceof Uint8Array||(n=Qo(Fn(n))),this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[this.prefix+"_exp"](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.getBuff(this.pOp3,this.n8)}e(t,n){if(t instanceof Uint8Array)return t;if(Array.isArray(t)&&t.length==3){let a=this.F.e(t[0],n),o=this.F.e(t[1],n),e=this.F.e(t[2],n),h=new Uint8Array(this.F.n8*3);return h.set(a),h.set(o,this.F.n8),h.set(e,this.F.n8*2),h}else throw new Error("invalid F3")}toString(t,n){let a=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8,this.F.n8*2),n),e=this.F.toString(t.slice(this.F.n8*2),n);return`[${a}, ${o}, ${e}]`}fromRng(t){let n=this.F.fromRng(t),a=this.F.fromRng(t),o=this.F.fromRng(t),e=new Uint8Array(this.F.n8*3);return e.set(n),e.set(a,this.F.n8),e.set(o,this.F.n8*2),e}random(){return this.fromRng(Fd())}toObject(t){let n=this.F.toObject(t.slice(0,this.F.n8)),a=this.F.toObject(t.slice(this.F.n8,this.F.n8*2)),o=this.F.toObject(t.slice(this.F.n8*2,this.F.n8*3));return[n,a,o]}fromObject(t){let n=new Uint8Array(this.F.n8*3),a=this.F.fromObject(t[0]),o=this.F.fromObject(t[1]),e=this.F.fromObject(t[2]);return n.set(a),n.set(o,this.F.n8),n.set(e,this.F.n8*2),n}c1(t){return t.slice(0,this.F.n8)}c2(t){return t.slice(this.F.n8,this.F.n8*2)}c3(t){return t.slice(this.F.n8*2)}},os=class{constructor(t,n,a,o,e,h){this.tm=t,this.prefix=n,this.F=a,this.pOp1=t.alloc(a.n8*3),this.pOp2=t.alloc(a.n8*3),this.pOp3=t.alloc(a.n8*3),this.tm.instance.exports[n+"_zero"](this.pOp1),this.zero=this.tm.getBuff(this.pOp1,a.n8*3),this.tm.instance.exports[n+"_zeroAffine"](this.pOp1),this.zeroAffine=this.tm.getBuff(this.pOp1,a.n8*2),this.one=this.tm.getBuff(o,a.n8*3),this.g=this.one,this.oneAffine=this.tm.getBuff(o,a.n8*2),this.gAffine=this.oneAffine,this.b=this.tm.getBuff(e,a.n8),h&&(this.cofactor=Qo(h)),this.negone=this.neg(this.one),this.two=this.add(this.one,this.one),this.batchLEMtoC=Ka(t,n+"_batchLEMtoC",a.n8*2,a.n8),this.batchLEMtoU=Ka(t,n+"_batchLEMtoU",a.n8*2,a.n8*2),this.batchCtoLEM=Ka(t,n+"_batchCtoLEM",a.n8,a.n8*2),this.batchUtoLEM=Ka(t,n+"_batchUtoLEM",a.n8*2,a.n8*2),this.batchToJacobian=Ka(t,n+"_batchToJacobian",a.n8*2,a.n8*3),this.batchToAffine=Ka(t,n+"_batchToAffine",a.n8*3,a.n8*2)}op2(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}op2bool(t,n,a){return this.tm.setBuff(this.pOp1,n),this.tm.setBuff(this.pOp2,a),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp2,this.pOp3)}op1(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}op1Affine(t,n){return this.tm.setBuff(this.pOp1,n),this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*2)}op1Bool(t,n){return this.tm.setBuff(this.pOp1,n),!!this.tm.instance.exports[this.prefix+t](this.pOp1,this.pOp3)}add(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2("_add",t,n);if(n.byteLength==this.F.n8*2)return this.op2("_addMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2("_addMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2("_addAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}sub(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2("_sub",t,n);if(n.byteLength==this.F.n8*2)return this.op2("_subMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2("_subMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2("_subAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}neg(t){if(t.byteLength==this.F.n8*3)return this.op1("_neg",t);if(t.byteLength==this.F.n8*2)return this.op1Affine("_negAffine",t);throw new Error("invalid point size")}double(t){if(t.byteLength==this.F.n8*3)return this.op1("_double",t);if(t.byteLength==this.F.n8*2)return this.op1("_doubleAffine",t);throw new Error("invalid point size")}isZero(t){if(t.byteLength==this.F.n8*3)return this.op1Bool("_isZero",t);if(t.byteLength==this.F.n8*2)return this.op1Bool("_isZeroAffine",t);throw new Error("invalid point size")}timesScalar(t,n){n instanceof Uint8Array||(n=Qo(Fn(n)));let a;if(t.byteLength==this.F.n8*3)a=this.prefix+"_timesScalar";else if(t.byteLength==this.F.n8*2)a=this.prefix+"_timesScalarAffine";else throw new Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[a](this.pOp1,this.pOp2,n.byteLength,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}timesFr(t,n){let a;if(t.byteLength==this.F.n8*3)a=this.prefix+"_timesFr";else if(t.byteLength==this.F.n8*2)a=this.prefix+"_timesFrAffine";else throw new Error("invalid point size");return this.tm.setBuff(this.pOp1,t),this.tm.setBuff(this.pOp2,n),this.tm.instance.exports[a](this.pOp1,this.pOp2,this.pOp3),this.tm.getBuff(this.pOp3,this.F.n8*3)}eq(t,n){if(t.byteLength==this.F.n8*3){if(n.byteLength==this.F.n8*3)return this.op2bool("_eq",t,n);if(n.byteLength==this.F.n8*2)return this.op2bool("_eqMixed",t,n);throw new Error("invalid point size")}else if(t.byteLength==this.F.n8*2){if(n.byteLength==this.F.n8*3)return this.op2bool("_eqMixed",n,t);if(n.byteLength==this.F.n8*2)return this.op2bool("_eqAffine",t,n);throw new Error("invalid point size")}else throw new Error("invalid point size")}toAffine(t){if(t.byteLength==this.F.n8*3)return this.op1Affine("_toAffine",t);if(t.byteLength==this.F.n8*2)return t;throw new Error("invalid point size")}toJacobian(t){if(t.byteLength==this.F.n8*3)return t;if(t.byteLength==this.F.n8*2)return this.op1("_toJacobian",t);throw new Error("invalid point size")}toRprUncompressed(t,n,a){if(this.tm.setBuff(this.pOp1,a),a.byteLength==this.F.n8*3)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(a.byteLength!=this.F.n8*2)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoU"](this.pOp1,this.pOp1);let o=this.tm.getBuff(this.pOp1,this.F.n8*2);t.set(o,n)}fromRprUncompressed(t,n){let a=t.slice(n,n+this.F.n8*2);return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_UtoLEM"](this.pOp1,this.pOp1),this.tm.getBuff(this.pOp1,this.F.n8*2)}toRprCompressed(t,n,a){if(this.tm.setBuff(this.pOp1,a),a.byteLength==this.F.n8*3)this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);else if(a.byteLength!=this.F.n8*2)throw new Error("invalid point size");this.tm.instance.exports[this.prefix+"_LEMtoC"](this.pOp1,this.pOp1);let o=this.tm.getBuff(this.pOp1,this.F.n8);t.set(o,n)}fromRprCompressed(t,n){let a=t.slice(n,n+this.F.n8);return this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_CtoLEM"](this.pOp1,this.pOp2),this.tm.getBuff(this.pOp2,this.F.n8*2)}toUncompressed(t){let n=new Uint8Array(this.F.n8*2);return this.toRprUncompressed(n,0,t),n}toRprLEM(t,n,a){if(a.byteLength==this.F.n8*2){t.set(a,n);return}else if(a.byteLength==this.F.n8*3){this.tm.setBuff(this.pOp1,a),this.tm.instance.exports[this.prefix+"_toAffine"](this.pOp1,this.pOp1);let o=this.tm.getBuff(this.pOp1,this.F.n8*2);t.set(o,n)}else throw new Error("invalid point size")}fromRprLEM(t,n){return n=n||0,t.slice(n,n+this.F.n8*2)}toString(t,n){if(t.byteLength==this.F.n8*3){let a=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8,this.F.n8*2),n),e=this.F.toString(t.slice(this.F.n8*2),n);return`[ ${a}, ${o}, ${e} ]`}else if(t.byteLength==this.F.n8*2){let a=this.F.toString(t.slice(0,this.F.n8),n),o=this.F.toString(t.slice(this.F.n8),n);return`[ ${a}, ${o} ]`}else throw new Error("invalid point size")}isValid(t){if(this.isZero(t))return!0;let n=this.F,a=this.toAffine(t),o=a.slice(0,this.F.n8),e=a.slice(this.F.n8,this.F.n8*2),h=n.add(n.mul(n.square(o),o),this.b),d=n.square(e);return n.eq(h,d)}fromRng(t){let n=this.F,a=[],o,e;do a[0]=n.fromRng(t),o=t.nextBool(),e=n.add(n.mul(n.square(a[0]),a[0]),this.b);while(!n.isSquare(e));a[1]=n.sqrt(e);let h=n.isNegative(a[1]);o^h&&(a[1]=n.neg(a[1]));let d=new Uint8Array(this.F.n8*2);return d.set(a[0]),d.set(a[1],this.F.n8),this.cofactor&&(d=this.timesScalar(d,this.cofactor)),d}toObject(t){if(this.isZero(t))return[this.F.toObject(this.F.zero),this.F.toObject(this.F.one),this.F.toObject(this.F.zero)];let n=this.F.toObject(t.slice(0,this.F.n8)),a=this.F.toObject(t.slice(this.F.n8,this.F.n8*2)),o;return t.byteLength==this.F.n8*3?o=this.F.toObject(t.slice(this.F.n8*2,this.F.n8*3)):o=this.F.toObject(this.F.one),[n,a,o]}fromObject(t){let n=this.F.fromObject(t[0]),a=this.F.fromObject(t[1]),o;if(t.length==3?o=this.F.fromObject(t[2]):o=this.F.one,this.F.isZero(o,this.F.one))return this.zeroAffine;if(this.F.eq(o,this.F.one)){let e=new Uint8Array(this.F.n8*2);return e.set(n),e.set(a,this.F.n8),e}else{let e=new Uint8Array(this.F.n8*3);return e.set(n),e.set(a,this.F.n8),e.set(o,this.F.n8*2),e}}e(t){return t instanceof Uint8Array?t:this.fromObject(t)}x(t){return this.toAffine(t).slice(0,this.F.n8)}y(t){return this.toAffine(t).slice(this.F.n8)}};Jr=25,is=class{constructor(){this.promise=new Promise((t,n)=>{this.reject=n,this.resolve=t})}};vh=`(function thread(self) {
    const MAXMEM = 32767;
    let instance;
    let memory;

    if (self) {
        self.onmessage = function(e) {
            let data;
            if (e.data) {
                data = e.data;
            } else {
                data = e;
            }

            if (data[0].cmd == "INIT") {
                init(data[0]).then(function() {
                    self.postMessage(data.result);
                });
            } else if (data[0].cmd == "TERMINATE") {
                self.close();
            } else {
                const res = runTask(data);
                self.postMessage(res);
            }
        };
    }

    async function init(data) {
        const code = new Uint8Array(data.code);
        const wasmModule = await WebAssembly.compile(code);
        memory = new WebAssembly.Memory({initial:data.init, maximum: MAXMEM});

        instance = await WebAssembly.instantiate(wasmModule, {
            env: {
                "memory": memory
            }
        });
    }



    function alloc(length) {
        const u32 = new Uint32Array(memory.buffer, 0, 1);
        while (u32[0] & 3) u32[0]++;  // Return always aligned pointers
        const res = u32[0];
        u32[0] += length;
        if (u32[0] + length > memory.buffer.byteLength) {
            const currentPages = memory.buffer.byteLength / 0x10000;
            let requiredPages = Math.floor((u32[0] + length) / 0x10000)+1;
            if (requiredPages>MAXMEM) requiredPages=MAXMEM;
            memory.grow(requiredPages-currentPages);
        }
        return res;
    }

    function allocBuffer(buffer) {
        const p = alloc(buffer.byteLength);
        setBuffer(p, buffer);
        return p;
    }

    function getBuffer(pointer, length) {
        const u8 = new Uint8Array(memory.buffer);
        return new Uint8Array(u8.buffer, u8.byteOffset + pointer, length);
    }

    function setBuffer(pointer, buffer) {
        const u8 = new Uint8Array(memory.buffer);
        u8.set(new Uint8Array(buffer), pointer);
    }

    function runTask(task) {
        if (task[0].cmd == "INIT") {
            return init(task[0]);
        }
        const ctx = {
            vars: [],
            out: []
        };
        const u32a = new Uint32Array(memory.buffer, 0, 1);
        const oldAlloc = u32a[0];
        for (let i=0; i<task.length; i++) {
            switch (task[i].cmd) {
            case "ALLOCSET":
                ctx.vars[task[i].var] = allocBuffer(task[i].buff);
                break;
            case "ALLOC":
                ctx.vars[task[i].var] = alloc(task[i].len);
                break;
            case "SET":
                setBuffer(ctx.vars[task[i].var], task[i].buff);
                break;
            case "CALL": {
                const params = [];
                for (let j=0; j<task[i].params.length; j++) {
                    const p = task[i].params[j];
                    if (typeof p.var !== "undefined") {
                        params.push(ctx.vars[p.var] + (p.offset || 0));
                    } else if (typeof p.val != "undefined") {
                        params.push(p.val);
                    }
                }
                instance.exports[task[i].fnName](...params);
                break;
            }
            case "GET":
                ctx.out[task[i].out] = getBuffer(ctx.vars[task[i].var], task[i].len).slice();
                break;
            default:
                throw new Error("Invalid cmd");
            }
        }
        const u32b = new Uint32Array(memory.buffer, 0, 1);
        u32b[0] = oldAlloc;
        return ctx.out;
    }


    return runTask;
})(self)`;if(globalThis?.Blob){let c=new TextEncoder().encode(vh),t=new Blob([c],{type:"application/javascript"});fd=URL.createObjectURL(t)}else fd="data:application/javascript;base64,"+globalThis.btoa(vh);gd=class{constructor(){this.actionQueue=[],this.oldPFree=0}startSyncOp(){if(this.oldPFree!=0)throw new Error("Sync operation in progress");this.oldPFree=this.u32[0]}endSyncOp(){if(this.oldPFree==0)throw new Error("No sync operation in progress");this.u32[0]=this.oldPFree,this.oldPFree=0}postAction(t,n,a,o){if(this.working[t])throw new Error("Posting a job t a working worker");return this.working[t]=!0,this.pendingDeferreds[t]=o||new is,this.workers[t].postMessage(n,a),this.pendingDeferreds[t].promise}processWorks(){for(let t=0;t<this.workers.length&&this.actionQueue.length>0;t++)if(this.working[t]==!1){let n=this.actionQueue.shift();this.postAction(t,n.data,n.transfers,n.deferred)}}queueAction(t,n){let a=new is;if(this.singleThread){let o=this.taskManager(t);a.resolve(o)}else this.actionQueue.push({data:t,transfers:n,deferred:a}),this.processWorks();return a.promise}resetMemory(){this.u32[0]=this.initalPFree}allocBuff(t){let n=this.alloc(t.byteLength);return this.setBuff(n,t),n}getBuff(t,n){return this.u8.slice(t,t+n)}setBuff(t,n){this.u8.set(new Uint8Array(n),t)}alloc(t){for(;this.u32[0]&3;)this.u32[0]++;let n=this.u32[0];return this.u32[0]+=t,n}async terminate(){for(let t=0;t<this.workers.length;t++)this.workers[t].postMessage([{cmd:"TERMINATE"}]);await t8(200)}};Sh=[1,1,1,1,2,3,4,5,6,7,7,8,9,10,11,12,13,13,14,15,16,16,17,17,17,17,17,17,17,17,17,17];pd=class{constructor(t){this.func=t,this.functionName=t.functionName,this.module=t.module}setLocal(t,n){let a=this.func.localIdxByName[t];if(a===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...n,33,...Dt(a)]}teeLocal(t,n){let a=this.func.localIdxByName[t];if(a===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[...n,34,...Dt(a)]}getLocal(t){let n=this.func.localIdxByName[t];if(n===void 0)throw new Error(`Local Variable not defined: Function: ${this.functionName} local: ${t} `);return[32,...Dt(n)]}i64_load8_s(t,n,a){let o=n||0,e=a===void 0?0:a;return[...t,48,e,...Dt(o)]}i64_load8_u(t,n,a){let o=n||0,e=a===void 0?0:a;return[...t,49,e,...Dt(o)]}i64_load16_s(t,n,a){let o=n||0,e=a===void 0?1:a;return[...t,50,e,...Dt(o)]}i64_load16_u(t,n,a){let o=n||0,e=a===void 0?1:a;return[...t,51,e,...Dt(o)]}i64_load32_s(t,n,a){let o=n||0,e=a===void 0?2:a;return[...t,52,e,...Dt(o)]}i64_load32_u(t,n,a){let o=n||0,e=a===void 0?2:a;return[...t,53,e,...Dt(o)]}i64_load(t,n,a){let o=n||0,e=a===void 0?3:a;return[...t,41,e,...Dt(o)]}i64_store(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=3,d=n):Array.isArray(a)?(e=n,h=3,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,55,h,...Dt(e)]}i64_store32(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=2,d=n):Array.isArray(a)?(e=n,h=2,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,62,h,...Dt(e)]}i64_store16(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=1,d=n):Array.isArray(a)?(e=n,h=1,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,61,h,...Dt(e)]}i64_store8(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=0,d=n):Array.isArray(a)?(e=n,h=0,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,60,h,...Dt(e)]}i32_load8_s(t,n,a){let o=n||0,e=a===void 0?0:a;return[...t,44,e,...Dt(o)]}i32_load8_u(t,n,a){let o=n||0,e=a===void 0?0:a;return[...t,45,e,...Dt(o)]}i32_load16_s(t,n,a){let o=n||0,e=a===void 0?1:a;return[...t,46,e,...Dt(o)]}i32_load16_u(t,n,a){let o=n||0,e=a===void 0?1:a;return[...t,47,e,...Dt(o)]}i32_load(t,n,a){let o=n||0,e=a===void 0?2:a;return[...t,40,e,...Dt(o)]}i32_store(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=2,d=n):Array.isArray(a)?(e=n,h=2,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,54,h,...Dt(e)]}i32_store16(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=1,d=n):Array.isArray(a)?(e=n,h=1,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,59,h,...Dt(e)]}i32_store8(t,n,a,o){let e,h,d;return Array.isArray(n)?(e=0,h=0,d=n):Array.isArray(a)?(e=n,h=0,d=a):Array.isArray(o)&&(e=n,h=a,d=o),[...t,...d,58,h,...Dt(e)]}call(t,...n){let a=this.module.functionIdxByName[t];if(a===void 0)throw new Error(`Function not defined: Function: ${t}`);return[...[].concat(...n),16,...Dt(a)]}call_indirect(t,...n){return[...[].concat(...n),...t,17,0,0]}if(t,n,a){return a?[...t,4,64,...n,5,...a,11]:[...t,4,64,...n,11]}block(t){return[2,64,...t,11]}loop(...t){return[3,64,...[].concat(...t),11]}br_if(t,n){return[...n,13,...Dt(t)]}br(t){return[12,...Dt(t)]}ret(t){return[...t,15]}drop(t){return[...t,26]}i64_const(t){return[66,...c8(t)]}i32_const(t){return[65,...Ld(t)]}i64_eqz(t){return[...t,80]}i64_eq(t,n){return[...t,...n,81]}i64_ne(t,n){return[...t,...n,82]}i64_lt_s(t,n){return[...t,...n,83]}i64_lt_u(t,n){return[...t,...n,84]}i64_gt_s(t,n){return[...t,...n,85]}i64_gt_u(t,n){return[...t,...n,86]}i64_le_s(t,n){return[...t,...n,87]}i64_le_u(t,n){return[...t,...n,88]}i64_ge_s(t,n){return[...t,...n,89]}i64_ge_u(t,n){return[...t,...n,90]}i64_add(t,n){return[...t,...n,124]}i64_sub(t,n){return[...t,...n,125]}i64_mul(t,n){return[...t,...n,126]}i64_div_s(t,n){return[...t,...n,127]}i64_div_u(t,n){return[...t,...n,128]}i64_rem_s(t,n){return[...t,...n,129]}i64_rem_u(t,n){return[...t,...n,130]}i64_and(t,n){return[...t,...n,131]}i64_or(t,n){return[...t,...n,132]}i64_xor(t,n){return[...t,...n,133]}i64_shl(t,n){return[...t,...n,134]}i64_shr_s(t,n){return[...t,...n,135]}i64_shr_u(t,n){return[...t,...n,136]}i64_extend_i32_s(t){return[...t,172]}i64_extend_i32_u(t){return[...t,173]}i64_clz(t){return[...t,121]}i64_ctz(t){return[...t,122]}i32_eqz(t){return[...t,69]}i32_eq(t,n){return[...t,...n,70]}i32_ne(t,n){return[...t,...n,71]}i32_lt_s(t,n){return[...t,...n,72]}i32_lt_u(t,n){return[...t,...n,73]}i32_gt_s(t,n){return[...t,...n,74]}i32_gt_u(t,n){return[...t,...n,75]}i32_le_s(t,n){return[...t,...n,76]}i32_le_u(t,n){return[...t,...n,77]}i32_ge_s(t,n){return[...t,...n,78]}i32_ge_u(t,n){return[...t,...n,79]}i32_add(t,n){return[...t,...n,106]}i32_sub(t,n){return[...t,...n,107]}i32_mul(t,n){return[...t,...n,108]}i32_div_s(t,n){return[...t,...n,109]}i32_div_u(t,n){return[...t,...n,110]}i32_rem_s(t,n){return[...t,...n,111]}i32_rem_u(t,n){return[...t,...n,112]}i32_and(t,n){return[...t,...n,113]}i32_or(t,n){return[...t,...n,114]}i32_xor(t,n){return[...t,...n,115]}i32_shl(t,n){return[...t,...n,116]}i32_shr_s(t,n){return[...t,...n,117]}i32_shr_u(t,n){return[...t,...n,118]}i32_rotl(t,n){return[...t,...n,119]}i32_rotr(t,n){return[...t,...n,120]}i32_wrap_i64(t){return[...t,167]}i32_clz(t){return[...t,103]}i32_ctz(t){return[...t,104]}unreachable(){return[0]}current_memory(){return[63,0]}comment(){return[]}},ad={i32:127,i64:126,f32:125,f64:124,anyfunc:112,func:96,emptyblock:64},es=class{constructor(t,n,a,o,e){if(a=="import")this.fnType="import",this.moduleName=o,this.fieldName=e;else if(a=="internal")this.fnType="internal";else throw new Error("Invalid function fnType: "+a);this.module=t,this.fnName=n,this.params=[],this.locals=[],this.localIdxByName={},this.code=[],this.returnType=null,this.nextLocal=0}addParam(t,n){if(this.localIdxByName[t])throw new Error(`param already exists. Function: ${this.fnName}, Param: ${t} `);let a=this.nextLocal++;this.localIdxByName[t]=a,this.params.push({type:n})}addLocal(t,n,a){let o=a||1;if(this.localIdxByName[t])throw new Error(`local already exists. Function: ${this.fnName}, Param: ${t} `);let e=this.nextLocal++;this.localIdxByName[t]=e,this.locals.push({type:n,length:o})}setReturnType(t){if(this.returnType)throw new Error(`returnType already defined. Function: ${this.fnName}`);this.returnType=t}getSignature(){let t=[...Dt(this.params.length),...this.params.map(a=>ad[a.type])],n=this.returnType?[1,ad[this.returnType]]:[0];return[96,...t,...n]}getBody(){let t=this.locals.map(a=>[...Dt(a.length),ad[a.type]]),n=[...Dt(this.locals.length),...[].concat(...t),...this.code,11];return[...Dt(n.length),...n]}addCode(...t){this.code.push(...[].concat(...t))}getCodeBuilder(){return new pd(this)}},cs=class{constructor(){this.functions=[],this.functionIdxByName={},this.nImportFunctions=0,this.nInternalFunctions=0,this.memory={pagesSize:1,moduleName:"env",fieldName:"memory"},this.free=8,this.datas=[],this.modules={},this.exports=[],this.functionsTable=[]}build(){return this._setSignatures(),new Uint8Array([...nd(1836278016),...nd(1),...this._buildType(),...this._buildImport(),...this._buildFunctionDeclarations(),...this._buildFunctionsTable(),...this._buildExports(),...this._buildElements(),...this._buildCode(),...this._buildData()])}addFunction(t){if(typeof this.functionIdxByName[t]<"u")throw new Error(`Function already defined: ${t}`);let n=this.functions.length;return this.functionIdxByName[t]=n,this.functions.push(new es(this,t,"internal")),this.nInternalFunctions++,this.functions[n]}addIimportFunction(t,n,a){if(typeof this.functionIdxByName[t]<"u")throw new Error(`Function already defined: ${t}`);if(this.functions.length>0&&this.functions[this.functions.length-1].type=="internal")throw new Error(`Import functions must be declared before internal: ${t}`);let o=a||t,e=this.functions.length;return this.functionIdxByName[t]=e,this.functions.push(new es(this,t,"import",n,o)),this.nImportFunctions++,this.functions[e]}setMemory(t,n,a){this.memory={pagesSize:t,moduleName:n||"env",fieldName:a||"memory"}}exportFunction(t,n){let a=n||t;if(typeof this.functionIdxByName[t]>"u")throw new Error(`Function not defined: ${t}`);let o=this.functionIdxByName[t];a!=t&&(this.functionIdxByName[a]=o),this.exports.push({exportName:a,idx:o})}addFunctionToTable(t){let n=this.functionIdxByName[t];this.functionsTable.push(n)}addData(t,n){this.datas.push({offset:t,bytes:n})}alloc(t,n){let a,o;(Array.isArray(t)||ArrayBuffer.isView(t))&&typeof n>"u"?(a=t.length,o=t):(a=t,o=n),a=(a-1>>3)+1<<3;let e=this.free;return this.free+=a,o&&this.addData(e,o),e}allocString(t){let a=new globalThis.TextEncoder().encode(t);return this.alloc([...a,0])}_setSignatures(){this.signatures=[];let t={};if(this.functionsTable.length>0){let n=this.functions[this.functionsTable[0]].getSignature(),a="s_"+Ih(n);t[a]=0,this.signatures.push(n)}for(let n=0;n<this.functions.length;n++){let a=this.functions[n].getSignature(),o="s_"+Ih(a);typeof t[o]>"u"&&(t[o]=this.signatures.length,this.signatures.push(a)),this.functions[n].signatureIdx=t[o]}}_buildSection(t,n){return[t,...Dt(n.length),...n]}_buildType(){return this._buildSection(1,[...Dt(this.signatures.length),...[].concat(...this.signatures)])}_buildImport(){let t=[];t.push([...Ki(this.memory.moduleName),...Ki(this.memory.fieldName),2,0,...Dt(this.memory.pagesSize)]);for(let n=0;n<this.nImportFunctions;n++)t.push([...Ki(this.functions[n].moduleName),...Ki(this.functions[n].fieldName),0,...Dt(this.functions[n].signatureIdx)]);return this._buildSection(2,Dt(t.length).concat(...t))}_buildFunctionDeclarations(){let t=[];for(let n=this.nImportFunctions;n<this.nImportFunctions+this.nInternalFunctions;n++)t.push(...Dt(this.functions[n].signatureIdx));return this._buildSection(3,[...Dt(t.length),...t])}_buildFunctionsTable(){return this.functionsTable.length==0?[]:this._buildSection(4,[...Dt(1),112,0,...Dt(this.functionsTable.length)])}_buildElements(){if(this.functionsTable.length==0)return[];let t=[];for(let n=0;n<this.functionsTable.length;n++)t.push(...Dt(this.functionsTable[n]));return this._buildSection(9,[...Dt(1),...Dt(0),65,...Ld(0),11,...Dt(this.functionsTable.length),...t])}_buildExports(){let t=[];for(let n=0;n<this.exports.length;n++)t.push([...Ki(this.exports[n].exportName),0,...Dt(this.exports[n].idx)]);return this._buildSection(7,Dt(t.length).concat(...t))}_buildCode(){let t=[];for(let n=this.nImportFunctions;n<this.nImportFunctions+this.nInternalFunctions;n++)t.push(this.functions[n].getBody());return this._buildSection(10,Dt(t.length).concat(...t))}_buildData(){let t=[];t.push([0,65,0,11,4,...nd(this.free)]);for(let n=0;n<this.datas.length;n++)t.push([0,65,...Ld(this.datas[n].offset),11,...Dt(this.datas[n].bytes.length),...this.datas[n].bytes]);return this._buildSection(11,Dt(t.length).concat(...t))}};globalThis.curve_bn128=null;globalThis.curve_bls12381=null;s8=Fn("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),l8=Fn("21888242871839275222246405745257275088548364400416034343698204186575808495617"),r8=Fn("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),d8=Fn("21888242871839275222246405745257275088696311157297823662689037894645226208583");f8=Qm,g8=J4});var gf=Sn((qw,ff)=>{"use strict";var L8={get:function(c,t){return isNaN(t)?c[t]:c.getElement(t)},set:function(c,t,n){return isNaN(t)?(c[t]=n,!0):c.setElement(t,n)}},Sd=class{constructor(t){this.length=t||0,this.arr=new Array(262144);for(let n=0;n<t;n+=262144)this.arr[n/262144]=new Array(Math.min(262144,t-n));return this}push(){for(let t=0;t<arguments.length;t++)this.setElement(this.length,arguments[t])}slice(t,n){let a=new Array(n-t);for(let o=t;o<n;o++)a[o-t]=this.getElement(o);return a}getElement(t){t=parseInt(t);let n=Math.floor(t/262144),a=t%262144;return this.arr[n]?this.arr[n][a]:void 0}setElement(t,n){t=parseInt(t);let a=Math.floor(t/262144);this.arr[a]||(this.arr[a]=new Array(262144));let o=t%262144;return this.arr[a][o]=n,t>=this.length&&(this.length=t+1),!0}getKeys(){let t=new _s;for(let n=0;n<this.arr.length;n++)if(this.arr[n])for(let a=0;a<this.arr[n].length;a++)typeof this.arr[n][a]<"u"&&t.push(n*262144+a);return t}},_s=class{constructor(t){let n=new Sd(t);return new Proxy(n,L8)}};ff.exports=_s});var Af=Sn(In=>{"use strict";Object.defineProperty(In,"__esModule",{value:!0});var Lf=(hf(),Ee(_f)),p8=gf(),b8=fl();function m8(c){return c&&typeof c=="object"&&"default"in c?c:{default:c}}function y8(c){if(c&&c.__esModule)return c;var t=Object.create(null);return c&&Object.keys(c).forEach(function(n){if(n!=="default"){var a=Object.getOwnPropertyDescriptor(c,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return c[n]}})}}),t.default=c,Object.freeze(t)}var qd=m8(p8),Tn=y8(b8),w8=1,F8=2,C8=3,hs=4,fs=5;async function pf(c,t,n){let a;typeof n=="object"?a=n:typeof n>"u"?a={singleThread:!1}:a={singleThread:n};let o={};if(await Tn.startReadUniqueSection(c,t,1),o.n8=await c.readULE32(),o.prime=await Tn.readBigInt(c,o.n8),a.F){if(a.F.p!=o.prime)throw new Error("Different Prime");o.F=a.F}else if(a.getFieldFromPrime)o.F=await a.getFieldFromPrime(o.prime,a.singleThread);else if(a.getCurveFromPrime)o.curve=await a.getCurveFromPrime(o.prime,a.singleThread),o.F=o.curve.Fr;else try{o.curve=await Lf.getCurveFromR(o.prime,a.singleThread),o.F=o.curve.Fr}catch{o.F=new Lf.F1Field(o.prime)}return o.nVars=await c.readULE32(),o.nOutputs=await c.readULE32(),o.nPubInputs=await c.readULE32(),o.nPrvInputs=await c.readULE32(),o.nLabels=await c.readULE64(),o.nConstraints=await c.readULE32(),o.useCustomGates=typeof t[hs]<"u"&&t[hs]!==null&&typeof t[fs]<"u"&&t[fs]!==null,await Tn.endReadSection(c),o}async function bf(c,t,n,a,o){let e;typeof a=="object"?e=a:typeof a>"u"?e={}:e={logger:a,loggerCtx:o};let h=await Tn.readSection(c,t,2),d=0,b;n.nConstraints>1<<20?b=new qd.default:b=[];for(let m=0;m<n.nConstraints;m++){e.logger&&m%1e5==0&&e.logger.info(`${e.loggerCtx}: Loading constraints: ${m}/${n.nConstraints}`);let B=l();b.push(B)}return b;function l(){let m=[];return m[0]=s(),m[1]=s(),m[2]=s(),m}function s(){let m={},B=h.slice(d,d+4);d+=4;let v=new DataView(B.buffer).getUint32(0,!0),M=h.slice(d,d+(4+n.n8)*v);d+=(4+n.n8)*v;let x=new DataView(M.buffer);for(let S=0;S<v;S++){let w=x.getUint32(S*(4+n.n8),!0),k=n.F.fromRprLE(M,S*(4+n.n8)+4);m[w]=k}return m}}async function mf(c,t,n,a,o){let e;typeof a=="object"?e=a:typeof a>"u"?e={}:e={logger:a,loggerCtx:o};let h=await Tn.readSection(c,t,3),d=0,b;n.nVars>1<<20?b=new qd.default:b=[];for(let s=0;s<n.nVars;s++){e.logger&&s%1e4==0&&e.logger.info(`${e.loggerCtx}: Loading map: ${s}/${n.nVars}`);let m=l();b.push(m)}return b;function l(){let s=h.slice(d,d+8);d+=8;let m=new DataView(s.buffer),B=m.getUint32(0,!0);return m.getUint32(4,!0)*4294967296+B}}async function yf(c,t,n){if(typeof n!="object")throw new Error("readR1csFd: options must be an object");n.loadConstraints="loadConstraints"in n?n.loadConstraints:!0,n.loadMap="loadMap"in n?n.loadMap:!1,n.loadCustomGates="loadCustomGates"in n?n.loadCustomGates:!0;let a=await pf(c,t,n);return n.loadConstraints&&(a.constraints=await bf(c,t,a,n)),n.loadMap&&(a.map=await mf(c,t,a,n)),n.loadCustomGates&&(a.useCustomGates?(a.customGates=await wf(c,t,a),a.customGatesUses=await Ff(c,t,n)):(a.customGates=[],a.customGatesUses=[])),a}async function B8(c,t,n,a,o,e){let h;typeof t=="object"?h=t:typeof t>"u"?h={loadConstraints:!0,loadMap:!1,loadCustomGates:!0}:h={loadConstraints:t,loadMap:n,singleThread:a,logger:o,loggerCtx:e};let{fd:d,sections:b}=await Tn.readBinFile(c,"r1cs",1,1<<25,1<<22),l=await yf(d,b,h);return await d.close(),l}async function wf(c,t,n){await Tn.startReadUniqueSection(c,t,hs);let a=await c.readULE32(),o=[];for(let e=0;e<a;e++){let h={};h.templateName=await c.readString();let d=await c.readULE32();h.parameters=Array(d);let b=await c.read(n.n8*d);for(let l=0;l<d;l++)h.parameters[l]=n.F.fromRprLE(b,l*n.n8,n.n8);o.push(h)}return await Tn.endReadSection(c),o}async function Ff(c,t,n){let a=await Tn.readSection(c,t,fs),o=new Uint32Array(a.buffer,a.byteOffset,a.byteLength/4),e=o[0],h=1,d;e>1<<20?d=new qd.default:d=[];for(let b=0;b<e;b++){n.logger&&b%1e5==0&&n.logger.info(`${n.loggerCtx}: Loading custom gate uses: ${b}/${e}`);let l={};l.id=o[h++];let s=o[h++];l.signals=[];for(let m=0;m<s;m++){let B=o[h++],p=o[h++];l.signals.push(p*4294967296+B)}d.push(l)}return d}async function Cf(c,t){await Tn.startWriteSection(c,1),await c.writeULE32(t.n8),await Tn.writeBigInt(c,t.prime,t.n8),await c.writeULE32(t.nVars),await c.writeULE32(t.nOutputs),await c.writeULE32(t.nPubInputs),await c.writeULE32(t.nPrvInputs),await c.writeULE64(t.nLabels),await c.writeULE32(t.constraints.length),await Tn.endWriteSection(c)}async function Bf(c,t,n,a){await Tn.startWriteSection(c,2);for(let e=0;e<t.constraints.length;e++)n&&e%1e4==0&&n.info(`${a}: writing constraint: ${e}/${t.constraints.length}`),await o(t.constraints[e]);await Tn.endWriteSection(c);function o(e){let h=t.n8,d=t.F||t.curve.Fr,b=Object.keys(e[0]),l=Object.keys(e[1]),s=Object.keys(e[2]),m=new Uint8Array((b.length+l.length+s.length)*(h+4)+12),B=new DataView(m.buffer),p=0;B.setUint32(p,b.length,!0),p+=4;for(let v=0;v<b.length;v++){let M=b[v];B.setUint32(p,M,!0),p+=4,d.toRprLE(m,p,e[0][M]),p+=h}B.setUint32(p,l.length,!0),p+=4;for(let v=0;v<l.length;v++){let M=l[v];B.setUint32(p,M,!0),p+=4,d.toRprLE(m,p,e[1][M]),p+=h}B.setUint32(p,s.length,!0),p+=4;for(let v=0;v<s.length;v++){let M=s[v];B.setUint32(p,M,!0),p+=4,d.toRprLE(m,p,e[2][M]),p+=h}return c.write(m)}}async function xf(c,t,n,a){if(await Tn.startWriteSection(c,3),t.map.length!=t.nVars)throw new Error("Invalid map size");for(let o=0;o<t.nVars;o++)n&&o%1e4==0&&n.info(`${a}: writing map: ${o}/${t.nVars}`),await c.writeULE64(t.map[o]);await Tn.endWriteSection(c)}async function x8(c,t,n,a){let o=await Tn.createBinFile(c,"r1cs",1,3,33554432,4194304);await Cf(o,t),await Bf(o,t,n,a),await xf(o,t,n,a),await o.close()}In.R1CS_FILE_CONSTRAINTS_SECTION=F8;In.R1CS_FILE_CUSTOM_GATES_LIST_SECTION=hs;In.R1CS_FILE_CUSTOM_GATES_USES_SECTION=fs;In.R1CS_FILE_HEADER_SECTION=w8;In.R1CS_FILE_WIRE2LABELID_SECTION=C8;In.readConstraints=bf;In.readCustomGatesListSection=wf;In.readCustomGatesUsesSection=Ff;In.readMap=mf;In.readR1cs=B8;In.readR1csFd=yf;In.readR1csHeader=pf;In.writeR1cs=x8;In.writeR1csConstraints=Bf;In.writeR1csHeader=Cf;In.writeR1csMap=xf});var vf=Sn(ca=>{"use strict";var A8=/[|\\{}()[\]^$+*?.]/g,E8=Object.prototype.hasOwnProperty,Id=function(c,t){return E8.apply(c,[t])};ca.escapeRegExpChars=function(c){return c?String(c).replace(A8,"\\$&"):""};var v8={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},S8=/[&<>'"]/g;function q8(c){return v8[c]||c}var I8=`var _ENCODE_HTML_RULES = {
      "&": "&amp;"
    , "<": "&lt;"
    , ">": "&gt;"
    , '"': "&#34;"
    , "'": "&#39;"
    }
  , _MATCH_HTML = /[&<>'"]/g;
function encode_char(c) {
  return _ENCODE_HTML_RULES[c] || c;
};
`;ca.escapeXML=function(c){return c==null?"":String(c).replace(S8,q8)};function Ef(){return Function.prototype.toString.call(this)+`;
`+I8}try{typeof Object.defineProperty=="function"?Object.defineProperty(ca.escapeXML,"toString",{value:Ef}):ca.escapeXML.toString=Ef}catch{console.warn("Unable to set escapeXML.toString (is the Function prototype frozen?)")}ca.shallowCopy=function(c,t){if(t=t||{},c!=null)for(var n in t)Id(t,n)&&(n==="__proto__"||n==="constructor"||(c[n]=t[n]));return c};ca.shallowCopyFromList=function(c,t,n){if(n=n||[],t=t||{},c!=null)for(var a=0;a<n.length;a++){var o=n[a];if(typeof t[o]<"u"){if(!Id(t,o)||o==="__proto__"||o==="constructor")continue;c[o]=t[o]}}return c};ca.cache={_data:{},set:function(c,t){this._data[c]=t},get:function(c){return this._data[c]},remove:function(c){delete this._data[c]},reset:function(){this._data={}}};ca.hyphenToCamel=function(c){return c.replace(/-[a-z]/g,function(t){return t[1].toUpperCase()})};ca.createNullProtoObjWherePossible=(function(){return typeof Object.create=="function"?function(){return Object.create(null)}:{__proto__:null}instanceof Object?function(){return{}}:function(){return{__proto__:null}}})();ca.hasOwnOnlyObject=function(c){var t=ca.createNullProtoObjWherePossible();for(var n in c)Id(c,n)&&(t[n]=c[n]);return t}});var Sf=Sn((Pw,O8)=>{O8.exports={name:"ejs",description:"Embedded JavaScript templates",keywords:["template","engine","ejs"],version:"3.1.10",author:"Matthew Eernisse <mde@fleegix.org> (http://fleegix.org)",license:"Apache-2.0",bin:{ejs:"./bin/cli.js"},main:"./lib/ejs.js",jsdelivr:"ejs.min.js",unpkg:"ejs.min.js",repository:{type:"git",url:"git://github.com/mde/ejs.git"},bugs:"https://github.com/mde/ejs/issues",homepage:"https://github.com/mde/ejs",dependencies:{jake:"^10.8.5"},devDependencies:{browserify:"^16.5.1",eslint:"^6.8.0","git-directory-deploy":"^1.5.1",jsdoc:"^4.0.2","lru-cache":"^4.0.1",mocha:"^10.2.0","uglify-js":"^3.3.16"},engines:{node:">=0.10.0"},scripts:{test:"npx jake test"}}});var Gf=Sn(sn=>{"use strict";var Pd=lo(),ee=lo(),Cn=vf(),qf=!1,P8=Sf().version,M8="<",R8=">",z8="%",zf="locals",T8="ejs",G8="(<%%|%%>|<%=|<%-|<%_|<%#|<%|%>|-%>|_%>)",Tf=["delimiter","scope","context","debug","compileDebug","client","_with","rmWhitespace","strict","filename","async"],k8=Tf.concat("cache"),If=/^\uFEFF/,Od=/^[a-zA-Z_$][0-9a-zA-Z_$]*$/;sn.cache=Cn.cache;sn.fileLoader=Pd.readFileSync;sn.localsName=zf;sn.promiseImpl=new Function("return this;")().Promise;sn.resolveInclude=function(c,t,n){var a=ee.dirname,o=ee.extname,e=ee.resolve,h=e(n?t:a(t),c),d=o(c);return d||(h+=".ejs"),h};function Of(c,t){var n;if(t.some(function(a){return n=sn.resolveInclude(c,a,!0),Pd.existsSync(n)}))return n}function U8(c,t){var n,a,o=t.views,e=/^[A-Za-z]+:\\|^\//.exec(c);if(e&&e.length)c=c.replace(/^\/*/,""),Array.isArray(t.root)?n=Of(c,t.root):n=sn.resolveInclude(c,t.root||"/",!0);else if(t.filename&&(a=sn.resolveInclude(c,t.filename),Pd.existsSync(a)&&(n=a)),!n&&Array.isArray(o)&&(n=Of(c,o)),!n&&typeof t.includer!="function")throw new Error('Could not find the include file "'+t.escapeFunction(c)+'"');return n}function ce(c,t){var n,a=c.filename,o=arguments.length>1;if(c.cache){if(!a)throw new Error("cache option requires a filename");if(n=sn.cache.get(a),n)return n;o||(t=Pf(a).toString().replace(If,""))}else if(!o){if(!a)throw new Error("Internal EJS error: no file name or template provided");t=Pf(a).toString().replace(If,"")}return n=sn.compile(t,c),c.cache&&sn.cache.set(a,n),n}function N8(c,t,n){var a;if(n){try{a=ce(c)(t)}catch(o){return n(o)}n(null,a)}else{if(typeof sn.promiseImpl=="function")return new sn.promiseImpl(function(o,e){try{a=ce(c)(t),o(a)}catch(h){e(h)}});throw new Error("Please provide a callback function")}}function Pf(c){return sn.fileLoader(c)}function $8(c,t){var n=Cn.shallowCopy(Cn.createNullProtoObjWherePossible(),t);if(n.filename=U8(c,n),typeof t.includer=="function"){var a=t.includer(c,n.filename);if(a&&(a.filename&&(n.filename=a.filename),a.template))return ce(n,a.template)}return ce(n)}function Mf(c,t,n,a,o){var e=t.split(`
`),h=Math.max(a-3,0),d=Math.min(e.length,a+3),b=o(n),l=e.slice(h,d).map(function(s,m){var B=m+h+1;return(B==a?" >> ":"    ")+B+"| "+s}).join(`
`);throw c.path=b,c.message=(b||"ejs")+":"+a+`
`+l+`

`+c.message,c}function Rf(c){return c.replace(/;(\s*$)/,"$1")}sn.compile=function(t,n){var a;return n&&n.scope&&(qf||(console.warn("`scope` option is deprecated and will be removed in EJS 3"),qf=!0),n.context||(n.context=n.scope),delete n.scope),a=new vn(t,n),a.compile()};sn.render=function(c,t,n){var a=t||Cn.createNullProtoObjWherePossible(),o=n||Cn.createNullProtoObjWherePossible();return arguments.length==2&&Cn.shallowCopyFromList(o,a,Tf),ce(o,c)(a)};sn.renderFile=function(){var c=Array.prototype.slice.call(arguments),t=c.shift(),n,a={filename:t},o,e;return typeof arguments[arguments.length-1]=="function"&&(n=c.pop()),c.length?(o=c.shift(),c.length?Cn.shallowCopy(a,c.pop()):(o.settings&&(o.settings.views&&(a.views=o.settings.views),o.settings["view cache"]&&(a.cache=!0),e=o.settings["view options"],e&&Cn.shallowCopy(a,e)),Cn.shallowCopyFromList(a,o,k8)),a.filename=t):o=Cn.createNullProtoObjWherePossible(),N8(a,o,n)};sn.Template=vn;sn.clearCache=function(){sn.cache.reset()};function vn(c,t){var n=Cn.hasOwnOnlyObject(t),a=Cn.createNullProtoObjWherePossible();this.templateText=c,this.mode=null,this.truncate=!1,this.currentLine=1,this.source="",a.client=n.client||!1,a.escapeFunction=n.escape||n.escapeFunction||Cn.escapeXML,a.compileDebug=n.compileDebug!==!1,a.debug=!!n.debug,a.filename=n.filename,a.openDelimiter=n.openDelimiter||sn.openDelimiter||M8,a.closeDelimiter=n.closeDelimiter||sn.closeDelimiter||R8,a.delimiter=n.delimiter||sn.delimiter||z8,a.strict=n.strict||!1,a.context=n.context,a.cache=n.cache||!1,a.rmWhitespace=n.rmWhitespace,a.root=n.root,a.includer=n.includer,a.outputFunctionName=n.outputFunctionName,a.localsName=n.localsName||sn.localsName||zf,a.views=n.views,a.async=n.async,a.destructuredLocals=n.destructuredLocals,a.legacyInclude=typeof n.legacyInclude<"u"?!!n.legacyInclude:!0,a.strict?a._with=!1:a._with=typeof n._with<"u"?n._with:!0,this.opts=a,this.regex=this.createRegex()}vn.modes={EVAL:"eval",ESCAPED:"escaped",RAW:"raw",COMMENT:"comment",LITERAL:"literal"};vn.prototype={createRegex:function(){var c=G8,t=Cn.escapeRegExpChars(this.opts.delimiter),n=Cn.escapeRegExpChars(this.opts.openDelimiter),a=Cn.escapeRegExpChars(this.opts.closeDelimiter);return c=c.replace(/%/g,t).replace(/</g,n).replace(/>/g,a),new RegExp(c)},compile:function(){var c,t,n=this.opts,a="",o="",e=n.escapeFunction,h,d=n.filename?JSON.stringify(n.filename):"undefined";if(!this.source){if(this.generateSource(),a+=`  var __output = "";
  function __append(s) { if (s !== undefined && s !== null) __output += s }
`,n.outputFunctionName){if(!Od.test(n.outputFunctionName))throw new Error("outputFunctionName is not a valid JS identifier.");a+="  var "+n.outputFunctionName+` = __append;
`}if(n.localsName&&!Od.test(n.localsName))throw new Error("localsName is not a valid JS identifier.");if(n.destructuredLocals&&n.destructuredLocals.length){for(var b="  var __locals = ("+n.localsName+` || {}),
`,l=0;l<n.destructuredLocals.length;l++){var s=n.destructuredLocals[l];if(!Od.test(s))throw new Error("destructuredLocals["+l+"] is not a valid JS identifier.");l>0&&(b+=`,
  `),b+=s+" = __locals."+s}a+=b+`;
`}n._with!==!1&&(a+="  with ("+n.localsName+` || {}) {
`,o+=`  }
`),o+=`  return __output;
`,this.source=a+this.source+o}n.compileDebug?c=`var __line = 1
  , __lines = `+JSON.stringify(this.templateText)+`
  , __filename = `+d+`;
try {
`+this.source+`} catch (e) {
  rethrow(e, __lines, __filename, __line, escapeFn);
}
`:c=this.source,n.client&&(c="escapeFn = escapeFn || "+e.toString()+`;
`+c,n.compileDebug&&(c="rethrow = rethrow || "+Mf.toString()+`;
`+c)),n.strict&&(c=`"use strict";
`+c),n.debug&&console.log(c),n.compileDebug&&n.filename&&(c=c+`
//# sourceURL=`+d+`
`);try{if(n.async)try{h=new Function("return (async function(){}).constructor;")()}catch(v){throw v instanceof SyntaxError?new Error("This environment does not support async/await"):v}else h=Function;t=new h(n.localsName+", escapeFn, include, rethrow",c)}catch(v){throw v instanceof SyntaxError&&(n.filename&&(v.message+=" in "+n.filename),v.message+=` while compiling ejs

`,v.message+=`If the above error is not helpful, you may want to try EJS-Lint:
`,v.message+="https://github.com/RyanZim/EJS-Lint",n.async||(v.message+=`
`,v.message+="Or, if you meant to create an async function, pass `async: true` as an option.")),v}var m=n.client?t:function(M){var x=function(S,w){var k=Cn.shallowCopy(Cn.createNullProtoObjWherePossible(),M);return w&&(k=Cn.shallowCopy(k,w)),$8(S,n)(k)};return t.apply(n.context,[M||Cn.createNullProtoObjWherePossible(),e,x,Mf])};if(n.filename&&typeof Object.defineProperty=="function"){var B=n.filename,p=ee.basename(B,ee.extname(B));try{Object.defineProperty(m,"name",{value:p,writable:!1,enumerable:!1,configurable:!0})}catch{}}return m},generateSource:function(){var c=this.opts;c.rmWhitespace&&(this.templateText=this.templateText.replace(/[\r\n]+/g,`
`).replace(/^\s+|\s+$/gm,"")),this.templateText=this.templateText.replace(/[ \t]*<%_/gm,"<%_").replace(/_%>[ \t]*/gm,"_%>");var t=this,n=this.parseTemplateText(),a=this.opts.delimiter,o=this.opts.openDelimiter,e=this.opts.closeDelimiter;n&&n.length&&n.forEach(function(h,d){var b;if(h.indexOf(o+a)===0&&h.indexOf(o+a+a)!==0&&(b=n[d+2],!(b==a+e||b=="-"+a+e||b=="_"+a+e)))throw new Error('Could not find matching close tag for "'+h+'".');t.scanLine(h)})},parseTemplateText:function(){for(var c=this.templateText,t=this.regex,n=t.exec(c),a=[],o;n;)o=n.index,o!==0&&(a.push(c.substring(0,o)),c=c.slice(o)),a.push(n[0]),c=c.slice(n[0].length),n=t.exec(c);return c&&a.push(c),a},_addOutput:function(c){if(this.truncate&&(c=c.replace(/^(?:\r\n|\r|\n)/,""),this.truncate=!1),!c)return c;c=c.replace(/\\/g,"\\\\"),c=c.replace(/\n/g,"\\n"),c=c.replace(/\r/g,"\\r"),c=c.replace(/"/g,'\\"'),this.source+='    ; __append("'+c+`")
`},scanLine:function(c){var t=this,n=this.opts.delimiter,a=this.opts.openDelimiter,o=this.opts.closeDelimiter,e=0;switch(e=c.split(`
`).length-1,c){case a+n:case a+n+"_":this.mode=vn.modes.EVAL;break;case a+n+"=":this.mode=vn.modes.ESCAPED;break;case a+n+"-":this.mode=vn.modes.RAW;break;case a+n+"#":this.mode=vn.modes.COMMENT;break;case a+n+n:this.mode=vn.modes.LITERAL,this.source+='    ; __append("'+c.replace(a+n+n,a+n)+`")
`;break;case n+n+o:this.mode=vn.modes.LITERAL,this.source+='    ; __append("'+c.replace(n+n+o,n+o)+`")
`;break;case n+o:case"-"+n+o:case"_"+n+o:this.mode==vn.modes.LITERAL&&this._addOutput(c),this.mode=null,this.truncate=c.indexOf("-")===0||c.indexOf("_")===0;break;default:if(this.mode){switch(this.mode){case vn.modes.EVAL:case vn.modes.ESCAPED:case vn.modes.RAW:c.lastIndexOf("//")>c.lastIndexOf(`
`)&&(c+=`
`)}switch(this.mode){case vn.modes.EVAL:this.source+="    ; "+c+`
`;break;case vn.modes.ESCAPED:this.source+="    ; __append(escapeFn("+Rf(c)+`))
`;break;case vn.modes.RAW:this.source+="    ; __append("+Rf(c)+`)
`;break;case vn.modes.COMMENT:break;case vn.modes.LITERAL:this._addOutput(c);break}}else this._addOutput(c)}t.opts.compileDebug&&e&&(this.currentLine+=e,this.source+="    ; __line = "+this.currentLine+`
`)}};sn.escapeXML=Cn.escapeXML;sn.__express=sn.renderFile;sn.VERSION=P8;sn.name=T8;typeof window<"u"&&(window.ejs=sn)});var Qf=Sn(dn=>{"use strict";Object.defineProperty(dn,"__esModule",{value:!0});dn.shake256=dn.shake128=dn.keccak_512=dn.keccak_384=dn.keccak_256=dn.keccak_224=dn.sha3_512=dn.sha3_384=dn.sha3_256=dn.sha3_224=dn.Keccak=void 0;dn.keccakP=Vf;var le=er(),kn=zo(),Z8=BigInt(0),se=BigInt(1),j8=BigInt(2),V8=BigInt(7),W8=BigInt(256),Q8=BigInt(113),Nf=[],$f=[],Zf=[];for(let c=0,t=se,n=1,a=0;c<24;c++){[n,a]=[a,(2*n+3*a)%5],Nf.push(2*(5*a+n)),$f.push((c+1)*(c+2)/2%64);let o=Z8;for(let e=0;e<7;e++)t=(t<<se^(t>>V8)*Q8)%W8,t&j8&&(o^=se<<(se<<BigInt(e))-se);Zf.push(o)}var jf=(0,le.split)(Zf,!0),X8=jf[0],H8=jf[1],kf=(c,t,n)=>n>32?(0,le.rotlBH)(c,t,n):(0,le.rotlSH)(c,t,n),Uf=(c,t,n)=>n>32?(0,le.rotlBL)(c,t,n):(0,le.rotlSL)(c,t,n);function Vf(c,t=24){let n=new Uint32Array(10);for(let a=24-t;a<24;a++){for(let h=0;h<10;h++)n[h]=c[h]^c[h+10]^c[h+20]^c[h+30]^c[h+40];for(let h=0;h<10;h+=2){let d=(h+8)%10,b=(h+2)%10,l=n[b],s=n[b+1],m=kf(l,s,1)^n[d],B=Uf(l,s,1)^n[d+1];for(let p=0;p<50;p+=10)c[h+p]^=m,c[h+p+1]^=B}let o=c[2],e=c[3];for(let h=0;h<24;h++){let d=$f[h],b=kf(o,e,d),l=Uf(o,e,d),s=Nf[h];o=c[s],e=c[s+1],c[s]=b,c[s+1]=l}for(let h=0;h<50;h+=10){for(let d=0;d<10;d++)n[d]=c[h+d];for(let d=0;d<10;d++)c[h+d]^=~n[(d+2)%10]&n[(d+4)%10]}c[0]^=X8[a],c[1]^=H8[a]}(0,kn.clean)(n)}var re=class c extends kn.Hash{constructor(t,n,a,o=!1,e=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=n,this.outputLen=a,this.enableXOF=o,this.rounds=e,(0,kn.anumber)(a),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=(0,kn.u32)(this.state)}clone(){return this._cloneInto()}keccak(){(0,kn.swap32IfBE)(this.state32),Vf(this.state32,this.rounds),(0,kn.swap32IfBE)(this.state32),this.posOut=0,this.pos=0}update(t){(0,kn.aexists)(this),t=(0,kn.toBytes)(t),(0,kn.abytes)(t);let{blockLen:n,state:a}=this,o=t.length;for(let e=0;e<o;){let h=Math.min(n-this.pos,o-e);for(let d=0;d<h;d++)a[this.pos++]^=t[e++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:n,pos:a,blockLen:o}=this;t[a]^=n,(n&128)!==0&&a===o-1&&this.keccak(),t[o-1]^=128,this.keccak()}writeInto(t){(0,kn.aexists)(this,!1),(0,kn.abytes)(t),this.finish();let n=this.state,{blockLen:a}=this;for(let o=0,e=t.length;o<e;){this.posOut>=a&&this.keccak();let h=Math.min(a-this.posOut,e-o);t.set(n.subarray(this.posOut,this.posOut+h),o),this.posOut+=h,o+=h}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return(0,kn.anumber)(t),this.xofInto(new Uint8Array(t))}digestInto(t){if((0,kn.aoutput)(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,(0,kn.clean)(this.state)}_cloneInto(t){let{blockLen:n,suffix:a,outputLen:o,rounds:e,enableXOF:h}=this;return t||(t=new c(n,a,o,h,e)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=e,t.suffix=a,t.outputLen=o,t.enableXOF=h,t.destroyed=this.destroyed,t}};dn.Keccak=re;var Ya=(c,t,n)=>(0,kn.createHasher)(()=>new re(t,c,n));dn.sha3_224=Ya(6,144,224/8);dn.sha3_256=Ya(6,136,256/8);dn.sha3_384=Ya(6,104,384/8);dn.sha3_512=Ya(6,72,512/8);dn.keccak_224=Ya(1,144,224/8);dn.keccak_256=Ya(1,136,256/8);dn.keccak_384=Ya(1,104,384/8);dn.keccak_512=Ya(1,72,512/8);var Wf=(c,t,n)=>(0,kn.createXOFer)((a={})=>new re(t,c,a.dkLen===void 0?n:a.dkLen,!0));dn.shake128=Wf(31,168,128/8);dn.shake256=Wf(31,136,256/8)});var pw=Sn(Ea=>{Object.defineProperty(Ea,"__esModule",{value:!0});var Gt=fl(),vt=(B_(),Ee(C_)),rn=s3(),e0=zo(),D8=lo(),K8=lo(),J8=_l(),c0=uh(),ni=Af(),Y8=Gf(),t6=Qf();function t2(c){return c&&typeof c=="object"&&"default"in c?c:{default:c}}function s0(c){if(c&&c.__esModule)return c;var t=Object.create(null);return c&&Object.keys(c).forEach(function(n){if(n!=="default"){var a=Object.getOwnPropertyDescriptor(c,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return c[n]}})}}),t.default=c,Object.freeze(t)}var Ft=s0(Gt),n6=t2(D8),l0=t2(K8),la=s0(J8),r0=t2(Y8),a6=vt.Scalar.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),o6=vt.Scalar.e("21888242871839275222246405745257275088548364400416034343698204186575808495617"),i6=vt.Scalar.e("1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab",16),e6=vt.Scalar.e("21888242871839275222246405745257275088696311157297823662689037894645226208583");async function d0(c,t){let n,a=t&&t.singleThread;if(vt.Scalar.eq(c,o6))n=await vt.buildBn128(a);else if(vt.Scalar.eq(c,a6))n=await vt.buildBls12381(a);else throw new Error(`Curve not supported: ${vt.Scalar.toString(c)}`);return n}async function Kn(c,t){let n,a=t&&t.singleThread;if(vt.Scalar.eq(c,e6))n=await vt.buildBn128(a);else if(vt.Scalar.eq(c,i6))n=await vt.buildBls12381(a);else throw new Error(`Curve not supported: ${vt.Scalar.toString(c)}`);return n}async function yo(c,t){let n,a=t&&t.singleThread,o=e(c);if(["BN128","BN254","ALTBN128"].indexOf(o)>=0)n=await vt.buildBn128(a);else if(["BLS12381"].indexOf(o)>=0)n=await vt.buildBls12381(a);else throw new Error(`Curve not supported: ${c}`);return n;function e(h){return h.toUpperCase().match(/[A-Za-z0-9]+/g).join("")}}var c6=Object.freeze({__proto__:null,getCurveFromR:d0,getCurveFromQ:Kn,getCurveFromName:yo});function ao(c){return((c&4294901760)!==0?(c&=4294901760,16):0)|((c&4278255360)!==0?(c&=4278255360,8):0)|((c&4042322160)!==0?(c&=4042322160,4):0)|((c&3435973836)!==0?(c&=3435973836,2):0)|(c&2863311530)!==0}function hn(c,t){let n=new DataView(c.buffer,c.byteOffset,c.byteLength),a="";for(let o=0;o<4;o++){o>0&&(a+=`
`),a+="		";for(let e=0;e<4;e++)e>0&&(a+=" "),a+=n.getUint32(o*16+e*4).toString(16).padStart(8,"0")}return t&&(a=t+`
`+a),a}function to(c,t){if(c.byteLength!=t.byteLength)return!1;for(var n=new Int8Array(c),a=new Int8Array(t),o=0;o!=c.byteLength;o++)if(n[o]!=a[o])return!1;return!0}function s6(c){return c.clone()}function u0(c){let t=c.subarray(0,128),n=e0.u32(c.subarray(128)),a=rn.blake2b.create({dkLen:64});a.buffer.set(t),a.v0l=n[0]|0,a.v0h=n[1]|0,a.v1l=n[2]|0,a.v1h=n[3]|0,a.v2l=n[4]|0,a.v2h=n[5]|0,a.v3l=n[6]|0,a.v3h=n[7]|0,a.v4l=n[8]|0,a.v4h=n[9]|0,a.v5l=n[10]|0,a.v5h=n[11]|0,a.v6l=n[12]|0,a.v6h=n[13]|0,a.v7l=n[14]|0,a.v7h=n[15]|0;let o=2**32,e=n[16]+n[17]*o,h=n[18]+n[19]*o;return a.length=e+h,a.pos=h,a}function n2(c){let t=new Uint8Array(216),n=e0.u32(t.subarray(128));return t.set(c.buffer),n[0]=c.v0l,n[1]=c.v0h,n[2]=c.v1l,n[3]=c.v1h,n[4]=c.v2l,n[5]=c.v2h,n[6]=c.v3l,n[7]=c.v3h,n[8]=c.v4l,n[9]=c.v4h,n[10]=c.v5l,n[11]=c.v5h,n[12]=c.v6l,n[13]=c.v6h,n[14]=c.v7l,n[15]=c.v7h,n[18]=c.pos,n[16]=c.length-c.pos,t}async function _0(c,t,n,a,o){return c.G1.isZero(t)||c.G1.isZero(n)||c.G2.isZero(a)||c.G2.isZero(o)?!1:await c.pairingEq(t,o,c.G1.neg(n),a)}function l6(){if(process.browser)return window.prompt("Enter a random text. (Entropy): ","");{let c=n6.default.createInterface({input:process.stdin,output:process.stdout});return new Promise(t=>{c.question("Enter a random text. (Entropy): ",n=>t(n))})}}function Jo(c){let t=new Uint8Array(c);return process.browser?globalThis.crypto.getRandomValues(t):l0.default.randomFillSync(t),t}async function r6(c){if(process.browser){let t=await globalThis.crypto.subtle.digest("SHA-256",c.buffer);return new Uint8Array(t)}else return l0.default.createHash("sha256").update(c).digest()}function bs(c,t){return new DataView(c.buffer).getUint32(t,!1)}async function Cs(c){for(;!c;)c=await l6();let t=rn.blake2b.create(64);t.update(Jo(64));let n=new TextEncoder;t.update(n.encode(c));let a=t.digest(),o=[];for(let h=0;h<8;h++)o[h]=bs(a,h*4);return new vt.ChaCha(o)}async function a2(c,t){let n,a;t<32?(n=1<<t>>>0,a=1):(n=4294967296,a=1<<t-32>>>0);let o=c;for(let b=0;b<a;b++)for(let l=0;l<n;l++)o=await r6(o);let e=new DataView(o.buffer,o.byteOffset,o.byteLength),h=[];for(let b=0;b<8;b++)h[b]=e.getUint32(b*4,!1);return new vt.ChaCha(h)}function h0(c){return c instanceof Uint8Array?c:(c.slice(0,2)=="0x"&&(c=c.slice(2)),new Uint8Array(c.match(/[\da-f]{2}/gi).map(function(t){return parseInt(t,16)})))}function f0(c){return Array.prototype.map.call(c,function(t){return("0"+(t&255).toString(16)).slice(-2)}).join("")}function ms(c,t){if(t instanceof Uint8Array)return c.toString(t);if(Array.isArray(t))return t.map(ms.bind(null,c));if(typeof t=="object"){let n={};return Object.keys(t).forEach(o=>{n[o]=ms(c,t[o])}),n}else return typeof t=="bigint"||t.eq!==void 0?t.toString(10):t}var Xf=1,d6=1,u6=2,Fe=10,_6=3,h6=17,Wd=2,ys=3,Qd=4,Xd=5,Hd=6,ue=7,_e=8,he=9,fe=10,ge=11,Le=12,pe=13,be=14,Dd=15,ws=16,Kd=17;async function o2(c,t){await Ft.startWriteSection(c,1),await c.writeULE32(1),await Ft.endWriteSection(c);let n=await Kn(t.q);await Ft.startWriteSection(c,2);let a=n.q,o=(Math.floor((vt.Scalar.bitLength(a)-1)/64)+1)*8,e=n.r,h=(Math.floor((vt.Scalar.bitLength(e)-1)/64)+1)*8;await c.writeULE32(o),await Ft.writeBigInt(c,a,o),await c.writeULE32(h),await Ft.writeBigInt(c,e,h),await c.writeULE32(t.nVars),await c.writeULE32(t.nPublic),await c.writeULE32(t.domainSize),await Yo(c,n,t.vk_alpha_1),await Yo(c,n,t.vk_beta_1),await Ls(c,n,t.vk_beta_2),await Ls(c,n,t.vk_gamma_2),await Yo(c,n,t.vk_delta_1),await Ls(c,n,t.vk_delta_2),await Ft.endWriteSection(c)}async function Yo(c,t,n){let a=new Uint8Array(t.G1.F.n8*2);t.G1.toRprLEM(a,0,n),await c.write(a)}async function Ls(c,t,n){let a=new Uint8Array(t.G2.F.n8*2);t.G2.toRprLEM(a,0,n),await c.write(a)}async function xn(c,t,n){let a=await c.read(t.G1.F.n8*2),o=t.G1.fromRprLEM(a,0);return n?t.G1.toObject(o):o}async function mo(c,t,n){let a=await c.read(t.G2.F.n8*2),o=t.G2.fromRprLEM(a,0);return n?t.G2.toObject(o):o}async function La(c,t,n,a){await Ft.startReadUniqueSection(c,t,1);let o=await c.readULE32();if(await Ft.endReadSection(c),o===d6)return await f6(c,t,n,a);if(o===u6)return await g6(c,t,n,a);if(o===Fe)return await L6(c,t,n,a);throw new Error("Protocol not supported: ")}async function f6(c,t,n,a){let o={};o.protocol="groth16",await Ft.startReadUniqueSection(c,t,2);let e=await c.readULE32();o.n8q=e,o.q=await Ft.readBigInt(c,e);let h=await c.readULE32();return o.n8r=h,o.r=await Ft.readBigInt(c,h),o.curve=await Kn(o.q,a),o.nVars=await c.readULE32(),o.nPublic=await c.readULE32(),o.domainSize=await c.readULE32(),o.power=ao(o.domainSize),o.vk_alpha_1=await xn(c,o.curve,n),o.vk_beta_1=await xn(c,o.curve,n),o.vk_beta_2=await mo(c,o.curve,n),o.vk_gamma_2=await mo(c,o.curve,n),o.vk_delta_1=await xn(c,o.curve,n),o.vk_delta_2=await mo(c,o.curve,n),await Ft.endReadSection(c),o}async function g6(c,t,n,a){let o={};o.protocol="plonk",await Ft.startReadUniqueSection(c,t,2);let e=await c.readULE32();o.n8q=e,o.q=await Ft.readBigInt(c,e);let h=await c.readULE32();return o.n8r=h,o.r=await Ft.readBigInt(c,h),o.curve=await Kn(o.q,a),o.nVars=await c.readULE32(),o.nPublic=await c.readULE32(),o.domainSize=await c.readULE32(),o.power=ao(o.domainSize),o.nAdditions=await c.readULE32(),o.nConstraints=await c.readULE32(),o.k1=await c.read(h),o.k2=await c.read(h),o.Qm=await xn(c,o.curve,n),o.Ql=await xn(c,o.curve,n),o.Qr=await xn(c,o.curve,n),o.Qo=await xn(c,o.curve,n),o.Qc=await xn(c,o.curve,n),o.S1=await xn(c,o.curve,n),o.S2=await xn(c,o.curve,n),o.S3=await xn(c,o.curve,n),o.X_2=await mo(c,o.curve,n),await Ft.endReadSection(c),o}async function L6(c,t,n,a){let o={};o.protocol="fflonk",o.protocolId=Fe,await Ft.startReadUniqueSection(c,t,Wd);let e=await c.readULE32();o.n8q=e,o.q=await Ft.readBigInt(c,e),o.curve=await Kn(o.q,a);let h=await c.readULE32();return o.n8r=h,o.r=await Ft.readBigInt(c,h),o.nVars=await c.readULE32(),o.nPublic=await c.readULE32(),o.domainSize=await c.readULE32(),o.power=ao(o.domainSize),o.nAdditions=await c.readULE32(),o.nConstraints=await c.readULE32(),o.k1=await c.read(h),o.k2=await c.read(h),o.w3=await c.read(h),o.w4=await c.read(h),o.w8=await c.read(h),o.wr=await c.read(h),o.X_2=await mo(c,o.curve,n),o.C0=await xn(c,o.curve,n),await Ft.endReadSection(c),o}async function p6(c,t){let{fd:n,sections:a}=await Ft.readBinFile(c,"zkey",1),o=await La(n,a,t),e=new vt.F1Field(o.r),h=vt.Scalar.mod(vt.Scalar.shl(1,o.n8r*8),o.r),d=e.inv(h),b=e.mul(d,d),l=await Kn(o.q);await Ft.startReadUniqueSection(n,a,3),o.IC=[];for(let B=0;B<=o.nPublic;B++){let p=await xn(n,l,t);o.IC.push(p)}await Ft.endReadSection(n),await Ft.startReadUniqueSection(n,a,4);let s=await n.readULE32();o.ccoefs=[];for(let B=0;B<s;B++){let p=await n.readULE32(),v=await n.readULE32(),M=await n.readULE32(),x=await m();o.ccoefs.push({matrix:p,constraint:v,signal:M,value:x})}await Ft.endReadSection(n),await Ft.startReadUniqueSection(n,a,5),o.A=[];for(let B=0;B<o.nVars;B++){let p=await xn(n,l,t);o.A[B]=p}await Ft.endReadSection(n),await Ft.startReadUniqueSection(n,a,6),o.B1=[];for(let B=0;B<o.nVars;B++){let p=await xn(n,l,t);o.B1[B]=p}await Ft.endReadSection(n),await Ft.startReadUniqueSection(n,a,7),o.B2=[];for(let B=0;B<o.nVars;B++){let p=await mo(n,l,t);o.B2[B]=p}await Ft.endReadSection(n),await Ft.startReadUniqueSection(n,a,8),o.C=[];for(let B=o.nPublic+1;B<o.nVars;B++){let p=await xn(n,l,t);o.C[B]=p}await Ft.endReadSection(n),await Ft.startReadUniqueSection(n,a,9),o.hExps=[];for(let B=0;B<o.domainSize;B++){let p=await xn(n,l,t);o.hExps.push(p)}return await Ft.endReadSection(n),await n.close(),o;async function m(){let B=await Ft.readBigInt(n,o.n8r);return e.mul(B,b)}}async function b6(c,t,n){let a={delta:{}};a.deltaAfter=await xn(c,t,n),a.delta.g1_s=await xn(c,t,n),a.delta.g1_sx=await xn(c,t,n),a.delta.g2_spx=await mo(c,t,n),a.transcript=await c.read(64),a.type=await c.readULE32();let o=await c.readULE32(),e=c.pos,h=0;for(;c.pos-e<o;){let d=await c.read(1);if(d[0]<=h)throw new Error("Parameters in the contribution must be sorted");if(h=d[0],d[0]==1){let b=await c.read(1),l=await c.read(b[0]);a.name=new TextDecoder().decode(l)}else if(d[0]==2){let b=await c.read(1);a.numIterationsExp=b[0]}else if(d[0]==3){let b=await c.read(1);a.beaconHash=await c.read(b[0])}else throw new Error("Parameter not recognized")}if(c.pos!=e+o)throw new Error("Parameters do not match");return a}async function ti(c,t,n){await Ft.startReadUniqueSection(c,n,10);let a={contributions:[]};a.csHash=await c.read(64);let o=await c.readULE32();for(let e=0;e<o;e++){let h=await b6(c,t);a.contributions.push(h)}return await Ft.endReadSection(c),a}async function m6(c,t,n){await Yo(c,t,n.deltaAfter),await Yo(c,t,n.delta.g1_s),await Yo(c,t,n.delta.g1_sx),await Ls(c,t,n.delta.g2_spx),await c.write(n.transcript),await c.writeULE32(n.type||0);let a=[];if(n.name){a.push(1);let o=new TextEncoder("utf-8").encode(n.name.substring(0,64));a.push(o.byteLength);for(let e=0;e<o.byteLength;e++)a.push(o[e])}if(n.type==1){a.push(2),a.push(n.numIterationsExp),a.push(3),a.push(n.beaconHash.byteLength);for(let o=0;o<n.beaconHash.byteLength;o++)a.push(n.beaconHash[o])}if(a.length>0){let o=new Uint8Array(a);await c.writeULE32(o.byteLength),await c.write(o)}else await c.writeULE32(0)}async function i2(c,t,n){await Ft.startWriteSection(c,10),await c.write(n.csHash),await c.writeULE32(n.contributions.length);for(let a=0;a<n.contributions.length;a++)await m6(c,t,n.contributions[a]);await Ft.endWriteSection(c)}function ga(c,t,n){let a=new Uint8Array(t.G1.F.n8*2);t.G1.toRprUncompressed(a,0,n),c.update(a)}function y6(c,t,n){let a=new Uint8Array(t.G2.F.n8*2);t.G2.toRprUncompressed(a,0,n),c.update(a)}function no(c,t,n){ga(c,t,n.deltaAfter),ga(c,t,n.delta.g1_s),ga(c,t,n.delta.g1_sx),y6(c,t,n.delta.g2_spx),c.update(n.transcript)}async function w6(c,t,n){await Ft.startWriteSection(c,1);let a=(Math.floor((vt.Scalar.bitLength(n)-1)/64)+1)*8;await c.writeULE32(a),await Ft.writeBigInt(c,n,a),await c.writeULE32(t.length),await Ft.endWriteSection(c),await Ft.startWriteSection(c,2);for(let o=0;o<t.length;o++)await Ft.writeBigInt(c,t[o],a);await Ft.endWriteSection(c,2)}async function F6(c,t,n){await Ft.startWriteSection(c,1);let a=(Math.floor((vt.Scalar.bitLength(n)-1)/64)+1)*8;if(await c.writeULE32(a),await Ft.writeBigInt(c,n,a),t.byteLength%a!=0)throw new Error("Invalid witness length");await c.writeULE32(t.byteLength/a),await Ft.endWriteSection(c),await Ft.startWriteSection(c,2),await c.write(t),await Ft.endWriteSection(c)}async function Ce(c,t){await Ft.startReadUniqueSection(c,t,1);let n=await c.readULE32(),a=await Ft.readBigInt(c,n),o=await c.readULE32();return await Ft.endReadSection(c),{n8:n,q:a,nWitness:o}}async function C6(c){let{fd:t,sections:n}=await Ft.readBinFile(c,"wtns",2),{n8:a,nWitness:o}=await Ce(t,n);await Ft.startReadUniqueSection(t,n,2);let e=[];for(let h=0;h<o;h++){let d=await Ft.readBigInt(t,a);e.push(d)}return await Ft.endReadSection(t),await t.close(),e}var{stringifyBigInts:Hf}=vt.utils;async function g0(c,t,n,a){let{fd:o,sections:e}=await Ft.readBinFile(t,"wtns",2,33554432,8388608),h=await Ce(o,e),{fd:d,sections:b}=await Ft.readBinFile(c,"zkey",2,1<<25,1<<23),l=await La(d,b,void 0,a);if(l.protocol!="groth16")throw new Error("zkey file is not groth16");if(!vt.Scalar.eq(l.r,h.q))throw new Error("Curve of the witness does not match the curve of the proving key");if(h.nWitness!=l.nVars)throw new Error(`Invalid witness length. Circuit: ${l.nVars}, witness: ${h.nWitness}`);let s=l.curve,m=s.Fr,B=s.G1,p=s.G2,v=ao(l.domainSize);n&&n.debug("Reading Wtns");let M=await Ft.readSection(o,e,2);n&&n.debug("Reading Coeffs");let x=await Ft.readSection(d,b,4);n&&n.debug("Building ABC");let[S,w,k]=await B6(s,l,M,x,n),O=v==m.s?s.Fr.shift:s.Fr.w[v+1],W=await m.ifft(S,"","",n,"IFFT_A"),F=await m.batchApplyKey(W,m.e(1),O),u=await m.fft(F,"","",n,"FFT_A"),L=await m.ifft(w,"","",n,"IFFT_B"),$=await m.batchApplyKey(L,m.e(1),O),Q=await m.fft($,"","",n,"FFT_B"),H=await m.ifft(k,"","",n,"IFFT_C"),q=await m.batchApplyKey(H,m.e(1),O),y=await m.fft(q,"","",n,"FFT_C");n&&n.debug("Join ABC");let I=await x6(s,l,u,Q,y,n),N={};n&&n.debug("Reading A Points");let nt=await Ft.readSection(d,b,5);N.pi_a=await s.G1.multiExpAffine(nt,M,n,"multiexp A"),n&&n.debug("Reading B1 Points");let J=await Ft.readSection(d,b,6),j=await s.G1.multiExpAffine(J,M,n,"multiexp B1");n&&n.debug("Reading B2 Points");let ot=await Ft.readSection(d,b,7);N.pi_b=await s.G2.multiExpAffine(ot,M,n,"multiexp B2"),n&&n.debug("Reading C Points");let V=await Ft.readSection(d,b,8);N.pi_c=await s.G1.multiExpAffine(V,M.slice((l.nPublic+1)*s.Fr.n8),n,"multiexp C"),n&&n.debug("Reading H Points");let at=await Ft.readSection(d,b,9),Lt=await s.G1.multiExpAffine(at,I,n,"multiexp H"),rt=s.Fr.random(),ht=s.Fr.random();N.pi_a=B.add(N.pi_a,l.vk_alpha_1),N.pi_a=B.add(N.pi_a,B.timesFr(l.vk_delta_1,rt)),N.pi_b=p.add(N.pi_b,l.vk_beta_2),N.pi_b=p.add(N.pi_b,p.timesFr(l.vk_delta_2,ht)),j=B.add(j,l.vk_beta_1),j=B.add(j,B.timesFr(l.vk_delta_1,ht)),N.pi_c=B.add(N.pi_c,Lt),N.pi_c=B.add(N.pi_c,B.timesFr(N.pi_a,ht)),N.pi_c=B.add(N.pi_c,B.timesFr(j,rt)),N.pi_c=B.add(N.pi_c,B.timesFr(l.vk_delta_1,m.neg(m.mul(rt,ht))));let A=[];for(let i=1;i<=l.nPublic;i++){let C=M.slice(i*m.n8,i*m.n8+m.n8);A.push(vt.Scalar.fromRprLE(C))}return N.pi_a=B.toObject(B.toAffine(N.pi_a)),N.pi_b=p.toObject(p.toAffine(N.pi_b)),N.pi_c=B.toObject(B.toAffine(N.pi_c)),N.protocol="groth16",N.curve=s.name,await d.close(),await o.close(),N=Hf(N),A=Hf(A),{proof:N,publicSignals:A}}async function B6(c,t,n,a,o){let e=c.Fr.n8,h=12+t.n8r,d=(a.byteLength-4)/h,b=new vt.BigBuffer(t.domainSize*e),l=new vt.BigBuffer(t.domainSize*e),s=new vt.BigBuffer(t.domainSize*e),m=[b,l];for(let B=0;B<d;B++){o&&B%1e6==0&&o.debug(`QAP AB: ${B}/${d}`);let p=a.slice(4+B*h,4+B*h+h),v=new DataView(p.buffer),M=v.getUint32(0,!0),x=v.getUint32(4,!0),S=v.getUint32(8,!0),w=p.slice(12,12+e);m[M].set(c.Fr.add(m[M].slice(x*e,x*e+e),c.Fr.mul(w,n.slice(S*e,S*e+e))),x*e)}for(let B=0;B<t.domainSize;B++)o&&B%1e6==0&&o.debug(`QAP C: ${B}/${t.domainSize}`),s.set(c.Fr.mul(b.slice(B*e,B*e+e),l.slice(B*e,B*e+e)),B*e);return[b,l,s]}async function x6(c,t,n,a,o,e){let d=c.Fr.n8,b=Math.floor(n.byteLength/c.Fr.n8),l=[];for(let p=0;p<b;p+=4194304){e&&e.debug(`JoinABC: ${p}/${b}`);let v=Math.min(b-p,4194304),M=[],x=n.slice(p*d,(p+v)*d),S=a.slice(p*d,(p+v)*d),w=o.slice(p*d,(p+v)*d);M.push({cmd:"ALLOCSET",var:0,buff:x}),M.push({cmd:"ALLOCSET",var:1,buff:S}),M.push({cmd:"ALLOCSET",var:2,buff:w}),M.push({cmd:"ALLOC",var:3,len:v*d}),M.push({cmd:"CALL",fnName:"qap_joinABC",params:[{var:0},{var:1},{var:2},{val:v},{var:3}]}),M.push({cmd:"CALL",fnName:"frm_batchFromMontgomery",params:[{var:3},{val:v},{var:3}]}),M.push({cmd:"GET",out:0,var:3,len:v*d}),l.push(c.tm.queueAction(M))}let s=await Promise.all(l),m;n instanceof vt.BigBuffer?m=new vt.BigBuffer(n.byteLength):m=new Uint8Array(n.byteLength);let B=0;for(let p=0;p<s.length;p++)m.set(s[p][0],B),B+=s[p][0].byteLength;return m}var{unstringifyBigInts:A6}=vt.utils;async function Bs(c,t,n,a){let o=A6(c),e=await la.readExisting(t),h=await e.read(e.totalSize);await e.close();let d=await c0.WitnessCalculatorBuilder(h,a);if(d.circom_version()===1){let b=await d.calculateBinWitness(o),l=await Ft.createBinFile(n,"wtns",2,2);await F6(l,b,d.prime),await l.close()}else{let b=await la.createOverride(n),l=await d.calculateWTNSBin(o);await b.write(l),await b.close()}}var{unstringifyBigInts:E6}=vt.utils;async function v6(c,t,n,a,o,e){let h=E6(c),d={type:"mem"};return await Bs(h,t,d,o),await g0(n,d,a,e)}var{unstringifyBigInts:Md}=vt.utils;async function S6(c,t,n,a){let o=Md(c),e=Md(n),h=Md(t),d=await yo(o.curve),b=d.G1.fromObject(o.IC[0]),l=new Uint8Array(d.G1.F.n8*2*h.length),s=new Uint8Array(d.Fr.n8*h.length);if(!O6(d,h))return a&&a.error("Public inputs are not valid."),!1;for(let O=0;O<h.length;O++){let W=d.G1.fromObject(o.IC[O+1]);l.set(W,O*d.G1.F.n8*2),vt.Scalar.toRprLE(s,d.Fr.n8*O,h[O],d.Fr.n8)}let m=await d.G1.multiExpAffine(l,s);m=d.G1.add(m,b);let B=d.G1.fromObject(e.pi_a),p=d.G2.fromObject(e.pi_b),v=d.G1.fromObject(e.pi_c);if(!q6(d,{pi_a:B,pi_b:p,pi_c:v}))return a&&a.error("Proof commitments are not valid."),!1;let M=d.G2.fromObject(o.vk_gamma_2),x=d.G2.fromObject(o.vk_delta_2),S=d.G1.fromObject(o.vk_alpha_1),w=d.G2.fromObject(o.vk_beta_2);return await d.pairingEq(d.G1.neg(B),p,m,M,v,x,S,w)?(a&&a.info("OK!"),!0):(a&&a.error("Invalid proof"),!1)}function q6(c,t){let n=c.G1,a=c.G2;return n.isValid(t.pi_a)&&a.isValid(t.pi_b)&&n.isValid(t.pi_c)}function I6(c,t){return vt.Scalar.geq(t,0)&&vt.Scalar.lt(t,c.r)}function O6(c,t){for(let n=0;n<t.length;n++)if(!I6(c,t[n]))return!1;return!0}var{unstringifyBigInts:Df}=vt.utils;function Ta(c){let t=c.toString(16);for(;t.length<64;)t="0"+t;return t=`"0x${t}"`,t}async function P6(c,t){let n=Df(c),a=Df(t),o="";for(let h=0;h<a.length;h++)o!=""&&(o=o+","),o=o+Ta(a[h]);let e;return e=`[${Ta(n.pi_a[0])}, ${Ta(n.pi_a[1])}],[[${Ta(n.pi_b[0][1])}, ${Ta(n.pi_b[0][0])}],[${Ta(n.pi_b[1][1])}, ${Ta(n.pi_b[1][0])}]],[${Ta(n.pi_c[0])}, ${Ta(n.pi_c[1])}],[${o}]`,e}var M6=Object.freeze({__proto__:null,fullProve:v6,prove:g0,verify:S6,exportSolidityCallData:P6});function Be(c,t){let n=new DataView(t.buffer,t.byteOffset,t.byteLength),a=[];for(let h=0;h<8;h++)a[h]=n.getUint32(h*4);let o=new vt.ChaCha(a);return c.G2.fromRng(o)}function ps(c,t,n,a,o){let e=rn.blake2b.create({dkLen:64}),h=new Uint8Array([t]);e.update(h),e.update(n);let d=c.G1.toUncompressed(a);e.update(d);let b=c.G1.toUncompressed(o);e.update(b);let l=e.digest();return Be(c,l)}function Rd(c,t,n,a,o){return c.g1_s=t.G1.toAffine(t.G1.fromRng(o)),c.g1_sx=t.G1.toAffine(t.G1.timesFr(c.g1_s,c.prvKey)),c.g2_sp=t.G2.toAffine(ps(t,n,a,c.g1_s,c.g1_sx)),c.g2_spx=t.G2.toAffine(t.G2.timesFr(c.g2_sp,c.prvKey)),c}function e2(c,t,n){let a={tau:{},alpha:{},beta:{}};return a.tau.prvKey=c.Fr.fromRng(n),a.alpha.prvKey=c.Fr.fromRng(n),a.beta.prvKey=c.Fr.fromRng(n),Rd(a.tau,c,0,t,n),Rd(a.alpha,c,1,t,n),Rd(a.beta,c,2,t,n),a}async function wo(c,t,n,a){a||(a=n),await c.writeULE32(1);let o=c.pos;await c.writeULE64(0),await c.writeULE32(t.F1.n64*8);let e=new Uint8Array(t.F1.n8);vt.Scalar.toRprLE(e,0,t.q,t.F1.n8),await c.write(e),await c.writeULE32(n),await c.writeULE32(a);let h=c.pos-o-8,d=c.pos;await c.writeULE64(h,o),c.pos=d}async function ra(c,t){if(!t[1])throw new Error(c.fileName+": File has no  header");if(t[1].length>1)throw new Error(c.fileName+": File has more than one header");c.pos=t[1][0].p;let n=await c.readULE32(),a=await c.read(n),o=vt.Scalar.fromRprLE(a),e=await Kn(o);if(e.F1.n64*8!=n)throw new Error(c.fileName+": Invalid size");let h=await c.readULE32(),d=await c.readULE32();if(c.pos-t[1][0].p!=t[1][0].size)throw new Error("Invalid PTau header size");return{curve:e,power:h,ceremonyPower:d}}async function R6(c,t,n){let a=await c.read(t.F1.n8*2*6+t.F2.n8*2*3);return L0(a,0,t,n)}function L0(c,t,n,a){let o={tau:{},alpha:{},beta:{}};return o.tau.g1_s=e(),o.tau.g1_sx=e(),o.alpha.g1_s=e(),o.alpha.g1_sx=e(),o.beta.g1_s=e(),o.beta.g1_sx=e(),o.tau.g2_spx=h(),o.alpha.g2_spx=h(),o.beta.g2_spx=h(),o;function e(){let d;return a?d=n.G1.fromRprLEM(c,t):d=n.G1.fromRprUncompressed(c,t),t+=n.G1.F.n8*2,d}function h(){let d;return a?d=n.G2.fromRprLEM(c,t):d=n.G2.fromRprUncompressed(c,t),t+=n.G2.F.n8*2,d}}function ai(c,t,n,a,o){e(a.tau.g1_s),e(a.tau.g1_sx),e(a.alpha.g1_s),e(a.alpha.g1_sx),e(a.beta.g1_s),e(a.beta.g1_sx),h(a.tau.g2_spx),h(a.alpha.g2_spx),h(a.beta.g2_spx);async function e(d){o?n.G1.toRprLEM(c,t,d):n.G1.toRprUncompressed(c,t,d),t+=n.F1.n8*2}async function h(d){o?n.G2.toRprLEM(c,t,d):n.G2.toRprUncompressed(c,t,d),t+=n.F2.n8*2}return c}async function z6(c,t,n,a){let o=new Uint8Array(t.F1.n8*2*6+t.F2.n8*2*3);ai(o,0,t,n,a),await c.write(o)}async function T6(c,t){let n={};n.tauG1=await b(),n.tauG2=await l(),n.alphaG1=await b(),n.betaG1=await b(),n.betaG2=await l(),n.key=await R6(c,t,!0),n.partialHash=await c.read(216),n.nextChallenge=await c.read(64),n.type=await c.readULE32();let a=new Uint8Array(t.G1.F.n8*2*6+t.G2.F.n8*2*3);ai(a,0,t,n.key,!1);let o=u0(n.partialHash);o.update(a),n.responseHash=o.digest();let e=await c.readULE32(),h=c.pos,d=0;for(;c.pos-h<e;){let m=await s(1);if(m[0]<=d)throw new Error("Parameters in the contribution must be sorted");if(d=m[0],m[0]==1){let B=await s(1),p=await s(B[0]);n.name=new TextDecoder().decode(p)}else if(m[0]==2){let B=await s(1);n.numIterationsExp=B[0]}else if(m[0]==3){let B=await s(1);n.beaconHash=await s(B[0])}else throw new Error("Parameter not recognized")}if(c.pos!=h+e)throw new Error("Parameters do not match");return n;async function b(){let m=await c.read(t.G1.F.n8*2);return t.G1.fromRprLEM(m)}async function l(){let m=await c.read(t.G2.F.n8*2);return t.G2.fromRprLEM(m)}async function s(m){let B=await c.read(m);return new Uint8Array(B)}}async function oi(c,t,n){if(!n[7])throw new Error(c.fileName+": File has no  contributions");if(n[7][0].length>1)throw new Error(c.fileName+": File has more than one contributions section");c.pos=n[7][0].p;let a=await c.readULE32(),o=[];for(let e=0;e<a;e++){let h=await T6(c,t);h.id=e+1,o.push(h)}if(c.pos-n[7][0].p!=n[7][0].size)throw new Error("Invalid contribution section size");return o}async function G6(c,t,n){let a=new Uint8Array(t.F1.n8*2),o=new Uint8Array(t.F2.n8*2);await h(n.tauG1),await d(n.tauG2),await h(n.alphaG1),await h(n.betaG1),await d(n.betaG2),await z6(c,t,n.key,!0),await c.write(n.partialHash),await c.write(n.nextChallenge),await c.writeULE32(n.type||0);let e=[];if(n.name){e.push(1);let b=new TextEncoder("utf-8").encode(n.name.substring(0,64));e.push(b.byteLength);for(let l=0;l<b.byteLength;l++)e.push(b[l])}if(n.type==1){e.push(2),e.push(n.numIterationsExp),e.push(3),e.push(n.beaconHash.byteLength);for(let b=0;b<n.beaconHash.byteLength;b++)e.push(n.beaconHash[b])}if(e.length>0){let b=new Uint8Array(e);await c.writeULE32(b.byteLength),await c.write(b)}else await c.writeULE32(0);async function h(b){t.G1.toRprLEM(a,0,b),await c.write(a)}async function d(b){t.G2.toRprLEM(o,0,b),await c.write(o)}}async function c2(c,t,n){await c.writeULE32(7);let a=c.pos;await c.writeULE64(0),await c.writeULE32(n.length);for(let h=0;h<n.length;h++)await G6(c,t,n[h]);let o=c.pos-a-8,e=c.pos;await c.writeULE64(o,a),c.pos=e}function ii(c,t,n){n&&n.debug("Calculating First Challenge Hash");let a=rn.blake2b.create({dkLen:64}),o=new Uint8Array(c.G1.F.n8*2),e=new Uint8Array(c.G2.F.n8*2);c.G1.toRprUncompressed(o,0,c.G1.g),c.G2.toRprUncompressed(e,0,c.G2.g),a.update(rn.blake2b.create({dkLen:64}).digest());let h;return h=2**t*2-1,n&&n.debug("Calculate Initial Hash: tauG1"),d(o,h),h=2**t,n&&n.debug("Calculate Initial Hash: tauG2"),d(e,h),n&&n.debug("Calculate Initial Hash: alphaTauG1"),d(o,h),n&&n.debug("Calculate Initial Hash: betaTauG1"),d(o,h),a.update(e),a.digest();function d(b,l){let m=Math.floor(l/341e3),B=l%341e3,p=new Uint8Array(341e3*b.byteLength);for(let v=0;v<341e3;v++)p.set(b,v*b.byteLength);for(let v=0;v<m;v++)a.update(p),n&&n.debug("Initial hash: "+v*341e3);for(let v=0;v<B;v++)a.update(b)}}async function p0(c,t,n,a){let o=await a2(n,a);return e2(c,t,o)}async function k6(c,t,n,a){let o=await Ft.createBinFile(n,"ptau",1,7);await wo(o,c,t,0);let e=c.G1.oneAffine,h=c.G2.oneAffine;await Ft.startWriteSection(o,2);let d=2**t*2-1;for(let B=0;B<d;B++)await o.write(e),a&&B%1e5==0&&B&&a.log("tauG1: "+B);await Ft.endWriteSection(o),await Ft.startWriteSection(o,3);let b=2**t;for(let B=0;B<b;B++)await o.write(h),a&&B%1e5==0&&B&&a.log("tauG2: "+B);await Ft.endWriteSection(o),await Ft.startWriteSection(o,4);let l=2**t;for(let B=0;B<l;B++)await o.write(e),a&&B%1e5==0&&B&&a.log("alphaTauG1: "+B);await Ft.endWriteSection(o),await Ft.startWriteSection(o,5);let s=2**t;for(let B=0;B<s;B++)await o.write(e),a&&B%1e5==0&&B&&a.log("betaTauG1: "+B);await Ft.endWriteSection(o),await Ft.startWriteSection(o,6),await o.write(h),await Ft.endWriteSection(o),await Ft.startWriteSection(o,7),await o.writeULE32(0),await Ft.endWriteSection(o),await o.close();let m=ii(c,t,a);return a&&a.debug(hn(rn.blake2b.create({dkLen:64}).digest(),"Blank Contribution Hash:")),a&&a.info(hn(m,"First Contribution Hash:")),m}async function U6(c,t,n){let{fd:a,sections:o}=await Ft.readBinFile(c,"ptau",1),{curve:e,power:h}=await ra(a,o),d=await oi(a,e,o),b,l;d.length==0?(b=rn.blake2b.create({dkLen:64}).digest(),l=ii(e,h)):(b=d[d.length-1].responseHash,l=d[d.length-1].nextChallenge),n&&n.info(hn(b,"Last Response Hash: ")),n&&n.info(hn(l,"New Challenge Hash: "));let s=await la.createOverride(t),m=rn.blake2b.create({dkLen:64});await s.write(b),m.update(b),await p(2,"G1",2**h*2-1,"tauG1"),await p(3,"G2",2**h,"tauG2"),await p(4,"G1",2**h,"alphaTauG1"),await p(5,"G1",2**h,"betaTauG1"),await p(6,"G2",1,"betaG2"),await a.close(),await s.close();let B=m.digest();if(!to(l,B))throw n&&n.info(hn(B,"Calc Curret Challenge Hash: ")),n&&n.error("PTau file is corrupted. Calculated new challenge hash does not match with the eclared one"),new Error("PTau file is corrupted. Calculated new challenge hash does not match with the eclared one");return l;async function p(v,M,x,S){let w=e[M],k=w.F.n8*2,O=Math.floor((1<<24)/k);await Ft.startReadUniqueSection(a,o,v);for(let W=0;W<x;W+=O){n&&n.debug(`Exporting ${S}: ${W}/${x}`);let F=Math.min(x-W,O),u;u=await a.read(F*k),u=await w.batchLEMtoU(u),await s.write(u),m.update(u)}await Ft.endReadSection(a)}}async function N6(c,t,n,a,o,e){let h=new Uint8Array(64);for(let I=0;I<64;I++)h[I]=255;let{fd:d,sections:b}=await Ft.readBinFile(c,"ptau",1),{curve:l,power:s}=await ra(d,b),m=await oi(d,l,b),B={};a&&(B.name=a);let p=l.F1.n8*2,v=l.F1.n8,M=l.F2.n8*2,x=l.F2.n8,S=await la.readExisting(t);if(S.totalSize!=64+(2**s*2-1)*v+2**s*x+2**s*v+2**s*v+x+p*6+M*3)throw new Error("Size of the contribution is invalid");let w;m.length>0?w=m[m.length-1].nextChallenge:w=ii(l,s,e);let k=await Ft.createBinFile(n,"ptau",1,o?7:2);await wo(k,l,s);let O=await S.read(64);if(to(h,w)&&(w=O,m[m.length-1].nextChallenge=w),!to(O,w))throw new Error("Wrong contribution. This contribution is not based on the previous hash");let W=rn.blake2b.create({dkLen:64});W.update(O);let F=[],u;u=await Q(S,k,"G1",2,2**s*2-1,[1],"tauG1"),B.tauG1=u[0],u=await Q(S,k,"G2",3,2**s,[1],"tauG2"),B.tauG2=u[0],u=await Q(S,k,"G1",4,2**s,[0],"alphaG1"),B.alphaG1=u[0],u=await Q(S,k,"G1",5,2**s,[0],"betaG1"),B.betaG1=u[0],u=await Q(S,k,"G2",6,1,[0],"betaG2"),B.betaG2=u[0],B.partialHash=n2(W);let L=await S.read(l.F1.n8*2*6+l.F2.n8*2*3);B.key=L0(L,0,l,!1),W.update(new Uint8Array(L));let $=W.digest();if(e&&e.info(hn($,"Contribution Response Hash imported: ")),o){let I=rn.blake2b.create({dkLen:64});I.update($),await y(I,k,"G1",2,2**s*2-1,"tauG1",e),await y(I,k,"G2",3,2**s,"tauG2",e),await y(I,k,"G1",4,2**s,"alphaTauG1",e),await y(I,k,"G1",5,2**s,"betaTauG1",e),await y(I,k,"G2",6,1,"betaG2",e),B.nextChallenge=I.digest(),e&&e.info(hn(B.nextChallenge,"Next Challenge Hash: "))}else B.nextChallenge=h;return m.push(B),await c2(k,l,m),await S.close(),await k.close(),await d.close(),B.nextChallenge;async function Q(I,N,nt,J,j,ot,V){return o?await H(I,N,nt,J,j,ot,V):await q(I,N,nt,J,j,ot,V)}async function H(I,N,nt,J,j,ot,V){let at=l[nt],Lt=at.F.n8,rt=at.F.n8*2,ht=[];await Ft.startWriteSection(N,J);let A=Math.floor((1<<24)/rt);F[J]=N.pos;for(let i=0;i<j;i+=A){e&&e.debug(`Importing ${V}: ${i}/${j}`);let C=Math.min(j-i,A),r=await I.read(C*Lt);W.update(r);let z=await at.batchCtoLEM(r);await N.write(z);for(let E=0;E<ot.length;E++){let g=ot[E];if(g>=i&&g<i+C){let U=at.fromRprLEM(z,(g-i)*rt);ht.push(U)}}}return await Ft.endWriteSection(N),ht}async function q(I,N,nt,J,j,ot,V){let at=l[nt],Lt=at.F.n8,rt=[],ht=Math.floor((1<<24)/Lt);for(let A=0;A<j;A+=ht){e&&e.debug(`Importing ${V}: ${A}/${j}`);let i=Math.min(j-A,ht),C=await I.read(i*Lt);W.update(C);for(let r=0;r<ot.length;r++){let z=ot[r];if(z>=A&&z<A+i){let E=at.fromRprCompressed(C,(z-A)*Lt);rt.push(E)}}}return rt}async function y(I,N,nt,J,j,ot,V){let at=l[nt],Lt=at.F.n8*2,rt=Math.floor((1<<24)/Lt),ht=N.pos;N.pos=F[J];for(let A=0;A<j;A+=rt){V&&V.debug(`Hashing ${ot}: ${A}/${j}`);let i=Math.min(j-A,rt),C=await N.read(i*Lt),r=await at.batchLEMtoU(C);I.update(r)}N.pos=ht}}var sa=_0;async function Kf(c,t,n,a){let o;if(t.type==1){let e=await p0(c,n.nextChallenge,t.beaconHash,t.numIterationsExp);if(!c.G1.eq(t.key.tau.g1_s,e.tau.g1_s))return a&&a.error(`BEACON key (tauG1_s) is not generated correctly in challenge #${t.id}  ${t.name||""}`),!1;if(!c.G1.eq(t.key.tau.g1_sx,e.tau.g1_sx))return a&&a.error(`BEACON key (tauG1_sx) is not generated correctly in challenge #${t.id}  ${t.name||""}`),!1;if(!c.G2.eq(t.key.tau.g2_spx,e.tau.g2_spx))return a&&a.error(`BEACON key (tauG2_spx) is not generated correctly in challenge #${t.id}  ${t.name||""}`),!1;if(!c.G1.eq(t.key.alpha.g1_s,e.alpha.g1_s))return a&&a.error(`BEACON key (alphaG1_s) is not generated correctly in challenge #${t.id}  ${t.name||""}`),!1;if(!c.G1.eq(t.key.alpha.g1_sx,e.alpha.g1_sx))return a&&a.error(`BEACON key (alphaG1_sx) is not generated correctly in challenge #${t.id}  ${t.name||""}`),!1;if(!c.G2.eq(t.key.alpha.g2_spx,e.alpha.g2_spx))return a&&a.error(`BEACON key (alphaG2_spx) is not generated correctly in challenge #${t.id}  ${t.name||""}`),!1;if(!c.G1.eq(t.key.beta.g1_s,e.beta.g1_s))return a&&a.error(`BEACON key (betaG1_s) is not generated correctly in challenge #${t.id}  ${t.name||""}`),!1;if(!c.G1.eq(t.key.beta.g1_sx,e.beta.g1_sx))return a&&a.error(`BEACON key (betaG1_sx) is not generated correctly in challenge #${t.id}  ${t.name||""}`),!1;if(!c.G2.eq(t.key.beta.g2_spx,e.beta.g2_spx))return a&&a.error(`BEACON key (betaG2_spx) is not generated correctly in challenge #${t.id}  ${t.name||""}`),!1}return t.key.tau.g2_sp=c.G2.toAffine(ps(c,0,n.nextChallenge,t.key.tau.g1_s,t.key.tau.g1_sx)),t.key.alpha.g2_sp=c.G2.toAffine(ps(c,1,n.nextChallenge,t.key.alpha.g1_s,t.key.alpha.g1_sx)),t.key.beta.g2_sp=c.G2.toAffine(ps(c,2,n.nextChallenge,t.key.beta.g1_s,t.key.beta.g1_sx)),o=await sa(c,t.key.tau.g1_s,t.key.tau.g1_sx,t.key.tau.g2_sp,t.key.tau.g2_spx),o!==!0?(a&&a.error("INVALID key (tau) in challenge #"+t.id),!1):(o=await sa(c,t.key.alpha.g1_s,t.key.alpha.g1_sx,t.key.alpha.g2_sp,t.key.alpha.g2_spx),o!==!0?(a&&a.error("INVALID key (alpha) in challenge #"+t.id),!1):(o=await sa(c,t.key.beta.g1_s,t.key.beta.g1_sx,t.key.beta.g2_sp,t.key.beta.g2_spx),o!==!0?(a&&a.error("INVALID key (beta) in challenge #"+t.id),!1):(o=await sa(c,n.tauG1,t.tauG1,t.key.tau.g2_sp,t.key.tau.g2_spx),o!==!0?(a&&a.error("INVALID tau*G1. challenge #"+t.id+" It does not follow the previous contribution"),!1):(o=await sa(c,t.key.tau.g1_s,t.key.tau.g1_sx,n.tauG2,t.tauG2),o!==!0?(a&&a.error("INVALID tau*G2. challenge #"+t.id+" It does not follow the previous contribution"),!1):(o=await sa(c,n.alphaG1,t.alphaG1,t.key.alpha.g2_sp,t.key.alpha.g2_spx),o!==!0?(a&&a.error("INVALID alpha*G1. challenge #"+t.id+" It does not follow the previous contribution"),!1):(o=await sa(c,n.betaG1,t.betaG1,t.key.beta.g2_sp,t.key.beta.g2_spx),o!==!0?(a&&a.error("INVALID beta*G1. challenge #"+t.id+" It does not follow the previous contribution"),!1):(o=await sa(c,t.key.beta.g1_s,t.key.beta.g1_sx,n.betaG2,t.betaG2),o!==!0?(a&&a.error("INVALID beta*G2. challenge #"+t.id+"It does not follow the previous contribution"),!1):(a&&a.info("Powers Of tau file OK!"),!0))))))))}async function $6(c,t){let n,{fd:a,sections:o}=await Ft.readBinFile(c,"ptau",1),{curve:e,power:h,ceremonyPower:d}=await ra(a,o),b=await oi(a,e,o);t&&t.debug("power: 2**"+h),t&&t.debug("Computing initial contribution hash");let l={tauG1:e.G1.g,tauG2:e.G2.g,alphaG1:e.G1.g,betaG1:e.G1.g,betaG2:e.G2.g,nextChallenge:ii(e,d,t),responseHash:rn.blake2b.create({dkLen:64}).digest()};if(b.length==0)return t&&t.error("This file has no contribution! It cannot be used in production"),!1;let s;b.length>1?s=b[b.length-2]:s=l;let m=b[b.length-1];if(t&&t.debug("Validating contribution #"+b[b.length-1].id),!await Kf(e,m,s,t))return!1;let p=rn.blake2b.create({dkLen:64});p.update(m.responseHash),t&&t.debug("Verifying powers in tau*G1 section");let v=await F(2,"G1","tauG1",2**h*2-1,[0,1],t);if(n=await sa(e,v.R1,v.R2,e.G2.g,m.tauG2),n!==!0)return t&&t.error("tauG1 section. Powers do not match"),!1;if(!e.G1.eq(e.G1.g,v.singularPoints[0]))return t&&t.error("First element of tau*G1 section must be the generator"),!1;if(!e.G1.eq(m.tauG1,v.singularPoints[1]))return t&&t.error("Second element of tau*G1 section does not match the one in the contribution section"),!1;t&&t.debug("Verifying powers in tau*G2 section");let M=await F(3,"G2","tauG2",2**h,[0,1],t);if(n=await sa(e,e.G1.g,m.tauG1,M.R1,M.R2),n!==!0)return t&&t.error("tauG2 section. Powers do not match"),!1;if(!e.G2.eq(e.G2.g,M.singularPoints[0]))return t&&t.error("First element of tau*G2 section must be the generator"),!1;if(!e.G2.eq(m.tauG2,M.singularPoints[1]))return t&&t.error("Second element of tau*G2 section does not match the one in the contribution section"),!1;t&&t.debug("Verifying powers in alpha*tau*G1 section");let x=await F(4,"G1","alphatauG1",2**h,[0],t);if(n=await sa(e,x.R1,x.R2,e.G2.g,m.tauG2),n!==!0)return t&&t.error("alphaTauG1 section. Powers do not match"),!1;if(!e.G1.eq(m.alphaG1,x.singularPoints[0]))return t&&t.error("First element of alpha*tau*G1 section (alpha*G1) does not match the one in the contribution section"),!1;t&&t.debug("Verifying powers in beta*tau*G1 section");let S=await F(5,"G1","betatauG1",2**h,[0],t);if(n=await sa(e,S.R1,S.R2,e.G2.g,m.tauG2),n!==!0)return t&&t.error("betaTauG1 section. Powers do not match"),!1;if(!e.G1.eq(m.betaG1,S.singularPoints[0]))return t&&t.error("First element of beta*tau*G1 section (beta*G1) does not match the one in the contribution section"),!1;let w=await W(t);if(!e.G2.eq(m.betaG2,w))return t&&t.error("betaG2 element in betaG2 section does not match the one in the contribution section"),!1;let k=p.digest();if(h==d&&!to(k,m.nextChallenge))return t&&t.error("Hash of the values does not match the next challenge of the last contributor in the contributions section"),!1;t&&t.info(hn(k,"Next challenge hash: ")),O(m,s);for(let L=b.length-2;L>=0;L--){let $=b[L],Q=L>0?b[L-1]:l;if(!await Kf(e,$,Q,t))return!1;O($,Q)}if(t&&t.info("-----------------------------------------------------"),!o[12]||!o[13]||!o[14]||!o[15])t&&t.warn(`this file does not contain phase2 precalculated values. Please run: 
   snarkjs "powersoftau preparephase2" to prepare this file to be used in the phase2 ceremony.`);else{let L;if(L=await u("G1",2,12,"tauG1",t),!L||(L=await u("G2",3,13,"tauG2",t),!L)||(L=await u("G1",4,14,"alphaTauG1",t),!L)||(L=await u("G1",5,15,"betaTauG1",t),!L))return!1}return await a.close(),t&&t.info("Powers of Tau Ok!"),!0;function O(L,$){if(!t)return;t.info("-----------------------------------------------------"),t.info(`Contribution #${L.id}: ${L.name||""}`),t.info(hn(L.nextChallenge,"Next Challenge: "));let Q=new Uint8Array(e.G1.F.n8*2*6+e.G2.F.n8*2*3);ai(Q,0,e,L.key,!1);let H=u0(L.partialHash);H.update(Q);let q=H.digest();t.info(hn(q,"Response Hash:")),t.info(hn($.nextChallenge,"Response Hash:")),L.type==1&&(t.info(`Beacon generator: ${f0(L.beaconHash)}`),t.info(`Beacon iterations Exp: ${L.numIterationsExp}`))}async function W(L){let $=e.G2,Q=$.F.n8*2,H=new Uint8Array(Q);if(!o[6])throw L.error("File has no BetaG2 section"),new Error("File has no BetaG2 section");if(o[6].length>1)throw L.error("File has no BetaG2 section"),new Error("File has more than one GetaG2 section");a.pos=o[6][0].p;let q=await a.read(Q),y=$.fromRprLEM(q);return $.toRprUncompressed(H,0,y),p.update(H),y}async function F(L,$,Q,H,q,y){let N=e[$],nt=N.F.n8*2;await Ft.startReadUniqueSection(a,o,L);let J=[],j=N.zero,ot=N.zero,V=N.zero;for(let at=0;at<H;at+=65536){y&&y.debug(`points relations: ${Q}: ${at}/${H} `);let Lt=Math.min(H-at,65536),rt=await a.read(Lt*nt),ht=await N.batchLEMtoU(rt);p.update(ht);let A=Jo(4*(Lt-1));if(at>0){let r=N.fromRprLEM(rt,0),z=bs(Jo(4),0);j=N.add(j,N.timesScalar(V,z)),ot=N.add(ot,N.timesScalar(r,z))}let i=await N.multiExpAffine(rt.slice(0,(Lt-1)*nt),A),C=await N.multiExpAffine(rt.slice(nt),A);j=N.add(j,i),ot=N.add(ot,C),V=N.fromRprLEM(rt,(Lt-1)*nt);for(let r=0;r<q.length;r++){let z=q[r];if(z>=at&&z<at+Lt){let E=N.fromRprLEM(rt,(z-at)*nt);J.push(E)}}}return await Ft.endReadSection(a),{R1:j,R2:ot,singularPoints:J}}async function u(L,$,Q,H,q){q&&q.debug(`Verifying phase2 calculated values ${H}...`);let y=e[L],I=y.F.n8*2,N=new Array(8);for(let J=0;J<8;J++)N[J]=bs(Jo(4),0);for(let J=0;J<=h;J++)if(!await nt(J))return!1;if($==2&&!await nt(h+1))return!1;return!0;async function nt(J){q&&q.debug(`Power ${J}...`);let j=e.Fr.n8,ot=2**J,V=new Uint32Array(ot),at,Lt=new vt.ChaCha(N);q&&q.debug(`Creating random numbers Powers${J}...`);for(let C=0;C<ot;C++)J==h+1&&C==ot-1?V[C]=0:V[C]=Lt.nextU32();V=new Uint8Array(V.buffer,V.byteOffset,V.byteLength),q&&q.debug(`reading points Powers${J}...`),await Ft.startReadUniqueSection(a,o,$),at=new vt.BigBuffer(ot*I),J==h+1?(await a.readToBuffer(at,0,(ot-1)*I),at.set(e.G1.zeroAffine,(ot-1)*I)):await a.readToBuffer(at,0,ot*I),await Ft.endReadSection(a,!0);let rt=await y.multiExpAffine(at,V,q,H+"_"+J);V=new vt.BigBuffer(ot*j),Lt=new vt.ChaCha(N);let ht=new Uint8Array(4),A=new DataView(ht.buffer);q&&q.debug(`Creating random numbers Powers${J}...`);for(let C=0;C<ot;C++)(C!=ot-1||J!=h+1)&&(A.setUint32(0,Lt.nextU32(),!0),V.set(ht,C*j));q&&q.debug(`batchToMontgomery ${J}...`),V=await e.Fr.batchToMontgomery(V),q&&q.debug(`fft ${J}...`),V=await e.Fr.fft(V),q&&q.debug(`batchFromMontgomery ${J}...`),V=await e.Fr.batchFromMontgomery(V),q&&q.debug(`reading points Lagrange${J}...`),await Ft.startReadUniqueSection(a,o,Q),a.pos+=I*(2**J-1),await a.readToBuffer(at,0,ot*I),await Ft.endReadSection(a,!0);let i=await y.multiExpAffine(at,V,q,H+"_"+J+"_transformed");return y.eq(rt,i)?!0:(q&&q.error("Phase2 caclutation does not match with powers of tau"),!1)}}}async function Fs(c,t,n,a,o,e,h,d,b,l){let m=o[e],B=m.F.n8*2,p=t[a][0].size/B;await Ft.startReadUniqueSection(c,t,a),await Ft.startWriteSection(n,a);let v=h;for(let M=0;M<p;M+=65536){l&&l.debug(`Applying key: ${b}: ${M}/${p}`);let x=Math.min(p-M,65536),S;S=await c.read(x*B),S=await m.batchApplyKey(S,v,d),await n.write(S),v=o.Fr.mul(v,o.Fr.exp(d,x))}await Ft.endWriteSection(n),await Ft.endReadSection(c)}async function bo(c,t,n,a,o,e,h,d,b,l,s){let m=a[o],B=m.F.n8*2,p=Math.floor((1<<20)/B),v=h;for(let M=0;M<e;M+=p){s&&s.debug(`Applying key ${l}: ${M}/${e}`);let x=Math.min(e-M,p),S=await c.read(x*B),w=await m.batchUtoLEM(S),k=await m.batchApplyKey(w,v,d),O;b=="COMPRESSED"?O=await m.batchLEMtoC(k):O=await m.batchLEMtoU(k),n&&n.update(O),await t.write(O),v=a.Fr.mul(v,a.Fr.exp(d,x))}}async function Z6(c,t,n,a,o){let e=await la.readExisting(t),h=c.F1.n64*8*2,d=c.F2.n64*8*2,b=(e.totalSize+h-64-d)/(4*h+d),l=b,s=0;for(;l>1;)l=l/2,s+=1;if(2**s!=b)throw new Error("Invalid file size");o&&o.debug("Power to tau size: "+s);let m=await Cs(a),B=await la.createOverride(n),p=rn.blake2b.create({dkLen:64});for(let O=0;O<e.totalSize;O+=e.pageSize){o&&o.debug(`Hashing challenge ${O}/${e.totalSize}`);let W=Math.min(e.totalSize-O,e.pageSize),F=await e.read(W);p.update(F)}let v=await e.read(64,0);o&&o.info(hn(v,"Claimed Previous Response Hash: "));let M=p.digest();o&&o.info(hn(M,"Current Challenge Hash: "));let x=e2(c,M,m);o&&["tau","alpha","beta"].forEach(O=>{o.debug(O+".g1_s: "+c.G1.toString(x[O].g1_s,16)),o.debug(O+".g1_sx: "+c.G1.toString(x[O].g1_sx,16)),o.debug(O+".g2_sp: "+c.G2.toString(x[O].g2_sp,16)),o.debug(O+".g2_spx: "+c.G2.toString(x[O].g2_spx,16)),o.debug("")});let S=rn.blake2b.create({dkLen:64});await B.write(M),S.update(M),await bo(e,B,S,c,"G1",2**s*2-1,c.Fr.one,x.tau.prvKey,"COMPRESSED","tauG1",o),await bo(e,B,S,c,"G2",2**s,c.Fr.one,x.tau.prvKey,"COMPRESSED","tauG2",o),await bo(e,B,S,c,"G1",2**s,x.alpha.prvKey,x.tau.prvKey,"COMPRESSED","alphaTauG1",o),await bo(e,B,S,c,"G1",2**s,x.beta.prvKey,x.tau.prvKey,"COMPRESSED","betaTauG1",o),await bo(e,B,S,c,"G2",1,x.beta.prvKey,x.tau.prvKey,"COMPRESSED","betaTauG2",o);let w=new Uint8Array(c.F1.n8*2*6+c.F2.n8*2*3);ai(w,0,c,x,!1),await B.write(w),S.update(w);let k=S.digest();o&&o.info(hn(k,"Contribution Response Hash: ")),await B.close(),await e.close()}async function j6(c,t,n,a,o,e){let h=h0(a);if(h.byteLength==0||h.byteLength*2!=a.length)return e&&e.error("Invalid Beacon Hash. (It must be a valid hexadecimal sequence)"),!1;if(h.length>=256)return e&&e.error("Maximum length of beacon hash is 255 bytes"),!1;if(o=parseInt(o),o<10||o>63)return e&&e.error("Invalid numIterationsExp. (Must be between 10 and 63)"),!1;let{fd:d,sections:b}=await Ft.readBinFile(c,"ptau",1),{curve:l,power:s,ceremonyPower:m}=await ra(d,b);if(s!=m)return e&&e.error("This file has been reduced. You cannot contribute into a reduced file."),!1;b[12]&&e&&e.warn("Contributing into a file that has phase2 calculated. You will have to prepare phase2 again.");let B=await oi(d,l,b),p={name:n,type:1,numIterationsExp:o,beaconHash:h},v;B.length>0?v=B[B.length-1].nextChallenge:v=ii(l,s,e),p.key=await p0(l,v,h,o);let M=rn.blake2b.create({dkLen:64});M.update(v);let x=await Ft.createBinFile(t,"ptau",1,7);await wo(x,l,s);let S=[],w;w=await F(2,"G1",2**s*2-1,l.Fr.e(1),p.key.tau.prvKey,"tauG1",e),p.tauG1=w[1],w=await F(3,"G2",2**s,l.Fr.e(1),p.key.tau.prvKey,"tauG2",e),p.tauG2=w[1],w=await F(4,"G1",2**s,p.key.alpha.prvKey,p.key.tau.prvKey,"alphaTauG1",e),p.alphaG1=w[0],w=await F(5,"G1",2**s,p.key.beta.prvKey,p.key.tau.prvKey,"betaTauG1",e),p.betaG1=w[0],w=await F(6,"G2",1,p.key.beta.prvKey,p.key.tau.prvKey,"betaTauG2",e),p.betaG2=w[0],p.partialHash=n2(M);let k=new Uint8Array(l.F1.n8*2*6+l.F2.n8*2*3);ai(k,0,l,p.key,!1),M.update(new Uint8Array(k));let O=M.digest();e&&e.info(hn(O,"Contribution Response Hash imported: "));let W=rn.blake2b.create({dkLen:64});return W.update(O),await u(x,"G1",2,2**s*2-1,"tauG1",e),await u(x,"G2",3,2**s,"tauG2",e),await u(x,"G1",4,2**s,"alphaTauG1",e),await u(x,"G1",5,2**s,"betaTauG1",e),await u(x,"G2",6,1,"betaG2",e),p.nextChallenge=W.digest(),e&&e.info(hn(p.nextChallenge,"Next Challenge Hash: ")),B.push(p),await c2(x,l,B),await d.close(),await x.close(),O;async function F(L,$,Q,H,q,y,I){let N=[];d.pos=b[L][0].p,await Ft.startWriteSection(x,L),S[L]=x.pos;let nt=l[$],J=nt.F.n8*2,j=Math.floor((1<<20)/J),ot=H;for(let V=0;V<Q;V+=j){I&&I.debug(`applying key${y}: ${V}/${Q}`);let at=Math.min(Q-V,j),Lt=await d.read(at*J),rt=await nt.batchApplyKey(Lt,ot,q),ht=x.write(rt),A=await nt.batchLEMtoC(rt);if(M.update(A),await ht,V==0)for(let i=0;i<Math.min(2,Q);i++)N.push(nt.fromRprLEM(rt,i*J));ot=l.Fr.mul(ot,l.Fr.exp(q,at))}return await Ft.endWriteSection(x),N}async function u(L,$,Q,H,q,y){let I=l[$],N=I.F.n8*2,nt=Math.floor((1<<24)/N),J=L.pos;L.pos=S[Q];for(let j=0;j<H;j+=nt){y&&y.debug(`Hashing ${q}: ${j}/${H}`);let ot=Math.min(H-j,nt),V=await L.read(ot*N),at=await I.batchLEMtoU(V);W.update(at)}L.pos=J}}async function V6(c,t,n,a,o){let{fd:e,sections:h}=await Ft.readBinFile(c,"ptau",1),{curve:d,power:b,ceremonyPower:l}=await ra(e,h);if(b!=l)throw o&&o.error("This file has been reduced. You cannot contribute into a reduced file."),new Error("This file has been reduced. You cannot contribute into a reduced file.");h[12]&&o&&o.warn("WARNING: Contributing into a file that has phase2 calculated. You will have to prepare phase2 again.");let s=await oi(e,d,h),m={name:n,type:0},B,p=await Cs(a);s.length>0?B=s[s.length-1].nextChallenge:B=ii(d,b,o),m.key=e2(d,B,p);let v=rn.blake2b.create({dkLen:64});v.update(B);let M=await Ft.createBinFile(t,"ptau",1,7);await wo(M,d,b);let x=[],S;S=await W(2,"G1",2**b*2-1,d.Fr.e(1),m.key.tau.prvKey,"tauG1"),m.tauG1=S[1],S=await W(3,"G2",2**b,d.Fr.e(1),m.key.tau.prvKey,"tauG2"),m.tauG2=S[1],S=await W(4,"G1",2**b,m.key.alpha.prvKey,m.key.tau.prvKey,"alphaTauG1"),m.alphaG1=S[0],S=await W(5,"G1",2**b,m.key.beta.prvKey,m.key.tau.prvKey,"betaTauG1"),m.betaG1=S[0],S=await W(6,"G2",1,m.key.beta.prvKey,m.key.tau.prvKey,"betaTauG2"),m.betaG2=S[0],m.partialHash=n2(v);let w=new Uint8Array(d.F1.n8*2*6+d.F2.n8*2*3);ai(w,0,d,m.key,!1),v.update(new Uint8Array(w));let k=v.digest();o&&o.info(hn(k,"Contribution Response Hash imported: "));let O=rn.blake2b.create({dkLen:64});return O.update(k),await F(M,"G1",2,2**b*2-1,"tauG1"),await F(M,"G2",3,2**b,"tauG2"),await F(M,"G1",4,2**b,"alphaTauG1"),await F(M,"G1",5,2**b,"betaTauG1"),await F(M,"G2",6,1,"betaG2"),m.nextChallenge=O.digest(),o&&o.info(hn(m.nextChallenge,"Next Challenge Hash: ")),s.push(m),await c2(M,d,s),await e.close(),await M.close(),k;async function W(u,L,$,Q,H,q){let y=[];e.pos=h[u][0].p,await Ft.startWriteSection(M,u),x[u]=M.pos;let I=d[L],N=I.F.n8*2,nt=Math.floor((1<<20)/N),J=Q;for(let j=0;j<$;j+=nt){o&&o.debug(`processing: ${q}: ${j}/${$}`);let ot=Math.min($-j,nt),V=await e.read(ot*N),at=await I.batchApplyKey(V,J,H),Lt=M.write(at),rt=await I.batchLEMtoC(at);if(v.update(rt),await Lt,j==0)for(let ht=0;ht<Math.min(2,$);ht++)y.push(I.fromRprLEM(at,ht*N));J=d.Fr.mul(J,d.Fr.exp(H,ot))}return await Ft.endWriteSection(M),y}async function F(u,L,$,Q,H){let q=d[L],y=q.F.n8*2,I=Math.floor((1<<24)/y),N=u.pos;u.pos=x[$];for(let nt=0;nt<Q;nt+=I){o&&nt&&o.debug(`Hashing ${H}: `+nt);let J=Math.min(Q-nt,I),j=await u.read(J*y),ot=await q.batchLEMtoU(j);O.update(ot)}u.pos=N}}async function W6(c,t,n){let{fd:a,sections:o}=await Ft.readBinFile(c,"ptau",1),{curve:e,power:h}=await ra(a,o),d=await Ft.createBinFile(t,"ptau",1,11);await wo(d,e,h),await Ft.copySection(a,o,d,2),await Ft.copySection(a,o,d,3),await Ft.copySection(a,o,d,4),await Ft.copySection(a,o,d,5),await Ft.copySection(a,o,d,6),await Ft.copySection(a,o,d,7),await b(2,12,"G1","tauG1"),await b(3,13,"G2","tauG2"),await b(4,14,"G1","alphaTauG1"),await b(5,15,"G1","betaTauG1"),await a.close(),await d.close();return;async function b(l,s,m,B){n&&n.debug("Starting section: "+B),await Ft.startWriteSection(d,s);for(let v=0;v<=h;v++)await p(v);l==2&&await p(h+1),await Ft.endWriteSection(d);async function p(v){let M=2**v,x=e[m];e.Fr;let S=x.F.n8*2;x.F.n8*3;let w;w=new vt.BigBuffer(M*S),await Ft.startReadUniqueSection(a,o,l),l==2&&v==h+1?(await a.readToBuffer(w,0,(M-1)*S),w.set(e.G1.zeroAffine,(M-1)*S)):await a.readToBuffer(w,0,M*S),await Ft.endReadSection(a,!0),w=await x.lagrangeEvaluations(w,"affine","affine",n,B),await d.write(w)}}}async function Q6(c,t,n){let{fd:a,sections:o}=await Ft.readBinFile(c,"ptau",1),{curve:e,power:h,ceremonyPower:d}=await ra(a,o),b=e.G1.F.n8*2,l=e.G2.F.n8*2;for(let m=1;m<h;m++)await s(m);return await a.close(),!0;async function s(m){let B=m.toString();for(;B.length<2;)B="0"+B;n&&n.debug("Writing Power: "+B);let p=await Ft.createBinFile(t+B+".ptau","ptau",1,11);await wo(p,e,m,d),await Ft.copySection(a,o,p,2,(2**m*2-1)*b),await Ft.copySection(a,o,p,3,2**m*l),await Ft.copySection(a,o,p,4,2**m*b),await Ft.copySection(a,o,p,5,2**m*b),await Ft.copySection(a,o,p,6,l),await Ft.copySection(a,o,p,7),await Ft.copySection(a,o,p,12,(2**(m+1)*2-1)*b),await Ft.copySection(a,o,p,13,(2**m*2-1)*l),await Ft.copySection(a,o,p,14,(2**m*2-1)*b),await Ft.copySection(a,o,p,15,(2**m*2-1)*b),await p.close()}}async function X6(c,t,n){let{fd:a,sections:o}=await Ft.readBinFile(c,"ptau",1),{curve:e,power:h}=await ra(a,o),d=await Ft.createBinFile(t,"ptau",1,11);await wo(d,e,h),await Ft.copySection(a,o,d,2),await Ft.copySection(a,o,d,3),await Ft.copySection(a,o,d,4),await Ft.copySection(a,o,d,5),await Ft.copySection(a,o,d,6),await Ft.copySection(a,o,d,7),await b(2,12,"G1","tauG1"),await Ft.copySection(a,o,d,13),await Ft.copySection(a,o,d,14),await Ft.copySection(a,o,d,15),await a.close(),await d.close();return;async function b(l,s,m,B){n&&n.debug("Starting section: "+B),await Ft.startWriteSection(d,s);let p=o[s][0].size,v=a.pageSize;await Ft.startReadUniqueSection(a,o,s);for(let x=0;x<p;x+=v){let S=Math.min(p-x,v),w=await a.read(S);await d.write(w)}await Ft.endReadSection(a),l==2&&await M(h+1),await Ft.endWriteSection(d);async function M(x){let S=2**x,w=e[m],k=w.F.n8*2,O;O=new vt.BigBuffer(S*k),await Ft.startReadUniqueSection(a,o,l),l==2&&x==h+1?(await a.readToBuffer(O,0,(S-1)*k),O.set(e.G1.zeroAffine,(S-1)*k)):await a.readToBuffer(O,0,S*k),await Ft.endReadSection(a,!0),O=await w.lagrangeEvaluations(O,"affine","affine",n,B),await d.write(O)}}}async function H6(c,t){let{fd:n,sections:a}=await Ft.readBinFile(c,"ptau",1),{curve:o,power:e}=await ra(n,a),h={};return h.q=o.q,h.power=e,h.contributions=await oi(n,o,a),h.tauG1=await d(2,"G1",2**e*2-1,"tauG1"),h.tauG2=await d(3,"G2",2**e,"tauG2"),h.alphaTauG1=await d(4,"G1",2**e,"alphaTauG1"),h.betaTauG1=await d(5,"G1",2**e,"betaTauG1"),h.betaG2=await d(6,"G2",1,"betaG2"),h.lTauG1=await b(12,"G1","lTauG1"),h.lTauG2=await b(13,"G2","lTauG2"),h.lAlphaTauG1=await b(14,"G1","lAlphaTauG2"),h.lBetaTauG1=await b(15,"G1","lBetaTauG2"),await n.close(),ms(o.Fr,h);async function d(l,s,m,B){let p=o[s],v=p.F.n8*2,M=[];await Ft.startReadUniqueSection(n,a,l);for(let x=0;x<m;x++){t&&x&&x%1e4==0&&console.log(`${B}: `+x);let S=await n.read(v);M.push(p.fromRprLEM(S,0))}return await Ft.endReadSection(n),M}async function b(l,s,m){let B=o[s],p=B.F.n8*2,v=[];await Ft.startReadUniqueSection(n,a,l);for(let M=0;M<=e;M++){t&&console.log(`${m}: Power: ${M}`),v[M]=[];let x=2**M;for(let S=0;S<x;S++){t&&S&&S%1e4==0&&console.log(`${m}: ${S}/${x}`);let w=await n.read(p);v[M].push(B.fromRprLEM(w,0))}}return await Ft.endReadSection(n,!0),v}}var D6=Object.freeze({__proto__:null,newAccumulator:k6,exportChallenge:U6,importResponse:N6,verify:$6,challengeContribute:Z6,beacon:j6,contribute:V6,preparePhase2:W6,truncate:Q6,convert:X6,exportJson:H6});function K6(c,t,n){for(let o=0;o<c.constraints.length;o++)a(c.constraints[o]);function a(o){let e=d=>{let b="";return Object.keys(d).forEach(s=>{let m=t.varIdx2Name[s];m=="one"&&(m="1");let B=c.curve.Fr.toString(d[s]);B=="1"&&(B=""),B=="-1"&&(B="-"),b!=""&&B[0]!="-"&&(B="+"+B),b!=""&&(B=" "+B),b=b+B+m}),b},h=`[ ${e(o[0])} ] * [ ${e(o[1])} ] - [ ${e(o[2])} ] = 0`;n&&n.info(h)}}var J6=vt.Scalar.e("73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001",16),Y6=vt.Scalar.e("21888242871839275222246405745257275088548364400416034343698204186575808495617");async function ty(c,t){let n=await ni.readR1cs(c);return vt.Scalar.eq(n.prime,Y6)?t&&t.info("Curve: bn-128"):vt.Scalar.eq(n.prime,J6)?t&&t.info("Curve: bls12-381"):t&&t.info(`Unknown Curve. Prime: ${vt.Scalar.toString(n.prime)}`),t&&t.info(`# of Wires: ${n.nVars}`),t&&t.info(`# of Constraints: ${n.nConstraints}`),t&&t.info(`# of Private Inputs: ${n.nPrvInputs}`),t&&t.info(`# of Public Inputs: ${n.nPubInputs}`),t&&t.info(`# of Labels: ${n.nLabels}`),t&&t.info(`# of Outputs: ${n.nOutputs}`),n}async function ny(c,t){let n=await ni.readR1cs(c,!0,!0,!0,t),a=n.curve.Fr;return delete n.curve,delete n.F,ms(a,n)}var ay=Object.freeze({__proto__:null,print:K6,info:ty,exportJson:ny});async function gs(c){let t={labelIdx2Name:["one"],varIdx2Name:["one"],componentIdx2Name:[]},n=await la.readExisting(c),a=await n.read(n.totalSize),e=new TextDecoder("utf-8").decode(a).split(`
`);for(let d=0;d<e.length;d++){let b=e[d].split(",");b.length==4&&(t.varIdx2Name[b[1]]?t.varIdx2Name[b[1]]+="|"+b[3]:t.varIdx2Name[b[1]]=b[3],t.labelIdx2Name[b[0]]=b[3],t.componentIdx2Name[b[2]]||(t.componentIdx2Name[b[2]]=h(b[3])))}return await n.close(),t;function h(d){let b=d.split(".");return b.pop(),b.join(".")}}var{unstringifyBigInts:oy}=vt.utils;async function iy(c,t,n,a,o,e){let h=oy(c),d=await la.readExisting(t),b=await d.read(d.totalSize);await d.close();let l={...o,sanityCheck:!0},s=await gs(a);o.set&&(s||(s=await gs(a)),l.logSetSignal=function(v,M){e&&e.info("SET "+s.labelIdx2Name[v]+" <-- "+M.toString())}),o.get&&(s||(s=await gs(a)),l.logGetSignal=function(v,M){e&&e.info("GET "+s.labelIdx2Name[v]+" --> "+M.toString())}),o.trigger&&(s||(s=await gs(a)),l.logStartComponent=function(v){e&&e.info("START: "+s.componentIdx2Name[v])},l.logFinishComponent=function(v){e&&e.info("FINISH: "+s.componentIdx2Name[v])}),l.sym=s;let m=await c0.WitnessCalculatorBuilder(b,l),B=await m.calculateWitness(h,!0),p=await Ft.createBinFile(n,"wtns",2,2);await w6(p,B,m.prime),await p.close()}async function ey(c){return await C6(c)}async function cy(c,t,n){n&&n.info("WITNESS CHECKING STARTED"),n&&n.info("> Reading r1cs file");let{fd:a,sections:o}=await Ft.readBinFile(c,"r1cs",1,1<<22,1<<24),e=await ni.readR1csFd(a,o,{loadConstraints:!1,loadCustomGates:!1});n&&n.info("> Reading witness file");let{fd:h,sections:d}=await Ft.readBinFile(t,"wtns",2,1<<22,1<<24),b=await Ce(h,d);if(!vt.Scalar.eq(e.prime,b.q))throw new Error("Curve of the witness does not match the curve of the proving key");let l=await Ft.readSection(h,d,2);await h.close();let m=(await d0(e.prime)).Fr,B=m.n8,p=await Ft.readSection(a,o,2);n&&(n.info("----------------------------"),n.info("  WITNESS CHECK"),n.info(`  Curve:          ${e.curve.name}`),n.info(`  Vars (wires):   ${e.nVars}`),n.info(`  Outputs:        ${e.nOutputs}`),n.info(`  Public Inputs:  ${e.nPubInputs}`),n.info(`  Private Inputs: ${e.nPrvInputs}`),n.info(`  Labels:         ${e.nLabels}`),n.info(`  Constraints:    ${e.nConstraints}`),n.info(`  Custom Gates:   ${e.useCustomGates}`),n.info("----------------------------")),n&&n.info("> Checking witness correctness");let v=0,M=!0;for(let k=0;k<e.nConstraints;k++){n&&k!==0&&k%5e5===0&&n.info(`\xB7\xB7\xB7 processing r1cs constraints ${k}/${e.nConstraints}`);let O=S(),W=S(),F=S(),u=x(O),L=x(W),$=x(F);if(!m.eq(m.sub(m.mul(u,L),$),m.zero)){n.warn("\xB7\xB7\xB7 aborting checking process at constraint "+k),M=!1;break}}return a.close(),n&&(M?(n.info("WITNESS IS CORRECT"),n.info("WITNESS CHECKING FINISHED SUCCESSFULLY")):(n.warn("WITNESS IS NOT CORRECT"),n.warn("WITNESS CHECKING FINISHED UNSUCCESSFULLY"))),M;function x(k){let O=m.zero;return Object.keys(k).forEach(F=>{let u=w(F),L=k[F];O=m.add(O,m.mul(u,L))}),O}function S(){let k={},O=p.slice(v,v+4);v+=4;let F=new DataView(O.buffer).getUint32(0,!0),u=p.slice(v,v+(4+e.n8)*F);v+=(4+e.n8)*F;let L=new DataView(u.buffer);for(let $=0;$<F;$++){let Q=L.getUint32($*(4+e.n8),!0),H=e.F.fromRprLE(u,$*(4+e.n8)+4);k[Q]=H}return k}function w(k){return m.fromRprLE(l.slice(k*B,k*B+B))}}var sy=Object.freeze({__proto__:null,calculate:Bs,debug:iy,exportJson:ey,check:cy}),Aa=262144,ly={get:function(c,t){return isNaN(t)?c[t]:c.getElement(t)},set:function(c,t,n){return isNaN(t)?(c[t]=n,!0):c.setElement(t,n)}},Jd=class{constructor(t){this.length=t||0,this.arr=new Array(Aa);for(let n=0;n<t;n+=Aa)this.arr[n/Aa]=new Array(Math.min(Aa,t-n));return this}push(){for(let t=0;t<arguments.length;t++)this.setElement(this.length,arguments[t])}slice(t,n){let a=new Array(n-t);for(let o=t;o<n;o++)a[o-t]=this.getElement(o);return a}getElement(t){t=parseInt(t);let n=Math.floor(t/Aa),a=t%Aa;return this.arr[n]?this.arr[n][a]:void 0}setElement(t,n){t=parseInt(t);let a=Math.floor(t/Aa);this.arr[a]||(this.arr[a]=new Array(Aa));let o=t%Aa;return this.arr[a][o]=n,t>=this.length&&(this.length=t+1),!0}getKeys(){let t=new Un;for(let n=0;n<this.arr.length;n++)if(this.arr[n])for(let a=0;a<this.arr[n].length;a++)typeof this.arr[n][a]<"u"&&t.push(n*Aa+a);return t}},Un=class{constructor(t){let n=new Jd(t);return new Proxy(n,ly)}};async function b0(c,t,n,a){let b=rn.blake2b.create({dkLen:64}),{fd:l,sections:s}=await Gt.readBinFile(t,"ptau",1,1<<22,1<<24),{curve:m,power:B}=await ra(l,s),{fd:p,sections:v}=await Gt.readBinFile(c,"r1cs",1,1<<22,1<<24),M=await ni.readR1csHeader(p,v,!1),x=await Gt.createBinFile(n,"zkey",1,10,1<<22,1<<24),S=m.G1.F.n8*2,w=m.G2.F.n8*2;if(M.prime!=m.r)return a&&a.error("r1cs curve does not match powers of tau ceremony curve"),-1;let k=ao(M.nConstraints+M.nPubInputs+M.nOutputs+1-1)+1;if(k>B)return a&&a.error(`circuit too big for this power of tau ceremony. ${M.nConstraints}*2 > 2**${B}`),-1;if(!s[12])return a&&a.error("Powers of tau is not prepared."),-1;let O=M.nOutputs+M.nPubInputs,W=2**k;await Gt.startWriteSection(x,1),await x.writeULE32(1),await Gt.endWriteSection(x),await Gt.startWriteSection(x,2);let F=m.q,u=(Math.floor((vt.Scalar.bitLength(F)-1)/64)+1)*8,L=m.r,$=(Math.floor((vt.Scalar.bitLength(L)-1)/64)+1)*8,Q=vt.Scalar.mod(vt.Scalar.shl(1,$*8),L),H=m.Fr.e(vt.Scalar.mod(vt.Scalar.mul(Q,Q),L));await x.writeULE32(u),await Gt.writeBigInt(x,F,u),await x.writeULE32($),await Gt.writeBigInt(x,L,$),await x.writeULE32(M.nVars),await x.writeULE32(O),await x.writeULE32(W);let q;q=await l.read(S,s[4][0].p),await x.write(q),q=await m.G1.batchLEMtoU(q),b.update(q);let y;y=await l.read(S,s[5][0].p),await x.write(y),y=await m.G1.batchLEMtoU(y),b.update(y);let I;I=await l.read(w,s[6][0].p),await x.write(I),I=await m.G2.batchLEMtoU(I),b.update(I);let N=new Uint8Array(S);m.G1.toRprLEM(N,0,m.G1.g);let nt=new Uint8Array(w);m.G2.toRprLEM(nt,0,m.G2.g);let J=new Uint8Array(S);m.G1.toRprUncompressed(J,0,m.G1.g);let j=new Uint8Array(w);m.G2.toRprUncompressed(j,0,m.G2.g),await x.write(nt),await x.write(N),await x.write(nt),b.update(j),b.update(J),b.update(j),await Gt.endWriteSection(x),a&&a.info("Reading r1cs");let ot=await Gt.readSection(p,v,2),V=new Un(M.nVars),at=new Un(M.nVars),Lt=new Un(M.nVars),rt=new Un(M.nVars-O-1),ht=new Array(O+1);a&&a.info("Reading tauG1");let A=await Gt.readSection(l,s,12,(W-1)*S,W*S);a&&a.info("Reading tauG2");let i=await Gt.readSection(l,s,13,(W-1)*w,W*w);a&&a.info("Reading alphatauG1");let C=await Gt.readSection(l,s,14,(W-1)*S,W*S);a&&a.info("Reading betatauG1");let r=await Gt.readSection(l,s,15,(W-1)*S,W*S);await g(),await U(3,"G1",ht,"IC"),await E(),await et(),await U(8,"G1",rt,"C"),await U(5,"G1",V,"A"),await U(6,"G1",at,"B1"),await U(7,"G2",Lt,"B2");let z=b.digest();return await Gt.startWriteSection(x,10),await x.write(z),await x.writeULE32(0),await Gt.endWriteSection(x),a&&a.info(hn(z,"Circuit hash: ")),await x.close(),await p.close(),await l.close(),z;async function E(){await Gt.startWriteSection(x,9);let gt=new vt.BigBuffer(W*S);if(k<m.Fr.s){let yt=await Gt.readSection(l,s,12,(W*2-1)*S,W*2*S);for(let ut=0;ut<W;ut++){a&&ut%1e4==0&&a.debug(`splitting buffer: ${ut}/${W}`);let lt=yt.slice((ut*2+1)*S,(ut*2+1)*S+S);gt.set(lt,ut*S)}}else if(k==m.Fr.s){let yt=s[12][0].p+(2**(k+1)-1)*S;await l.readToBuffer(gt,0,W*S,yt+W*S)}else throw a&&a.error("Circuit too big"),new Error("Circuit too big for this curve");await x.write(gt),await Gt.endWriteSection(x)}async function g(){let gt=new Uint8Array(12+m.Fr.n8),yt=new DataView(gt.buffer),ut=new Uint8Array(m.Fr.n8);m.Fr.toRprLE(ut,0,m.Fr.e(1));let lt=0;function bt(){let qt=ot.slice(lt,lt+4);return lt+=4,new DataView(qt.buffer).getUint32(0,!0)}let Et=new Un;for(let qt=0;qt<M.nConstraints;qt++){a&&qt%1e4==0&&a.debug(`processing constraints: ${qt}/${M.nConstraints}`);let Rt=bt();for(let X=0;X<Rt;X++){let _=bt(),f=lt;lt+=m.Fr.n8;let R=0,G=S*qt,P=3,Z=S*qt;typeof V[_]>"u"&&(V[_]=[]),V[_].push([R,G,f]),_<=O?(typeof ht[_]>"u"&&(ht[_]=[]),ht[_].push([P,Z,f])):(typeof rt[_-O-1]>"u"&&(rt[_-O-1]=[]),rt[_-O-1].push([P,Z,f])),Et.push([0,qt,_,f])}let Kt=bt();for(let X=0;X<Kt;X++){let _=bt(),f=lt;lt+=m.Fr.n8;let R=0,G=S*qt,P=1,Z=w*qt,T=2,D=S*qt;typeof at[_]>"u"&&(at[_]=[]),at[_].push([R,G,f]),typeof Lt[_]>"u"&&(Lt[_]=[]),Lt[_].push([P,Z,f]),_<=O?(typeof ht[_]>"u"&&(ht[_]=[]),ht[_].push([T,D,f])):(typeof rt[_-O-1]>"u"&&(rt[_-O-1]=[]),rt[_-O-1].push([T,D,f])),Et.push([1,qt,_,f])}let Ut=bt();for(let X=0;X<Ut;X++){let _=bt(),f=lt;lt+=m.Fr.n8;let R=0,G=S*qt;_<=O?(typeof ht[_]>"u"&&(ht[_]=[]),ht[_].push([R,G,f])):(typeof rt[_-O-1]>"u"&&(rt[_-O-1]=[]),rt[_-O-1].push([R,G,f]))}}for(let qt=0;qt<=O;qt++){let Kt=S*(M.nConstraints+qt),Ut=3,X=S*(M.nConstraints+qt);typeof V[qt]>"u"&&(V[qt]=[]),V[qt].push([0,Kt,-1]),typeof ht[qt]>"u"&&(ht[qt]=[]),ht[qt].push([Ut,X,-1]),Et.push([0,M.nConstraints+qt,qt,-1])}await Gt.startWriteSection(x,4);let It=new vt.BigBuffer(Et.length*(12+m.Fr.n8)+4),zt=new Uint8Array(4);new DataView(zt.buffer).setUint32(0,Et.length,!0),It.set(zt);let kt=4;for(let qt=0;qt<Et.length;qt++)a&&qt%1e5==0&&a.debug(`writing coeffs: ${qt}/${Et.length}`),Pt(Et[qt]);await x.write(It),await Gt.endWriteSection(x);function Pt(qt){yt.setUint32(0,qt[0],!0),yt.setUint32(4,qt[1],!0),yt.setUint32(8,qt[2],!0);let Rt;qt[3]>=0?Rt=m.Fr.fromRprLE(ot.slice(qt[3],qt[3]+m.Fr.n8),0):Rt=m.Fr.fromRprLE(ut,0);let Kt=m.Fr.mul(Rt,H);m.Fr.toRprLE(gt,12,Kt),It.set(gt,kt),kt+=gt.length}}async function U(gt,yt,ut,lt){let Et=m[yt];_t(ut.length),await Gt.startWriteSection(x,gt);let It=[],zt=0;for(;zt<ut.length;){let Mt=0;for(;zt<ut.length&&Mt<m.tm.concurrency;){a&&a.debug(`Writing points start ${lt}: ${zt}/${ut.length}`);let Pt=1,qt=ut[zt]?ut[zt].length:0;for(;zt+Pt<ut.length&&qt+(ut[zt+Pt]?ut[zt+Pt].length:0)<32768&&Pt<32768;)qt+=ut[zt+Pt]?ut[zt+Pt].length:0,Pt++;let Rt=ut.slice(zt,zt+Pt),Kt=zt;It.push(st(yt,Rt,a,lt).then(Ut=>(a&&a.debug(`Writing points end ${lt}: ${Kt}/${ut.length}`),Ut))),zt+=Pt,Mt++}let kt=await Promise.all(It);for(let Pt=0;Pt<kt.length;Pt++){await x.write(kt[Pt][0]);let qt=await Et.batchLEMtoU(kt[Pt][0]);b.update(qt)}It=[]}await Gt.endWriteSection(x)}async function st(gt,yt,ut,lt){let bt=m[gt],Et=bt.F.n8*2,It=bt.F.n8*3,zt=bt.F.n8*2,Mt,kt,Pt,qt;if(gt=="G1")Mt="g1m_timesScalarAffine",kt="g1m_multiexpAffine",Pt="g1m_batchToAffine",qt="g1m_zero";else if(gt=="G2")Mt="g2m_timesScalarAffine",kt="g2m_multiexpAffine",Pt="g2m_batchToAffine",qt="g2m_zero";else throw new Error("Invalid group");let Rt=0;for(let P=0;P<yt.length;P++)Rt+=yt[P]?yt[P].length:0;let Kt,Ut;Rt>32768?(Kt=new vt.BigBuffer(Rt*Et),Ut=new vt.BigBuffer(Rt*m.Fr.n8)):(Kt=new Uint8Array(Rt*Et),Ut=new Uint8Array(Rt*m.Fr.n8));let X=0,_=0,f=[A,i,C,r],R=new Uint8Array(m.Fr.n8);m.Fr.toRprLE(R,0,m.Fr.e(1));let G=0;for(let P=0;P<yt.length;P++)if(yt[P])for(let Z=0;Z<yt[P].length;Z++)ut&&Z&&Z%1e4==0&&ut.debug(`Configuring big array ${lt}: ${Z}/${yt[P].length}`),Kt.set(f[yt[P][Z][0]].slice(yt[P][Z][1],yt[P][Z][1]+Et),G*Et),yt[P][Z][2]>=0?Ut.set(ot.slice(yt[P][Z][2],yt[P][Z][2]+m.Fr.n8),G*m.Fr.n8):Ut.set(R,G*m.Fr.n8),G++;if(yt.length>1){let P=[];P.push({cmd:"ALLOCSET",var:0,buff:Kt}),P.push({cmd:"ALLOCSET",var:1,buff:Ut}),P.push({cmd:"ALLOC",var:2,len:yt.length*It}),X=0,_=0;let Z=0;for(let D=0;D<yt.length;D++){if(!yt[D]){P.push({cmd:"CALL",fnName:qt,params:[{var:2,offset:Z}]}),Z+=It;continue}yt[D].length==1?P.push({cmd:"CALL",fnName:Mt,params:[{var:0,offset:X},{var:1,offset:_},{val:m.Fr.n8},{var:2,offset:Z}]}):P.push({cmd:"CALL",fnName:kt,params:[{var:0,offset:X},{var:1,offset:_},{val:m.Fr.n8},{val:yt[D].length},{var:2,offset:Z}]}),X+=Et*yt[D].length,_+=m.Fr.n8*yt[D].length,Z+=It}return P.push({cmd:"CALL",fnName:Pt,params:[{var:2},{val:yt.length},{var:2}]}),P.push({cmd:"GET",out:0,var:2,len:yt.length*zt}),await m.tm.queueAction(P)}else{let P=await bt.multiExpAffine(Kt,Ut,ut,lt);return P=[bt.toAffine(P)],P}}async function et(){_t(W-1);for(let yt=0;yt<W-1;yt+=16384){a&&a.debug(`HashingHPoints: ${yt}/${W}`);let ut=Math.min(W-1,16384);await ct(yt,ut)}}async function ct(gt,yt){let ut=await l.read(yt*S,s[2][0].p+(gt+W)*S),lt=await l.read(yt*S,s[2][0].p+gt*S),bt=m.tm.concurrency,Et=Math.floor(yt/bt),It=[];for(let Mt=0;Mt<bt;Mt++){let kt;if(Mt<bt-1?kt=Et:kt=yt-Mt*Et,kt==0)continue;let Pt=ut.slice(Mt*Et*S,(Mt*Et+kt)*S),qt=lt.slice(Mt*Et*S,(Mt*Et+kt)*S);It.push(ft(Pt,qt))}let zt=await Promise.all(It);for(let Mt=0;Mt<zt.length;Mt++)b.update(zt[Mt][0])}async function ft(gt,yt){let ut=gt.byteLength/S,lt=m.G1.F.n8*3,bt=[];bt.push({cmd:"ALLOCSET",var:0,buff:gt}),bt.push({cmd:"ALLOCSET",var:1,buff:yt}),bt.push({cmd:"ALLOC",var:2,len:ut*lt});for(let It=0;It<ut;It++)bt.push({cmd:"CALL",fnName:"g1m_subAffine",params:[{var:0,offset:It*S},{var:1,offset:It*S},{var:2,offset:It*lt}]});return bt.push({cmd:"CALL",fnName:"g1m_batchToAffine",params:[{var:2},{val:ut},{var:2}]}),bt.push({cmd:"CALL",fnName:"g1m_batchLEMtoU",params:[{var:2},{val:ut},{var:2}]}),bt.push({cmd:"GET",out:0,var:2,len:ut*S}),await m.tm.queueAction(bt)}function _t(gt){let yt=new Uint8Array(4);new DataView(yt.buffer,yt.byteOffset,yt.byteLength).setUint32(0,gt,!1),b.update(yt)}}async function ry(c,t,n){let{fd:a,sections:o}=await Ft.readBinFile(c,"zkey",2),e=await La(a,o);if(e.protocol!="groth16")throw new Error("zkey file is not groth16");let h=await Kn(e.q),d=h.G1.F.n8*2,b=h.G2.F.n8*2,l=await ti(a,h,o),s=await la.createOverride(t);await w(e.vk_alpha_1),await w(e.vk_beta_1),await k(e.vk_beta_2),await k(e.vk_gamma_2),await w(e.vk_delta_1),await k(e.vk_delta_2);let m;m=await Ft.readSection(a,o,3),m=await h.G1.batchLEMtoU(m),await O("G1",m);let B=await Ft.readSection(a,o,9),p;p=await h.G1.fft(B,"affine","jacobian",n),p=await h.G1.batchApplyKey(p,h.Fr.neg(h.Fr.e(2)),h.Fr.w[e.power+1],"jacobian","affine",n),p=p.slice(0,p.byteLength-d),p=await h.G1.batchLEMtoU(p),await O("G1",p);let v;v=await Ft.readSection(a,o,8),v=await h.G1.batchLEMtoU(v),await O("G1",v);let M;M=await Ft.readSection(a,o,5),M=await h.G1.batchLEMtoU(M),await O("G1",M);let x;x=await Ft.readSection(a,o,6),x=await h.G1.batchLEMtoU(x),await O("G1",x);let S;S=await Ft.readSection(a,o,7),S=await h.G2.batchLEMtoU(S),await O("G2",S),await s.write(l.csHash),await W(l.contributions.length);for(let F=0;F<l.contributions.length;F++){let u=l.contributions[F];await w(u.deltaAfter),await w(u.delta.g1_s),await w(u.delta.g1_sx),await k(u.delta.g2_spx),await s.write(u.transcript)}await a.close(),await s.close();async function w(F){let u=new Uint8Array(d);h.G1.toRprUncompressed(u,0,F),await s.write(u)}async function k(F){let u=new Uint8Array(b);h.G2.toRprUncompressed(u,0,F),await s.write(u)}async function O(F,u){let L;F=="G1"?L=d:L=b;let $=new Uint8Array(4);new DataView($.buffer,$.byteOffset,$.byteLength).setUint32(0,u.byteLength/L,!1),await s.write($),await s.write(u)}async function W(F){let u=new Uint8Array(4);new DataView(u.buffer,u.byteOffset,u.byteLength).setUint32(0,F,!1),await s.write(u)}}async function dy(c,t,n,a,o){let{fd:e,sections:h}=await Ft.readBinFile(c,"zkey",2),d=await La(e,h,!1);if(d.protocol!="groth16")throw new Error("zkey file is not groth16");let b=await Kn(d.q),l=b.G1.F.n8*2,s=b.G2.F.n8*2,m=await ti(e,b,h),B={},p=await la.readExisting(t);p.pos=l*3+s*3+8+l*d.nVars+4+l*(d.domainSize-1)+4+l*d.nVars+4+l*d.nVars+4+s*d.nVars,B.csHash=await p.read(64);let v=await p.readUBE32();B.contributions=[];for(let N=0;N<v;N++){let nt={delta:{}};nt.deltaAfter=await q(p),nt.delta.g1_s=await q(p),nt.delta.g1_sx=await q(p),nt.delta.g2_spx=await y(p),nt.transcript=await p.read(64),N<m.contributions.length&&(nt.type=m.contributions[N].type,nt.type==1&&(nt.beaconHash=m.contributions[N].beaconHash,nt.numIterationsExp=m.contributions[N].numIterationsExp),m.contributions[N].name&&(nt.name=m.contributions[N].name)),B.contributions.push(nt)}if(!to(B.csHash,m.csHash))return o&&o.error("Hash of the original circuit does not match with the MPC one"),!1;if(m.contributions.length>B.contributions.length)return o&&o.error("The impoerted file does not include new contributions"),!1;for(let N=0;N<m.contributions.length;N++)if(!I(m.contributions[N],B.contributions[N]))return o&&o.error(`Previous contribution ${N} does not match`),!1;if(a)for(let N=m.contributions.length;N<B.contributions.length;N++)B.contributions[N].name=a;let M=await Ft.createBinFile(n,"zkey",1,10);if(p.pos=0,p.pos+=l,p.pos+=l,p.pos+=s,p.pos+=s,d.vk_delta_1=await q(p),d.vk_delta_2=await y(p),await o2(M,d),await p.readUBE32()!=d.nPublic+1)return o&&o.error("Invalid number of points in IC"),await M.discard(),!1;if(p.pos+=l*(d.nPublic+1),await Ft.copySection(e,h,M,3),await Ft.copySection(e,h,M,4),await p.readUBE32()!=d.domainSize-1)return o&&o.error("Invalid number of points in H"),await M.discard(),!1;let w,k=await p.read(l*(d.domainSize-1)),O=await b.G1.batchUtoLEM(k);w=new Uint8Array(d.domainSize*l),w.set(O),b.G1.toRprLEM(w,l*(d.domainSize-1),b.G1.zeroAffine);let W=b.Fr.neg(b.Fr.inv(b.Fr.e(2))),F=b.Fr.inv(b.Fr.w[d.power+1]);if(w=await b.G1.batchApplyKey(w,W,F,"affine","jacobian",o),w=await b.G1.ifft(w,"jacobian","affine",o),await Ft.startWriteSection(M,9),await M.write(w),await Ft.endWriteSection(M),await p.readUBE32()!=d.nVars-d.nPublic-1)return o&&o.error("Invalid number of points in L"),await M.discard(),!1;let L;if(L=await p.read(l*(d.nVars-d.nPublic-1)),L=await b.G1.batchUtoLEM(L),await Ft.startWriteSection(M,8),await M.write(L),await Ft.endWriteSection(M),await p.readUBE32()!=d.nVars)return o&&o.error("Invalid number of points in A"),await M.discard(),!1;if(p.pos+=l*d.nVars,await Ft.copySection(e,h,M,5),await p.readUBE32()!=d.nVars)return o&&o.error("Invalid number of points in B1"),await M.discard(),!1;if(p.pos+=l*d.nVars,await Ft.copySection(e,h,M,6),await p.readUBE32()!=d.nVars)return o&&o.error("Invalid number of points in B2"),await M.discard(),!1;return p.pos+=s*d.nVars,await Ft.copySection(e,h,M,7),await i2(M,b,B),await p.close(),await M.close(),await e.close(),!0;async function q(N){let nt=await N.read(b.G1.F.n8*2);return b.G1.fromRprUncompressed(nt,0)}async function y(N){let nt=await N.read(b.G2.F.n8*2);return b.G2.fromRprUncompressed(nt,0)}function I(N,nt){return!(!b.G1.eq(N.deltaAfter,nt.deltaAfter)||!b.G1.eq(N.delta.g1_s,nt.delta.g1_s)||!b.G1.eq(N.delta.g1_sx,nt.delta.g1_sx)||!b.G2.eq(N.delta.g2_spx,nt.delta.g2_spx)||!to(N.transcript,nt.transcript))}}var de=_0;async function m0(c,t,n,a){let o,{fd:e,sections:h}=await Ft.readBinFile(n,"zkey",2),d=await La(e,h,!1);if(d.protocol!="groth16")throw new Error("zkey file is not groth16");let b=await Kn(d.q),l=b.G1.F.n8*2,s=await ti(e,b,h),m=rn.blake2b.create({dkLen:64});m.update(s.csHash);let B=b.G1.g;for(let F=0;F<s.contributions.length;F++){let u=s.contributions[F],L=s6(m);if(ga(L,b,u.delta.g1_s),ga(L,b,u.delta.g1_sx),!to(L.digest(),u.transcript))return console.log(`INVALID(${F}): Inconsistent transcript `),!1;let $=Be(b,u.transcript);if(o=await de(b,u.delta.g1_s,u.delta.g1_sx,$,u.delta.g2_spx),o!==!0)return console.log(`INVALID(${F}): public key G1 and G2 do not have the same ration `),!1;if(o=await de(b,B,u.deltaAfter,$,u.delta.g2_spx),o!==!0)return console.log(`INVALID(${F}): deltaAfter does not fillow the public key `),!1;if(u.type==1){let H=await a2(u.beaconHash,u.numIterationsExp),q=b.Fr.fromRng(H),y=b.G1.toAffine(b.G1.fromRng(H)),I=b.G1.toAffine(b.G1.timesFr(y,q));if(b.G1.eq(y,u.delta.g1_s)!==!0)return console.log(`INVALID(${F}): Key of the beacon does not match. g1_s `),!1;if(b.G1.eq(I,u.delta.g1_sx)!==!0)return console.log(`INVALID(${F}): Key of the beacon does not match. g1_sx `),!1}no(m,b,u);let Q=rn.blake2b.create({dkLen:64});no(Q,b,u),u.contributionHash=Q.digest(),B=u.deltaAfter}let{fd:p,sections:v}=await Ft.readBinFile(c,"zkey",2),M=await La(p,v,!1);if(M.protocol!="groth16")throw new Error("zkeyinit file is not groth16");if(!vt.Scalar.eq(M.q,d.q)||!vt.Scalar.eq(M.r,d.r)||M.n8q!=d.n8q||M.n8r!=d.n8r)return a&&a.error("INVALID:  Different curves"),!1;if(M.nVars!=d.nVars||M.nPublic!=d.nPublic||M.domainSize!=d.domainSize)return a&&a.error("INVALID:  Different circuit parameters"),!1;if(!b.G1.eq(d.vk_alpha_1,M.vk_alpha_1))return a&&a.error("INVALID:  Invalid alpha1"),!1;if(!b.G1.eq(d.vk_beta_1,M.vk_beta_1))return a&&a.error("INVALID:  Invalid beta1"),!1;if(!b.G2.eq(d.vk_beta_2,M.vk_beta_2))return a&&a.error("INVALID:  Invalid beta2"),!1;if(!b.G2.eq(d.vk_gamma_2,M.vk_gamma_2))return a&&a.error("INVALID:  Invalid gamma2"),!1;if(!b.G1.eq(d.vk_delta_1,B))return a&&a.error("INVALID:  Invalid delta1"),!1;if(o=await de(b,b.G1.g,B,b.G2.g,d.vk_delta_2),o!==!0)return a&&a.error("INVALID:  Invalid delta2"),!1;let x=await ti(p,b,v);if(!to(s.csHash,x.csHash))return a&&a.error("INVALID:  Circuit does not match"),!1;if(h[8][0].size!=l*(d.nVars-d.nPublic-1))return a&&a.error("INVALID:  Invalid L section size"),!1;if(h[9][0].size!=l*d.domainSize)return a&&a.error("INVALID:  Invalid H section size"),!1;let S;if(S=await Ft.sectionIsEqual(e,h,p,v,3),!S)return a&&a.error("INVALID:  IC section is not identical"),!1;if(S=await Ft.sectionIsEqual(e,h,p,v,4),!S)return a&&a.error("Coeffs section is not identical"),!1;if(S=await Ft.sectionIsEqual(e,h,p,v,5),!S)return a&&a.error("A section is not identical"),!1;if(S=await Ft.sectionIsEqual(e,h,p,v,6),!S)return a&&a.error("B1 section is not identical"),!1;if(S=await Ft.sectionIsEqual(e,h,p,v,7),!S)return a&&a.error("B2 section is not identical"),!1;if(o=await w("G1",p,v,e,h,8,d.vk_delta_2,M.vk_delta_2,"L section"),o!==!0)return a&&a.error("L section does not match"),!1;if(o=await k(),o!==!0)return a&&a.error("H section does not match"),!1;a&&a.info(hn(s.csHash,"Circuit Hash: ")),await e.close(),await p.close();for(let F=s.contributions.length-1;F>=0;F--){let u=s.contributions[F];a&&a.info("-------------------------"),a&&a.info(hn(u.contributionHash,`contribution #${F+1} ${u.name?u.name:""}:`)),u.type==1&&(a&&a.info(`Beacon generator: ${f0(u.beaconHash)}`),a&&a.info(`Beacon iterations Exp: ${u.numIterationsExp}`))}return a&&a.info("-------------------------"),a&&a.info("ZKey Ok!"),!0;async function w(F,u,L,$,Q,H,q,y,I){let nt=b[F],J=nt.F.n8*2;await Ft.startReadUniqueSection(u,L,H),await Ft.startReadUniqueSection($,Q,H);let j=nt.zero,ot=nt.zero,V=L[H][0].size/J;for(let at=0;at<V;at+=1048576){a&&a.debug(`Same ratio check ${I}:  ${at}/${V}`);let Lt=Math.min(V-at,1048576),rt=await u.read(Lt*J),ht=await $.read(Lt*J),A=Jo(4*Lt),i=await nt.multiExpAffine(rt,A),C=await nt.multiExpAffine(ht,A);j=nt.add(j,i),ot=nt.add(ot,C)}return await Ft.endReadSection(u),await Ft.endReadSection($),V==0?!0:(o=await de(b,j,ot,q,y),o===!0)}async function k(){let u=b.G1,L=b.Fr,$=u.F.n8*2,{fd:Q,sections:H}=await Ft.readBinFile(t,"ptau",1),q=new vt.BigBuffer(d.domainSize*d.n8r),y=new Array(8);for(let ot=0;ot<8;ot++)y[ot]=bs(Jo(4),0);let I=new vt.ChaCha(y);for(let ot=0;ot<d.domainSize-1;ot++){let V=L.fromRng(I);L.toRprLE(q,ot*d.n8r,V)}L.toRprLE(q,(d.domainSize-1)*d.n8r,L.zero);let N=u.zero;for(let ot=0;ot<d.domainSize;ot+=1048576){a&&a.debug(`H Verification(tau):  ${ot}/${d.domainSize}`);let V=Math.min(d.domainSize-ot,1048576),at=await Q.read($*V,H[2][0].p+d.domainSize*$+ot*$),Lt=await Q.read($*V,H[2][0].p+ot*$),rt=await O(at,Lt),ht=q.slice(ot*d.n8r,(ot+V)*d.n8r),A=await u.multiExpAffine(rt,ht);N=u.add(N,A)}q=await L.batchToMontgomery(q);let nt;if(d.power<L.s)nt=L.neg(L.e(2));else{let ot=2**L.s,V=L.exp(L.shift,ot);nt=L.sub(V,L.one)}let J=d.power<L.s?L.w[d.power+1]:L.shift;q=await L.batchApplyKey(q,nt,J),q=await L.fft(q),q=await L.batchFromMontgomery(q),await Ft.startReadUniqueSection(e,h,9);let j=u.zero;for(let ot=0;ot<d.domainSize;ot+=1048576){a&&a.debug(`H Verification(lagrange):  ${ot}/${d.domainSize}`);let V=Math.min(d.domainSize-ot,1048576),at=await e.read($*V),Lt=q.slice(ot*d.n8r,(ot+V)*d.n8r),rt=await u.multiExpAffine(at,Lt);j=u.add(j,rt)}return await Ft.endReadSection(e),o=await de(b,N,j,d.vk_delta_2,M.vk_delta_2),o===!0}async function O(F,u){let L=b.G1.F.n8*2,$=F.byteLength/L,Q=b.tm.concurrency,H=Math.floor($/Q),q=[];for(let nt=0;nt<Q;nt++){let J;if(nt<Q-1?J=H:J=$-nt*H,J==0)continue;let j=F.slice(nt*H*l,(nt*H+J)*l),ot=u.slice(nt*H*l,(nt*H+J)*l);q.push(W(j,ot))}let y=await Promise.all(q),I=new Uint8Array($*L),N=0;for(let nt=0;nt<y.length;nt++)I.set(y[nt][0],N),N+=y[nt][0].byteLength;return I}async function W(F,u){let L=b.G1.F.n8*2,$=b.G1.F.n8*3,Q=F.byteLength/L,H=[];H.push({cmd:"ALLOCSET",var:0,buff:F}),H.push({cmd:"ALLOCSET",var:1,buff:u}),H.push({cmd:"ALLOC",var:2,len:Q*$});for(let y=0;y<Q;y++)H.push({cmd:"CALL",fnName:"g1m_subAffine",params:[{var:0,offset:y*L},{var:1,offset:y*L},{var:2,offset:y*$}]});return H.push({cmd:"CALL",fnName:"g1m_batchToAffine",params:[{var:2},{val:Q},{var:2}]}),H.push({cmd:"GET",out:0,var:2,len:Q*L}),await b.tm.queueAction(H)}}async function uy(c,t,n,a){let o={type:"bigMem"};return await b0(c,t,o,a),await m0(o,t,n,a)}async function _y(c,t,n,a,o){let{fd:e,sections:h}=await Ft.readBinFile(c,"zkey",2),d=await La(e,h);if(d.protocol!="groth16")throw new Error("zkey file is not groth16");let b=await Kn(d.q),l=await ti(e,b,h),s=await Ft.createBinFile(t,"zkey",1,10),m=await Cs(a),B=rn.blake2b.create({dkLen:64});B.update(l.csHash);for(let S=0;S<l.contributions.length;S++)no(B,b,l.contributions[S]);let p={};p.delta={},p.delta.prvKey=b.Fr.fromRng(m),p.delta.g1_s=b.G1.toAffine(b.G1.fromRng(m)),p.delta.g1_sx=b.G1.toAffine(b.G1.timesFr(p.delta.g1_s,p.delta.prvKey)),ga(B,b,p.delta.g1_s),ga(B,b,p.delta.g1_sx),p.transcript=B.digest(),p.delta.g2_sp=Be(b,p.transcript),p.delta.g2_spx=b.G2.toAffine(b.G2.timesFr(p.delta.g2_sp,p.delta.prvKey)),d.vk_delta_1=b.G1.timesFr(d.vk_delta_1,p.delta.prvKey),d.vk_delta_2=b.G2.timesFr(d.vk_delta_2,p.delta.prvKey),p.deltaAfter=d.vk_delta_1,p.type=0,n&&(p.name=n),l.contributions.push(p),await o2(s,d),await Ft.copySection(e,h,s,3),await Ft.copySection(e,h,s,4),await Ft.copySection(e,h,s,5),await Ft.copySection(e,h,s,6),await Ft.copySection(e,h,s,7);let v=b.Fr.inv(p.delta.prvKey);await Fs(e,h,s,8,b,"G1",v,b.Fr.e(1),"L Section",o),await Fs(e,h,s,9,b,"G1",v,b.Fr.e(1),"H Section",o),await i2(s,b,l),await e.close(),await s.close();let M=rn.blake2b.create({dkLen:64});no(M,b,p);let x=M.digest();return o&&o.info(hn(l.csHash,"Circuit Hash: ")),o&&o.info(hn(x,"Contribution Hash: ")),x}async function hy(c,t,n,a,o,e){let h=h0(a);if(h.byteLength==0||h.byteLength*2!=a.length)return e&&e.error("Invalid Beacon Hash. (It must be a valid hexadecimal sequence)"),!1;if(h.length>=256)return e&&e.error("Maximum length of beacon hash is 255 bytes"),!1;if(o=parseInt(o),o<10||o>63)return e&&e.error("Invalid numIterationsExp. (Must be between 10 and 63)"),!1;let{fd:d,sections:b}=await Ft.readBinFile(c,"zkey",2),l=await La(d,b);if(l.protocol!="groth16")throw new Error("zkey file is not groth16");let s=await Kn(l.q),m=await ti(d,s,b),B=await Ft.createBinFile(t,"zkey",1,10),p=await a2(h,o),v=rn.blake2b.create({dkLen:64});v.update(m.csHash);for(let k=0;k<m.contributions.length;k++)no(v,s,m.contributions[k]);let M={};M.delta={},M.delta.prvKey=s.Fr.fromRng(p),M.delta.g1_s=s.G1.toAffine(s.G1.fromRng(p)),M.delta.g1_sx=s.G1.toAffine(s.G1.timesFr(M.delta.g1_s,M.delta.prvKey)),ga(v,s,M.delta.g1_s),ga(v,s,M.delta.g1_sx),M.transcript=v.digest(),M.delta.g2_sp=Be(s,M.transcript),M.delta.g2_spx=s.G2.toAffine(s.G2.timesFr(M.delta.g2_sp,M.delta.prvKey)),l.vk_delta_1=s.G1.timesFr(l.vk_delta_1,M.delta.prvKey),l.vk_delta_2=s.G2.timesFr(l.vk_delta_2,M.delta.prvKey),M.deltaAfter=l.vk_delta_1,M.type=1,M.numIterationsExp=o,M.beaconHash=h,n&&(M.name=n),m.contributions.push(M),await o2(B,l),await Ft.copySection(d,b,B,3),await Ft.copySection(d,b,B,4),await Ft.copySection(d,b,B,5),await Ft.copySection(d,b,B,6),await Ft.copySection(d,b,B,7);let x=s.Fr.inv(M.delta.prvKey);await Fs(d,b,B,8,s,"G1",x,s.Fr.e(1),"L Section",e),await Fs(d,b,B,9,s,"G1",x,s.Fr.e(1),"H Section",e),await i2(B,s,m),await d.close(),await B.close();let S=rn.blake2b.create({dkLen:64});no(S,s,M);let w=S.digest();return e&&e.info(hn(w,"Contribution Hash: ")),w}async function fy(c){let t=await p6(c,!0);return delete t.curve,delete t.F,vt.utils.stringifyBigInts(t)}async function gy(c,t,n,a,o){let e=await Cs(a),h=c.Fr.fromRng(e),d=c.Fr.inv(h),b=c.G1.F.n8*2,l=c.G2.F.n8*2,s=await la.readExisting(t),m=await la.createOverride(n);await q(b),await q(b),await q(l),await q(l);let B=await y(),p=c.G1.timesFr(B,h);await N(p);let v=await I(),M=c.G2.timesFr(v,h);await nt(M);let x=await s.readUBE32();await m.writeUBE32(x),await q(x*b);let S=await s.readUBE32();await m.writeUBE32(S),await bo(s,m,null,c,"G1",S,d,c.Fr.e(1),"UNCOMPRESSED","H",o);let w=await s.readUBE32();await m.writeUBE32(w),await bo(s,m,null,c,"G1",w,d,c.Fr.e(1),"UNCOMPRESSED","L",o);let k=await s.readUBE32();await m.writeUBE32(k),await q(k*b);let O=await s.readUBE32();await m.writeUBE32(O),await q(O*b);let W=await s.readUBE32();await m.writeUBE32(W),await q(W*l);let F=rn.blake2b.create({dkLen:64}),u={};u.csHash=await s.read(64),F.update(u.csHash);let L=await s.readUBE32();u.contributions=[];for(let J=0;J<L;J++){let j={delta:{}};j.deltaAfter=await y(),j.delta.g1_s=await y(),j.delta.g1_sx=await y(),j.delta.g2_spx=await I(),j.transcript=await s.read(64),u.contributions.push(j),no(F,c,j)}let $={};$.delta={},$.delta.prvKey=h,$.delta.g1_s=c.G1.toAffine(c.G1.fromRng(e)),$.delta.g1_sx=c.G1.toAffine(c.G1.timesFr($.delta.g1_s,h)),ga(F,c,$.delta.g1_s),ga(F,c,$.delta.g1_sx),$.transcript=F.digest(),$.delta.g2_sp=Be(c,$.transcript),$.delta.g2_spx=c.G2.toAffine(c.G2.timesFr($.delta.g2_sp,h)),$.deltaAfter=p,$.type=0,u.contributions.push($),await m.write(u.csHash),await m.writeUBE32(u.contributions.length);for(let J=0;J<u.contributions.length;J++){let j=u.contributions[J];await N(j.deltaAfter),await N(j.delta.g1_s),await N(j.delta.g1_sx),await nt(j.delta.g2_spx),await m.write(j.transcript)}let Q=rn.blake2b.create({dkLen:64});no(Q,c,$);let H=Q.digest();return o&&o.info(hn(H,"Contribution Hash: ")),await m.close(),await s.close(),H;async function q(J){let j=s.pageSize*2;for(let ot=0;ot<J;ot+=j){let V=Math.min(J-ot,j),at=await s.read(V);await m.write(at)}}async function y(){let J=await s.read(c.G1.F.n8*2);return c.G1.fromRprUncompressed(J,0)}async function I(){let J=await s.read(c.G2.F.n8*2);return c.G2.fromRprUncompressed(J,0)}async function N(J){let j=new Uint8Array(b);c.G1.toRprUncompressed(j,0,J),await m.write(j)}async function nt(J){let j=new Uint8Array(l);c.G2.toRprUncompressed(j,0,J),await m.write(j)}}var{stringifyBigInts:s2}=vt.utils;async function y0(c,t){t&&t.info("EXPORT VERIFICATION KEY STARTED");let{fd:n,sections:a}=await Ft.readBinFile(c,"zkey",2),o=await La(n,a);t&&t.info("> Detected protocol: "+o.protocol);let e;if(o.protocol==="groth16")e=await Ly(o,n,a);else if(o.protocol==="plonk")e=await py(o);else if(o.protocolId&&o.protocolId===Fe)e=await by(o);else throw new Error("zkey file protocol unrecognized");return await n.close(),t&&t.info("EXPORT VERIFICATION KEY FINISHED"),e}async function Ly(c,t,n){let a=await Kn(c.q),o=a.G1.F.n8*2,e=await a.pairing(c.vk_alpha_1,c.vk_beta_2),h={protocol:c.protocol,curve:a.name,nPublic:c.nPublic,vk_alpha_1:a.G1.toObject(c.vk_alpha_1),vk_beta_2:a.G2.toObject(c.vk_beta_2),vk_gamma_2:a.G2.toObject(c.vk_gamma_2),vk_delta_2:a.G2.toObject(c.vk_delta_2),vk_alphabeta_12:a.Gt.toObject(e)};await Ft.startReadUniqueSection(t,n,3),h.IC=[];for(let d=0;d<=c.nPublic;d++){let b=await t.read(o),l=a.G1.toObject(b);h.IC.push(l)}return await Ft.endReadSection(t),h=s2(h),h}async function py(c){let t=await Kn(c.q),n={protocol:c.protocol,curve:t.name,nPublic:c.nPublic,power:c.power,k1:t.Fr.toObject(c.k1),k2:t.Fr.toObject(c.k2),Qm:t.G1.toObject(c.Qm),Ql:t.G1.toObject(c.Ql),Qr:t.G1.toObject(c.Qr),Qo:t.G1.toObject(c.Qo),Qc:t.G1.toObject(c.Qc),S1:t.G1.toObject(c.S1),S2:t.G1.toObject(c.S2),S3:t.G1.toObject(c.S3),X_2:t.G2.toObject(c.X_2),w:t.Fr.toObject(t.Fr.w[c.power])};return n=s2(n),n}async function by(c,t){let n=await Kn(c.q),a={protocol:c.protocol,curve:n.name,nPublic:c.nPublic,power:c.power,k1:n.Fr.toObject(c.k1),k2:n.Fr.toObject(c.k2),w:n.Fr.toObject(n.Fr.w[c.power]),w3:n.Fr.toObject(c.w3),w4:n.Fr.toObject(c.w4),w8:n.Fr.toObject(c.w8),wr:n.Fr.toObject(c.wr),X_2:n.G2.toObject(c.X_2),C0:n.G1.toObject(c.C0)};return s2(a)}var{unstringifyBigInts:my,stringifyBigInts:yy}=vt.utils;async function w0(c,t,n){n&&n.info("FFLONK EXPORT SOLIDITY VERIFIER STARTED");let a=await yo(c.curve),o=l(c.w3);c.w3_2=s(a.Fr.square(o));let e=l(c.w4);c.w4_2=s(a.Fr.square(e)),c.w4_3=s(a.Fr.mul(a.Fr.square(e),e));let h=l(c.w8),d=a.Fr.one;for(let m=1;m<8;m++)d=a.Fr.mul(d,h),c["w8_"+m]=s(d);let b=t[c.protocol];return n&&n.info("FFLONK EXPORT SOLIDITY VERIFIER FINISHED"),r0.default.render(b,c);function l(m){let B=my(m);return a.Fr.fromObject(B)}function s(m){let B=a.Fr.toObject(m);return yy(B)}}async function wy(c,t,n){let a=await y0(c,n);if(a.protocol==="fflonk")return w0(a,t,n);let o=t[a.protocol];return r0.default.render(o,a)}var Fy=Object.freeze({__proto__:null,newZKey:b0,exportBellman:ry,importBellman:dy,verifyFromR1cs:uy,verifyFromInit:m0,contribute:_y,beacon:hy,exportJson:fy,bellmanContribute:gy,exportVerificationKey:y0,exportSolidityVerifier:wy});async function Cy(c,t,n,a){globalThis.gc&&globalThis.gc();let{fd:o,sections:e}=await Gt.readBinFile(t,"ptau",1,1<<22,1<<24),{curve:h,power:d}=await ra(o,e),{fd:b,sections:l}=await Gt.readBinFile(c,"r1cs",1,1<<22,1<<24),s=await ni.readR1csFd(b,l,{loadConstraints:!0,loadCustomGates:!0}),m=h.G1.F.n8*2,B=h.G1,p=h.G2.F.n8*2,v=h.Fr,M=h.Fr.n8;a&&a.info("Reading r1cs"),await Gt.readSection(b,l,2);let x=new Un,S=new Un,w=s.nVars,k=s.nOutputs+s.nPubInputs;await y(h.Fr,s,a),globalThis.gc&&globalThis.gc();let O=await Gt.createBinFile(n,"zkey",1,14,1<<22,1<<24);if(s.prime!=h.r)return a&&a.error("r1cs curve does not match powers of tau ceremony curve"),-1;let W=ao(x.length-1)+1;W<3&&(W=3);let F=2**W;if(a&&a.info("Plonk constraints: "+x.length),W>d)return a&&a.error(`circuit too big for this power of tau ceremony. ${x.length} > 2**${d}`),-1;if(!e[12])return a&&a.error("Powers of tau is not prepared."),-1;let u=new vt.BigBuffer(F*m),L=e[12][0].p+(2**W-1)*m;await o.readToBuffer(u,0,F*m,L);let[$,Q]=at(),H={};await J(3,"Additions"),globalThis.gc&&globalThis.gc(),await I(4,0,"Amap"),globalThis.gc&&globalThis.gc(),await I(5,1,"Bmap"),globalThis.gc&&globalThis.gc(),await I(6,2,"Cmap"),globalThis.gc&&globalThis.gc(),await N(7,3,"Qm"),globalThis.gc&&globalThis.gc(),await N(8,4,"Ql"),globalThis.gc&&globalThis.gc(),await N(9,5,"Qr"),globalThis.gc&&globalThis.gc(),await N(10,6,"Qo"),globalThis.gc&&globalThis.gc(),await N(11,7,"Qc"),globalThis.gc&&globalThis.gc(),await j(12,"sigma"),globalThis.gc&&globalThis.gc(),await ot(13,"lagrange polynomials"),globalThis.gc&&globalThis.gc(),await Gt.startWriteSection(O,14);let q=new vt.BigBuffer((F+6)*m);await o.readToBuffer(q,0,(F+6)*m,e[2][0].p),await O.write(q),await Gt.endWriteSection(O),globalThis.gc&&globalThis.gc(),await V(),await O.close(),await b.close(),await o.close(),a&&a.info("Setup Finished");return;async function y(Lt,rt,ht){function A(U){let st=Object.keys(U);for(let et=0;et<st.length;et++)U[st[et]]==0n&&delete U[st[et]]}function i(U,st,et){let ct={};for(let ft in U)typeof ct[ft]>"u"?ct[ft]=Lt.mul(st,U[ft]):ct[ft]=Lt.add(ct[ft],Lt.mul(st,U[ft]));for(let ft in et){let _t=Lt.neg(et[ft]);typeof ct[ft]>"u"?ct[ft]=_t:ct[ft]=Lt.add(ct[ft],_t)}return A(ct),ct}function C(U,st){let et={k:Lt.zero,s:[],coefs:[]},ct=[];for(let ft in U)ft==0?et.k=Lt.add(et.k,U[ft]):U[ft]!=0n&&ct.push([Number(ft),U[ft]]);for(;ct.length>st;){let ft=ct.shift(),_t=ct.shift(),gt=ft[0],yt=_t[0],ut=w++,lt=Lt.zero,bt=Lt.neg(ft[1]),Et=Lt.neg(_t[1]),It=Lt.one,zt=Lt.zero;x.push([gt,yt,ut,lt,bt,Et,It,zt]),S.push([gt,yt,ft[1],_t[1]]),ct.push([ut,Lt.one])}for(let ft=0;ft<ct.length;ft++)et.s[ft]=ct[ft][0],et.coefs[ft]=ct[ft][1];for(;et.coefs.length<st;)et.s.push(0),et.coefs.push(Lt.zero);return et}function r(U){let st=C(U,3),et=st.s[0],ct=st.s[1],ft=st.s[2],_t=Lt.zero,gt=st.coefs[0],yt=st.coefs[1],ut=st.coefs[2],lt=st.k;x.push([et,ct,ft,_t,gt,yt,ut,lt])}function z(U,st,et){let ct=C(U,1),ft=C(st,1),_t=C(et,1),gt=ct.s[0],yt=ft.s[0],ut=_t.s[0],lt=Lt.mul(ct.coefs[0],ft.coefs[0]),bt=Lt.mul(ct.coefs[0],ft.k),Et=Lt.mul(ct.k,ft.coefs[0]),It=Lt.neg(_t.coefs[0]),zt=Lt.sub(Lt.mul(ct.k,ft.k),_t.k);x.push([gt,yt,ut,lt,bt,Et,It,zt])}function E(U){let st=Lt.zero,et=0,ct=Object.keys(U);for(let ft=0;ft<ct.length;ft++)U[ct[ft]]==0n?delete U[ct[ft]]:ct[ft]==0?st=Lt.add(st,U[ct[ft]]):et++;return et>0?et.toString():st!=Lt.zero?"k":"0"}function g(U,st,et){let ct=E(U),ft=E(st);if(ct==="0"||ft==="0")A(et),r(et);else if(ct==="k"){let _t=i(st,U[0],et);r(_t)}else if(ft==="k"){let _t=i(U,st[0],et);r(_t)}else z(U,st,et)}for(let U=1;U<=k;U++){let st=U,et=0,ct=0,ft=Lt.zero,_t=Lt.one,gt=Lt.zero,yt=Lt.zero,ut=Lt.zero;x.push([st,et,ct,ft,_t,gt,yt,ut])}for(let U=0;U<rt.constraints.length;U++)ht&&U%1e4===0&&ht.debug(`processing constraints: ${U}/${rt.nConstraints}`),g(...rt.constraints[U])}async function I(Lt,rt,ht){await Gt.startWriteSection(O,Lt);for(let A=0;A<x.length;A++)await O.writeULE32(x[A][rt]),a&&A%1e6==0&&a.debug(`writing ${ht}: ${A}/${x.length}`);await Gt.endWriteSection(O)}async function N(Lt,rt,ht){let A=new vt.BigBuffer(F*M);for(let i=0;i<x.length;i++)A.set(x[i][rt],i*M),a&&i%1e6==0&&a.debug(`writing ${ht}: ${i}/${x.length}`);await Gt.startWriteSection(O,Lt),await nt(A),await Gt.endWriteSection(O),A=await v.batchFromMontgomery(A),H[ht]=await h.G1.multiExpAffine(u,A,a,"multiexp "+ht)}async function nt(Lt){let rt=await v.ifft(Lt),ht=new vt.BigBuffer(F*M*4);ht.set(rt,0);let A=await v.fft(ht);await O.write(rt),await O.write(A)}async function J(Lt,rt){await Gt.startWriteSection(O,Lt);let ht=new Uint8Array(8+2*M),A=new DataView(ht.buffer);for(let i=0;i<S.length;i++){let C=S[i],r=0;A.setUint32(r,C[0],!0),r+=4,A.setUint32(r,C[1],!0),r+=4,ht.set(C[2],r),r+=M,ht.set(C[3],r),r+=M,await O.write(ht),a&&i%1e6==0&&a.debug(`writing ${rt}: ${i}/${S.length}`)}await Gt.endWriteSection(O)}async function j(Lt,rt){let ht=new vt.BigBuffer(M*F*3),A=new Un(w),i=new Un(w),C=v.one;for(let U=0;U<F;U++)U<x.length?(g(x[U][0],U),g(x[U][1],F+U),g(x[U][2],F*2+U)):(g(0,U),g(0,F+U),g(0,F*2+U)),C=v.mul(C,v.w[W]),a&&U%1e6==0&&a.debug(`writing ${rt} phase1: ${U}/${x.length}`);for(let U=0;U<w;U++)typeof i[U]<"u"?ht.set(A[U],i[U]*M):console.log("Variable not used"),a&&U%1e6==0&&a.debug(`writing ${rt} phase2: ${U}/${w}`);globalThis.gc&&globalThis.gc(),await Gt.startWriteSection(O,Lt);let r=ht.slice(0,F*M);await nt(r),globalThis.gc&&globalThis.gc();let z=ht.slice(F*M,F*M*2);await nt(z),globalThis.gc&&globalThis.gc();let E=ht.slice(F*M*2,F*M*3);await nt(E),globalThis.gc&&globalThis.gc(),await Gt.endWriteSection(O),r=await v.batchFromMontgomery(r),z=await v.batchFromMontgomery(z),E=await v.batchFromMontgomery(E),H.S1=await h.G1.multiExpAffine(u,r,a,"multiexp S1"),globalThis.gc&&globalThis.gc(),H.S2=await h.G1.multiExpAffine(u,z,a,"multiexp S2"),globalThis.gc&&globalThis.gc(),H.S3=await h.G1.multiExpAffine(u,E,a,"multiexp S3"),globalThis.gc&&globalThis.gc();function g(U,st){typeof A[U]>"u"?i[U]=st:ht.set(A[U],st*M);let et;st<F?et=C:st<2*F?et=v.mul(C,$):et=v.mul(C,Q),A[U]=et}}async function ot(Lt,rt){await Gt.startWriteSection(O,Lt);let ht=Math.max(k,1);for(let A=0;A<ht;A++){let i=new vt.BigBuffer(F*M);i.set(v.one,A*M),await nt(i),a&&a.debug(`writing ${rt} ${A}/${ht}`)}await Gt.endWriteSection(O)}async function V(){await Gt.startWriteSection(O,1),await O.writeULE32(2),await Gt.endWriteSection(O),await Gt.startWriteSection(O,2);let Lt=h.q,rt=(Math.floor((vt.Scalar.bitLength(Lt)-1)/64)+1)*8,ht=h.r,A=(Math.floor((vt.Scalar.bitLength(ht)-1)/64)+1)*8;await O.writeULE32(rt),await Gt.writeBigInt(O,Lt,rt),await O.writeULE32(A),await Gt.writeBigInt(O,ht,A),await O.writeULE32(w),await O.writeULE32(k),await O.writeULE32(F),await O.writeULE32(S.length),await O.writeULE32(x.length),await O.write($),await O.write(Q),await O.write(B.toAffine(H.Qm)),await O.write(B.toAffine(H.Ql)),await O.write(B.toAffine(H.Qr)),await O.write(B.toAffine(H.Qo)),await O.write(B.toAffine(H.Qc)),await O.write(B.toAffine(H.S1)),await O.write(B.toAffine(H.S2)),await O.write(B.toAffine(H.S3));let i;i=await o.read(p,e[3][0].p+p),await O.write(i),await Gt.endWriteSection(O)}function at(){let Lt=v.two;for(;ht(Lt,[],W);)v.add(Lt,v.one);let rt=v.add(Lt,v.one);for(;ht(rt,[Lt],W);)v.add(rt,v.one);return[Lt,rt];function ht(A,i,C){let r=2**C,z=v.one;for(let E=0;E<r;E++){if(v.eq(A,z))return!0;for(let g=0;g<i.length;g++)if(v.eq(A,v.mul(i[g],z)))return!0;z=v.mul(z,v.w[C])}return!1}}}var ye=class{constructor(t,n){this.curve=t,this.logger=n,this.resetProof()}resetProof(){this.polynomials={},this.evaluations={}}addPolynomial(t,n){t in this.polynomials&&this.logger.warn(`proof: polynomial.${t} already exist in proof`),this.polynomials[t]=n}getPolynomial(t){return t in this.polynomials||this.logger.warn(`proof: polynomial ${t} does not exist in proof`),this.polynomials[t]}addEvaluation(t,n){t in this.evaluations&&this.logger.warn(`proof: evaluations.${t} already exist in proof`),this.evaluations[t]=n}getEvaluation(t){return t in this.evaluations||this.logger.warn(`proof: evaluation ${t} does not exist in proof`),this.evaluations[t]}toObjectProof(t=!0){let n=t?{polynomials:{},evaluations:{}}:{};return Object.keys(this.polynomials).forEach(a=>{let o=this.curve.G1.toObject(this.polynomials[a]);t?n.polynomials[a]=o:n[a]=o}),Object.keys(this.evaluations).forEach(a=>{let o=this.curve.Fr.toObject(this.evaluations[a]);t?n.evaluations[a]=o:n[a]=o}),n}fromObjectProof(t){this.resetProof(),Object.keys(t.polynomials).forEach(n=>{this.polynomials[n]=this.curve.G1.fromObject(t.polynomials[n])}),Object.keys(t.evaluations).forEach(n=>{this.evaluations[n]=this.curve.Fr.fromObject(t.evaluations[n])})}},zd=0,By=1,Ga=class{constructor(t){this.G1=t.G1,this.Fr=t.Fr,this.reset()}reset(){this.data=[]}addPolCommitment(t){this.data.push({type:zd,data:t})}addScalar(t){this.data.push({type:By,data:t})}getChallenge(){if(this.data.length===0)throw new Error("Keccak256Transcript: No data to generate a transcript");let t=0,n=0;this.data.forEach(h=>zd===h.type?t++:n++);let a=new Uint8Array(n*this.Fr.n8+t*this.G1.F.n8*2),o=0;for(let h=0;h<this.data.length;h++)zd===this.data[h].type?(this.G1.toRprUncompressed(a,o,this.data[h].data),o+=this.G1.F.n8*2):(this.Fr.toRprBE(a,o,this.data[h].data),o+=this.Fr.n8);let e=vt.Scalar.fromRprBE(t6.keccak_256(a));return this.Fr.e(e)}},me=class{static getZ1(t){return[t.zero,t.add(t.e(-1),t.w[2]),t.e(-2),t.sub(t.e(-1),t.w[2])]}static getZ2(t){return[t.zero,t.add(t.zero,t.mul(t.e(-2),t.w[2])),t.e(4),t.sub(t.zero,t.mul(t.e(-2),t.w[2]))]}static getZ3(t){return[t.zero,t.add(t.e(2),t.mul(t.e(2),t.w[2])),t.e(-8),t.sub(t.e(2),t.mul(t.e(2),t.w[2]))]}static mul2(t,n,a,o,e,h){let d=this.getZ1(h),b,l,s=h.mul(t,n),m=h.mul(t,o),B=h.mul(a,n),p=h.mul(a,o);b=s;let v=h.add(m,B),M=p;return l=v,e&&(l=h.add(l,h.mul(d[e],M))),[b,l]}static mul3(t,n,a,o,e,h,d,b){let l=this.getZ1(b),s=this.getZ2(b),m,B,p=b.mul(t,n),v=b.mul(t,e),M=b.mul(o,n),x=b.mul(o,e);m=b.mul(p,a);let S=b.mul(M,a);S=b.add(S,b.mul(v,a)),S=b.add(S,b.mul(p,h));let w=b.mul(x,a);if(w=b.add(w,b.mul(v,h)),w=b.add(w,b.mul(M,h)),B=S,d){let k=b.mul(x,h);B=b.add(B,b.mul(l[d],w)),B=b.add(B,b.mul(s[d],k))}return[m,B]}static mul4(t,n,a,o,e,h,d,b,l,s){let m=this.getZ1(s),B=this.getZ2(s),p=this.getZ3(s),v,M,x=s.mul(t,n),S=s.mul(t,h),w=s.mul(e,n),k=s.mul(e,h),O=s.mul(a,o),W=s.mul(a,b),F=s.mul(d,o),u=s.mul(d,b);v=s.mul(x,O);let L=s.mul(w,O);L=s.add(L,s.mul(S,O)),L=s.add(L,s.mul(x,F)),L=s.add(L,s.mul(x,W));let $=s.mul(k,O);$=s.add($,s.mul(w,F)),$=s.add($,s.mul(w,W)),$=s.add($,s.mul(S,F)),$=s.add($,s.mul(S,W)),$=s.add($,s.mul(x,u));let Q=s.mul(S,u);Q=s.add(Q,s.mul(w,u)),Q=s.add(Q,s.mul(k,W)),Q=s.add(Q,s.mul(k,F));let H=s.mul(k,u);return M=L,l&&(M=s.add(M,s.mul(m[l],$)),M=s.add(M,s.mul(B[l],Q)),M=s.add(M,s.mul(p[l],H))),[v,M]}},Jf=3,xy=4,Ay=5,Ey=6,Td=7,Gd=8,kd=9,Ud=10,Nd=11,po=12,vy=13,Yf=14,Nt=class c{constructor(t,n,a){this.coef=t,this.curve=n,this.Fr=n.Fr,this.G1=n.G1,this.logger=a}static async fromEvaluations(t,n,a){let o=await n.Fr.ifft(t);return new c(o,n,a)}static fromCoefficientsArray(t,n,a){let o=n.Fr,e=t.length>32768?new vt.BigBuffer(t.length*o.n8):new Uint8Array(t.length*o.n8);for(let h=0;h<t.length;h++)e.set(t[h],h*o.n8);return new c(e,n,a)}static fromPolynomial(t,n,a){let o=t.length(),e=n.Fr,h=o>32768?new vt.BigBuffer(o*e.n8):new Uint8Array(o*e.n8);return h.set(t.coef.slice(),0),new c(h,n,a)}isEqual(t){let n=this.degree();if(n!==t.degree())return!1;for(let a=0;a<n+1;a++)if(!this.Fr.eq(this.getCoef(a),t.getCoef(a)))return!1;return!0}blindCoefficients(t){t=t||[];let n=this.length()+t.length>32768?new vt.BigBuffer((this.length()+t.length)*this.Fr.n8):new Uint8Array((this.length()+t.length)*this.Fr.n8);n.set(this.coef,0);for(let a=0;a<t.length;a++)n.set(this.Fr.add(n.slice((this.length()+a)*this.Fr.n8,(this.length()+a+1)*this.Fr.n8),t[a]),(this.length()+a)*this.Fr.n8),n.set(this.Fr.sub(n.slice(a*this.Fr.n8,(a+1)*this.Fr.n8),t[a]),a*this.Fr.n8);this.coef=n}getCoef(t){let n=t*this.Fr.n8;return n+this.Fr.n8>this.coef.byteLength?this.Fr.zero:this.coef.slice(n,n+this.Fr.n8)}setCoef(t,n){if(t>this.length()-1)throw new Error("Coef index is not available");this.coef.set(n,t*this.Fr.n8)}static async to4T(t,n,a,o){a=a||[];let e=await o.ifft(t),h=n*4>32768?new vt.BigBuffer(n*4*o.n8):new Uint8Array(n*4*o.n8);h.set(e,0);let d=await o.fft(h);if(a.length===0)return[e,d];let b=n+a.length>32768?new vt.BigBuffer((n+a.length)*o.n8):new Uint8Array((n+a.length)*o.n8);b.set(e,0);for(let l=0;l<a.length;l++)b.set(o.add(b.slice((n+l)*o.n8,(n+l+1)*o.n8),a[l]),(n+l)*o.n8),b.set(o.sub(b.slice(l*o.n8,(l+1)*o.n8),a[l]),l*o.n8);return[b,d]}length(){let t=this.coef.byteLength/this.Fr.n8;if(t!==Math.floor(this.coef.byteLength/this.Fr.n8))throw new Error("Polynomial coefficients buffer has incorrect size");return t===0&&this.logger&&this.logger.warn("Polynomial has length zero"),t}degree(){for(let t=this.length()-1;t>0;t--){let n=t*this.Fr.n8;if(!this.Fr.eq(this.Fr.zero,this.coef.slice(n,n+this.Fr.n8)))return t}return 0}evaluate(t){let n=this.Fr.zero;for(let a=this.degree()+1;a>0;a--){let o=a*this.Fr.n8,e=this.coef.slice(o-this.Fr.n8,o);n=this.Fr.add(e,this.Fr.mul(n,t))}return n}fastEvaluate(t){let n=this.Fr,a=3,o=this.degree()+1,e=parseInt(o/a),h=o-e*a,d=[],b=[];b[0]=n.one;for(let l=0;l<a;l++){d[l]=n.zero;let s=l===a-1?e+h:e;for(let m=s;m>0;m--)d[l]=n.add(this.getCoef(l*e+m-1),n.mul(d[l],t)),l===0&&(b[0]=n.mul(b[0],t))}for(let l=1;l<a;l++)d[0]=n.add(d[0],n.mul(b[l-1],d[l])),b[l]=n.mul(b[l-1],b[0]);return d[0]}add(t,n){let a=!1;t.length()>this.length()&&(a=!0);let o=this.length(),e=t.length();for(let h=0;h<Math.max(o,e);h++){let d=h*this.Fr.n8,b=h<o?this.coef.slice(d,d+this.Fr.n8):this.Fr.zero,l=h<e?t.coef.slice(d,d+this.Fr.n8):this.Fr.zero;n!==void 0&&(l=this.Fr.mul(l,n)),a?t.coef.set(this.Fr.add(b,l),d):this.coef.set(this.Fr.add(b,l),d)}a&&(delete this.coef,this.coef=t.coef)}sub(t,n){let a=!1;t.length()>this.length()&&(a=!0);let o=this.length(),e=t.length();for(let h=0;h<Math.max(o,e);h++){let d=h*this.Fr.n8,b=h<o?this.coef.slice(d,d+this.Fr.n8):this.Fr.zero,l=h<e?t.coef.slice(d,d+this.Fr.n8):this.Fr.zero;n!==void 0&&(l=this.Fr.mul(l,n)),a?t.coef.set(this.Fr.sub(b,l),d):this.coef.set(this.Fr.sub(b,l),d)}a&&(delete this.coef,this.coef=t.coef)}mulScalar(t){for(let n=0;n<this.length();n++){let a=n*this.Fr.n8;this.coef.set(this.Fr.mul(this.coef.slice(a,a+this.Fr.n8),t),a)}}addScalar(t){let n=this.length()===0?this.Fr.zero:this.coef.slice(0,this.Fr.n8);this.coef.set(this.Fr.add(n,t),0)}subScalar(t){let n=this.length()===0?this.Fr.zero:this.coef.slice(0,this.Fr.n8);this.coef.set(this.Fr.sub(n,t),0)}byXSubValue(t){let n=this.Fr,o=!n.eq(n.zero,this.getCoef(this.length()-1))?this.length()+1:this.length(),e=o>32768?new vt.BigBuffer(o*n.n8):new Uint8Array(o*n.n8),h=new c(e,this.curve,this.logger);h.coef.set(this.coef.slice(0,(o-1)*n.n8),32),this.mulScalar(n.neg(t)),h.add(this),this.coef=h.coef}byXNSubValue(t,n){let a=this.Fr,e=!(this.length()-t-1>=this.degree())?this.length()+t:this.length(),h=e>32768?new vt.BigBuffer(e*a.n8):new Uint8Array(e*a.n8),d=new c(h,this.curve,this.logger);d.coef.set(this.coef.slice(0,(this.degree()+1)*32),t*32),this.mulScalar(n),d.add(this),this.coef=d.coef}divBy(t){let n=this.Fr,a=this.degree(),o=t.degree(),e=new c(this.coef,this.curve,this.logger);this.coef=this.length()>32768?new vt.BigBuffer(this.length()*n.n8):new Uint8Array(this.length()*n.n8);for(let h=a-o;h>=0;h--){this.setCoef(h,n.div(e.getCoef(h+o),t.getCoef(o)));for(let d=0;d<=o;d++)e.setCoef(h+d,n.sub(e.getCoef(h+d),n.mul(this.getCoef(h),t.getCoef(d))))}return e}divByMonic(t,n){let a=this.Fr,o=this.degree(),e=this.length()>32768?new vt.BigBuffer(this.length()*a.n8):new Uint8Array(this.length()*a.n8),h=new c(e,this.curve,this.logger),d=[];for(let l=0;l<t;l++)h.setCoef(o-l-t,this.getCoef(o-l)),d[l]=this.getCoef(o-l);let b=t;for(let l=0;l<b;l++)for(let s=o-2*t-l;s>=0&&!(s<0);s=s-b){let m=l;d[m]=a.add(this.getCoef(s+t),a.mul(d[m],n)),h.setCoef(s,d[m])}this.coef=h.coef}divByVanishing(t,n){if(this.degree()<t)throw new Error("divByVanishing polynomial divisor must be of degree lower than the dividend polynomial");let a=this.Fr,o=new c(this.coef,this.curve,this.logger);this.coef=this.length()>32768?new vt.BigBuffer(this.length()*a.n8):new Uint8Array(this.length()*a.n8);for(let e=this.length()-1;e>=t;e--){let h=o.getCoef(e);a.eq(a.zero,h)||(o.setCoef(e,a.zero),o.setCoef(e-t,a.add(o.getCoef(e-t),a.mul(n,h))),this.setCoef(e-t,a.add(this.getCoef(e-t),h)))}return o}divByVanishing2(t,n){if(this.degree()<t)throw new Error("divByVanishing polynomial divisor must be of degree lower than the dividend polynomial");let a=this.Fr,o=new c(this.coef,this.curve,this.logger);this.coef=this.length()>32768?new vt.BigBuffer(this.length()*a.n8):new Uint8Array(this.length()*a.n8);let e=3,h=this.length()-t,d=Math.floor(h/e),b=h-(e-1)*d;console.log(h),console.log(d+"  "+b);for(let l=0;l<e;l++){console.log("> Thread "+l);for(let s=l===0?b:d;s>0;s--){let m=s-1;l!==0&&(m+=(l-1)*d+b);let B=m+t,p=o.getCoef(B);a.eq(a.zero,p)||(o.setCoef(B,a.zero),o.setCoef(m,a.add(o.getCoef(m),a.mul(n,p))),this.setCoef(m,a.add(this.getCoef(m),p)),console.log(m+" <-- "+B))}}return this.print(),o}fastDivByVanishing(t){let n=this.Fr;for(let a=0;a<t.length;a++){let o=t[a][0],e=t[a][1];if(this.degree()<o)throw new Error("divByVanishing polynomial divisor must be of degree lower than the dividend polynomial");let h=5,d=this.length()-o,b=Math.floor(d/h/o),l=b*o,s=d-h*l,m=new c(this.length()>32768?new vt.BigBuffer(this.length()*n.n8):new Uint8Array(this.length()*n.n8),this.curve,this.logger),B=this.coef;this.coef=m.coef,m.coef=B;for(let w=0;w<h;w++){let k=(w+1)*l+s;for(let O=0;O<o;O++)this.setCoef(k+O-o,m.getCoef(k+O));for(let O=0;O<l-o;O++){let W=k-O-1,F=n.add(m.getCoef(W),n.mul(e,this.getCoef(W)));this.setCoef(W-o,F)}}let p=s,v=s;for(let w=0;w<o&&v;w++)this.setCoef(p-w-1,m.getCoef(p+o-w-1)),v--;for(let w=0;w<v;w++){let k=p-w-1,O=n.add(m.getCoef(k),n.mul(e,this.getCoef(k)));this.setCoef(k-o,O)}let M=[],x=n.one;for(let w=0;w<b;w++)x=n.mul(x,e);let S=n.one;for(let w=h;w>0;w--){let k=w-1,O=k*l+s;M[k]=[];for(let W=0;W<o;W++)M[k][W]=this.getCoef(O+W),w!==h&&(M[k][W]=n.add(M[k][W],n.mul(x,M[k+1][W])));S=n.mul(S,x)}for(let w=0;w<h;w++){let k=w*l+s,O=e,W=o-1,F=w===0?s:l;for(let u=0;u<F;u++){let L=k-u-1,$=n.add(this.getCoef(L),n.mul(O,M[w][W]));this.setCoef(L,$),W===0?(W=o-1,O=n.mul(O,e)):W--}}}}divByXSubValue(t){let n=this.length()>32768?new vt.BigBuffer(this.length()*this.Fr.n8):new Uint8Array(this.length()*this.Fr.n8);n.set(this.Fr.zero,(this.length()-1)*this.Fr.n8),n.set(this.coef.slice((this.length()-1)*this.Fr.n8,this.length()*this.Fr.n8),(this.length()-2)*this.Fr.n8);for(let a=this.length()-3;a>=0;a--){let o=a*this.Fr.n8;n.set(this.Fr.add(this.coef.slice(o+this.Fr.n8,o+2*this.Fr.n8),this.Fr.mul(t,n.slice(o+this.Fr.n8,o+2*this.Fr.n8))),a*this.Fr.n8)}if(!this.Fr.eq(this.coef.slice(0,this.Fr.n8),this.Fr.mul(this.Fr.neg(t),n.slice(0,this.Fr.n8))))throw new Error("Polynomial does not divide");this.coef=n}divZh(t,n=4){for(let o=0;o<t;o++){let e=o*this.Fr.n8;this.coef.set(this.Fr.neg(this.coef.slice(e,e+this.Fr.n8)),e)}let a=this.coef.byteLength/this.Fr.n8;for(let o=t;o<a;o++){let e=o*this.Fr.n8,h=this.Fr.sub(this.coef.slice((o-t)*this.Fr.n8,(o-t)*this.Fr.n8+this.Fr.n8),this.coef.slice(e,e+this.Fr.n8));if(this.coef.set(h,e),o>t*(n-1)-n&&!this.Fr.isZero(h))throw new Error("Polynomial is not divisible")}return this}divByZerofier(t,n){let a=this.Fr,o=a.inv(n),e=a.neg(o),h=a.eq(a.one,e),d=a.eq(a.negone,e);if(!h)for(let b=0;b<t;b++){let l=b*this.Fr.n8,s;d?s=a.neg(this.coef.slice(l,l+this.Fr.n8)):s=a.mul(e,this.coef.slice(l,l+this.Fr.n8)),this.coef.set(s,l)}h=a.eq(a.one,o),d=a.eq(a.negone,o);for(let b=t;b<this.length();b++){let l=b*this.Fr.n8,s=(b-t)*this.Fr.n8,m=this.Fr.sub(this.coef.slice(s,s+this.Fr.n8),this.coef.slice(l,l+this.Fr.n8));if(h||(d?m=a.neg(m):m=a.mul(o,m)),this.coef.set(m,l),b>this.length()-t-1&&!this.Fr.isZero(m))throw new Error("Polynomial is not divisible")}return this}byX(){let t=this.length()+1>32768?new vt.BigBuffer(this.coef.byteLength+this.Fr.n8):new Uint8Array(this.coef.byteLength+this.Fr.n8);t.set(this.Fr.zero,0),t.set(this.coef,this.Fr.n8),this.coef=t}static async expX(t,n,a=!1){let o=t.Fr;if(n<1)throw new Error("Compute a new polynomial to a zero or negative number is not allowed");if(n===1)return await c.fromEvaluations(t.coef,curve,t.logger);let e=a?t.degree():t.length()-1,h=e*n+1>32768?new vt.BigBuffer((e*n+1)*o.n8):new Uint8Array((e*n+1)*o.n8);h.set(t.getCoef(0),0);for(let d=1;d<=e;d++){let b=d*o.n8,l=t.getCoef(d);h.set(l,b*n)}return new c(h,t.curve,t.logger)}split(t,n,a){if(t<1)throw new Error(`Polynomials can't be split in ${t} parts`);if(t===1)return[this];if(a.length!==0&&a.length<t-1)throw new Error(`Blinding factors length must be ${t-1}`);let o=(n+1)*this.Fr.n8,e=[],h=Math.ceil((this.degree()+1)*this.Fr.n8/o);if(h<t)for(let d=h;d<t;d++)e[d]=new c(new Uint8Array(this.Fr.n8),this.curve,this.logger);t=Math.min(t,h);for(let d=0;d<t;d++){let b=t-1===d,l=b?this.coef.byteLength-(t-1)*o:o+this.Fr.n8,s=l/this.Fr.n8>32768?new vt.BigBuffer(l):new Uint8Array(l);e[d]=new c(s,this.curve,this.logger);let m=d*o,B=b?this.coef.byteLength:(d+1)*o;if(e[d].coef.set(this.coef.slice(m,B),0),b||e[d].coef.set(a[d],o),d!==0){let p=this.Fr.sub(e[d].coef.slice(0,this.Fr.n8),a[d-1]);e[d].coef.set(p,0)}b&&e[d].truncate()}return e}truncate(){let t=this.degree();if(t+1<this.coef.byteLength/this.Fr.n8){let n=t+1>32768?new vt.BigBuffer((t+1)*this.Fr.n8):new Uint8Array((t+1)*this.Fr.n8);n.set(this.coef.slice(0,(t+1)*this.Fr.n8),0),this.coef=n}}static lagrangePolynomialInterpolation(t,n,a){let o=a.Fr,e=h(0);for(let d=1;d<t.length;d++)e.add(h(d));return e;function h(d){let b;for(let m=0;m<t.length;m++)if(m!==d)if(b===void 0){let B=t.length>32768?new vt.BigBuffer(t.length*o.n8):new Uint8Array(t.length*o.n8);b=new c(B,a),b.setCoef(0,o.neg(t[m])),b.setCoef(1,o.one)}else b.byXSubValue(t[m]);let l=b.evaluate(t[d]);l=o.inv(l);let s=o.mul(n[d],l);return b.mulScalar(s),b}}static zerofierPolynomial(t,n){let a=n.Fr,o=t.length+1>32768?new vt.BigBuffer((t.length+1)*a.n8):new Uint8Array((t.length+1)*a.n8),e=new c(o,n);e.setCoef(0,a.neg(t[0])),e.setCoef(1,a.one);for(let h=1;h<t.length;h++)e.byXSubValue(t[h]);return e}print(){let t=this.Fr,n="";for(let a=this.degree();a>=0;a--){let o=this.getCoef(a);t.eq(t.zero,o)||(t.isNegative(o)?n+=" - ":a!==this.degree()&&(n+=" + "),n+=t.toString(o),a>0&&(n+=a>1?"x^"+a:"x"))}console.log(n)}async multiExponentiation(t,n){let a=this.coef.byteLength/this.Fr.n8,o=t.slice(0,a*this.G1.F.n8*2),e=await this.Fr.batchFromMontgomery(this.coef),h=await this.G1.multiExpAffine(o,e,this.logger,n);return h=this.G1.toAffine(h),h}},ln=class c{constructor(t,n,a){this.eval=t,this.curve=n,this.Fr=n.Fr,this.logger=a}static async fromPolynomial(t,n,a,o){let e=new vt.BigBuffer(t.length()*n*a.Fr.n8);e.set(t.coef,0);let h=await a.Fr.fft(e);return new c(h,a,o)}getEvaluation(t){let n=t*this.Fr.n8;if(n+this.Fr.n8>this.eval.byteLength)throw new Error("Evaluations.getEvaluation() out of bounds");return this.eval.slice(n,n+this.Fr.n8)}length(){let t=this.eval.byteLength/this.Fr.n8;if(t!==Math.floor(this.eval.byteLength/this.Fr.n8))throw new Error("Polynomial evaluations buffer has incorrect size");return t===0&&this.logger.warn("Polynomial has length zero"),t}},{stringifyBigInts:t0}=vt.utils;async function F0(c,t,n,a){let{fd:o,sections:e}=await Ft.readBinFile(t,"wtns",2,33554432,8388608);n&&n.debug("> Reading witness file");let h=await Ce(o,e);n&&n.debug("> Reading zkey file");let{fd:d,sections:b}=await Ft.readBinFile(c,"zkey",2,1<<25,1<<23),l=await La(d,b,void 0,a);if(l.protocol!="plonk")throw new Error("zkey file is not plonk");if(!vt.Scalar.eq(l.r,h.q))throw new Error("Curve of the witness does not match the curve of the proving key");if(h.nWitness!=l.nVars-l.nAdditions)throw new Error(`Invalid witness length. Circuit: ${l.nVars}, witness: ${h.nWitness}, ${l.nAdditions}`);let s=l.curve,m=s.Fr,B=s.Fr.n8,p=l.domainSize*B;n&&(n.debug("----------------------------"),n.debug("  PLONK PROVE SETTINGS"),n.debug(`  Curve:         ${s.name}`),n.debug(`  Circuit power: ${l.power}`),n.debug(`  Domain size:   ${l.domainSize}`),n.debug(`  Vars:          ${l.nVars}`),n.debug(`  Public vars:   ${l.nPublic}`),n.debug(`  Constraints:   ${l.nConstraints}`),n.debug(`  Additions:     ${l.nAdditions}`),n.debug("----------------------------")),n&&n.debug("> Reading witness file data");let v=await Ft.readSection(o,e,2);v.set(m.zero,0);let M=new vt.BigBuffer(B*l.nAdditions),x={},S={},w={},k={},O=new ye(s,n),W=new Ga(s);n&&n.debug(`> Reading Section ${Jf}. Additions`),await $(),n&&n.debug(`> Reading Section ${po}. Sigma1, Sigma2 & Sigma 3`),n&&n.debug("\xB7\xB7\xB7 Reading Sigma polynomials "),S.Sigma1=new Nt(new vt.BigBuffer(p),s,n),S.Sigma2=new Nt(new vt.BigBuffer(p),s,n),S.Sigma3=new Nt(new vt.BigBuffer(p),s,n),await d.readToBuffer(S.Sigma1.coef,0,p,b[po][0].p),await d.readToBuffer(S.Sigma2.coef,0,p,b[po][0].p+5*p),await d.readToBuffer(S.Sigma3.coef,0,p,b[po][0].p+10*p),n&&n.debug("\xB7\xB7\xB7 Reading Sigma evaluations"),w.Sigma1=new ln(new vt.BigBuffer(p*4),s,n),w.Sigma2=new ln(new vt.BigBuffer(p*4),s,n),w.Sigma3=new ln(new vt.BigBuffer(p*4),s,n),await d.readToBuffer(w.Sigma1.eval,0,p*4,b[po][0].p+p),await d.readToBuffer(w.Sigma2.eval,0,p*4,b[po][0].p+6*p),await d.readToBuffer(w.Sigma3.eval,0,p*4,b[po][0].p+11*p),n&&n.debug(`> Reading Section ${Yf}. Powers of Tau`);let F=await Ft.readSection(d,b,Yf),u=[];for(let rt=1;rt<=l.nPublic;rt++){let ht=v.slice(rt*m.n8,rt*m.n8+m.n8);u.push(vt.Scalar.fromRprLE(ht))}n&&n.debug(""),n&&n.debug("> ROUND 1"),await q(),n&&n.debug("> ROUND 2"),await I(),n&&n.debug("> ROUND 3"),await nt(),n&&n.debug("> ROUND 4"),await j(),n&&n.debug("> ROUND 5"),await ot(),await d.close(),await o.close();let L=O.toObjectProof(!1);return L.protocol="plonk",L.curve=s.name,n&&n.debug("PLONK PROVER FINISHED"),{proof:t0(L),publicSignals:t0(u)};async function $(){n&&n.debug("\xB7\xB7\xB7 Computing additions");let rt=await Ft.readSection(d,b,Jf),ht=8+B*2;for(let A=0;A<l.nAdditions;A++){n&&A!==0&&A%1e5===0&&n.debug(`    addition ${A}/${l.nAdditions}`);let i=A*ht,C=Q(rt,i);i+=4;let r=Q(rt,i);i+=4;let z=rt.slice(i,i+B);i+=B;let E=rt.slice(i,i+B),g=H(C),U=H(r),st=m.add(m.mul(z,g),m.mul(E,U));M.set(st,B*A)}}function Q(rt,ht){let A=rt.slice(ht,ht+4);return new DataView(A.buffer,A.byteOffset,A.byteLength).getUint32(0,!0)}function H(rt){return rt<l.nVars-l.nAdditions?v.slice(rt*B,rt*B+B):rt<l.nVars?M.slice((rt-(l.nVars-l.nAdditions))*B,(rt-(l.nVars-l.nAdditions))*B+B):s.Fr.zero}async function q(){k.b=[];for(let i=1;i<=11;i++)k.b[i]=s.Fr.random();n&&n.debug("> Computing A, B, C wire polynomials"),await y(),n&&n.debug("> Computing A, B, C MSM");let rt=await S.A.multiExponentiation(F,"A"),ht=await S.B.multiExponentiation(F,"B"),A=await S.C.multiExponentiation(F,"C");return O.addPolynomial("A",rt),O.addPolynomial("B",ht),O.addPolynomial("C",A),0}async function y(){n&&n.debug("\xB7\xB7\xB7 Reading data from zkey file"),x.A=new vt.BigBuffer(p),x.B=new vt.BigBuffer(p),x.C=new vt.BigBuffer(p);let rt=await Ft.readSection(d,b,xy),ht=await Ft.readSection(d,b,Ay),A=await Ft.readSection(d,b,Ey);for(let i=0;i<l.nConstraints;i++){let C=i*B,r=i*4,z=Q(rt,r);x.A.set(H(z),C);let E=Q(ht,r);x.B.set(H(E),C);let g=Q(A,r);x.C.set(H(g),C)}if(x.A=await m.batchToMontgomery(x.A),x.B=await m.batchToMontgomery(x.B),x.C=await m.batchToMontgomery(x.C),n&&n.debug("\xB7\xB7\xB7 Computing A ifft"),S.A=await Nt.fromEvaluations(x.A,s,n),n&&n.debug("\xB7\xB7\xB7 Computing B ifft"),S.B=await Nt.fromEvaluations(x.B,s,n),n&&n.debug("\xB7\xB7\xB7 Computing C ifft"),S.C=await Nt.fromEvaluations(x.C,s,n),n&&n.debug("\xB7\xB7\xB7 Computing A fft"),w.A=await ln.fromPolynomial(S.A,4,s,n),n&&n.debug("\xB7\xB7\xB7 Computing B fft"),w.B=await ln.fromPolynomial(S.B,4,s,n),n&&n.debug("\xB7\xB7\xB7 Computing C fft"),w.C=await ln.fromPolynomial(S.C,4,s,n),S.A.blindCoefficients([k.b[2],k.b[1]]),S.B.blindCoefficients([k.b[4],k.b[3]]),S.C.blindCoefficients([k.b[6],k.b[5]]),S.A.degree()>=l.domainSize+2)throw new Error("A Polynomial is not well calculated");if(S.B.degree()>=l.domainSize+2)throw new Error("B Polynomial is not well calculated");if(S.C.degree()>=l.domainSize+2)throw new Error("C Polynomial is not well calculated")}async function I(){n&&n.debug("> Computing challenges beta and gamma"),W.reset(),W.addPolCommitment(l.Qm),W.addPolCommitment(l.Ql),W.addPolCommitment(l.Qr),W.addPolCommitment(l.Qo),W.addPolCommitment(l.Qc),W.addPolCommitment(l.S1),W.addPolCommitment(l.S2),W.addPolCommitment(l.S3);for(let ht=0;ht<l.nPublic;ht++)W.addScalar(x.A.slice(ht*B,ht*B+B));W.addPolCommitment(O.getPolynomial("A")),W.addPolCommitment(O.getPolynomial("B")),W.addPolCommitment(O.getPolynomial("C")),k.beta=W.getChallenge(),n&&n.debug("\xB7\xB7\xB7 challenges.beta: "+m.toString(k.beta,16)),W.reset(),W.addScalar(k.beta),k.gamma=W.getChallenge(),n&&n.debug("\xB7\xB7\xB7 challenges.gamma: "+m.toString(k.gamma,16)),n&&n.debug("> Computing Z polynomial"),await N(),n&&n.debug("> Computing Z MSM");let rt=await S.Z.multiExponentiation(F,"Z");O.addPolynomial("Z",rt)}async function N(){n&&n.debug("\xB7\xB7\xB7 Computing Z evaluations");let rt=new vt.BigBuffer(p),ht=new vt.BigBuffer(p);rt.set(m.one,0),ht.set(m.one,0);let A=m.one;for(let i=0;i<l.domainSize;i++){let C=i*B,r=x.A.slice(C,C+B),z=x.B.slice(C,C+B),E=x.C.slice(C,C+B),g=m.mul(k.beta,A),U=m.add(r,g);U=m.add(U,k.gamma);let st=m.add(z,m.mul(l.k1,g));st=m.add(st,k.gamma);let et=m.add(E,m.mul(l.k2,g));et=m.add(et,k.gamma);let ct=m.mul(U,m.mul(st,et)),ft=m.add(r,m.mul(w.Sigma1.getEvaluation(i*4),k.beta));ft=m.add(ft,k.gamma);let _t=m.add(z,m.mul(w.Sigma2.getEvaluation(i*4),k.beta));_t=m.add(_t,k.gamma);let gt=m.add(E,m.mul(w.Sigma3.getEvaluation(i*4),k.beta));gt=m.add(gt,k.gamma);let yt=m.mul(ft,m.mul(_t,gt));ct=m.mul(rt.slice(C,C+B),ct),rt.set(ct,(i+1)%l.domainSize*B),yt=m.mul(ht.slice(C,C+B),yt),ht.set(yt,(i+1)%l.domainSize*B),A=m.mul(A,m.w[l.power])}ht=await m.batchInverse(ht);for(let i=0;i<l.domainSize;i++){let C=i*B,r=m.mul(rt.slice(C,C+B),ht.slice(C,C+B));rt.set(r,C)}if(x.Z=rt,!m.eq(rt.slice(0,B),m.one))throw new Error("Copy constraints does not match");if(n&&n.debug("\xB7\xB7\xB7 Computing Z ifft"),S.Z=await Nt.fromEvaluations(x.Z,s,n),n&&n.debug("\xB7\xB7\xB7 Computing Z fft"),w.Z=await ln.fromPolynomial(S.Z,4,s,n),S.Z.blindCoefficients([k.b[9],k.b[8],k.b[7]]),S.Z.degree()>=l.domainSize+3)throw new Error("Z Polynomial is not well calculated");delete x.Z}async function nt(){n&&n.debug("> Computing challenge alpha"),W.reset(),W.addScalar(k.beta),W.addScalar(k.gamma),W.addPolCommitment(O.getPolynomial("Z")),k.alpha=W.getChallenge(),k.alpha2=m.square(k.alpha),n&&n.debug("\xB7\xB7\xB7 challenges.alpha: "+m.toString(k.alpha,16)),n&&n.debug("> Computing T polynomial"),await J(),n&&n.debug("> Computing T MSM");let rt=await S.T1.multiExponentiation(F,"T1"),ht=await S.T2.multiExponentiation(F,"T2"),A=await S.T3.multiExponentiation(F,"T3");O.addPolynomial("T1",rt),O.addPolynomial("T2",ht),O.addPolynomial("T3",A)}async function J(){n&&n.debug(`\xB7\xB7\xB7 Reading sections ${Gd}, ${kd}, ${Td}, ${Ud}, ${Nd}. Q selectors`),w.QL=new ln(new vt.BigBuffer(p*4),s,n),w.QR=new ln(new vt.BigBuffer(p*4),s,n),w.QM=new ln(new vt.BigBuffer(p*4),s,n),w.QO=new ln(new vt.BigBuffer(p*4),s,n),w.QC=new ln(new vt.BigBuffer(p*4),s,n),await d.readToBuffer(w.QL.eval,0,p*4,b[Gd][0].p+p),await d.readToBuffer(w.QR.eval,0,p*4,b[kd][0].p+p),await d.readToBuffer(w.QM.eval,0,p*4,b[Td][0].p+p),await d.readToBuffer(w.QO.eval,0,p*4,b[Ud][0].p+p),await d.readToBuffer(w.QC.eval,0,p*4,b[Nd][0].p+p),w.Lagrange=new ln(new vt.BigBuffer(p*4*l.nPublic),s,n);for(let i=0;i<l.nPublic;i++)await d.readToBuffer(w.Lagrange.eval,i*p*4,p*4,b[vy][0].p+i*5*p+p);x.T=new vt.BigBuffer(p*4),x.Tz=new vt.BigBuffer(p*4),n&&n.debug("\xB7\xB7\xB7 Computing T evaluations");let rt=m.one;for(let i=0;i<l.domainSize*4;i++){n&&i!==0&&i%1e5===0&&n.debug(`      T evaluation ${i}/${l.domainSize*4}`);let C=w.A.getEvaluation(i),r=w.B.getEvaluation(i),z=w.C.getEvaluation(i),E=w.Z.getEvaluation(i),g=w.Z.getEvaluation((l.domainSize*4+4+i)%(l.domainSize*4)),U=w.QM.getEvaluation(i),st=w.QL.getEvaluation(i),et=w.QR.getEvaluation(i),ct=w.QO.getEvaluation(i),ft=w.QC.getEvaluation(i),_t=w.Sigma1.getEvaluation(i),gt=w.Sigma2.getEvaluation(i),yt=w.Sigma3.getEvaluation(i),ut=m.add(k.b[2],m.mul(k.b[1],rt)),lt=m.add(k.b[4],m.mul(k.b[3],rt)),bt=m.add(k.b[6],m.mul(k.b[5],rt)),Et=m.square(rt),It=m.add(m.add(m.mul(k.b[7],Et),m.mul(k.b[8],rt)),k.b[9]),zt=m.mul(rt,m.w[l.power]),Mt=m.square(zt),kt=m.add(m.add(m.mul(k.b[7],Mt),m.mul(k.b[8],zt)),k.b[9]),Pt=m.zero;for(let dt=0;dt<l.nPublic;dt++){let Ct=dt*4*l.domainSize+i,xt=w.Lagrange.getEvaluation(Ct),St=x.A.slice(dt*B,(dt+1)*B);Pt=m.sub(Pt,m.mul(xt,St))}let[qt,Rt]=me.mul2(C,r,ut,lt,i%4,m);qt=m.mul(qt,U),Rt=m.mul(Rt,U),qt=m.add(qt,m.mul(C,st)),Rt=m.add(Rt,m.mul(ut,st)),qt=m.add(qt,m.mul(r,et)),Rt=m.add(Rt,m.mul(lt,et)),qt=m.add(qt,m.mul(z,ct)),Rt=m.add(Rt,m.mul(bt,ct)),qt=m.add(qt,Pt),qt=m.add(qt,ft);let Kt=m.mul(k.beta,rt),Ut=C;Ut=m.add(Ut,Kt),Ut=m.add(Ut,k.gamma);let X=r;X=m.add(X,m.mul(Kt,l.k1)),X=m.add(X,k.gamma);let _=z;_=m.add(_,m.mul(Kt,l.k2)),_=m.add(_,k.gamma);let f=E,[R,G]=me.mul4(Ut,X,_,f,ut,lt,bt,It,i%4,m);R=m.mul(R,k.alpha),G=m.mul(G,k.alpha);let P=C;P=m.add(P,m.mul(k.beta,_t)),P=m.add(P,k.gamma);let Z=r;Z=m.add(Z,m.mul(k.beta,gt)),Z=m.add(Z,k.gamma);let T=z;T=m.add(T,m.mul(k.beta,yt)),T=m.add(T,k.gamma);let D=g,[Y,tt]=me.mul4(P,Z,T,D,ut,lt,bt,kt,i%4,m);Y=m.mul(Y,k.alpha),tt=m.mul(tt,k.alpha);let K=m.sub(E,m.one);K=m.mul(K,w.Lagrange.getEvaluation(i)),K=m.mul(K,k.alpha2);let it=m.mul(It,w.Lagrange.getEvaluation(i));it=m.mul(it,k.alpha2);let mt=m.add(m.sub(m.add(qt,R),Y),K),pt=m.add(m.sub(m.add(Rt,G),tt),it);x.T.set(mt,i*B),x.Tz.set(pt,i*B),rt=m.mul(rt,m.w[l.power+2])}if(n&&n.debug("\xB7\xB7\xB7 Computing T ifft"),S.T=await Nt.fromEvaluations(x.T,s,n),n&&n.debug("\xB7\xB7\xB7 Computing T / ZH"),S.T.divZh(l.domainSize,4),n&&n.debug("\xB7\xB7\xB7 Computing Tz ifft"),S.Tz=await Nt.fromEvaluations(x.Tz,s,n),S.T.add(S.Tz),S.T.degree()>=l.domainSize*3+6)throw new Error("T Polynomial is not well calculated");n&&n.debug("\xB7\xB7\xB7 Computing T1, T2, T3 polynomials"),S.T1=new Nt(new vt.BigBuffer((l.domainSize+1)*B),s,n),S.T2=new Nt(new vt.BigBuffer((l.domainSize+1)*B),s,n),S.T3=new Nt(new vt.BigBuffer((l.domainSize+6)*B),s,n),S.T1.coef.set(S.T.coef.slice(0,p),0),S.T2.coef.set(S.T.coef.slice(p,p*2),0),S.T3.coef.set(S.T.coef.slice(p*2,p*3+6*B),0),S.T1.setCoef(l.domainSize,k.b[10]);let ht=m.sub(S.T2.getCoef(0),k.b[10]);S.T2.setCoef(0,ht),S.T2.setCoef(l.domainSize,k.b[11]);let A=m.sub(S.T3.getCoef(0),k.b[11]);S.T3.setCoef(0,A)}async function j(){n&&n.debug("> Computing challenge xi"),W.reset(),W.addScalar(k.alpha),W.addPolCommitment(O.getPolynomial("T1")),W.addPolCommitment(O.getPolynomial("T2")),W.addPolCommitment(O.getPolynomial("T3")),k.xi=W.getChallenge(),k.xiw=m.mul(k.xi,m.w[l.power]),n&&n.debug("\xB7\xB7\xB7 challenges.xi: "+m.toString(k.xi,16)),O.addEvaluation("eval_a",S.A.evaluate(k.xi)),O.addEvaluation("eval_b",S.B.evaluate(k.xi)),O.addEvaluation("eval_c",S.C.evaluate(k.xi)),O.addEvaluation("eval_s1",S.Sigma1.evaluate(k.xi)),O.addEvaluation("eval_s2",S.Sigma2.evaluate(k.xi)),O.addEvaluation("eval_zw",S.Z.evaluate(k.xiw))}async function ot(){n&&n.debug("> Computing challenge v"),W.reset(),W.addScalar(k.xi),W.addScalar(O.getEvaluation("eval_a")),W.addScalar(O.getEvaluation("eval_b")),W.addScalar(O.getEvaluation("eval_c")),W.addScalar(O.getEvaluation("eval_s1")),W.addScalar(O.getEvaluation("eval_s2")),W.addScalar(O.getEvaluation("eval_zw")),k.v=[],k.v[1]=W.getChallenge(),n&&n.debug("\xB7\xB7\xB7 challenges.v: "+m.toString(k.v[1],16));for(let A=2;A<6;A++)k.v[A]=m.mul(k.v[A-1],k.v[1]);n&&n.debug("> Computing linearisation polynomial R(X)"),await V(),n&&n.debug("> Computing opening proof polynomial Wxi(X) polynomial"),at(),n&&n.debug("> Computing opening proof polynomial Wxiw(X) polynomial"),Lt(),n&&n.debug("> Computing Wxi, Wxiw MSM");let rt=await S.Wxi.multiExponentiation(F,"Wxi"),ht=await S.Wxiw.multiExponentiation(F,"Wxiw");O.addPolynomial("Wxi",rt),O.addPolynomial("Wxiw",ht)}async function V(){let rt=s.Fr;S.QL=new Nt(new vt.BigBuffer(p),s,n),S.QR=new Nt(new vt.BigBuffer(p),s,n),S.QM=new Nt(new vt.BigBuffer(p),s,n),S.QO=new Nt(new vt.BigBuffer(p),s,n),S.QC=new Nt(new vt.BigBuffer(p),s,n),await d.readToBuffer(S.QL.coef,0,p,b[Gd][0].p),await d.readToBuffer(S.QR.coef,0,p,b[kd][0].p),await d.readToBuffer(S.QM.coef,0,p,b[Td][0].p),await d.readToBuffer(S.QO.coef,0,p,b[Ud][0].p),await d.readToBuffer(S.QC.coef,0,p,b[Nd][0].p),k.xin=k.xi;for(let lt=0;lt<l.power;lt++)k.xin=rt.square(k.xin);k.zh=rt.sub(k.xin,rt.one);let ht=[],A=rt.e(l.domainSize),i=rt.one;for(let lt=1;lt<=Math.max(1,l.nPublic);lt++)ht[lt]=rt.div(rt.mul(i,k.zh),rt.mul(A,rt.sub(k.xi,i))),i=rt.mul(i,rt.w[l.power]);let C=rt.div(rt.sub(k.xin,rt.one),rt.mul(A,rt.sub(k.xi,rt.one)));if(n){n.debug("Lagrange Evaluations: ");for(let lt=1;lt<ht.length;lt++)n.debug(`L${lt}(xi)=`+rt.toString(ht[lt],16))}let r=rt.zero;for(let lt=0;lt<u.length;lt++){let bt=rt.e(u[lt]);r=rt.sub(r,rt.mul(bt,ht[lt+1]))}n&&n.debug("PI: "+rt.toString(r,16));let z=rt.mul(O.evaluations.eval_a,O.evaluations.eval_b),E=O.evaluations.eval_a,g=rt.mul(k.beta,k.xi);E=rt.add(E,g),E=rt.add(E,k.gamma);let U=O.evaluations.eval_b;U=rt.add(U,rt.mul(g,l.k1)),U=rt.add(U,k.gamma);let st=O.evaluations.eval_c;st=rt.add(st,rt.mul(g,l.k2)),st=rt.add(st,k.gamma);let et=rt.mul(rt.mul(rt.mul(E,U),st),k.alpha),ct=O.evaluations.eval_a;ct=rt.add(ct,rt.mul(k.beta,O.evaluations.eval_s1)),ct=rt.add(ct,k.gamma);let ft=O.evaluations.eval_b;ft=rt.add(ft,rt.mul(k.beta,O.evaluations.eval_s2)),ft=rt.add(ft,k.gamma);let _t=rt.mul(ct,ft);_t=rt.mul(_t,O.evaluations.eval_zw),_t=rt.mul(_t,k.alpha);let gt=rt.mul(C,k.alpha2);S.R=new Nt(new vt.BigBuffer((l.domainSize+6)*B),s,n),S.R.add(S.QM,z),S.R.add(S.QL,O.evaluations.eval_a),S.R.add(S.QR,O.evaluations.eval_b),S.R.add(S.QO,O.evaluations.eval_c),S.R.add(S.QC),S.R.add(S.Z,et),S.R.sub(S.Sigma3,rt.mul(_t,k.beta)),S.R.add(S.Z,gt);let yt=Nt.fromPolynomial(S.T3,s,n);yt.mulScalar(rt.square(k.xin)),yt.add(S.T2,k.xin),yt.add(S.T1),yt.mulScalar(k.zh),S.R.sub(yt);let ut=rt.sub(r,rt.mul(_t,rt.add(O.evaluations.eval_c,k.gamma)));ut=rt.sub(ut,gt),n&&n.debug("r0: "+rt.toString(ut,16)),S.R.addScalar(ut)}function at(){S.Wxi=new Nt(new vt.BigBuffer(p+6*B),s,n),S.Wxi.add(S.R),S.Wxi.add(S.A,k.v[1]),S.Wxi.add(S.B,k.v[2]),S.Wxi.add(S.C,k.v[3]),S.Wxi.add(S.Sigma1,k.v[4]),S.Wxi.add(S.Sigma2,k.v[5]),S.Wxi.subScalar(m.mul(k.v[1],O.evaluations.eval_a)),S.Wxi.subScalar(m.mul(k.v[2],O.evaluations.eval_b)),S.Wxi.subScalar(m.mul(k.v[3],O.evaluations.eval_c)),S.Wxi.subScalar(m.mul(k.v[4],O.evaluations.eval_s1)),S.Wxi.subScalar(m.mul(k.v[5],O.evaluations.eval_s2)),S.Wxi.divByZerofier(1,k.xi)}async function Lt(){S.Wxiw=Nt.fromPolynomial(S.Z,s,n),S.Wxiw.subScalar(O.evaluations.eval_zw),S.Wxiw.divByZerofier(1,k.xiw)}}var{unstringifyBigInts:Sy}=vt.utils;async function qy(c,t,n,a,o,e){let h=Sy(c),d={type:"mem"};return await Bs(h,t,d,o),await F0(n,d,a,e)}var{unstringifyBigInts:$d}=vt.utils;async function Iy(c,t,n,a){let o=$d(c);n=$d(n);let e=$d(t),h=await yo(o.curve),d=h.Fr,b=h.G1;a&&a.info("PLONK VERIFIER STARTED");let l=Oy(h,n);if(o=Py(h,o),!My(h,l))return a.error("Proof commitments are not valid."),!1;if(e.length!=o.nPublic)return a&&a.error("Invalid number of public inputs"),!1;if(!Ry(h,l))return a&&a.error("Proof evaluations are not valid"),!1;if(!zy(h,e))return a&&a.error("Public inputs are not valid."),!1;let s=Ty(h,l,e,o);if(a){a.debug("beta: "+d.toString(s.beta,16)),a.debug("gamma: "+d.toString(s.gamma,16)),a.debug("alpha: "+d.toString(s.alpha,16)),a.debug("xi: "+d.toString(s.xi,16));for(let w=1;w<6;w++)a&&a.debug("v: "+d.toString(s.v[w],16));a.debug("u: "+d.toString(s.u,16))}let m=Gy(h,s,o);if(a)for(let w=1;w<m.length;w++)a.debug(`L${w}(xi)=`+d.toString(m[w],16));if(e.length!=o.nPublic)return a.error("Number of public signals does not match with vk"),!1;let B=ky(h,e,m);a&&a.debug("PI(xi): "+d.toString(B,16));let p=Uy(h,l,s,B,m[1]);a&&a.debug("r0: "+d.toString(p,16));let v=Ny(h,l,s,o,m[1]);a&&a.debug("D: "+b.toString(b.toAffine(v),16));let M=$y(h,l,s,o,v);a&&a.debug("F: "+b.toString(b.toAffine(M),16));let x=Zy(h,l,s,p);a&&a.debug("E: "+b.toString(b.toAffine(x),16));let S=await jy(h,l,s,o,x,M);return a&&(S?a.info("OK!"):a.warn("Invalid Proof")),S}function Oy(c,t){let n=c.G1,a=c.Fr,o={};return o.A=n.fromObject(t.A),o.B=n.fromObject(t.B),o.C=n.fromObject(t.C),o.Z=n.fromObject(t.Z),o.T1=n.fromObject(t.T1),o.T2=n.fromObject(t.T2),o.T3=n.fromObject(t.T3),o.eval_a=a.fromObject(t.eval_a),o.eval_b=a.fromObject(t.eval_b),o.eval_c=a.fromObject(t.eval_c),o.eval_zw=a.fromObject(t.eval_zw),o.eval_s1=a.fromObject(t.eval_s1),o.eval_s2=a.fromObject(t.eval_s2),o.Wxi=n.fromObject(t.Wxi),o.Wxiw=n.fromObject(t.Wxiw),o}function Py(c,t){let n=c.G1,a=c.G2,o=c.Fr,e=t;return e.Qm=n.fromObject(t.Qm),e.Ql=n.fromObject(t.Ql),e.Qr=n.fromObject(t.Qr),e.Qo=n.fromObject(t.Qo),e.Qc=n.fromObject(t.Qc),e.S1=n.fromObject(t.S1),e.S2=n.fromObject(t.S2),e.S3=n.fromObject(t.S3),e.k1=o.fromObject(t.k1),e.k2=o.fromObject(t.k2),e.X_2=a.fromObject(t.X_2),e}function My(c,t){let n=c.G1;return!(!n.isValid(t.A)||!n.isValid(t.B)||!n.isValid(t.C)||!n.isValid(t.Z)||!n.isValid(t.T1)||!n.isValid(t.T2)||!n.isValid(t.T3)||!n.isValid(t.Wxi)||!n.isValid(t.Wxiw))}function C0(c,t){return vt.Scalar.geq(t,0)&&vt.Scalar.lt(t,c.r)}function Ko(c,t){return C0(c,vt.Scalar.fromRprLE(t))}function Ry(c,t){return Ko(c,t.eval_a)&&Ko(c,t.eval_b)&&Ko(c,t.eval_c)&&Ko(c,t.eval_s1)&&Ko(c,t.eval_s2)&&Ko(c,t.eval_zw)}function zy(c,t){for(let n=0;n<t.length;n++)if(!C0(c,t[n]))return!1;return!0}function Ty(c,t,n,a){let o=c.Fr,e={},h=new Ga(c);h.addPolCommitment(a.Qm),h.addPolCommitment(a.Ql),h.addPolCommitment(a.Qr),h.addPolCommitment(a.Qo),h.addPolCommitment(a.Qc),h.addPolCommitment(a.S1),h.addPolCommitment(a.S2),h.addPolCommitment(a.S3);for(let d=0;d<n.length;d++)h.addScalar(o.e(n[d]));h.addPolCommitment(t.A),h.addPolCommitment(t.B),h.addPolCommitment(t.C),e.beta=h.getChallenge(),h.reset(),h.addScalar(e.beta),e.gamma=h.getChallenge(),h.reset(),h.addScalar(e.beta),h.addScalar(e.gamma),h.addPolCommitment(t.Z),e.alpha=h.getChallenge(),h.reset(),h.addScalar(e.alpha),h.addPolCommitment(t.T1),h.addPolCommitment(t.T2),h.addPolCommitment(t.T3),e.xi=h.getChallenge(),h.reset(),h.addScalar(e.xi),h.addScalar(t.eval_a),h.addScalar(t.eval_b),h.addScalar(t.eval_c),h.addScalar(t.eval_s1),h.addScalar(t.eval_s2),h.addScalar(t.eval_zw),e.v=[],e.v[1]=h.getChallenge();for(let d=2;d<6;d++)e.v[d]=o.mul(e.v[d-1],e.v[1]);return h.reset(),h.addPolCommitment(t.Wxi),h.addPolCommitment(t.Wxiw),e.u=h.getChallenge(),e}function Gy(c,t,n){let a=c.Fr,o=t.xi,e=1;for(let l=0;l<n.power;l++)o=a.square(o),e*=2;t.xin=o,t.zh=a.sub(o,a.one);let h=[],d=a.e(e),b=a.one;for(let l=1;l<=Math.max(1,n.nPublic);l++)h[l]=a.div(a.mul(b,t.zh),a.mul(d,a.sub(t.xi,b))),b=a.mul(b,a.w[n.power]);return h}function ky(c,t,n){let a=c.Fr,o=a.zero;for(let e=0;e<t.length;e++){let h=a.e(t[e]);o=a.sub(o,a.mul(h,n[e+1]))}return o}function Uy(c,t,n,a,o){let e=c.Fr,h=a,d=e.mul(o,e.square(n.alpha)),b=e.add(t.eval_a,e.mul(n.beta,t.eval_s1));b=e.add(b,n.gamma);let l=e.add(t.eval_b,e.mul(n.beta,t.eval_s2));l=e.add(l,n.gamma);let s=e.add(t.eval_c,n.gamma),m=e.mul(e.mul(b,l),s);return m=e.mul(m,t.eval_zw),m=e.mul(m,n.alpha),e.sub(e.sub(h,d),m)}function Ny(c,t,n,a,o){let e=c.G1,h=c.Fr,d=e.timesFr(a.Qm,h.mul(t.eval_a,t.eval_b));d=e.add(d,e.timesFr(a.Ql,t.eval_a)),d=e.add(d,e.timesFr(a.Qr,t.eval_b)),d=e.add(d,e.timesFr(a.Qo,t.eval_c)),d=e.add(d,a.Qc);let b=h.mul(n.beta,n.xi),l=h.add(h.add(t.eval_a,b),n.gamma),s=h.add(h.add(t.eval_b,h.mul(b,a.k1)),n.gamma),m=h.add(h.add(t.eval_c,h.mul(b,a.k2)),n.gamma),B=h.mul(h.mul(h.mul(l,s),m),n.alpha),p=h.mul(o,h.square(n.alpha)),v=e.timesFr(t.Z,h.add(h.add(B,p),n.u)),M=h.add(h.add(t.eval_a,h.mul(n.beta,t.eval_s1)),n.gamma),x=h.add(h.add(t.eval_b,h.mul(n.beta,t.eval_s2)),n.gamma),S=h.mul(h.mul(n.alpha,n.beta),t.eval_zw),w=e.timesFr(a.S3,h.mul(h.mul(M,x),S)),k=t.T1,O=e.timesFr(t.T2,n.xin),W=e.timesFr(t.T3,h.square(n.xin)),F=e.add(k,e.add(O,W));return F=e.timesFr(F,n.zh),e.sub(e.sub(e.add(d,v),w),F)}function $y(c,t,n,a,o){let e=c.G1,h=e.add(o,e.timesFr(t.A,n.v[1]));return h=e.add(h,e.timesFr(t.B,n.v[2])),h=e.add(h,e.timesFr(t.C,n.v[3])),h=e.add(h,e.timesFr(a.S1,n.v[4])),h=e.add(h,e.timesFr(a.S2,n.v[5])),h}function Zy(c,t,n,a){let o=c.G1,e=c.Fr,h=e.add(e.neg(a),e.mul(n.v[1],t.eval_a));return h=e.add(h,e.mul(n.v[2],t.eval_b)),h=e.add(h,e.mul(n.v[3],t.eval_c)),h=e.add(h,e.mul(n.v[4],t.eval_s1)),h=e.add(h,e.mul(n.v[5],t.eval_s2)),h=e.add(h,e.mul(n.u,t.eval_zw)),o.timesFr(o.one,h)}async function jy(c,t,n,a,o,e){let h=c.G1,d=c.Fr,b=t.Wxi;b=h.add(b,h.timesFr(t.Wxiw,n.u));let l=h.timesFr(t.Wxi,n.xi),s=d.mul(d.mul(n.u,n.xi),d.w[a.power]);return l=h.add(l,h.timesFr(t.Wxiw,s)),l=h.add(l,e),l=h.sub(l,o),await c.pairingEq(h.neg(b),a.X_2,l,c.G2.one)}var{unstringifyBigInts:n0}=vt.utils;function un(c){let t=c.toString(16);for(;t.length<64;)t="0"+t;return t=`"0x${t}"`,t}async function Vy(c,t){let n=n0(c),a=n0(t),o=await yo(n.curve);o.G1,o.Fr;let e="";for(let h=0;h<a.length;h++)e!=""&&(e=e+","),e=e+un(a[h]);return`[${un(n.A[0])}, ${un(n.A[1])},${un(n.B[0])},${un(n.B[1])},${un(n.C[0])},${un(n.C[1])},${un(n.Z[0])},${un(n.Z[1])},${un(n.T1[0])},${un(n.T1[1])},${un(n.T2[0])},${un(n.T2[1])},${un(n.T3[0])},${un(n.T3[1])},${un(n.Wxi[0])},${un(n.Wxi[1])},${un(n.Wxiw[0])},${un(n.Wxiw[1])},${un(n.eval_a)},${un(n.eval_b)},${un(n.eval_c)},${un(n.eval_s1)},${un(n.eval_s2)},${un(n.eval_zw)}][${e}]`}var Wy=Object.freeze({__proto__:null,setup:Cy,fullProve:qy,prove:F0,verify:Iy,exportSolidityCallData:Vy});function a0(c,t){return[c,0,0,t.one,t.zero,t.zero,t.zero,t.zero]}function Qy(c,t,n,a,o,e,h,d){return[c,t,n,a,o,e,h,d]}function Xy(c,t,n,a,o,e,h,d,b){return[c,t,n,a,o,e,h,d]}var Zd=0,jd=1,Hy=2,Yd=class{constructor(t,n,a,o,e){this.Fr=t,this.logger=e,this.fnGetAdditionConstraint=a,this.fnGetMultiplicationConstraint=o}processR1csConstraint(t,n,a,o){this.normalizeLinearCombination(n),this.normalizeLinearCombination(a),this.normalizeLinearCombination(o);let e=this.getLinearCombinationType(n),h=this.getLinearCombinationType(a);if(e===Zd||h===Zd)return this.processR1csAdditionConstraint(t,o);if(e===jd){let d=this.joinLinearCombinations(a,o,n[0]);return this.processR1csAdditionConstraint(t,d)}else if(h===jd){let d=this.joinLinearCombinations(n,o,a[0]);return this.processR1csAdditionConstraint(t,d)}else return this.processR1csMultiplicationConstraint(t,n,a,o)}getLinearCombinationType(t){let n=this.Fr.zero,a=0,o=Object.keys(t);for(let e=0;e<o.length;e++)t[o[e]]==0n?delete t[o[e]]:o[e]==0?n=this.Fr.add(n,t[o[e]]):a++;return a>0?Hy:this.Fr.isZero(n)?Zd:jd}normalizeLinearCombination(t){let n=Object.keys(t);for(let a=0;a<n.length;a++)this.Fr.isZero(t[n[a]])&&delete t[n[a]];return t}joinLinearCombinations(t,n,a){let o={};for(let e in t)typeof o[e]>"u"?o[e]=this.Fr.mul(a,t[e]):o[e]=this.Fr.add(o[e],this.Fr.mul(a,t[e]));for(let e in n){let h=this.Fr.neg(n[e]);typeof o[e]>"u"?o[e]=h:o[e]=this.Fr.add(o[e],h)}return this.normalizeLinearCombination(o)}reduceCoefs(t,n,a,o,e){let h={k:this.Fr.zero,signals:[],coefs:[]},d=[];for(let b in o)b==0?h.k=this.Fr.add(h.k,o[b]):o[b]!=0n&&d.push([Number(b),o[b]]);for(;d.length>e;){let b=d.shift(),l=d.shift(),s=t.nVars++,m=this.fnGetAdditionConstraint(b[0],l[0],s,this.Fr.neg(b[1]),this.Fr.neg(l[1]),this.Fr.zero,this.Fr.one,this.Fr.zero);n.push(m),a.push([b[0],l[0],b[1],l[1]]),d.push([s,this.Fr.one])}for(let b=0;b<d.length;b++)h.signals[b]=d[b][0],h.coefs[b]=d[b][1];for(;h.coefs.length<e;)h.signals.push(0),h.coefs.push(this.Fr.zero);return h}processR1csAdditionConstraint(t,n){let a=[],o=[],e=this.reduceCoefs(t,a,o,n,3),h=this.fnGetAdditionConstraint(e.signals[0],e.signals[1],e.signals[2],e.coefs[0],e.coefs[1],this.Fr.zero,e.coefs[2],e.k);return a.push(h),[a,o]}processR1csMultiplicationConstraint(t,n,a,o){let e=[],h=[],d=this.reduceCoefs(t,e,h,n,1),b=this.reduceCoefs(t,e,h,a,1),l=this.reduceCoefs(t,e,h,o,1),s=this.fnGetMultiplicationConstraint(d.signals[0],b.signals[0],l.signals[0],this.Fr.mul(d.coefs[0],b.k),this.Fr.mul(d.k,b.coefs[0]),this.Fr.mul(d.coefs[0],b.coefs[0]),this.Fr.neg(l.coefs[0]),this.Fr.sub(this.Fr.mul(d.k,b.k),l.k));return e.push(s),[e,h]}},we=class{constructor(t,n,a){this.n=t,this.polynomials=Array(t).fill(void 0),this.curve=n,this.Fr=n.Fr,this.G1=n.G1,this.logger=a}addPolynomial(t,n){if(t>this.n-1)throw new Error("CPolynomial:addPolynomial, cannot add a polynomial to a position greater than n-1");this.polynomials[t]=n}degree(){let t=this.polynomials.map((n,a)=>n===void 0?0:n.degree()*this.n+a);return Math.max(...t)}getPolynomial(){let t=this.polynomials.map(h=>h===void 0?0:h.degree()),n=this.degree(),a=2**(ao(n-1)+1),o=this.Fr.n8,e=new Nt(new vt.BigBuffer(a*o),this.curve,this.logger);for(let h=0;h<n;h++){let d=h*o,b=d*this.n;for(let l=0;l<this.n;l++)this.polynomials[l]!==void 0&&h<=t[l]&&e.coef.set(this.polynomials[l].coef.slice(d,d+o),b+l*o)}return e}async multiExponentiation(t,n){let a=this.getPolynomial(),o=a.coef.byteLength/this.Fr.n8,e=t.slice(0,o*this.G1.F.n8*2),h=await this.Fr.batchFromMontgomery(a.coef),d=await this.G1.multiExpAffine(e,h,this.logger,n);return d=this.G1.toAffine(d),d}};async function Dy(c,t,n,a){a&&a.info("FFLONK SETUP STARTED"),globalThis.gc&&globalThis.gc(),a&&a.info("> Reading PTau file");let{fd:o,sections:e}=await Gt.readBinFile(t,"ptau",1,1<<22,1<<24);if(!e[12])throw new Error("Powers of Tau is not well prepared. Section 12 missing.");a&&a.info("> Getting curve from PTau settings");let{curve:h}=await ra(o,e);a&&a.info("> Reading r1cs file");let{fd:d,sections:b}=await Gt.readBinFile(c,"r1cs",1,1<<22,1<<24),l=await ni.readR1csFd(d,b,{loadConstraints:!1,loadCustomGates:!0});if(l.prime!==h.r)throw new Error("r1cs curve does not match powers of tau ceremony curve");let s=h.Fr,m=h.Fr.n8,B=h.G1.F.n8*2,p=h.G2.F.n8*2,v={},M={},x,S={nVars:l.nVars,nPublic:l.nOutputs+l.nPubInputs},w=new Un,k=new Un;if(a&&a.info("> Processing FFlonk constraints"),await Q(h.Fr,l,a),globalThis.gc&&globalThis.gc(),S.cirPower=Math.max(_6,ao(w.length+2-1)+1),S.domainSize=2**S.cirPower,e[2][0].size<(S.domainSize*9+18)*B)throw new Error("Powers of Tau is not big enough for this circuit size. Section 2 too small.");if(e[3][0].size<p)throw new Error("Powers of Tau is not well prepared. Section 3 too small.");a&&(a.info("----------------------------"),a.info("  FFLONK SETUP SETTINGS"),a.info(`  Curve:         ${h.name}`),a.info(`  Circuit power: ${S.cirPower}`),a.info(`  Domain size:   ${S.domainSize}`),a.info(`  Vars:          ${S.nVars}`),a.info(`  Public vars:   ${S.nPublic}`),a.info(`  Constraints:   ${w.length}`),a.info(`  Additions:     ${k.length}`),a.info("----------------------------")),a&&a.info("> computing k1 and k2");let[O,W]=Lt();a&&a.info("> computing w3");let F=rt();a&&a.info("> computing w4");let u=ht();a&&a.info("> computing w8");let L=A();a&&a.info("> computing wr");let $=i(S.cirPower,h.Fr);return await H(),await d.close(),await o.close(),a&&a.info("FFLONK SETUP FINISHED"),0;async function Q(C,r,z){for(let ct=0;ct<S.nPublic;ct++)w.push(a0(ct+1,C));let E=new Yd(C,a0,Qy,Xy,z),g=await Ft.readSection(d,b,2),U=0;for(let ct=0;ct<r.nConstraints;ct++){z&&ct!==0&&ct%5e5===0&&z.info(`    processing r1cs constraints ${ct}/${r.nConstraints}`);let[ft,_t]=E.processR1csConstraint(S,...st());w.push(...ft),k.push(..._t)}function st(){let ct=[];return ct[0]=et(),ct[1]=et(),ct[2]=et(),ct}function et(){let ct={},ft=g.slice(U,U+4);U+=4;let gt=new DataView(ft.buffer).getUint32(0,!0),yt=g.slice(U,U+(4+r.n8)*gt);U+=(4+r.n8)*gt;let ut=new DataView(yt.buffer);for(let lt=0;lt<gt;lt++){let bt=ut.getUint32(lt*(4+r.n8),!0),Et=r.F.fromRprLE(yt,lt*(4+r.n8)+4);ct[bt]=Et}return ct}return 0}async function H(){a&&a.info("> Writing the zkey file");let C=await Gt.createBinFile(n,"zkey",1,h6,1<<22,1<<24);a&&a.info(`\xB7\xB7\xB7 Writing Section ${Xf}. Zkey Header`),await q(C),a&&a.info(`\xB7\xB7\xB7 Writing Section ${ys}. Additions`),await y(C),globalThis.gc&&globalThis.gc(),a&&a.info(`\xB7\xB7\xB7 Writing Section ${Qd}. A Map`),await I(C,Qd,0,"A map"),globalThis.gc&&globalThis.gc(),a&&a.info(`\xB7\xB7\xB7 Writing Section ${Xd}. B Map`),await I(C,Xd,1,"B map"),globalThis.gc&&globalThis.gc(),a&&a.info(`\xB7\xB7\xB7 Writing Section ${Hd}. C Map`),await I(C,Hd,2,"C map"),globalThis.gc&&globalThis.gc(),a&&a.info(`\xB7\xB7\xB7 Writing Section ${ue}. QL`),await N(C,ue,3,"QL"),globalThis.gc&&globalThis.gc(),a&&a.info(`\xB7\xB7\xB7 Writing Section ${_e}. QR`),await N(C,_e,4,"QR"),globalThis.gc&&globalThis.gc(),a&&a.info(`\xB7\xB7\xB7 Writing Section ${he}. QM`),await N(C,he,5,"QM"),globalThis.gc&&globalThis.gc(),a&&a.info(`\xB7\xB7\xB7 Writing Section ${fe}. QO`),await N(C,fe,6,"QO"),globalThis.gc&&globalThis.gc(),a&&a.info(`\xB7\xB7\xB7 Writing Section ${ge}. QC`),await N(C,ge,7,"QC"),globalThis.gc&&globalThis.gc(),a&&a.info(`\xB7\xB7\xB7 Writing Sections ${Le},${pe},${be}. Sigma1, Sigma2 & Sigma 3`),await nt(C),globalThis.gc&&globalThis.gc(),a&&a.info(`\xB7\xB7\xB7 Writing Section ${Dd}. Lagrange Polynomials`),await J(C),globalThis.gc&&globalThis.gc(),a&&a.info(`\xB7\xB7\xB7 Writing Section ${ws}. Powers of Tau`),await j(C),globalThis.gc&&globalThis.gc(),a&&a.info(`\xB7\xB7\xB7 Writing Section ${Kd}. C0`),await ot(C),globalThis.gc&&globalThis.gc(),a&&a.info(`\xB7\xB7\xB7 Writing Section ${Wd}. FFlonk Header`),await V(C),globalThis.gc&&globalThis.gc(),a&&a.info("> Writing the zkey file finished"),await C.close()}async function q(C){await Gt.startWriteSection(C,Xf),await C.writeULE32(Fe),await Gt.endWriteSection(C)}async function y(C){await Gt.startWriteSection(C,ys);let r=new Uint8Array(8+2*m),z=new DataView(r.buffer);for(let E=0;E<k.length;E++){a&&E!==0&&E%5e5===0&&a.info(`      writing Additions: ${E}/${k.length}`);let g=k[E];z.setUint32(0,g[0],!0),z.setUint32(4,g[1],!0),r.set(g[2],8),r.set(g[3],8+m),await C.write(r)}await Gt.endWriteSection(C)}async function I(C,r,z,E){await Gt.startWriteSection(C,r);for(let g=0;g<w.length;g++)a&&g!==0&&g%5e5===0&&a.info(`      writing witness ${E}: ${g}/${w.length}`),await C.writeULE32(w[g][z]);await Gt.endWriteSection(C)}async function N(C,r,z,E){let g=new vt.BigBuffer(S.domainSize*m);for(let U=0;U<w.length;U++)g.set(w[U][z],U*m),a&&U!==0&&U%5e5===0&&a.info(`      writing ${E}: ${U}/${w.length}`);v[E]=await Nt.fromEvaluations(g,h,a),M[E]=await ln.fromPolynomial(v[E],4,h,a),await Gt.startWriteSection(C,r),await C.write(v[E].coef),await C.write(M[E].eval),await Gt.endWriteSection(C)}async function nt(C){let r=new vt.BigBuffer(m*S.domainSize*3),z=new Un(S.nVars),E=new Un(S.nVars),g=s.one;for(let st=0;st<S.domainSize;st++)st<w.length?(U(w[st][0],st),U(w[st][1],S.domainSize+st),U(w[st][2],S.domainSize*2+st)):st<S.domainSize-2?(U(0,st),U(0,S.domainSize+st),U(0,S.domainSize*2+st)):(r.set(g,st*m),r.set(s.mul(g,O),(S.domainSize+st)*m),r.set(s.mul(g,W),(S.domainSize*2+st)*m)),g=s.mul(g,s.w[S.cirPower]),a&&st!==0&&st%5e5===0&&a.info(`      writing sigma phase1: ${st}/${w.length}`);for(let st=0;st<S.nVars;st++)typeof E[st]<"u"?r.set(z[st],E[st]*m):console.log("Variable not used"),a&&st!==0&&st%5e5===0&&a.info(`      writing sigma phase2: ${st}/${S.nVars}`);globalThis.gc&&globalThis.gc();for(let st=0;st<3;st++){let et=st===0?Le:st===1?pe:be,ct="S"+(st+1);v[ct]=await Nt.fromEvaluations(r.slice(S.domainSize*m*st,S.domainSize*m*(st+1)),h,a),M[ct]=await ln.fromPolynomial(v[ct],4,h,a),await Gt.startWriteSection(C,et),await C.write(v[ct].coef),await C.write(M[ct].eval),await Gt.endWriteSection(C),globalThis.gc&&globalThis.gc()}return 0;function U(st,et){typeof z[st]>"u"?E[st]=et:r.set(z[st],et*m);let ct;et<S.domainSize?ct=g:et<2*S.domainSize?ct=s.mul(g,O):ct=s.mul(g,W),z[st]=ct}}async function J(C){await Gt.startWriteSection(C,Dd);let r=Math.max(S.nPublic,1);for(let z=0;z<r;z++){let E=new vt.BigBuffer(S.domainSize*m);E.set(s.one,z*m),await at(C,E)}await Gt.endWriteSection(C)}async function j(C){await Gt.startWriteSection(C,ws),x=new vt.BigBuffer((S.domainSize*9+18)*B),await o.readToBuffer(x,0,(S.domainSize*9+18)*B,e[2][0].p),await C.write(x),await Gt.endWriteSection(C)}async function ot(C){let r=new we(8,h,a);if(r.addPolynomial(0,v.QL),r.addPolynomial(1,v.QR),r.addPolynomial(2,v.QO),r.addPolynomial(3,v.QM),r.addPolynomial(4,v.QC),r.addPolynomial(5,v.S1),r.addPolynomial(6,v.S2),r.addPolynomial(7,v.S3),v.C0=r.getPolynomial(),v.C0.degree()>=8*S.domainSize)throw new Error("C0 Polynomial is not well calculated");await Gt.startWriteSection(C,Kd),await C.write(v.C0.coef),await Gt.endWriteSection(C)}async function V(C){await Gt.startWriteSection(C,Wd);let r=h.q,z=(Math.floor((vt.Scalar.bitLength(r)-1)/64)+1)*8;await C.writeULE32(z),await Gt.writeBigInt(C,r,z);let E=h.r,g=(Math.floor((vt.Scalar.bitLength(E)-1)/64)+1)*8;await C.writeULE32(g),await Gt.writeBigInt(C,E,g),await C.writeULE32(S.nVars),await C.writeULE32(S.nPublic),await C.writeULE32(S.domainSize),await C.writeULE32(k.length),await C.writeULE32(w.length),await C.write(O),await C.write(W),await C.write(F),await C.write(u),await C.write(L),await C.write($);let U;U=await o.read(p,e[3][0].p+p),await C.write(U);let st=await v.C0.multiExponentiation(x,"C0");await C.write(st),await Gt.endWriteSection(C)}async function at(C,r){let[z,E]=await Nt.to4T(r,S.domainSize,[],s);return await C.write(z),await C.write(E),[z,E]}function Lt(){let C=s.two;for(;z(C,[],S.cirPower);)s.add(C,s.one);let r=s.add(C,s.one);for(;z(r,[C],S.cirPower);)s.add(r,s.one);return[C,r];function z(E,g,U){let st=2**U,et=s.one;for(let ct=0;ct<st;ct++){if(s.eq(E,et))return!0;for(let ft=0;ft<g.length;ft++)if(s.eq(E,s.mul(g[ft],et)))return!0;et=s.mul(et,s.w[U])}return!1}}function rt(){let C=s.e(31624),z=vt.Scalar.div(3648040478639879203707734290876212514758060733402672390616367364429301415936n,vt.Scalar.e(3));return s.exp(C,z)}function ht(){return s.w[2]}function A(){return s.w[3]}function i(C,r){let z=r.e(467799165886069610036046866799264026481344299079011762026774533774345988080n);return r.exp(z,2**(28-C))}}var{stringifyBigInts:o0}=vt.utils;async function B0(c,t,n,a){n&&n.info("FFLONK PROVER STARTED"),n&&n.info("> Reading witness file");let{fd:o,sections:e}=await Ft.readBinFile(t,"wtns",2,1<<25,1<<23),h=await Ce(o,e);n&&n.info("> Reading zkey file");let{fd:d,sections:b}=await Ft.readBinFile(c,"zkey",2,1<<25,1<<23),l=await La(d,b,void 0,a);if(l.protocolId!==Fe)throw new Error("zkey file is not fflonk");if(!vt.Scalar.eq(l.r,h.q))throw new Error("Curve of the witness does not match the curve of the proving key");if(h.nWitness!==l.nVars-l.nAdditions)throw new Error(`Invalid witness length. Circuit: ${l.nVars}, witness: ${h.nWitness}, ${l.nAdditions}`);let s=l.curve,m=s.Fr,B=s.Fr.n8,p=s.G1.F.n8*2,v=l.domainSize*B;n&&(n.info("----------------------------"),n.info("  FFLONK PROVE SETTINGS"),n.info(`  Curve:         ${s.name}`),n.info(`  Circuit power: ${l.power}`),n.info(`  Domain size:   ${l.domainSize}`),n.info(`  Vars:          ${l.nVars}`),n.info(`  Public vars:   ${l.nPublic}`),n.info(`  Constraints:   ${l.nConstraints}`),n.info(`  Additions:     ${l.nAdditions}`),n.info("----------------------------")),n&&n.info("> Reading witness file data");let M=await Ft.readSection(o,e,2);await o.close(),M.set(m.zero,0);let x=new vt.BigBuffer(l.nAdditions*B),S={},w={},k={},O={},W={},F={},u=new ye(s,n);n&&n.info(`> Reading Section ${ys}. Additions`),await H(),n&&n.info(`> Reading Sections ${Le},${pe},${be}. Sigma1, Sigma2 & Sigma 3`),n&&n.info("\xB7\xB7\xB7 Reading Sigma polynomials "),w.Sigma1=new Nt(new vt.BigBuffer(v),s,n),w.Sigma2=new Nt(new vt.BigBuffer(v),s,n),w.Sigma3=new Nt(new vt.BigBuffer(v),s,n),await d.readToBuffer(w.Sigma1.coef,0,v,b[Le][0].p),await d.readToBuffer(w.Sigma2.coef,0,v,b[pe][0].p),await d.readToBuffer(w.Sigma3.coef,0,v,b[be][0].p),n&&n.info("\xB7\xB7\xB7 Reading Sigma evaluations"),k.Sigma1=new ln(new vt.BigBuffer(v*4),s,n),k.Sigma2=new ln(new vt.BigBuffer(v*4),s,n),k.Sigma3=new ln(new vt.BigBuffer(v*4),s,n),await d.readToBuffer(k.Sigma1.eval,0,v*4,b[Le][0].p+v),await d.readToBuffer(k.Sigma2.eval,0,v*4,b[pe][0].p+v),await d.readToBuffer(k.Sigma3.eval,0,v*4,b[be][0].p+v),n&&n.info(`> Reading Section ${ws}. Powers of Tau`);let L=new vt.BigBuffer(l.domainSize*16*p);await d.readToBuffer(L,0,(l.domainSize*9+18)*p,b[ws][0].p),globalThis.gc&&globalThis.gc(),n&&n.info(""),n&&n.info("> ROUND 1"),await I(),delete w.T0,delete k.QL,delete k.QR,delete k.QM,delete k.QO,delete k.QC,globalThis.gc&&globalThis.gc(),n&&n.info("> ROUND 2"),await N(),delete S.A,delete S.B,delete S.C,delete k.A,delete k.B,delete k.C,delete k.Sigma1,delete k.Sigma2,delete k.Sigma3,delete k.lagrange1,delete k.Z,globalThis.gc&&globalThis.gc(),n&&n.info("> ROUND 3"),await nt(),delete w.A,delete w.B,delete w.C,delete w.Z,delete w.T1,delete w.T2,delete w.Sigma1,delete w.Sigma2,delete w.Sigma3,delete w.QL,delete w.QR,delete w.QM,delete w.QC,delete w.QO,globalThis.gc&&globalThis.gc(),n&&n.info("> ROUND 4"),await J(),globalThis.gc&&globalThis.gc(),n&&n.info("> ROUND 5"),await j(),delete w.C0,delete w.C1,delete w.C2,delete w.R1,delete w.R2,delete w.F,delete w.L,delete w.ZT,delete w.ZTS2,await d.close(),globalThis.gc&&globalThis.gc(),u.addEvaluation("inv",ot());let $=u.toObjectProof();$.protocol="fflonk",$.curve=s.name;let Q=[];for(let V=1;V<=l.nPublic;V++){let at=V*B,Lt=M.slice(at,at+B);Q.push(vt.Scalar.fromRprLE(Lt))}return n&&n.info("FFLONK PROVER FINISHED"),{proof:o0($),publicSignals:o0(Q)};async function H(){n&&n.info("\xB7\xB7\xB7 Computing additions");let V=await Ft.readSection(d,b,ys),at=8+B*2;for(let Lt=0;Lt<l.nAdditions;Lt++){n&&Lt!==0&&Lt%1e5===0&&n.info(`    addition ${Lt}/${l.nAdditions}`);let rt=Lt*at,ht=q(V,rt);rt+=4;let A=q(V,rt);rt+=4;let i=V.slice(rt,rt+B);rt+=B;let C=V.slice(rt,rt+B),r=y(ht),z=y(A),E=m.add(m.mul(i,r),m.mul(C,z));x.set(E,B*Lt)}}function q(V,at){let Lt=V.slice(at,at+4);return new DataView(Lt.buffer,Lt.byteOffset,Lt.byteLength).getUint32(0,!0)}function y(V){let at=l.nVars-l.nAdditions;if(V<at)return M.slice(V*B,V*B+B);if(V<l.nVars){let Lt=(V-at)*B;return x.slice(Lt,Lt+B)}return m.zero}async function I(){W.b=[];for(let ht=1;ht<=9;ht++)W.b[ht]=m.random();n&&n.info("> Computing A, B, C wire polynomials"),await at(),n&&n.info("> Computing T0 polynomial"),await Lt(),n&&n.info("> Computing C1 polynomial"),await rt(),n&&n.info("> Computing C1 multi exponentiation");let V=await w.C1.multiExponentiation(L,"C1");return u.addPolynomial("C1",V),0;async function at(){n&&n.info("\xB7\xB7\xB7 Reading data from zkey file"),S.A=new vt.BigBuffer(v),S.B=new vt.BigBuffer(v),S.C=new vt.BigBuffer(v);let ht=await Ft.readSection(d,b,Qd),A=await Ft.readSection(d,b,Xd),i=await Ft.readSection(d,b,Hd);for(let C=0;C<l.nConstraints;C++){let r=C*B,z=C*4,E=q(ht,z);S.A.set(y(E),r);let g=q(A,z);S.B.set(y(g),r);let U=q(i,z);S.C.set(y(U),r)}if(S.A.set(W.b[1],v-64),S.A.set(W.b[2],v-32),S.B.set(W.b[3],v-64),S.B.set(W.b[4],v-32),S.C.set(W.b[5],v-64),S.C.set(W.b[6],v-32),S.A=await m.batchToMontgomery(S.A),S.B=await m.batchToMontgomery(S.B),S.C=await m.batchToMontgomery(S.C),n&&n.info("\xB7\xB7\xB7 Computing A ifft"),w.A=await Nt.fromEvaluations(S.A,s,n),n&&n.info("\xB7\xB7\xB7 Computing B ifft"),w.B=await Nt.fromEvaluations(S.B,s,n),n&&n.info("\xB7\xB7\xB7 Computing C ifft"),w.C=await Nt.fromEvaluations(S.C,s,n),n&&n.info("\xB7\xB7\xB7 Computing A fft"),k.A=await ln.fromPolynomial(w.A,4,s,n),n&&n.info("\xB7\xB7\xB7 Computing B fft"),k.B=await ln.fromPolynomial(w.B,4,s,n),n&&n.info("\xB7\xB7\xB7 Computing C fft"),k.C=await ln.fromPolynomial(w.C,4,s,n),w.A.degree()>=l.domainSize)throw new Error("A Polynomial is not well calculated");if(w.B.degree()>=l.domainSize)throw new Error("B Polynomial is not well calculated");if(w.C.degree()>=l.domainSize)throw new Error("C Polynomial is not well calculated")}async function Lt(){n&&n.info(`\xB7\xB7\xB7 Reading sections ${ue}, ${_e}, ${he}, ${fe}, ${ge}. Q selectors`),k.QL=new ln(new vt.BigBuffer(v*4),s,n),k.QR=new ln(new vt.BigBuffer(v*4),s,n),k.QM=new ln(new vt.BigBuffer(v*4),s,n),k.QO=new ln(new vt.BigBuffer(v*4),s,n),k.QC=new ln(new vt.BigBuffer(v*4),s,n),await d.readToBuffer(k.QL.eval,0,v*4,b[ue][0].p+v),await d.readToBuffer(k.QR.eval,0,v*4,b[_e][0].p+v),await d.readToBuffer(k.QM.eval,0,v*4,b[he][0].p+v),await d.readToBuffer(k.QO.eval,0,v*4,b[fe][0].p+v),await d.readToBuffer(k.QC.eval,0,v*4,b[ge][0].p+v);let ht=await Ft.readSection(d,b,Dd);k.lagrange1=new ln(ht,s,n),S.T0=new vt.BigBuffer(v*4),n&&n.info("\xB7\xB7\xB7 Computing T0 evaluations");for(let A=0;A<l.domainSize*4;A++){n&&A!==0&&A%1e5===0&&n.info(`      T0 evaluation ${A}/${l.domainSize*4}`);let i=k.A.getEvaluation(A),C=k.B.getEvaluation(A),r=k.C.getEvaluation(A),z=k.QL.getEvaluation(A),E=k.QR.getEvaluation(A),g=k.QM.getEvaluation(A),U=k.QO.getEvaluation(A),st=k.QC.getEvaluation(A),et=m.zero;for(let ut=0;ut<l.nPublic;ut++){let lt=ut*5*l.domainSize+l.domainSize+A,bt=k.lagrange1.getEvaluation(lt),Et=S.A.slice(ut*B,(ut+1)*B);et=m.sub(et,m.mul(bt,Et))}let ct=m.mul(i,z),ft=m.mul(C,E),_t=m.mul(m.mul(i,C),g),gt=m.mul(r,U),yt=m.add(ct,m.add(ft,m.add(_t,m.add(gt,m.add(st,et)))));S.T0.set(yt,A*B)}if(n&&n.info("buffer T0: "+S.T0.byteLength/B),n&&n.info("\xB7\xB7\xB7 Computing T0 ifft"),w.T0=await Nt.fromEvaluations(S.T0,s,n),n&&n.info("T0 length: "+w.T0.length()),n&&n.info("T0 degree: "+w.T0.degree()),n&&n.info("\xB7\xB7\xB7 Computing T0 / ZH"),w.T0.divByZerofier(l.domainSize,m.one),w.T0.degree()>=2*l.domainSize-2)throw new Error(`T0 Polynomial is not well calculated (degree is ${w.T0.degree()} and must be less than ${2*l.domainSize+2}`);delete S.T0}async function rt(){let ht=new we(4,s,n);if(ht.addPolynomial(0,w.A),ht.addPolynomial(1,w.B),ht.addPolynomial(2,w.C),ht.addPolynomial(3,w.T0),w.C1=ht.getPolynomial(),w.C1.degree()>=8*l.domainSize-8)throw new Error("C1 Polynomial is not well calculated")}}async function N(){n&&n.info("> Computing challenges beta and gamma");let V=new Ga(s);V.addPolCommitment(l.C0);for(let i=0;i<l.nPublic;i++)V.addScalar(S.A.slice(i*B,i*B+B));V.addPolCommitment(u.getPolynomial("C1")),W.beta=V.getChallenge(),n&&n.info("\xB7\xB7\xB7 challenges.beta: "+m.toString(W.beta)),V.reset(),V.addScalar(W.beta),W.gamma=V.getChallenge(),n&&n.info("\xB7\xB7\xB7 challenges.gamma: "+m.toString(W.gamma)),n&&n.info("> Computing Z polynomial"),await Lt(),n&&n.info("> Computing T1 polynomial"),await rt(),n&&n.info("> Computing T2 polynomial"),await ht(),n&&n.info("> Computing C2 polynomial"),await A(),n&&n.info("> Computing C2 multi exponentiation");let at=await w.C2.multiExponentiation(L,"C2");return u.addPolynomial("C2",at),0;async function Lt(){n&&n.info("\xB7\xB7\xB7 Computing Z evaluations");let i=new vt.BigBuffer(v),C=new vt.BigBuffer(v);i.set(m.one,0),C.set(m.one,0);let r=m.one;for(let z=0;z<l.domainSize;z++){n&&z!==0&&z%1e5===0&&n.info(`    Z evaluation ${z}/${l.domainSize}`);let E=z*B,g=m.mul(W.beta,r),U=S.A.slice(E,E+B);U=m.add(U,g),U=m.add(U,W.gamma);let st=S.B.slice(E,E+B);st=m.add(st,m.mul(l.k1,g)),st=m.add(st,W.gamma);let et=S.C.slice(E,E+B);et=m.add(et,m.mul(l.k2,g)),et=m.add(et,W.gamma);let ct=m.mul(U,m.mul(st,et)),ft=S.A.slice(E,E+B);ft=m.add(ft,m.mul(W.beta,k.Sigma1.getEvaluation(z*4))),ft=m.add(ft,W.gamma);let _t=S.B.slice(E,E+B);_t=m.add(_t,m.mul(W.beta,k.Sigma2.getEvaluation(z*4))),_t=m.add(_t,W.gamma);let gt=S.C.slice(E,E+B);gt=m.add(gt,m.mul(W.beta,k.Sigma3.getEvaluation(z*4))),gt=m.add(gt,W.gamma);let yt=m.mul(ft,m.mul(_t,gt));ct=m.mul(i.slice(E,E+B),ct),i.set(ct,(z+1)%l.domainSize*B),yt=m.mul(C.slice(E,E+B),yt),C.set(yt,(z+1)%l.domainSize*B),r=m.mul(r,m.w[l.power])}C=await m.batchInverse(C);for(let z=0;z<l.domainSize;z++){let E=z*B,g=m.mul(i.slice(E,E+B),C.slice(E,E+B));i.set(g,E)}if(S.Z=i,!m.eq(i.slice(0,B),m.one))throw new Error("Copy constraints does not match");if(n&&n.info("\xB7\xB7\xB7 Computing Z ifft"),w.Z=await Nt.fromEvaluations(S.Z,s,n),n&&n.info("\xB7\xB7\xB7 Computing Z fft"),k.Z=await ln.fromPolynomial(w.Z,4,s,n),w.Z.blindCoefficients([W.b[9],W.b[8],W.b[7]]),w.Z.degree()>=l.domainSize+3)throw new Error("Z Polynomial is not well calculated");delete S.Z}async function rt(){n&&n.info("\xB7\xB7\xB7 Computing T1 evaluations"),S.T1=new vt.BigBuffer(v*2),S.T1z=new vt.BigBuffer(v*2);let i=m.one;for(let C=0;C<l.domainSize*2;C++){n&&C!==0&&C%1e5===0&&n.info(`    T1 evaluation ${C}/${l.domainSize*4}`);let r=m.square(i),z=k.Z.getEvaluation(C*2),E=m.add(m.add(m.mul(W.b[7],r),m.mul(W.b[8],i)),W.b[9]),g=k.lagrange1.getEvaluation(l.domainSize+C*2),U=m.mul(m.sub(z,m.one),g),st=m.mul(E,g);S.T1.set(U,C*B),S.T1z.set(st,C*B),i=m.mul(i,m.w[l.power+1])}if(n&&n.info("\xB7\xB7\xB7 Computing T1 ifft"),w.T1=await Nt.fromEvaluations(S.T1,s,n),w.T1.divByZerofier(l.domainSize,m.one),n&&n.info("\xB7\xB7\xB7 Computing T1z ifft"),w.T1z=await Nt.fromEvaluations(S.T1z,s,n),w.T1.add(w.T1z),w.T1.degree()>=l.domainSize+2)throw new Error("T1 Polynomial is not well calculated");delete S.T1,delete S.T1z,delete w.T1z}async function ht(){n&&n.info("\xB7\xB7\xB7 Computing T2 evaluations"),S.T2=new vt.BigBuffer(v*4),S.T2z=new vt.BigBuffer(v*4);let i=m.one;for(let C=0;C<l.domainSize*4;C++){n&&C!==0&&C%1e5===0&&n.info(`    T2 evaluation ${C}/${l.domainSize*4}`);let r=m.square(i),z=m.mul(i,m.w[l.power]),E=m.square(z),g=k.A.getEvaluation(C),U=k.B.getEvaluation(C),st=k.C.getEvaluation(C),et=k.Z.getEvaluation(C),ct=k.Z.getEvaluation((l.domainSize*4+4+C)%(l.domainSize*4)),ft=m.add(m.add(m.mul(W.b[7],r),m.mul(W.b[8],i)),W.b[9]),_t=m.add(m.add(m.mul(W.b[7],E),m.mul(W.b[8],z)),W.b[9]),gt=k.Sigma1.getEvaluation(C),yt=k.Sigma2.getEvaluation(C),ut=k.Sigma3.getEvaluation(C),lt=m.mul(W.beta,i),bt=m.add(g,lt);bt=m.add(bt,W.gamma);let Et=m.add(U,m.mul(lt,l.k1));Et=m.add(Et,W.gamma);let It=m.add(st,m.mul(lt,l.k2));It=m.add(It,W.gamma);let zt=m.mul(m.mul(m.mul(bt,Et),It),et),Mt=m.mul(m.mul(m.mul(bt,Et),It),ft),kt=m.add(g,m.mul(W.beta,gt));kt=m.add(kt,W.gamma);let Pt=m.add(U,m.mul(W.beta,yt));Pt=m.add(Pt,W.gamma);let qt=m.add(st,m.mul(W.beta,ut));qt=m.add(qt,W.gamma);let Rt=m.mul(m.mul(m.mul(kt,Pt),qt),ct),Kt=m.mul(m.mul(m.mul(kt,Pt),qt),_t),Ut=m.sub(zt,Rt),X=m.sub(Mt,Kt);S.T2.set(Ut,C*B),S.T2z.set(X,C*B),i=m.mul(i,m.w[l.power+2])}if(n&&n.info("\xB7\xB7\xB7 Computing T2 ifft"),w.T2=await Nt.fromEvaluations(S.T2,s,n),n&&n.info("\xB7\xB7\xB7 Computing T2 / ZH"),w.T2.divByZerofier(l.domainSize,m.one),n&&n.info("\xB7\xB7\xB7 Computing T2z ifft"),w.T2z=await Nt.fromEvaluations(S.T2z,s,n),w.T2.add(w.T2z),w.T2.degree()>=3*l.domainSize)throw new Error("T2 Polynomial is not well calculated");delete S.T2,delete S.T2z,delete w.T2z}async function A(){let i=new we(3,s,n);if(i.addPolynomial(0,w.Z),i.addPolynomial(1,w.T1),i.addPolynomial(2,w.T2),w.C2=i.getPolynomial(),w.C2.degree()>=9*l.domainSize)throw new Error("C2 Polynomial is not well calculated")}}async function nt(){n&&n.info("> Computing challenge xi");let V=new Ga(s);V.addScalar(W.gamma),V.addPolCommitment(u.getPolynomial("C2")),W.xiSeed=V.getChallenge();let at=m.square(W.xiSeed);F.w8=[],F.w8[0]=m.one;for(let Lt=1;Lt<8;Lt++)F.w8[Lt]=m.mul(F.w8[Lt-1],l.w8);F.w4=[],F.w4[0]=m.one;for(let Lt=1;Lt<4;Lt++)F.w4[Lt]=m.mul(F.w4[Lt-1],l.w4);F.w3=[],F.w3[0]=m.one,F.w3[1]=l.w3,F.w3[2]=m.square(l.w3),F.S0={},F.S0.h0w8=[],F.S0.h0w8[0]=m.mul(at,W.xiSeed);for(let Lt=1;Lt<8;Lt++)F.S0.h0w8[Lt]=m.mul(F.S0.h0w8[0],F.w8[Lt]);F.S1={},F.S1.h1w4=[],F.S1.h1w4[0]=m.square(F.S0.h0w8[0]);for(let Lt=1;Lt<4;Lt++)F.S1.h1w4[Lt]=m.mul(F.S1.h1w4[0],F.w4[Lt]);F.S2={},F.S2.h2w3=[],F.S2.h2w3[0]=m.mul(F.S1.h1w4[0],at),F.S2.h2w3[1]=m.mul(F.S2.h2w3[0],F.w3[1]),F.S2.h2w3[2]=m.mul(F.S2.h2w3[0],F.w3[2]),F.S2.h3w3=[],F.S2.h3w3[0]=m.mul(F.S2.h2w3[0],l.wr),F.S2.h3w3[1]=m.mul(F.S2.h3w3[0],F.w3[1]),F.S2.h3w3[2]=m.mul(F.S2.h3w3[0],F.w3[2]),W.xi=m.mul(m.square(F.S2.h2w3[0]),F.S2.h2w3[0]),n&&n.info("\xB7\xB7\xB7 challenges.xi: "+m.toString(W.xi)),w.QL=new Nt(new vt.BigBuffer(v),s,n),w.QR=new Nt(new vt.BigBuffer(v),s,n),w.QM=new Nt(new vt.BigBuffer(v),s,n),w.QO=new Nt(new vt.BigBuffer(v),s,n),w.QC=new Nt(new vt.BigBuffer(v),s,n),await d.readToBuffer(w.QL.coef,0,v,b[ue][0].p),await d.readToBuffer(w.QR.coef,0,v,b[_e][0].p),await d.readToBuffer(w.QM.coef,0,v,b[he][0].p),await d.readToBuffer(w.QO.coef,0,v,b[fe][0].p),await d.readToBuffer(w.QC.coef,0,v,b[ge][0].p),n&&n.info("\xB7\xB7\xB7 Computing evaluations"),u.addEvaluation("ql",w.QL.evaluate(W.xi)),u.addEvaluation("qr",w.QR.evaluate(W.xi)),u.addEvaluation("qm",w.QM.evaluate(W.xi)),u.addEvaluation("qo",w.QO.evaluate(W.xi)),u.addEvaluation("qc",w.QC.evaluate(W.xi)),u.addEvaluation("s1",w.Sigma1.evaluate(W.xi)),u.addEvaluation("s2",w.Sigma2.evaluate(W.xi)),u.addEvaluation("s3",w.Sigma3.evaluate(W.xi)),u.addEvaluation("a",w.A.evaluate(W.xi)),u.addEvaluation("b",w.B.evaluate(W.xi)),u.addEvaluation("c",w.C.evaluate(W.xi)),u.addEvaluation("z",w.Z.evaluate(W.xi)),W.xiw=m.mul(W.xi,m.w[l.power]),u.addEvaluation("zw",w.Z.evaluate(W.xiw)),u.addEvaluation("t1w",w.T1.evaluate(W.xiw)),u.addEvaluation("t2w",w.T2.evaluate(W.xiw))}async function J(){n&&n.info("> Computing challenge alpha");let V=new Ga(s);V.addScalar(W.xiSeed),V.addScalar(u.getEvaluation("ql")),V.addScalar(u.getEvaluation("qr")),V.addScalar(u.getEvaluation("qm")),V.addScalar(u.getEvaluation("qo")),V.addScalar(u.getEvaluation("qc")),V.addScalar(u.getEvaluation("s1")),V.addScalar(u.getEvaluation("s2")),V.addScalar(u.getEvaluation("s3")),V.addScalar(u.getEvaluation("a")),V.addScalar(u.getEvaluation("b")),V.addScalar(u.getEvaluation("c")),V.addScalar(u.getEvaluation("z")),V.addScalar(u.getEvaluation("zw")),V.addScalar(u.getEvaluation("t1w")),V.addScalar(u.getEvaluation("t2w")),W.alpha=V.getChallenge(),n&&n.info("\xB7\xB7\xB7 challenges.alpha: "+m.toString(W.alpha)),n&&n.info("> Reading C0 polynomial"),w.C0=new Nt(new vt.BigBuffer(v*8),s,n),await d.readToBuffer(w.C0.coef,0,v*8,b[Kd][0].p),n&&n.info("> Computing R0 polynomial"),Lt(),n&&n.info("> Computing R1 polynomial"),rt(),n&&n.info("> Computing R2 polynomial"),ht(),n&&n.info("> Computing F polynomial"),await A(),n&&n.info("> Computing W1 multi exponentiation");let at=await w.F.multiExponentiation(L,"W1");return u.addPolynomial("W1",at),0;function Lt(){if(w.R0=Nt.lagrangePolynomialInterpolation([F.S0.h0w8[0],F.S0.h0w8[1],F.S0.h0w8[2],F.S0.h0w8[3],F.S0.h0w8[4],F.S0.h0w8[5],F.S0.h0w8[6],F.S0.h0w8[7]],[w.C0.evaluate(F.S0.h0w8[0]),w.C0.evaluate(F.S0.h0w8[1]),w.C0.evaluate(F.S0.h0w8[2]),w.C0.evaluate(F.S0.h0w8[3]),w.C0.evaluate(F.S0.h0w8[4]),w.C0.evaluate(F.S0.h0w8[5]),w.C0.evaluate(F.S0.h0w8[6]),w.C0.evaluate(F.S0.h0w8[7])],s),w.R0.degree()>7)throw new Error("R0 Polynomial is not well calculated")}function rt(){if(w.R1=Nt.lagrangePolynomialInterpolation([F.S1.h1w4[0],F.S1.h1w4[1],F.S1.h1w4[2],F.S1.h1w4[3]],[w.C1.evaluate(F.S1.h1w4[0]),w.C1.evaluate(F.S1.h1w4[1]),w.C1.evaluate(F.S1.h1w4[2]),w.C1.evaluate(F.S1.h1w4[3])],s),w.R1.degree()>3)throw new Error("R1 Polynomial is not well calculated")}function ht(){if(w.R2=Nt.lagrangePolynomialInterpolation([F.S2.h2w3[0],F.S2.h2w3[1],F.S2.h2w3[2],F.S2.h3w3[0],F.S2.h3w3[1],F.S2.h3w3[2]],[w.C2.evaluate(F.S2.h2w3[0]),w.C2.evaluate(F.S2.h2w3[1]),w.C2.evaluate(F.S2.h2w3[2]),w.C2.evaluate(F.S2.h3w3[0]),w.C2.evaluate(F.S2.h3w3[1]),w.C2.evaluate(F.S2.h3w3[2])],s),w.R2.degree()>5)throw new Error("R2 Polynomial is not well calculated")}async function A(){n&&n.info("\xB7\xB7\xB7 Computing F polynomial"),w.F=Nt.fromPolynomial(w.C0,s,n),w.F.sub(w.R0),w.F.divByZerofier(8,W.xi);let i=Nt.fromPolynomial(w.C1,s,n);i.sub(w.R1),i.mulScalar(W.alpha),i.divByZerofier(4,W.xi);let C=Nt.fromPolynomial(w.C2,s,n);if(C.sub(w.R2),C.mulScalar(m.square(W.alpha)),C.divByZerofier(3,W.xi),C.divByZerofier(3,W.xiw),w.F.add(i),w.F.add(C),w.F.degree()>=9*l.domainSize-6)throw new Error("F Polynomial is not well calculated")}}async function j(){n&&n.info("> Computing challenge y");let V=new Ga(s);V.addScalar(W.alpha),V.addPolCommitment(u.getPolynomial("W1")),W.y=V.getChallenge(),n&&n.info("\xB7\xB7\xB7 challenges.y: "+m.toString(W.y)),n&&n.info("> Computing L polynomial"),await A(),n&&n.info("> Computing ZTS2 polynomial"),await C();let at=w.ZTS2.evaluate(W.y);at=m.inv(at),w.L.mulScalar(at);let Lt=Nt.fromCoefficientsArray([m.neg(W.y),m.one],s);n&&n.info("> Computing W' = L / ZTS2 polynomial");let rt=w.L.divBy(Lt);if(rt.degree()>0)throw new Error(`Degree of L(X)/(ZTS2(y)(X-y)) remainder is ${rt.degree()} and should be 0`);if(w.L.degree()>=9*l.domainSize-1)throw new Error("Degree of L(X)/(ZTS2(y)(X-y)) is not correct");n&&n.info("> Computing W' multi exponentiation");let ht=await w.L.multiExponentiation(L,"W2");return u.addPolynomial("W2",ht),0;async function A(){n&&n.info("\xB7\xB7\xB7 Computing L polynomial");let r=w.R0.evaluate(W.y),z=w.R1.evaluate(W.y),E=w.R2.evaluate(W.y),g=m.sub(W.y,F.S0.h0w8[0]);for(let ut=1;ut<8;ut++)g=m.mul(g,m.sub(W.y,F.S0.h0w8[ut]));let U=m.sub(W.y,F.S1.h1w4[0]);for(let ut=1;ut<4;ut++)U=m.mul(U,m.sub(W.y,F.S1.h1w4[ut]));let st=m.sub(W.y,F.S2.h2w3[0]);for(let ut=1;ut<3;ut++)st=m.mul(st,m.sub(W.y,F.S2.h2w3[ut]));for(let ut=0;ut<3;ut++)st=m.mul(st,m.sub(W.y,F.S2.h3w3[ut]));let et=m.mul(U,st),ct=m.mul(W.alpha,m.mul(g,st)),ft=m.mul(m.square(W.alpha),m.mul(g,U));O.denH1=U,O.denH2=st,w.L=Nt.fromPolynomial(w.C0,s,n),w.L.subScalar(r),w.L.mulScalar(et);let _t=Nt.fromPolynomial(w.C1,s,n);_t.subScalar(z),_t.mulScalar(ct);let gt=Nt.fromPolynomial(w.C2,s,n);gt.subScalar(E),gt.mulScalar(ft),w.L.add(_t),w.L.add(gt),n&&n.info("> Computing ZT polynomial"),await i();let yt=w.ZT.evaluate(W.y);if(w.F.mulScalar(yt),w.L.sub(w.F),w.L.degree()>=9*l.domainSize)throw new Error("L Polynomial is not well calculated");delete S.L}async function i(){w.ZT=Nt.zerofierPolynomial([F.S0.h0w8[0],F.S0.h0w8[1],F.S0.h0w8[2],F.S0.h0w8[3],F.S0.h0w8[4],F.S0.h0w8[5],F.S0.h0w8[6],F.S0.h0w8[7],F.S1.h1w4[0],F.S1.h1w4[1],F.S1.h1w4[2],F.S1.h1w4[3],F.S2.h2w3[0],F.S2.h2w3[1],F.S2.h2w3[2],F.S2.h3w3[0],F.S2.h3w3[1],F.S2.h3w3[2]],s)}async function C(){w.ZTS2=Nt.zerofierPolynomial([F.S1.h1w4[0],F.S1.h1w4[1],F.S1.h1w4[2],F.S1.h1w4[3],F.S2.h2w3[0],F.S2.h2w3[1],F.S2.h2w3[2],F.S2.h3w3[0],F.S2.h3w3[1],F.S2.h3w3[2]],s)}}function ot(){let V=W.xi;for(let C=0;C<l.power;C++)V=m.square(V);O.zh=m.sub(V,m.one),ht(O,F.S0.h0w8,W.y,s),A(O,F.S1.h1w4,W.y,s),i(O,F.S2.h2w3,F.S2.h3w3,W.y,W.xi,W.xiw,s);let at=Math.max(1,l.nPublic),Lt=m.one;for(let C=0;C<at;C++)O["Li_"+(C+1)]=m.mul(m.e(l.domainSize),m.sub(W.xi,Lt)),Lt=m.mul(Lt,m.w[l.power]);let rt=m.one;for(let C of Object.values(O))if(Array.isArray(C))for(let r of C)rt=m.mul(rt,r);else rt=m.mul(rt,C);return m.inv(rt);function ht(C,r,z,E){let g=E.Fr,U=r.length,st=g.mul(g.e(U),g.exp(r[0],U-2)),et=[];for(let ct=0;ct<U;ct++){let ft=r[(U-1)*ct%U],_t=g.sub(z,r[ct]);C[["LiS0_"+(ct+1)]]=g.mul(g.mul(st,ft),_t)}return et}function A(C,r,z,E){let g=E.Fr,U=r.length,st=g.mul(g.e(U),g.exp(r[0],U-2)),et=[];for(let ct=0;ct<U;ct++){let ft=r[(U-1)*ct%U],_t=g.sub(z,r[ct]);C[["LiS1_"+(ct+1)]]=g.mul(g.mul(st,ft),_t)}return et}function i(C,r,z,E,g,U,st){let et=st.Fr,ct=[],ft=et.mul(et.e(3),r[0]),_t=et.sub(g,U),gt=et.mul(ft,_t);for(let lt=0;lt<3;lt++){let bt=r[2*lt%3],Et=et.sub(E,r[lt]);C[["LiS2_"+(lt+1)]]=et.mul(gt,et.mul(bt,Et))}let yt=et.mul(et.e(3),z[0]),ut=et.sub(U,g);gt=et.mul(yt,ut);for(let lt=0;lt<3;lt++){let bt=z[2*lt%3],Et=et.sub(E,z[lt]);C[["LiS2_"+(lt+1+3)]]=et.mul(gt,et.mul(bt,Et))}return ct}}}var{unstringifyBigInts:Ky}=vt.utils;async function Jy(c,t,n,a,o,e){let h=Ky(c),d={type:"mem"};return await Bs(h,t,d,o),await B0(n,d,a,e)}var{unstringifyBigInts:Vd}=vt.utils;async function Yy(c,t,n,a){a&&a.info("FFLONK VERIFIER STARTED"),c=Vd(c),n=Vd(n);let o=await yo(c.curve),e=tw(o,c),h=new ye(o,a);h.fromObjectProof(n);let d=Vd(t);if(d.length!==e.nPublic)return a.error("Number of public signals does not match with vk"),!1;let b=o.Fr;if(a&&(a.info("----------------------------"),a.info("  FFLONK VERIFY SETTINGS"),a.info(`  Curve:         ${o.name}`),a.info(`  Circuit power: ${e.power}`),a.info(`  Domain size:   ${2**e.power}`),a.info(`  Public vars:   ${e.nPublic}`),a.info("----------------------------")),a&&a.info("> Checking commitments belong to G1"),!nw(o,h,e))return a&&a.error("Proof commitments are not valid"),!1;if(a&&a.info("> Checking evaluations belong to F"),!aw(o,h))return a&&a.error("Proof evaluations are not valid."),!1;if(a&&a.info("> Checking public inputs belong to F"),!ow(o,d))return a&&a.error("Public inputs are not valid."),!1;a&&a.info("> Computing challenges");let{challenges:l,roots:s}=iw(o,h,e,d,a);a&&a.info("> Computing Zero polynomial evaluation Z_H(xi)"),l.zh=b.sub(l.xiN,b.one),l.invzh=b.inv(l.zh),a&&a.info("> Computing Lagrange evaluations");let m=await ew(o,l,e);a&&a.info("> Computing polynomial identities PI(X)");let B=cw(o,d,m);a&&a.info("> Computing r0(y)");let p=sw(h,l,s,o,a);a&&a.info("> Computing r1(y)");let v=lw(h,l,s,B,o,a);a&&a.info("> Computing r2(y)");let M=rw(h,l,s,m[1],e,o,a);a&&a.info("> Computing F");let x=dw(o,h,e,l,s);a&&a.info("> Computing E");let S=uw(o,h,l,e,p,v,M);a&&a.info("> Computing J");let w=_w(o,h,l);a&&a.info("> Validate all evaluations with a pairing");let k=await hw(o,h,l,e,x,S,w);return a&&(k?a.info("PROOF VERIFIED SUCCESSFULLY"):a.warn("Invalid Proof")),a&&a.info("FFLONK VERIFIER FINISHED"),k}function tw(c,t){let n=t;return n.k1=c.Fr.fromObject(t.k1),n.k2=c.Fr.fromObject(t.k2),n.w=c.Fr.fromObject(t.w),n.w3=c.Fr.fromObject(t.w3),n.w4=c.Fr.fromObject(t.w4),n.w8=c.Fr.fromObject(t.w8),n.wr=c.Fr.fromObject(t.wr),n.X_2=c.G2.fromObject(t.X_2),n.C0=c.G1.fromObject(t.C0),n}function nw(c,t,n){let a=c.G1;return a.isValid(t.polynomials.C1)&&a.isValid(t.polynomials.C2)&&a.isValid(t.polynomials.W1)&&a.isValid(t.polynomials.W2)&&a.isValid(n.C0)}function x0(c,t){return vt.Scalar.geq(t,0)&&vt.Scalar.lt(t,c.r)}function Dn(c,t){return x0(c,vt.Scalar.fromRprLE(t))}function aw(c,t){return Dn(c,t.evaluations.ql)&&Dn(c,t.evaluations.qr)&&Dn(c,t.evaluations.qm)&&Dn(c,t.evaluations.qo)&&Dn(c,t.evaluations.qc)&&Dn(c,t.evaluations.s1)&&Dn(c,t.evaluations.s2)&&Dn(c,t.evaluations.s3)&&Dn(c,t.evaluations.a)&&Dn(c,t.evaluations.b)&&Dn(c,t.evaluations.c)&&Dn(c,t.evaluations.z)&&Dn(c,t.evaluations.zw)&&Dn(c,t.evaluations.t1w)&&Dn(c,t.evaluations.t2w)}function ow(c,t){for(let n=0;n<t.length;n++)if(!x0(c,t[n]))return!1;return!0}function iw(c,t,n,a,o){let e=c.Fr,h={},d={},b=new Ga(c);b.addPolCommitment(n.C0);for(let v=0;v<a.length;v++)b.addScalar(e.e(a[v]));b.addPolCommitment(t.polynomials.C1),h.beta=b.getChallenge(),b.reset(),b.addScalar(h.beta),h.gamma=b.getChallenge(),b.reset(),b.addScalar(h.gamma),b.addPolCommitment(t.polynomials.C2);let l=b.getChallenge(),s=e.square(l),m=[];m[1]=n.w8,m[2]=e.square(n.w8),m[3]=e.mul(m[2],n.w8),m[4]=e.mul(m[3],n.w8),m[5]=e.mul(m[4],n.w8),m[6]=e.mul(m[5],n.w8),m[7]=e.mul(m[6],n.w8);let B=[];B[1]=n.w4,B[2]=e.square(n.w4),B[3]=e.mul(B[2],n.w4);let p=[];p[1]=n.w3,p[2]=e.square(n.w3),d.S0={},d.S0.h0w8=[],d.S0.h0w8[0]=e.mul(s,l);for(let v=1;v<8;v++)d.S0.h0w8[v]=e.mul(d.S0.h0w8[0],m[v]);d.S1={},d.S1.h1w4=[],d.S1.h1w4[0]=e.square(d.S0.h0w8[0]);for(let v=1;v<4;v++)d.S1.h1w4[v]=e.mul(d.S1.h1w4[0],B[v]);d.S2={},d.S2.h2w3=[],d.S2.h2w3[0]=e.mul(d.S1.h1w4[0],s),d.S2.h2w3[1]=e.mul(d.S2.h2w3[0],p[1]),d.S2.h2w3[2]=e.mul(d.S2.h2w3[0],p[2]),d.S2.h3w3=[],d.S2.h3w3[0]=e.mul(d.S2.h2w3[0],n.wr),d.S2.h3w3[1]=e.mul(d.S2.h3w3[0],p[1]),d.S2.h3w3[2]=e.mul(d.S2.h3w3[0],p[2]),h.xi=e.mul(e.square(d.S2.h2w3[0]),d.S2.h2w3[0]),h.xiw=e.mul(h.xi,e.w[n.power]),h.xiN=h.xi,n.domainSize=1;for(let v=0;v<n.power;v++)h.xiN=e.square(h.xiN),n.domainSize*=2;return b.reset(),b.addScalar(l),b.addScalar(t.evaluations.ql),b.addScalar(t.evaluations.qr),b.addScalar(t.evaluations.qm),b.addScalar(t.evaluations.qo),b.addScalar(t.evaluations.qc),b.addScalar(t.evaluations.s1),b.addScalar(t.evaluations.s2),b.addScalar(t.evaluations.s3),b.addScalar(t.evaluations.a),b.addScalar(t.evaluations.b),b.addScalar(t.evaluations.c),b.addScalar(t.evaluations.z),b.addScalar(t.evaluations.zw),b.addScalar(t.evaluations.t1w),b.addScalar(t.evaluations.t2w),h.alpha=b.getChallenge(),b.reset(),b.addScalar(h.alpha),b.addPolCommitment(t.polynomials.W1),h.y=b.getChallenge(),o&&(o.info("\xB7\xB7\xB7 challenges.beta:  "+e.toString(h.beta)),o.info("\xB7\xB7\xB7 challenges.gamma: "+e.toString(h.gamma)),o.info("\xB7\xB7\xB7 challenges.xi:    "+e.toString(h.xi)),o.info("\xB7\xB7\xB7 challenges.alpha: "+e.toString(h.alpha)),o.info("\xB7\xB7\xB7 challenges.y:     "+e.toString(h.y))),{challenges:h,roots:d}}async function ew(c,t,n){let a=c.Fr,o=Math.max(1,n.nPublic),e=new vt.BigBuffer(o*a.n8),h=new vt.BigBuffer(o*a.n8),d=a.one;for(let l=0;l<o;l++){let s=l*a.n8;e.set(a.mul(d,t.zh),s),h.set(a.mul(a.e(n.domainSize),a.sub(t.xi,d)),s),d=a.mul(d,n.w)}h=await a.batchInverse(h);let b=[];for(let l=0;l<o;l++){let s=l*a.n8;b[l+1]=a.mul(e.slice(s,s+a.n8),h.slice(s,s+a.n8))}return b}function cw(c,t,n){let a=c.Fr,o=a.zero;for(let e=0;e<t.length;e++){let h=a.e(t[e]);o=a.sub(o,a.mul(h,n[e+1]))}return o}function sw(c,t,n,a,o){let e=a.Fr,h=A0(n.S0.h0w8,t.y,t.xi,a);o&&o.info("\xB7\xB7\xB7 Computing r0(y)");let d=e.zero;for(let b=0;b<8;b++){let l=[];l[1]=n.S0.h0w8[b];for(let m=2;m<8;m++)l[m]=e.mul(l[m-1],n.S0.h0w8[b]);let s=e.add(c.evaluations.ql,e.mul(c.evaluations.qr,l[1]));s=e.add(s,e.mul(c.evaluations.qo,l[2])),s=e.add(s,e.mul(c.evaluations.qm,l[3])),s=e.add(s,e.mul(c.evaluations.qc,l[4])),s=e.add(s,e.mul(c.evaluations.s1,l[5])),s=e.add(s,e.mul(c.evaluations.s2,l[6])),s=e.add(s,e.mul(c.evaluations.s3,l[7])),d=e.add(d,e.mul(s,h[b]))}return d}function lw(c,t,n,a,o,e){let h=o.Fr,d=A0(n.S1.h1w4,t.y,t.xi,o);e&&e.info("\xB7\xB7\xB7 Computing T0(xi)");let b=h.mul(c.evaluations.ql,c.evaluations.a);b=h.add(b,h.mul(c.evaluations.qr,c.evaluations.b)),b=h.add(b,h.mul(c.evaluations.qm,h.mul(c.evaluations.a,c.evaluations.b))),b=h.add(b,h.mul(c.evaluations.qo,c.evaluations.c)),b=h.add(b,c.evaluations.qc),b=h.add(b,a),b=h.mul(b,t.invzh),e&&e.info("\xB7\xB7\xB7 Computing C1(h_1\u03C9_4^i) values");let l=h.zero;for(let s=0;s<4;s++){let m=c.evaluations.a;m=h.add(m,h.mul(n.S1.h1w4[s],c.evaluations.b));let B=h.square(n.S1.h1w4[s]);m=h.add(m,h.mul(B,c.evaluations.c)),m=h.add(m,h.mul(h.mul(B,n.S1.h1w4[s]),b)),l=h.add(l,h.mul(m,d[s]))}return l}function rw(c,t,n,a,o,e,h){let d=e.Fr,b=fw([n.S2.h2w3,n.S2.h3w3],t.y,t.xi,t.xiw,e);h&&h.info("\xB7\xB7\xB7 Computing T1(xi)");let l=d.sub(c.evaluations.z,d.one);l=d.mul(l,a),l=d.mul(l,t.invzh),h&&h.info("\xB7\xB7\xB7 Computing T2(xi)");let s=d.mul(t.beta,t.xi),m=d.add(c.evaluations.a,d.add(s,t.gamma)),B=d.add(c.evaluations.b,d.add(d.mul(s,o.k1),t.gamma)),p=d.add(c.evaluations.c,d.add(d.mul(s,o.k2),t.gamma)),v=d.mul(m,d.mul(B,d.mul(p,c.evaluations.z))),M=d.add(c.evaluations.a,d.add(d.mul(t.beta,c.evaluations.s1),t.gamma)),x=d.add(c.evaluations.b,d.add(d.mul(t.beta,c.evaluations.s2),t.gamma)),S=d.add(c.evaluations.c,d.add(d.mul(t.beta,c.evaluations.s3),t.gamma)),w=d.mul(M,d.mul(x,d.mul(S,c.evaluations.zw))),k=d.sub(v,w);k=d.mul(k,t.invzh),h&&h.info("\xB7\xB7\xB7 Computing C2(h_2\u03C9_3^i) values");let O=d.zero;for(let W=0;W<3;W++){let F=d.add(c.evaluations.z,d.mul(n.S2.h2w3[W],l));F=d.add(F,d.mul(d.square(n.S2.h2w3[W]),k)),O=d.add(O,d.mul(F,b[W]))}h&&h.info("\xB7\xB7\xB7 Computing C2(h_3\u03C9_3^i) values");for(let W=0;W<3;W++){let F=d.add(c.evaluations.zw,d.mul(n.S2.h3w3[W],c.evaluations.t1w));F=d.add(F,d.mul(d.square(n.S2.h3w3[W]),c.evaluations.t2w)),O=d.add(O,d.mul(F,b[W+3]))}return O}function dw(c,t,n,a,o){let e=c.G1,h=c.Fr,d=h.sub(a.y,o.S0.h0w8[0]);for(let B=1;B<8;B++)d=h.mul(d,h.sub(a.y,o.S0.h0w8[B]));a.temp=d;let b=h.sub(a.y,o.S1.h1w4[0]);for(let B=1;B<4;B++)b=h.mul(b,h.sub(a.y,o.S1.h1w4[B]));let l=h.sub(a.y,o.S2.h2w3[0]);for(let B=1;B<3;B++)l=h.mul(l,h.sub(a.y,o.S2.h2w3[B]));for(let B=0;B<3;B++)l=h.mul(l,h.sub(a.y,o.S2.h3w3[B]));a.quotient1=h.mul(a.alpha,h.div(d,b)),a.quotient2=h.mul(h.square(a.alpha),h.div(d,l));let s=e.timesFr(t.polynomials.C1,a.quotient1),m=e.timesFr(t.polynomials.C2,a.quotient2);return e.add(n.C0,e.add(s,m))}function uw(c,t,n,a,o,e,h){let d=c.G1,b=c.Fr,l=b.mul(e,n.quotient1),s=b.mul(h,n.quotient2);return d.timesFr(d.one,b.add(o,b.add(l,s)))}function _w(c,t,n){return c.G1.timesFr(t.polynomials.W1,n.temp)}async function hw(c,t,n,a,o,e,h){let d=c.G1,b=d.timesFr(t.polynomials.W2,n.y);b=d.add(d.sub(d.sub(o,e),h),b);let l=c.G2.one,s=t.polynomials.W2,m=a.X_2;return await c.pairingEq(d.neg(b),l,s,m)}function A0(c,t,n,a){let o=a.Fr,e=c.length,h=o.sub(o.exp(t,e),n),d=o.mul(o.e(e),o.exp(c[0],e-2)),b=[];for(let l=0;l<e;l++){let s=c[(e-1)*l%e],m=o.sub(t,c[l]);b[l]=o.div(h,o.mul(o.mul(d,s),m))}return b}function fw(c,t,n,a,o){let e=o.Fr,h=[],d=c[0].length,b=d*c.length,l=e.exp(t,b),s=e.mul(e.add(n,a),e.exp(t,d)),m=e.mul(n,a),B=e.add(e.sub(l,s),m),p=e.mul(e.mul(e.e(d),c[0][0]),e.sub(n,a));for(let v=0;v<d;v++){let M=c[0][(d-1)*v%d],x=e.sub(t,c[0][v]),S=e.mul(p,e.mul(M,x));h[v]=e.div(B,S)}p=e.mul(e.mul(e.e(d),c[1][0]),e.sub(a,n));for(let v=0;v<d;v++){let M=c[1][(d-1)*v%d],x=e.sub(t,c[1][v]),S=e.mul(p,e.mul(M,x));h[v+d]=e.div(B,S)}return h}var{unstringifyBigInts:i0}=vt.utils;function _n(c){let t=c.toString(16);for(;t.length<64;)t="0"+t;return t=`0x${t}`,t}async function gw(c,t){let n=i0(t),a=i0(c),o=await yo(n.curve);o.G1,o.Fr;let e="";for(let h=0;h<a.length;h++)e!==""&&(e=e+","),e=e+_n(a[h]);return`[${_n(n.polynomials.C1[0])}, ${_n(n.polynomials.C1[1])},${_n(n.polynomials.C2[0])},${_n(n.polynomials.C2[1])},${_n(n.polynomials.W1[0])},${_n(n.polynomials.W1[1])},${_n(n.polynomials.W2[0])},${_n(n.polynomials.W2[1])},${_n(n.evaluations.ql)},${_n(n.evaluations.qr)},${_n(n.evaluations.qm)},${_n(n.evaluations.qo)},${_n(n.evaluations.qc)},${_n(n.evaluations.s1)},${_n(n.evaluations.s2)},${_n(n.evaluations.s3)},${_n(n.evaluations.a)},${_n(n.evaluations.b)},${_n(n.evaluations.c)},${_n(n.evaluations.z)},${_n(n.evaluations.zw)},${_n(n.evaluations.t1w)},${_n(n.evaluations.t2w)},${_n(n.evaluations.inv)}],[${e}]`}var Lw=Object.freeze({__proto__:null,setup:Dy,prove:B0,fullProve:Jy,verify:Yy,exportSolidityVerifier:w0,exportSolidityCallData:gw});Ea.curves=c6;Ea.fflonk=Lw;Ea.groth16=M6;Ea.plonk=Wy;Ea.powersOfTau=D6;Ea.r1cs=ay;Ea.wtns=sy;Ea.zKey=Fy});return pw();})();
/*! Bundled license information:

@noble/hashes/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

ejs/lib/ejs.js:
  (**
   * @file Embedded JavaScript templating engine. {@link http://ejs.co}
   * @author Matthew Eernisse <mde@fleegix.org>
   * @author Tiancheng "Timothy" Gu <timothygu99@gmail.com>
   * @project EJS
   * @license {@link http://www.apache.org/licenses/LICENSE-2.0 Apache License, Version 2.0}
   *)
*/
